function s4(t,n){for(var r=0;r<n.length;r++){const s=n[r];if(typeof s!="string"&&!Array.isArray(s)){for(const i in s)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(s,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>s[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();function jp(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Yh={exports:{}},rc={},Zh={exports:{}},Ot={};var d0;function a4(){if(d0)return Ot;d0=1;var t=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.iterator;function v(I){return I===null||typeof I!="object"?null:(I=g&&I[g]||I["@@iterator"],typeof I=="function"?I:null)}var j={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,b={};function C(I,re,T){this.props=I,this.context=re,this.refs=b,this.updater=T||j}C.prototype.isReactComponent={},C.prototype.setState=function(I,re){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,re,"setState")},C.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function S(){}S.prototype=C.prototype;function k(I,re,T){this.props=I,this.context=re,this.refs=b,this.updater=T||j}var P=k.prototype=new S;P.constructor=k,N(P,C.prototype),P.isPureReactComponent=!0;var R=Array.isArray,E=Object.prototype.hasOwnProperty,A={current:null},W={key:!0,ref:!0,__self:!0,__source:!0};function X(I,re,T){var Y,oe={},Ne=null,xe=null;if(re!=null)for(Y in re.ref!==void 0&&(xe=re.ref),re.key!==void 0&&(Ne=""+re.key),re)E.call(re,Y)&&!W.hasOwnProperty(Y)&&(oe[Y]=re[Y]);var Se=arguments.length-2;if(Se===1)oe.children=T;else if(1<Se){for(var Oe=Array(Se),Pe=0;Pe<Se;Pe++)Oe[Pe]=arguments[Pe+2];oe.children=Oe}if(I&&I.defaultProps)for(Y in Se=I.defaultProps,Se)oe[Y]===void 0&&(oe[Y]=Se[Y]);return{$$typeof:t,type:I,key:Ne,ref:xe,props:oe,_owner:A.current}}function se(I,re){return{$$typeof:t,type:I.type,key:re,ref:I.ref,props:I.props,_owner:I._owner}}function V(I){return typeof I=="object"&&I!==null&&I.$$typeof===t}function G(I){var re={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(T){return re[T]})}var O=/\/+/g;function F(I,re){return typeof I=="object"&&I!==null&&I.key!=null?G(""+I.key):re.toString(36)}function U(I,re,T,Y,oe){var Ne=typeof I;(Ne==="undefined"||Ne==="boolean")&&(I=null);var xe=!1;if(I===null)xe=!0;else switch(Ne){case"string":case"number":xe=!0;break;case"object":switch(I.$$typeof){case t:case n:xe=!0}}if(xe)return xe=I,oe=oe(xe),I=Y===""?"."+F(xe,0):Y,R(oe)?(T="",I!=null&&(T=I.replace(O,"$&/")+"/"),U(oe,re,T,"",function(Pe){return Pe})):oe!=null&&(V(oe)&&(oe=se(oe,T+(!oe.key||xe&&xe.key===oe.key?"":(""+oe.key).replace(O,"$&/")+"/")+I)),re.push(oe)),1;if(xe=0,Y=Y===""?".":Y+":",R(I))for(var Se=0;Se<I.length;Se++){Ne=I[Se];var Oe=Y+F(Ne,Se);xe+=U(Ne,re,T,Oe,oe)}else if(Oe=v(I),typeof Oe=="function")for(I=Oe.call(I),Se=0;!(Ne=I.next()).done;)Ne=Ne.value,Oe=Y+F(Ne,Se++),xe+=U(Ne,re,T,Oe,oe);else if(Ne==="object")throw re=String(I),Error("Objects are not valid as a React child (found: "+(re==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":re)+"). If you meant to render a collection of children, use an array instead.");return xe}function $(I,re,T){if(I==null)return I;var Y=[],oe=0;return U(I,Y,"","",function(Ne){return re.call(T,Ne,oe++)}),Y}function q(I){if(I._status===-1){var re=I._result;re=re(),re.then(function(T){(I._status===0||I._status===-1)&&(I._status=1,I._result=T)},function(T){(I._status===0||I._status===-1)&&(I._status=2,I._result=T)}),I._status===-1&&(I._status=0,I._result=re)}if(I._status===1)return I._result.default;throw I._result}var le={current:null},K={transition:null},J={ReactCurrentDispatcher:le,ReactCurrentBatchConfig:K,ReactCurrentOwner:A};function D(){throw Error("act(...) is not supported in production builds of React.")}return Ot.Children={map:$,forEach:function(I,re,T){$(I,function(){re.apply(this,arguments)},T)},count:function(I){var re=0;return $(I,function(){re++}),re},toArray:function(I){return $(I,function(re){return re})||[]},only:function(I){if(!V(I))throw Error("React.Children.only expected to receive a single React element child.");return I}},Ot.Component=C,Ot.Fragment=r,Ot.Profiler=i,Ot.PureComponent=k,Ot.StrictMode=s,Ot.Suspense=p,Ot.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J,Ot.act=D,Ot.cloneElement=function(I,re,T){if(I==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+I+".");var Y=N({},I.props),oe=I.key,Ne=I.ref,xe=I._owner;if(re!=null){if(re.ref!==void 0&&(Ne=re.ref,xe=A.current),re.key!==void 0&&(oe=""+re.key),I.type&&I.type.defaultProps)var Se=I.type.defaultProps;for(Oe in re)E.call(re,Oe)&&!W.hasOwnProperty(Oe)&&(Y[Oe]=re[Oe]===void 0&&Se!==void 0?Se[Oe]:re[Oe])}var Oe=arguments.length-2;if(Oe===1)Y.children=T;else if(1<Oe){Se=Array(Oe);for(var Pe=0;Pe<Oe;Pe++)Se[Pe]=arguments[Pe+2];Y.children=Se}return{$$typeof:t,type:I.type,key:oe,ref:Ne,props:Y,_owner:xe}},Ot.createContext=function(I){return I={$$typeof:c,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},I.Provider={$$typeof:o,_context:I},I.Consumer=I},Ot.createElement=X,Ot.createFactory=function(I){var re=X.bind(null,I);return re.type=I,re},Ot.createRef=function(){return{current:null}},Ot.forwardRef=function(I){return{$$typeof:d,render:I}},Ot.isValidElement=V,Ot.lazy=function(I){return{$$typeof:h,_payload:{_status:-1,_result:I},_init:q}},Ot.memo=function(I,re){return{$$typeof:m,type:I,compare:re===void 0?null:re}},Ot.startTransition=function(I){var re=K.transition;K.transition={};try{I()}finally{K.transition=re}},Ot.unstable_act=D,Ot.useCallback=function(I,re){return le.current.useCallback(I,re)},Ot.useContext=function(I){return le.current.useContext(I)},Ot.useDebugValue=function(){},Ot.useDeferredValue=function(I){return le.current.useDeferredValue(I)},Ot.useEffect=function(I,re){return le.current.useEffect(I,re)},Ot.useId=function(){return le.current.useId()},Ot.useImperativeHandle=function(I,re,T){return le.current.useImperativeHandle(I,re,T)},Ot.useInsertionEffect=function(I,re){return le.current.useInsertionEffect(I,re)},Ot.useLayoutEffect=function(I,re){return le.current.useLayoutEffect(I,re)},Ot.useMemo=function(I,re){return le.current.useMemo(I,re)},Ot.useReducer=function(I,re,T){return le.current.useReducer(I,re,T)},Ot.useRef=function(I){return le.current.useRef(I)},Ot.useState=function(I){return le.current.useState(I)},Ot.useSyncExternalStore=function(I,re,T){return le.current.useSyncExternalStore(I,re,T)},Ot.useTransition=function(){return le.current.useTransition()},Ot.version="18.3.1",Ot}var u0;function bp(){return u0||(u0=1,Zh.exports=a4()),Zh.exports}var p0;function i4(){if(p0)return rc;p0=1;var t=bp(),n=Symbol.for("react.element"),r=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(d,p,m){var h,g={},v=null,j=null;m!==void 0&&(v=""+m),p.key!==void 0&&(v=""+p.key),p.ref!==void 0&&(j=p.ref);for(h in p)s.call(p,h)&&!o.hasOwnProperty(h)&&(g[h]=p[h]);if(d&&d.defaultProps)for(h in p=d.defaultProps,p)g[h]===void 0&&(g[h]=p[h]);return{$$typeof:n,type:d,key:v,ref:j,props:g,_owner:i.current}}return rc.Fragment=r,rc.jsx=c,rc.jsxs=c,rc}var m0;function o4(){return m0||(m0=1,Yh.exports=i4()),Yh.exports}var e=o4(),mu={},Xh={exports:{}},Rr={},Jh={exports:{}},ef={};var h0;function l4(){return h0||(h0=1,(function(t){function n(K,J){var D=K.length;K.push(J);e:for(;0<D;){var I=D-1>>>1,re=K[I];if(0<i(re,J))K[I]=J,K[D]=re,D=I;else break e}}function r(K){return K.length===0?null:K[0]}function s(K){if(K.length===0)return null;var J=K[0],D=K.pop();if(D!==J){K[0]=D;e:for(var I=0,re=K.length,T=re>>>1;I<T;){var Y=2*(I+1)-1,oe=K[Y],Ne=Y+1,xe=K[Ne];if(0>i(oe,D))Ne<re&&0>i(xe,oe)?(K[I]=xe,K[Ne]=D,I=Ne):(K[I]=oe,K[Y]=D,I=Y);else if(Ne<re&&0>i(xe,D))K[I]=xe,K[Ne]=D,I=Ne;else break e}}return J}function i(K,J){var D=K.sortIndex-J.sortIndex;return D!==0?D:K.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var c=Date,d=c.now();t.unstable_now=function(){return c.now()-d}}var p=[],m=[],h=1,g=null,v=3,j=!1,N=!1,b=!1,C=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(K){for(var J=r(m);J!==null;){if(J.callback===null)s(m);else if(J.startTime<=K)s(m),J.sortIndex=J.expirationTime,n(p,J);else break;J=r(m)}}function R(K){if(b=!1,P(K),!N)if(r(p)!==null)N=!0,q(E);else{var J=r(m);J!==null&&le(R,J.startTime-K)}}function E(K,J){N=!1,b&&(b=!1,S(X),X=-1),j=!0;var D=v;try{for(P(J),g=r(p);g!==null&&(!(g.expirationTime>J)||K&&!G());){var I=g.callback;if(typeof I=="function"){g.callback=null,v=g.priorityLevel;var re=I(g.expirationTime<=J);J=t.unstable_now(),typeof re=="function"?g.callback=re:g===r(p)&&s(p),P(J)}else s(p);g=r(p)}if(g!==null)var T=!0;else{var Y=r(m);Y!==null&&le(R,Y.startTime-J),T=!1}return T}finally{g=null,v=D,j=!1}}var A=!1,W=null,X=-1,se=5,V=-1;function G(){return!(t.unstable_now()-V<se)}function O(){if(W!==null){var K=t.unstable_now();V=K;var J=!0;try{J=W(!0,K)}finally{J?F():(A=!1,W=null)}}else A=!1}var F;if(typeof k=="function")F=function(){k(O)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,$=U.port2;U.port1.onmessage=O,F=function(){$.postMessage(null)}}else F=function(){C(O,0)};function q(K){W=K,A||(A=!0,F())}function le(K,J){X=C(function(){K(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(K){K.callback=null},t.unstable_continueExecution=function(){N||j||(N=!0,q(E))},t.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):se=0<K?Math.floor(1e3/K):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_getFirstCallbackNode=function(){return r(p)},t.unstable_next=function(K){switch(v){case 1:case 2:case 3:var J=3;break;default:J=v}var D=v;v=J;try{return K()}finally{v=D}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(K,J){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var D=v;v=K;try{return J()}finally{v=D}},t.unstable_scheduleCallback=function(K,J,D){var I=t.unstable_now();switch(typeof D=="object"&&D!==null?(D=D.delay,D=typeof D=="number"&&0<D?I+D:I):D=I,K){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=D+re,K={id:h++,callback:J,priorityLevel:K,startTime:D,expirationTime:re,sortIndex:-1},D>I?(K.sortIndex=D,n(m,K),r(p)===null&&K===r(m)&&(b?(S(X),X=-1):b=!0,le(R,D-I))):(K.sortIndex=re,n(p,K),N||j||(N=!0,q(E))),K},t.unstable_shouldYield=G,t.unstable_wrapCallback=function(K){var J=v;return function(){var D=v;v=J;try{return K.apply(this,arguments)}finally{v=D}}}})(ef)),ef}var f0;function c4(){return f0||(f0=1,Jh.exports=l4()),Jh.exports}var x0;function d4(){if(x0)return Rr;x0=1;var t=bp(),n=c4();function r(a){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+a,u=1;u<arguments.length;u++)l+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,i={};function o(a,l){c(a,l),c(a+"Capture",l)}function c(a,l){for(i[a]=l,a=0;a<l.length;a++)s.add(l[a])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),p=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},g={};function v(a){return p.call(g,a)?!0:p.call(h,a)?!1:m.test(a)?g[a]=!0:(h[a]=!0,!1)}function j(a,l,u,f){if(u!==null&&u.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return f?!1:u!==null?!u.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function N(a,l,u,f){if(l===null||typeof l>"u"||j(a,l,u,f))return!0;if(f)return!1;if(u!==null)switch(u.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function b(a,l,u,f,y,w,_){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=f,this.attributeNamespace=y,this.mustUseProperty=u,this.propertyName=a,this.type=l,this.sanitizeURL=w,this.removeEmptyString=_}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){C[a]=new b(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var l=a[0];C[l]=new b(l,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){C[a]=new b(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){C[a]=new b(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){C[a]=new b(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){C[a]=new b(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){C[a]=new b(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){C[a]=new b(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){C[a]=new b(a,5,!1,a.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function k(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var l=a.replace(S,k);C[l]=new b(l,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var l=a.replace(S,k);C[l]=new b(l,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var l=a.replace(S,k);C[l]=new b(l,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){C[a]=new b(a,1,!1,a.toLowerCase(),null,!1,!1)}),C.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){C[a]=new b(a,1,!1,a.toLowerCase(),null,!0,!0)});function P(a,l,u,f){var y=C.hasOwnProperty(l)?C[l]:null;(y!==null?y.type!==0:f||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(N(l,u,y,f)&&(u=null),f||y===null?v(l)&&(u===null?a.removeAttribute(l):a.setAttribute(l,""+u)):y.mustUseProperty?a[y.propertyName]=u===null?y.type===3?!1:"":u:(l=y.attributeName,f=y.attributeNamespace,u===null?a.removeAttribute(l):(y=y.type,u=y===3||y===4&&u===!0?"":""+u,f?a.setAttributeNS(f,l,u):a.setAttribute(l,u))))}var R=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,E=Symbol.for("react.element"),A=Symbol.for("react.portal"),W=Symbol.for("react.fragment"),X=Symbol.for("react.strict_mode"),se=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),G=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),U=Symbol.for("react.suspense_list"),$=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),le=Symbol.for("react.offscreen"),K=Symbol.iterator;function J(a){return a===null||typeof a!="object"?null:(a=K&&a[K]||a["@@iterator"],typeof a=="function"?a:null)}var D=Object.assign,I;function re(a){if(I===void 0)try{throw Error()}catch(u){var l=u.stack.trim().match(/\n( *(at )?)/);I=l&&l[1]||""}return`
`+I+a}var T=!1;function Y(a,l){if(!a||T)return"";T=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(fe){var f=fe}Reflect.construct(a,[],l)}else{try{l.call()}catch(fe){f=fe}a.call(l.prototype)}else{try{throw Error()}catch(fe){f=fe}a()}}catch(fe){if(fe&&f&&typeof fe.stack=="string"){for(var y=fe.stack.split(`
`),w=f.stack.split(`
`),_=y.length-1,Z=w.length-1;1<=_&&0<=Z&&y[_]!==w[Z];)Z--;for(;1<=_&&0<=Z;_--,Z--)if(y[_]!==w[Z]){if(_!==1||Z!==1)do if(_--,Z--,0>Z||y[_]!==w[Z]){var ee=`
`+y[_].replace(" at new "," at ");return a.displayName&&ee.includes("<anonymous>")&&(ee=ee.replace("<anonymous>",a.displayName)),ee}while(1<=_&&0<=Z);break}}}finally{T=!1,Error.prepareStackTrace=u}return(a=a?a.displayName||a.name:"")?re(a):""}function oe(a){switch(a.tag){case 5:return re(a.type);case 16:return re("Lazy");case 13:return re("Suspense");case 19:return re("SuspenseList");case 0:case 2:case 15:return a=Y(a.type,!1),a;case 11:return a=Y(a.type.render,!1),a;case 1:return a=Y(a.type,!0),a;default:return""}}function Ne(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case W:return"Fragment";case A:return"Portal";case se:return"Profiler";case X:return"StrictMode";case F:return"Suspense";case U:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case G:return(a.displayName||"Context")+".Consumer";case V:return(a._context.displayName||"Context")+".Provider";case O:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case $:return l=a.displayName||null,l!==null?l:Ne(a.type)||"Memo";case q:l=a._payload,a=a._init;try{return Ne(a(l))}catch{}}return null}function xe(a){var l=a.type;switch(a.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=l.render,a=a.displayName||a.name||"",l.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ne(l);case 8:return l===X?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function Se(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Oe(a){var l=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Pe(a){var l=Oe(a)?"checked":"value",u=Object.getOwnPropertyDescriptor(a.constructor.prototype,l),f=""+a[l];if(!a.hasOwnProperty(l)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var y=u.get,w=u.set;return Object.defineProperty(a,l,{configurable:!0,get:function(){return y.call(this)},set:function(_){f=""+_,w.call(this,_)}}),Object.defineProperty(a,l,{enumerable:u.enumerable}),{getValue:function(){return f},setValue:function(_){f=""+_},stopTracking:function(){a._valueTracker=null,delete a[l]}}}}function Be(a){a._valueTracker||(a._valueTracker=Pe(a))}function ve(a){if(!a)return!1;var l=a._valueTracker;if(!l)return!0;var u=l.getValue(),f="";return a&&(f=Oe(a)?a.checked?"true":"false":a.value),a=f,a!==u?(l.setValue(a),!0):!1}function We(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function Ye(a,l){var u=l.checked;return D({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??a._wrapperState.initialChecked})}function Qe(a,l){var u=l.defaultValue==null?"":l.defaultValue,f=l.checked!=null?l.checked:l.defaultChecked;u=Se(l.value!=null?l.value:u),a._wrapperState={initialChecked:f,initialValue:u,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function mt(a,l){l=l.checked,l!=null&&P(a,"checked",l,!1)}function ht(a,l){mt(a,l);var u=Se(l.value),f=l.type;if(u!=null)f==="number"?(u===0&&a.value===""||a.value!=u)&&(a.value=""+u):a.value!==""+u&&(a.value=""+u);else if(f==="submit"||f==="reset"){a.removeAttribute("value");return}l.hasOwnProperty("value")?Jt(a,l.type,u):l.hasOwnProperty("defaultValue")&&Jt(a,l.type,Se(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(a.defaultChecked=!!l.defaultChecked)}function cn(a,l,u){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var f=l.type;if(!(f!=="submit"&&f!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+a._wrapperState.initialValue,u||l===a.value||(a.value=l),a.defaultValue=l}u=a.name,u!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,u!==""&&(a.name=u)}function Jt(a,l,u){(l!=="number"||We(a.ownerDocument)!==a)&&(u==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+u&&(a.defaultValue=""+u))}var Vt=Array.isArray;function tt(a,l,u,f){if(a=a.options,l){l={};for(var y=0;y<u.length;y++)l["$"+u[y]]=!0;for(u=0;u<a.length;u++)y=l.hasOwnProperty("$"+a[u].value),a[u].selected!==y&&(a[u].selected=y),y&&f&&(a[u].defaultSelected=!0)}else{for(u=""+Se(u),l=null,y=0;y<a.length;y++){if(a[y].value===u){a[y].selected=!0,f&&(a[y].defaultSelected=!0);return}l!==null||a[y].disabled||(l=a[y])}l!==null&&(l.selected=!0)}}function L(a,l){if(l.dangerouslySetInnerHTML!=null)throw Error(r(91));return D({},l,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function de(a,l){var u=l.value;if(u==null){if(u=l.children,l=l.defaultValue,u!=null){if(l!=null)throw Error(r(92));if(Vt(u)){if(1<u.length)throw Error(r(93));u=u[0]}l=u}l==null&&(l=""),u=l}a._wrapperState={initialValue:Se(u)}}function ge(a,l){var u=Se(l.value),f=Se(l.defaultValue);u!=null&&(u=""+u,u!==a.value&&(a.value=u),l.defaultValue==null&&a.defaultValue!==u&&(a.defaultValue=u)),f!=null&&(a.defaultValue=""+f)}function ze(a){var l=a.textContent;l===a._wrapperState.initialValue&&l!==""&&l!==null&&(a.value=l)}function M(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ie(a,l){return a==null||a==="http://www.w3.org/1999/xhtml"?M(l):a==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var we,qe=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,u,f,y){MSApp.execUnsafeLocalFunction(function(){return a(l,u,f,y)})}:a})(function(a,l){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=l;else{for(we=we||document.createElement("div"),we.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=we.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;l.firstChild;)a.appendChild(l.firstChild)}});function Ze(a,l){if(l){var u=a.firstChild;if(u&&u===a.lastChild&&u.nodeType===3){u.nodeValue=l;return}}a.textContent=l}var Rt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},en=["Webkit","ms","Moz","O"];Object.keys(Rt).forEach(function(a){en.forEach(function(l){l=l+a.charAt(0).toUpperCase()+a.substring(1),Rt[l]=Rt[a]})});function Lt(a,l,u){return l==null||typeof l=="boolean"||l===""?"":u||typeof l!="number"||l===0||Rt.hasOwnProperty(a)&&Rt[a]?(""+l).trim():l+"px"}function An(a,l){a=a.style;for(var u in l)if(l.hasOwnProperty(u)){var f=u.indexOf("--")===0,y=Lt(u,l[u],f);u==="float"&&(u="cssFloat"),f?a.setProperty(u,y):a[u]=y}}var Hn=D({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function tn(a,l){if(l){if(Hn[a]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(r(137,a));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(r(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(r(61))}if(l.style!=null&&typeof l.style!="object")throw Error(r(62))}}function Sn(a,l){if(a.indexOf("-")===-1)return typeof l.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hn=null;function Jr(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Ts=null,ir=null,$r=null;function ba(a){if(a=ql(a)){if(typeof Ts!="function")throw Error(r(280));var l=a.stateNode;l&&(l=Pd(l),Ts(a.stateNode,a.type,l))}}function Rs(a){ir?$r?$r.push(a):$r=[a]:ir=a}function te(){if(ir){var a=ir,l=$r;if($r=ir=null,ba(a),l)for(a=0;a<l.length;a++)ba(l[a])}}function Ee(a,l){return a(l)}function H(){}var Nt=!1;function zn(a,l,u){if(Nt)return a(l,u);Nt=!0;try{return Ee(a,l,u)}finally{Nt=!1,(ir!==null||$r!==null)&&(H(),te())}}function Xn(a,l){var u=a.stateNode;if(u===null)return null;var f=Pd(u);if(f===null)return null;u=f[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(a=a.type,f=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!f;break e;default:a=!1}if(a)return null;if(u&&typeof u!="function")throw Error(r(231,l,typeof u));return u}var wa=!1;if(d)try{var Xs={};Object.defineProperty(Xs,"passive",{get:function(){wa=!0}}),window.addEventListener("test",Xs,Xs),window.removeEventListener("test",Xs,Xs)}catch{wa=!1}function id(a,l,u,f,y,w,_,Z,ee){var fe=Array.prototype.slice.call(arguments,3);try{l.apply(u,fe)}catch(_e){this.onError(_e)}}var vi=!1,Na=null,Qi=!1,Ca=null,es={onError:function(a){vi=!0,Na=a}};function od(a,l,u,f,y,w,_,Z,ee){vi=!1,Na=null,id.apply(es,arguments)}function As(a,l,u,f,y,w,_,Z,ee){if(od.apply(this,arguments),vi){if(vi){var fe=Na;vi=!1,Na=null}else throw Error(r(198));Qi||(Qi=!0,Ca=fe)}}function _s(a){var l=a,u=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,(l.flags&4098)!==0&&(u=l.return),a=l.return;while(a)}return l.tag===3?u:null}function Yi(a){if(a.tag===13){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function bl(a){if(_s(a)!==a)throw Error(r(188))}function Is(a){var l=a.alternate;if(!l){if(l=_s(a),l===null)throw Error(r(188));return l!==a?null:a}for(var u=a,f=l;;){var y=u.return;if(y===null)break;var w=y.alternate;if(w===null){if(f=y.return,f!==null){u=f;continue}break}if(y.child===w.child){for(w=y.child;w;){if(w===u)return bl(y),a;if(w===f)return bl(y),l;w=w.sibling}throw Error(r(188))}if(u.return!==f.return)u=y,f=w;else{for(var _=!1,Z=y.child;Z;){if(Z===u){_=!0,u=y,f=w;break}if(Z===f){_=!0,f=y,u=w;break}Z=Z.sibling}if(!_){for(Z=w.child;Z;){if(Z===u){_=!0,u=w,f=y;break}if(Z===f){_=!0,f=w,u=y;break}Z=Z.sibling}if(!_)throw Error(r(189))}}if(u.alternate!==f)throw Error(r(190))}if(u.tag!==3)throw Error(r(188));return u.stateNode.current===u?a:l}function wl(a){return a=Is(a),a!==null?ld(a):null}function ld(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var l=ld(a);if(l!==null)return l;a=a.sibling}return null}var yi=n.unstable_scheduleCallback,Zi=n.unstable_cancelCallback,Xi=n.unstable_shouldYield,qt=n.unstable_requestPaint,Yt=n.unstable_now,hm=n.unstable_getCurrentPriorityLevel,Nl=n.unstable_ImmediatePriority,cd=n.unstable_UserBlockingPriority,Ji=n.unstable_NormalPriority,z=n.unstable_LowPriority,Ve=n.unstable_IdlePriority,Ce=null,lt=null;function Ft(a){if(lt&&typeof lt.onCommitFiberRoot=="function")try{lt.onCommitFiberRoot(Ce,a,void 0,(a.current.flags&128)===128)}catch{}}var Jn=Math.clz32?Math.clz32:wP,fm=Math.log,xm=Math.LN2;function wP(a){return a>>>=0,a===0?32:31-(fm(a)/xm|0)|0}var dd=64,ud=4194304;function Cl(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function pd(a,l){var u=a.pendingLanes;if(u===0)return 0;var f=0,y=a.suspendedLanes,w=a.pingedLanes,_=u&268435455;if(_!==0){var Z=_&~y;Z!==0?f=Cl(Z):(w&=_,w!==0&&(f=Cl(w)))}else _=u&~y,_!==0?f=Cl(_):w!==0&&(f=Cl(w));if(f===0)return 0;if(l!==0&&l!==f&&(l&y)===0&&(y=f&-f,w=l&-l,y>=w||y===16&&(w&4194240)!==0))return l;if((f&4)!==0&&(f|=u&16),l=a.entangledLanes,l!==0)for(a=a.entanglements,l&=f;0<l;)u=31-Jn(l),y=1<<u,f|=a[u],l&=~y;return f}function NP(a,l){switch(a){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function CP(a,l){for(var u=a.suspendedLanes,f=a.pingedLanes,y=a.expirationTimes,w=a.pendingLanes;0<w;){var _=31-Jn(w),Z=1<<_,ee=y[_];ee===-1?((Z&u)===0||(Z&f)!==0)&&(y[_]=NP(Z,l)):ee<=l&&(a.expiredLanes|=Z),w&=~Z}}function gm(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Vv(){var a=dd;return dd<<=1,(dd&4194240)===0&&(dd=64),a}function vm(a){for(var l=[],u=0;31>u;u++)l.push(a);return l}function Sl(a,l,u){a.pendingLanes|=l,l!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,l=31-Jn(l),a[l]=u}function SP(a,l){var u=a.pendingLanes&~l;a.pendingLanes=l,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=l,a.mutableReadLanes&=l,a.entangledLanes&=l,l=a.entanglements;var f=a.eventTimes;for(a=a.expirationTimes;0<u;){var y=31-Jn(u),w=1<<y;l[y]=0,f[y]=-1,a[y]=-1,u&=~w}}function ym(a,l){var u=a.entangledLanes|=l;for(a=a.entanglements;u;){var f=31-Jn(u),y=1<<f;y&l|a[f]&l&&(a[f]|=l),u&=~y}}var Zt=0;function qv(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var Uv,jm,Bv,Gv,Hv,bm=!1,md=[],Sa=null,ka=null,Ea=null,kl=new Map,El=new Map,Pa=[],kP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Kv(a,l){switch(a){case"focusin":case"focusout":Sa=null;break;case"dragenter":case"dragleave":ka=null;break;case"mouseover":case"mouseout":Ea=null;break;case"pointerover":case"pointerout":kl.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":El.delete(l.pointerId)}}function Pl(a,l,u,f,y,w){return a===null||a.nativeEvent!==w?(a={blockedOn:l,domEventName:u,eventSystemFlags:f,nativeEvent:w,targetContainers:[y]},l!==null&&(l=ql(l),l!==null&&jm(l)),a):(a.eventSystemFlags|=f,l=a.targetContainers,y!==null&&l.indexOf(y)===-1&&l.push(y),a)}function EP(a,l,u,f,y){switch(l){case"focusin":return Sa=Pl(Sa,a,l,u,f,y),!0;case"dragenter":return ka=Pl(ka,a,l,u,f,y),!0;case"mouseover":return Ea=Pl(Ea,a,l,u,f,y),!0;case"pointerover":var w=y.pointerId;return kl.set(w,Pl(kl.get(w)||null,a,l,u,f,y)),!0;case"gotpointercapture":return w=y.pointerId,El.set(w,Pl(El.get(w)||null,a,l,u,f,y)),!0}return!1}function Wv(a){var l=ji(a.target);if(l!==null){var u=_s(l);if(u!==null){if(l=u.tag,l===13){if(l=Yi(u),l!==null){a.blockedOn=l,Hv(a.priority,function(){Bv(u)});return}}else if(l===3&&u.stateNode.current.memoizedState.isDehydrated){a.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}a.blockedOn=null}function hd(a){if(a.blockedOn!==null)return!1;for(var l=a.targetContainers;0<l.length;){var u=Nm(a.domEventName,a.eventSystemFlags,l[0],a.nativeEvent);if(u===null){u=a.nativeEvent;var f=new u.constructor(u.type,u);hn=f,u.target.dispatchEvent(f),hn=null}else return l=ql(u),l!==null&&jm(l),a.blockedOn=u,!1;l.shift()}return!0}function Qv(a,l,u){hd(a)&&u.delete(l)}function PP(){bm=!1,Sa!==null&&hd(Sa)&&(Sa=null),ka!==null&&hd(ka)&&(ka=null),Ea!==null&&hd(Ea)&&(Ea=null),kl.forEach(Qv),El.forEach(Qv)}function Tl(a,l){a.blockedOn===l&&(a.blockedOn=null,bm||(bm=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,PP)))}function Rl(a){function l(y){return Tl(y,a)}if(0<md.length){Tl(md[0],a);for(var u=1;u<md.length;u++){var f=md[u];f.blockedOn===a&&(f.blockedOn=null)}}for(Sa!==null&&Tl(Sa,a),ka!==null&&Tl(ka,a),Ea!==null&&Tl(Ea,a),kl.forEach(l),El.forEach(l),u=0;u<Pa.length;u++)f=Pa[u],f.blockedOn===a&&(f.blockedOn=null);for(;0<Pa.length&&(u=Pa[0],u.blockedOn===null);)Wv(u),u.blockedOn===null&&Pa.shift()}var eo=R.ReactCurrentBatchConfig,fd=!0;function TP(a,l,u,f){var y=Zt,w=eo.transition;eo.transition=null;try{Zt=1,wm(a,l,u,f)}finally{Zt=y,eo.transition=w}}function RP(a,l,u,f){var y=Zt,w=eo.transition;eo.transition=null;try{Zt=4,wm(a,l,u,f)}finally{Zt=y,eo.transition=w}}function wm(a,l,u,f){if(fd){var y=Nm(a,l,u,f);if(y===null)zm(a,l,f,xd,u),Kv(a,f);else if(EP(y,a,l,u,f))f.stopPropagation();else if(Kv(a,f),l&4&&-1<kP.indexOf(a)){for(;y!==null;){var w=ql(y);if(w!==null&&Uv(w),w=Nm(a,l,u,f),w===null&&zm(a,l,f,xd,u),w===y)break;y=w}y!==null&&f.stopPropagation()}else zm(a,l,f,null,u)}}var xd=null;function Nm(a,l,u,f){if(xd=null,a=Jr(f),a=ji(a),a!==null)if(l=_s(a),l===null)a=null;else if(u=l.tag,u===13){if(a=Yi(l),a!==null)return a;a=null}else if(u===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;a=null}else l!==a&&(a=null);return xd=a,null}function Yv(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hm()){case Nl:return 1;case cd:return 4;case Ji:case z:return 16;case Ve:return 536870912;default:return 16}default:return 16}}var Ta=null,Cm=null,gd=null;function Zv(){if(gd)return gd;var a,l=Cm,u=l.length,f,y="value"in Ta?Ta.value:Ta.textContent,w=y.length;for(a=0;a<u&&l[a]===y[a];a++);var _=u-a;for(f=1;f<=_&&l[u-f]===y[w-f];f++);return gd=y.slice(a,1<f?1-f:void 0)}function vd(a){var l=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&l===13&&(a=13)):a=l,a===10&&(a=13),32<=a||a===13?a:0}function yd(){return!0}function Xv(){return!1}function zr(a){function l(u,f,y,w,_){this._reactName=u,this._targetInst=y,this.type=f,this.nativeEvent=w,this.target=_,this.currentTarget=null;for(var Z in a)a.hasOwnProperty(Z)&&(u=a[Z],this[Z]=u?u(w):w[Z]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?yd:Xv,this.isPropagationStopped=Xv,this}return D(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=yd)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=yd)},persist:function(){},isPersistent:yd}),l}var to={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sm=zr(to),Al=D({},to,{view:0,detail:0}),AP=zr(Al),km,Em,_l,jd=D({},Al,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tm,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==_l&&(_l&&a.type==="mousemove"?(km=a.screenX-_l.screenX,Em=a.screenY-_l.screenY):Em=km=0,_l=a),km)},movementY:function(a){return"movementY"in a?a.movementY:Em}}),Jv=zr(jd),_P=D({},jd,{dataTransfer:0}),IP=zr(_P),MP=D({},Al,{relatedTarget:0}),Pm=zr(MP),OP=D({},to,{animationName:0,elapsedTime:0,pseudoElement:0}),DP=zr(OP),LP=D({},to,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),FP=zr(LP),$P=D({},to,{data:0}),ey=zr($P),zP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},VP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function UP(a){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(a):(a=qP[a])?!!l[a]:!1}function Tm(){return UP}var BP=D({},Al,{key:function(a){if(a.key){var l=zP[a.key]||a.key;if(l!=="Unidentified")return l}return a.type==="keypress"?(a=vd(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?VP[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tm,charCode:function(a){return a.type==="keypress"?vd(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?vd(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),GP=zr(BP),HP=D({},jd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ty=zr(HP),KP=D({},Al,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tm}),WP=zr(KP),QP=D({},to,{propertyName:0,elapsedTime:0,pseudoElement:0}),YP=zr(QP),ZP=D({},jd,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),XP=zr(ZP),JP=[9,13,27,32],Rm=d&&"CompositionEvent"in window,Il=null;d&&"documentMode"in document&&(Il=document.documentMode);var eT=d&&"TextEvent"in window&&!Il,ny=d&&(!Rm||Il&&8<Il&&11>=Il),ry=" ",sy=!1;function ay(a,l){switch(a){case"keyup":return JP.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function iy(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var no=!1;function tT(a,l){switch(a){case"compositionend":return iy(l);case"keypress":return l.which!==32?null:(sy=!0,ry);case"textInput":return a=l.data,a===ry&&sy?null:a;default:return null}}function nT(a,l){if(no)return a==="compositionend"||!Rm&&ay(a,l)?(a=Zv(),gd=Cm=Ta=null,no=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return ny&&l.locale!=="ko"?null:l.data;default:return null}}var rT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function oy(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l==="input"?!!rT[a.type]:l==="textarea"}function ly(a,l,u,f){Rs(f),l=Sd(l,"onChange"),0<l.length&&(u=new Sm("onChange","change",null,u,f),a.push({event:u,listeners:l}))}var Ml=null,Ol=null;function sT(a){ky(a,0)}function bd(a){var l=oo(a);if(ve(l))return a}function aT(a,l){if(a==="change")return l}var cy=!1;if(d){var Am;if(d){var _m="oninput"in document;if(!_m){var dy=document.createElement("div");dy.setAttribute("oninput","return;"),_m=typeof dy.oninput=="function"}Am=_m}else Am=!1;cy=Am&&(!document.documentMode||9<document.documentMode)}function uy(){Ml&&(Ml.detachEvent("onpropertychange",py),Ol=Ml=null)}function py(a){if(a.propertyName==="value"&&bd(Ol)){var l=[];ly(l,Ol,a,Jr(a)),zn(sT,l)}}function iT(a,l,u){a==="focusin"?(uy(),Ml=l,Ol=u,Ml.attachEvent("onpropertychange",py)):a==="focusout"&&uy()}function oT(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return bd(Ol)}function lT(a,l){if(a==="click")return bd(l)}function cT(a,l){if(a==="input"||a==="change")return bd(l)}function dT(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var hs=typeof Object.is=="function"?Object.is:dT;function Dl(a,l){if(hs(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var u=Object.keys(a),f=Object.keys(l);if(u.length!==f.length)return!1;for(f=0;f<u.length;f++){var y=u[f];if(!p.call(l,y)||!hs(a[y],l[y]))return!1}return!0}function my(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function hy(a,l){var u=my(a);a=0;for(var f;u;){if(u.nodeType===3){if(f=a+u.textContent.length,a<=l&&f>=l)return{node:u,offset:l-a};a=f}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=my(u)}}function fy(a,l){return a&&l?a===l?!0:a&&a.nodeType===3?!1:l&&l.nodeType===3?fy(a,l.parentNode):"contains"in a?a.contains(l):a.compareDocumentPosition?!!(a.compareDocumentPosition(l)&16):!1:!1}function xy(){for(var a=window,l=We();l instanceof a.HTMLIFrameElement;){try{var u=typeof l.contentWindow.location.href=="string"}catch{u=!1}if(u)a=l.contentWindow;else break;l=We(a.document)}return l}function Im(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l&&(l==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||l==="textarea"||a.contentEditable==="true")}function uT(a){var l=xy(),u=a.focusedElem,f=a.selectionRange;if(l!==u&&u&&u.ownerDocument&&fy(u.ownerDocument.documentElement,u)){if(f!==null&&Im(u)){if(l=f.start,a=f.end,a===void 0&&(a=l),"selectionStart"in u)u.selectionStart=l,u.selectionEnd=Math.min(a,u.value.length);else if(a=(l=u.ownerDocument||document)&&l.defaultView||window,a.getSelection){a=a.getSelection();var y=u.textContent.length,w=Math.min(f.start,y);f=f.end===void 0?w:Math.min(f.end,y),!a.extend&&w>f&&(y=f,f=w,w=y),y=hy(u,w);var _=hy(u,f);y&&_&&(a.rangeCount!==1||a.anchorNode!==y.node||a.anchorOffset!==y.offset||a.focusNode!==_.node||a.focusOffset!==_.offset)&&(l=l.createRange(),l.setStart(y.node,y.offset),a.removeAllRanges(),w>f?(a.addRange(l),a.extend(_.node,_.offset)):(l.setEnd(_.node,_.offset),a.addRange(l)))}}for(l=[],a=u;a=a.parentNode;)a.nodeType===1&&l.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<l.length;u++)a=l[u],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var pT=d&&"documentMode"in document&&11>=document.documentMode,ro=null,Mm=null,Ll=null,Om=!1;function gy(a,l,u){var f=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Om||ro==null||ro!==We(f)||(f=ro,"selectionStart"in f&&Im(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Ll&&Dl(Ll,f)||(Ll=f,f=Sd(Mm,"onSelect"),0<f.length&&(l=new Sm("onSelect","select",null,l,u),a.push({event:l,listeners:f}),l.target=ro)))}function wd(a,l){var u={};return u[a.toLowerCase()]=l.toLowerCase(),u["Webkit"+a]="webkit"+l,u["Moz"+a]="moz"+l,u}var so={animationend:wd("Animation","AnimationEnd"),animationiteration:wd("Animation","AnimationIteration"),animationstart:wd("Animation","AnimationStart"),transitionend:wd("Transition","TransitionEnd")},Dm={},vy={};d&&(vy=document.createElement("div").style,"AnimationEvent"in window||(delete so.animationend.animation,delete so.animationiteration.animation,delete so.animationstart.animation),"TransitionEvent"in window||delete so.transitionend.transition);function Nd(a){if(Dm[a])return Dm[a];if(!so[a])return a;var l=so[a],u;for(u in l)if(l.hasOwnProperty(u)&&u in vy)return Dm[a]=l[u];return a}var yy=Nd("animationend"),jy=Nd("animationiteration"),by=Nd("animationstart"),wy=Nd("transitionend"),Ny=new Map,Cy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ra(a,l){Ny.set(a,l),o(l,[a])}for(var Lm=0;Lm<Cy.length;Lm++){var Fm=Cy[Lm],mT=Fm.toLowerCase(),hT=Fm[0].toUpperCase()+Fm.slice(1);Ra(mT,"on"+hT)}Ra(yy,"onAnimationEnd"),Ra(jy,"onAnimationIteration"),Ra(by,"onAnimationStart"),Ra("dblclick","onDoubleClick"),Ra("focusin","onFocus"),Ra("focusout","onBlur"),Ra(wy,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fT=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fl));function Sy(a,l,u){var f=a.type||"unknown-event";a.currentTarget=u,As(f,l,void 0,a),a.currentTarget=null}function ky(a,l){l=(l&4)!==0;for(var u=0;u<a.length;u++){var f=a[u],y=f.event;f=f.listeners;e:{var w=void 0;if(l)for(var _=f.length-1;0<=_;_--){var Z=f[_],ee=Z.instance,fe=Z.currentTarget;if(Z=Z.listener,ee!==w&&y.isPropagationStopped())break e;Sy(y,Z,fe),w=ee}else for(_=0;_<f.length;_++){if(Z=f[_],ee=Z.instance,fe=Z.currentTarget,Z=Z.listener,ee!==w&&y.isPropagationStopped())break e;Sy(y,Z,fe),w=ee}}}if(Qi)throw a=Ca,Qi=!1,Ca=null,a}function dn(a,l){var u=l[Hm];u===void 0&&(u=l[Hm]=new Set);var f=a+"__bubble";u.has(f)||(Ey(l,a,2,!1),u.add(f))}function $m(a,l,u){var f=0;l&&(f|=4),Ey(u,a,f,l)}var Cd="_reactListening"+Math.random().toString(36).slice(2);function $l(a){if(!a[Cd]){a[Cd]=!0,s.forEach(function(u){u!=="selectionchange"&&(fT.has(u)||$m(u,!1,a),$m(u,!0,a))});var l=a.nodeType===9?a:a.ownerDocument;l===null||l[Cd]||(l[Cd]=!0,$m("selectionchange",!1,l))}}function Ey(a,l,u,f){switch(Yv(l)){case 1:var y=TP;break;case 4:y=RP;break;default:y=wm}u=y.bind(null,l,u,a),y=void 0,!wa||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(y=!0),f?y!==void 0?a.addEventListener(l,u,{capture:!0,passive:y}):a.addEventListener(l,u,!0):y!==void 0?a.addEventListener(l,u,{passive:y}):a.addEventListener(l,u,!1)}function zm(a,l,u,f,y){var w=f;if((l&1)===0&&(l&2)===0&&f!==null)e:for(;;){if(f===null)return;var _=f.tag;if(_===3||_===4){var Z=f.stateNode.containerInfo;if(Z===y||Z.nodeType===8&&Z.parentNode===y)break;if(_===4)for(_=f.return;_!==null;){var ee=_.tag;if((ee===3||ee===4)&&(ee=_.stateNode.containerInfo,ee===y||ee.nodeType===8&&ee.parentNode===y))return;_=_.return}for(;Z!==null;){if(_=ji(Z),_===null)return;if(ee=_.tag,ee===5||ee===6){f=w=_;continue e}Z=Z.parentNode}}f=f.return}zn(function(){var fe=w,_e=Jr(u),Me=[];e:{var Te=Ny.get(a);if(Te!==void 0){var Ge=Sm,Je=a;switch(a){case"keypress":if(vd(u)===0)break e;case"keydown":case"keyup":Ge=GP;break;case"focusin":Je="focus",Ge=Pm;break;case"focusout":Je="blur",Ge=Pm;break;case"beforeblur":case"afterblur":Ge=Pm;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ge=Jv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ge=IP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ge=WP;break;case yy:case jy:case by:Ge=DP;break;case wy:Ge=YP;break;case"scroll":Ge=AP;break;case"wheel":Ge=XP;break;case"copy":case"cut":case"paste":Ge=FP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ge=ty}var nt=(l&4)!==0,_n=!nt&&a==="scroll",ue=nt?Te!==null?Te+"Capture":null:Te;nt=[];for(var ne=fe,pe;ne!==null;){pe=ne;var Fe=pe.stateNode;if(pe.tag===5&&Fe!==null&&(pe=Fe,ue!==null&&(Fe=Xn(ne,ue),Fe!=null&&nt.push(zl(ne,Fe,pe)))),_n)break;ne=ne.return}0<nt.length&&(Te=new Ge(Te,Je,null,u,_e),Me.push({event:Te,listeners:nt}))}}if((l&7)===0){e:{if(Te=a==="mouseover"||a==="pointerover",Ge=a==="mouseout"||a==="pointerout",Te&&u!==hn&&(Je=u.relatedTarget||u.fromElement)&&(ji(Je)||Je[Js]))break e;if((Ge||Te)&&(Te=_e.window===_e?_e:(Te=_e.ownerDocument)?Te.defaultView||Te.parentWindow:window,Ge?(Je=u.relatedTarget||u.toElement,Ge=fe,Je=Je?ji(Je):null,Je!==null&&(_n=_s(Je),Je!==_n||Je.tag!==5&&Je.tag!==6)&&(Je=null)):(Ge=null,Je=fe),Ge!==Je)){if(nt=Jv,Fe="onMouseLeave",ue="onMouseEnter",ne="mouse",(a==="pointerout"||a==="pointerover")&&(nt=ty,Fe="onPointerLeave",ue="onPointerEnter",ne="pointer"),_n=Ge==null?Te:oo(Ge),pe=Je==null?Te:oo(Je),Te=new nt(Fe,ne+"leave",Ge,u,_e),Te.target=_n,Te.relatedTarget=pe,Fe=null,ji(_e)===fe&&(nt=new nt(ue,ne+"enter",Je,u,_e),nt.target=pe,nt.relatedTarget=_n,Fe=nt),_n=Fe,Ge&&Je)t:{for(nt=Ge,ue=Je,ne=0,pe=nt;pe;pe=ao(pe))ne++;for(pe=0,Fe=ue;Fe;Fe=ao(Fe))pe++;for(;0<ne-pe;)nt=ao(nt),ne--;for(;0<pe-ne;)ue=ao(ue),pe--;for(;ne--;){if(nt===ue||ue!==null&&nt===ue.alternate)break t;nt=ao(nt),ue=ao(ue)}nt=null}else nt=null;Ge!==null&&Py(Me,Te,Ge,nt,!1),Je!==null&&_n!==null&&Py(Me,_n,Je,nt,!0)}}e:{if(Te=fe?oo(fe):window,Ge=Te.nodeName&&Te.nodeName.toLowerCase(),Ge==="select"||Ge==="input"&&Te.type==="file")var at=aT;else if(oy(Te))if(cy)at=cT;else{at=oT;var ft=iT}else(Ge=Te.nodeName)&&Ge.toLowerCase()==="input"&&(Te.type==="checkbox"||Te.type==="radio")&&(at=lT);if(at&&(at=at(a,fe))){ly(Me,at,u,_e);break e}ft&&ft(a,Te,fe),a==="focusout"&&(ft=Te._wrapperState)&&ft.controlled&&Te.type==="number"&&Jt(Te,"number",Te.value)}switch(ft=fe?oo(fe):window,a){case"focusin":(oy(ft)||ft.contentEditable==="true")&&(ro=ft,Mm=fe,Ll=null);break;case"focusout":Ll=Mm=ro=null;break;case"mousedown":Om=!0;break;case"contextmenu":case"mouseup":case"dragend":Om=!1,gy(Me,u,_e);break;case"selectionchange":if(pT)break;case"keydown":case"keyup":gy(Me,u,_e)}var xt;if(Rm)e:{switch(a){case"compositionstart":var bt="onCompositionStart";break e;case"compositionend":bt="onCompositionEnd";break e;case"compositionupdate":bt="onCompositionUpdate";break e}bt=void 0}else no?ay(a,u)&&(bt="onCompositionEnd"):a==="keydown"&&u.keyCode===229&&(bt="onCompositionStart");bt&&(ny&&u.locale!=="ko"&&(no||bt!=="onCompositionStart"?bt==="onCompositionEnd"&&no&&(xt=Zv()):(Ta=_e,Cm="value"in Ta?Ta.value:Ta.textContent,no=!0)),ft=Sd(fe,bt),0<ft.length&&(bt=new ey(bt,a,null,u,_e),Me.push({event:bt,listeners:ft}),xt?bt.data=xt:(xt=iy(u),xt!==null&&(bt.data=xt)))),(xt=eT?tT(a,u):nT(a,u))&&(fe=Sd(fe,"onBeforeInput"),0<fe.length&&(_e=new ey("onBeforeInput","beforeinput",null,u,_e),Me.push({event:_e,listeners:fe}),_e.data=xt))}ky(Me,l)})}function zl(a,l,u){return{instance:a,listener:l,currentTarget:u}}function Sd(a,l){for(var u=l+"Capture",f=[];a!==null;){var y=a,w=y.stateNode;y.tag===5&&w!==null&&(y=w,w=Xn(a,u),w!=null&&f.unshift(zl(a,w,y)),w=Xn(a,l),w!=null&&f.push(zl(a,w,y))),a=a.return}return f}function ao(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function Py(a,l,u,f,y){for(var w=l._reactName,_=[];u!==null&&u!==f;){var Z=u,ee=Z.alternate,fe=Z.stateNode;if(ee!==null&&ee===f)break;Z.tag===5&&fe!==null&&(Z=fe,y?(ee=Xn(u,w),ee!=null&&_.unshift(zl(u,ee,Z))):y||(ee=Xn(u,w),ee!=null&&_.push(zl(u,ee,Z)))),u=u.return}_.length!==0&&a.push({event:l,listeners:_})}var xT=/\r\n?/g,gT=/\u0000|\uFFFD/g;function Ty(a){return(typeof a=="string"?a:""+a).replace(xT,`
`).replace(gT,"")}function kd(a,l,u){if(l=Ty(l),Ty(a)!==l&&u)throw Error(r(425))}function Ed(){}var Vm=null,qm=null;function Um(a,l){return a==="textarea"||a==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Bm=typeof setTimeout=="function"?setTimeout:void 0,vT=typeof clearTimeout=="function"?clearTimeout:void 0,Ry=typeof Promise=="function"?Promise:void 0,yT=typeof queueMicrotask=="function"?queueMicrotask:typeof Ry<"u"?function(a){return Ry.resolve(null).then(a).catch(jT)}:Bm;function jT(a){setTimeout(function(){throw a})}function Gm(a,l){var u=l,f=0;do{var y=u.nextSibling;if(a.removeChild(u),y&&y.nodeType===8)if(u=y.data,u==="/$"){if(f===0){a.removeChild(y),Rl(l);return}f--}else u!=="$"&&u!=="$?"&&u!=="$!"||f++;u=y}while(u);Rl(l)}function Aa(a){for(;a!=null;a=a.nextSibling){var l=a.nodeType;if(l===1||l===3)break;if(l===8){if(l=a.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return a}function Ay(a){a=a.previousSibling;for(var l=0;a;){if(a.nodeType===8){var u=a.data;if(u==="$"||u==="$!"||u==="$?"){if(l===0)return a;l--}else u==="/$"&&l++}a=a.previousSibling}return null}var io=Math.random().toString(36).slice(2),Ms="__reactFiber$"+io,Vl="__reactProps$"+io,Js="__reactContainer$"+io,Hm="__reactEvents$"+io,bT="__reactListeners$"+io,wT="__reactHandles$"+io;function ji(a){var l=a[Ms];if(l)return l;for(var u=a.parentNode;u;){if(l=u[Js]||u[Ms]){if(u=l.alternate,l.child!==null||u!==null&&u.child!==null)for(a=Ay(a);a!==null;){if(u=a[Ms])return u;a=Ay(a)}return l}a=u,u=a.parentNode}return null}function ql(a){return a=a[Ms]||a[Js],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function oo(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(r(33))}function Pd(a){return a[Vl]||null}var Km=[],lo=-1;function _a(a){return{current:a}}function un(a){0>lo||(a.current=Km[lo],Km[lo]=null,lo--)}function rn(a,l){lo++,Km[lo]=a.current,a.current=l}var Ia={},or=_a(Ia),Sr=_a(!1),bi=Ia;function co(a,l){var u=a.type.contextTypes;if(!u)return Ia;var f=a.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===l)return f.__reactInternalMemoizedMaskedChildContext;var y={},w;for(w in u)y[w]=l[w];return f&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=l,a.__reactInternalMemoizedMaskedChildContext=y),y}function kr(a){return a=a.childContextTypes,a!=null}function Td(){un(Sr),un(or)}function _y(a,l,u){if(or.current!==Ia)throw Error(r(168));rn(or,l),rn(Sr,u)}function Iy(a,l,u){var f=a.stateNode;if(l=l.childContextTypes,typeof f.getChildContext!="function")return u;f=f.getChildContext();for(var y in f)if(!(y in l))throw Error(r(108,xe(a)||"Unknown",y));return D({},u,f)}function Rd(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Ia,bi=or.current,rn(or,a),rn(Sr,Sr.current),!0}function My(a,l,u){var f=a.stateNode;if(!f)throw Error(r(169));u?(a=Iy(a,l,bi),f.__reactInternalMemoizedMergedChildContext=a,un(Sr),un(or),rn(or,a)):un(Sr),rn(Sr,u)}var ea=null,Ad=!1,Wm=!1;function Oy(a){ea===null?ea=[a]:ea.push(a)}function NT(a){Ad=!0,Oy(a)}function Ma(){if(!Wm&&ea!==null){Wm=!0;var a=0,l=Zt;try{var u=ea;for(Zt=1;a<u.length;a++){var f=u[a];do f=f(!0);while(f!==null)}ea=null,Ad=!1}catch(y){throw ea!==null&&(ea=ea.slice(a+1)),yi(Nl,Ma),y}finally{Zt=l,Wm=!1}}return null}var uo=[],po=0,_d=null,Id=0,ts=[],ns=0,wi=null,ta=1,na="";function Ni(a,l){uo[po++]=Id,uo[po++]=_d,_d=a,Id=l}function Dy(a,l,u){ts[ns++]=ta,ts[ns++]=na,ts[ns++]=wi,wi=a;var f=ta;a=na;var y=32-Jn(f)-1;f&=~(1<<y),u+=1;var w=32-Jn(l)+y;if(30<w){var _=y-y%5;w=(f&(1<<_)-1).toString(32),f>>=_,y-=_,ta=1<<32-Jn(l)+y|u<<y|f,na=w+a}else ta=1<<w|u<<y|f,na=a}function Qm(a){a.return!==null&&(Ni(a,1),Dy(a,1,0))}function Ym(a){for(;a===_d;)_d=uo[--po],uo[po]=null,Id=uo[--po],uo[po]=null;for(;a===wi;)wi=ts[--ns],ts[ns]=null,na=ts[--ns],ts[ns]=null,ta=ts[--ns],ts[ns]=null}var Vr=null,qr=null,fn=!1,fs=null;function Ly(a,l){var u=is(5,null,null,0);u.elementType="DELETED",u.stateNode=l,u.return=a,l=a.deletions,l===null?(a.deletions=[u],a.flags|=16):l.push(u)}function Fy(a,l){switch(a.tag){case 5:var u=a.type;return l=l.nodeType!==1||u.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(a.stateNode=l,Vr=a,qr=Aa(l.firstChild),!0):!1;case 6:return l=a.pendingProps===""||l.nodeType!==3?null:l,l!==null?(a.stateNode=l,Vr=a,qr=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(u=wi!==null?{id:ta,overflow:na}:null,a.memoizedState={dehydrated:l,treeContext:u,retryLane:1073741824},u=is(18,null,null,0),u.stateNode=l,u.return=a,a.child=u,Vr=a,qr=null,!0):!1;default:return!1}}function Zm(a){return(a.mode&1)!==0&&(a.flags&128)===0}function Xm(a){if(fn){var l=qr;if(l){var u=l;if(!Fy(a,l)){if(Zm(a))throw Error(r(418));l=Aa(u.nextSibling);var f=Vr;l&&Fy(a,l)?Ly(f,u):(a.flags=a.flags&-4097|2,fn=!1,Vr=a)}}else{if(Zm(a))throw Error(r(418));a.flags=a.flags&-4097|2,fn=!1,Vr=a}}}function $y(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;Vr=a}function Md(a){if(a!==Vr)return!1;if(!fn)return $y(a),fn=!0,!1;var l;if((l=a.tag!==3)&&!(l=a.tag!==5)&&(l=a.type,l=l!=="head"&&l!=="body"&&!Um(a.type,a.memoizedProps)),l&&(l=qr)){if(Zm(a))throw zy(),Error(r(418));for(;l;)Ly(a,l),l=Aa(l.nextSibling)}if($y(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));e:{for(a=a.nextSibling,l=0;a;){if(a.nodeType===8){var u=a.data;if(u==="/$"){if(l===0){qr=Aa(a.nextSibling);break e}l--}else u!=="$"&&u!=="$!"&&u!=="$?"||l++}a=a.nextSibling}qr=null}}else qr=Vr?Aa(a.stateNode.nextSibling):null;return!0}function zy(){for(var a=qr;a;)a=Aa(a.nextSibling)}function mo(){qr=Vr=null,fn=!1}function Jm(a){fs===null?fs=[a]:fs.push(a)}var CT=R.ReactCurrentBatchConfig;function Ul(a,l,u){if(a=u.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(r(309));var f=u.stateNode}if(!f)throw Error(r(147,a));var y=f,w=""+a;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===w?l.ref:(l=function(_){var Z=y.refs;_===null?delete Z[w]:Z[w]=_},l._stringRef=w,l)}if(typeof a!="string")throw Error(r(284));if(!u._owner)throw Error(r(290,a))}return a}function Od(a,l){throw a=Object.prototype.toString.call(l),Error(r(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a))}function Vy(a){var l=a._init;return l(a._payload)}function qy(a){function l(ue,ne){if(a){var pe=ue.deletions;pe===null?(ue.deletions=[ne],ue.flags|=16):pe.push(ne)}}function u(ue,ne){if(!a)return null;for(;ne!==null;)l(ue,ne),ne=ne.sibling;return null}function f(ue,ne){for(ue=new Map;ne!==null;)ne.key!==null?ue.set(ne.key,ne):ue.set(ne.index,ne),ne=ne.sibling;return ue}function y(ue,ne){return ue=qa(ue,ne),ue.index=0,ue.sibling=null,ue}function w(ue,ne,pe){return ue.index=pe,a?(pe=ue.alternate,pe!==null?(pe=pe.index,pe<ne?(ue.flags|=2,ne):pe):(ue.flags|=2,ne)):(ue.flags|=1048576,ne)}function _(ue){return a&&ue.alternate===null&&(ue.flags|=2),ue}function Z(ue,ne,pe,Fe){return ne===null||ne.tag!==6?(ne=Bh(pe,ue.mode,Fe),ne.return=ue,ne):(ne=y(ne,pe),ne.return=ue,ne)}function ee(ue,ne,pe,Fe){var at=pe.type;return at===W?_e(ue,ne,pe.props.children,Fe,pe.key):ne!==null&&(ne.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===q&&Vy(at)===ne.type)?(Fe=y(ne,pe.props),Fe.ref=Ul(ue,ne,pe),Fe.return=ue,Fe):(Fe=au(pe.type,pe.key,pe.props,null,ue.mode,Fe),Fe.ref=Ul(ue,ne,pe),Fe.return=ue,Fe)}function fe(ue,ne,pe,Fe){return ne===null||ne.tag!==4||ne.stateNode.containerInfo!==pe.containerInfo||ne.stateNode.implementation!==pe.implementation?(ne=Gh(pe,ue.mode,Fe),ne.return=ue,ne):(ne=y(ne,pe.children||[]),ne.return=ue,ne)}function _e(ue,ne,pe,Fe,at){return ne===null||ne.tag!==7?(ne=Ai(pe,ue.mode,Fe,at),ne.return=ue,ne):(ne=y(ne,pe),ne.return=ue,ne)}function Me(ue,ne,pe){if(typeof ne=="string"&&ne!==""||typeof ne=="number")return ne=Bh(""+ne,ue.mode,pe),ne.return=ue,ne;if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case E:return pe=au(ne.type,ne.key,ne.props,null,ue.mode,pe),pe.ref=Ul(ue,null,ne),pe.return=ue,pe;case A:return ne=Gh(ne,ue.mode,pe),ne.return=ue,ne;case q:var Fe=ne._init;return Me(ue,Fe(ne._payload),pe)}if(Vt(ne)||J(ne))return ne=Ai(ne,ue.mode,pe,null),ne.return=ue,ne;Od(ue,ne)}return null}function Te(ue,ne,pe,Fe){var at=ne!==null?ne.key:null;if(typeof pe=="string"&&pe!==""||typeof pe=="number")return at!==null?null:Z(ue,ne,""+pe,Fe);if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case E:return pe.key===at?ee(ue,ne,pe,Fe):null;case A:return pe.key===at?fe(ue,ne,pe,Fe):null;case q:return at=pe._init,Te(ue,ne,at(pe._payload),Fe)}if(Vt(pe)||J(pe))return at!==null?null:_e(ue,ne,pe,Fe,null);Od(ue,pe)}return null}function Ge(ue,ne,pe,Fe,at){if(typeof Fe=="string"&&Fe!==""||typeof Fe=="number")return ue=ue.get(pe)||null,Z(ne,ue,""+Fe,at);if(typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case E:return ue=ue.get(Fe.key===null?pe:Fe.key)||null,ee(ne,ue,Fe,at);case A:return ue=ue.get(Fe.key===null?pe:Fe.key)||null,fe(ne,ue,Fe,at);case q:var ft=Fe._init;return Ge(ue,ne,pe,ft(Fe._payload),at)}if(Vt(Fe)||J(Fe))return ue=ue.get(pe)||null,_e(ne,ue,Fe,at,null);Od(ne,Fe)}return null}function Je(ue,ne,pe,Fe){for(var at=null,ft=null,xt=ne,bt=ne=0,Qn=null;xt!==null&&bt<pe.length;bt++){xt.index>bt?(Qn=xt,xt=null):Qn=xt.sibling;var Ut=Te(ue,xt,pe[bt],Fe);if(Ut===null){xt===null&&(xt=Qn);break}a&&xt&&Ut.alternate===null&&l(ue,xt),ne=w(Ut,ne,bt),ft===null?at=Ut:ft.sibling=Ut,ft=Ut,xt=Qn}if(bt===pe.length)return u(ue,xt),fn&&Ni(ue,bt),at;if(xt===null){for(;bt<pe.length;bt++)xt=Me(ue,pe[bt],Fe),xt!==null&&(ne=w(xt,ne,bt),ft===null?at=xt:ft.sibling=xt,ft=xt);return fn&&Ni(ue,bt),at}for(xt=f(ue,xt);bt<pe.length;bt++)Qn=Ge(xt,ue,bt,pe[bt],Fe),Qn!==null&&(a&&Qn.alternate!==null&&xt.delete(Qn.key===null?bt:Qn.key),ne=w(Qn,ne,bt),ft===null?at=Qn:ft.sibling=Qn,ft=Qn);return a&&xt.forEach(function(Ua){return l(ue,Ua)}),fn&&Ni(ue,bt),at}function nt(ue,ne,pe,Fe){var at=J(pe);if(typeof at!="function")throw Error(r(150));if(pe=at.call(pe),pe==null)throw Error(r(151));for(var ft=at=null,xt=ne,bt=ne=0,Qn=null,Ut=pe.next();xt!==null&&!Ut.done;bt++,Ut=pe.next()){xt.index>bt?(Qn=xt,xt=null):Qn=xt.sibling;var Ua=Te(ue,xt,Ut.value,Fe);if(Ua===null){xt===null&&(xt=Qn);break}a&&xt&&Ua.alternate===null&&l(ue,xt),ne=w(Ua,ne,bt),ft===null?at=Ua:ft.sibling=Ua,ft=Ua,xt=Qn}if(Ut.done)return u(ue,xt),fn&&Ni(ue,bt),at;if(xt===null){for(;!Ut.done;bt++,Ut=pe.next())Ut=Me(ue,Ut.value,Fe),Ut!==null&&(ne=w(Ut,ne,bt),ft===null?at=Ut:ft.sibling=Ut,ft=Ut);return fn&&Ni(ue,bt),at}for(xt=f(ue,xt);!Ut.done;bt++,Ut=pe.next())Ut=Ge(xt,ue,bt,Ut.value,Fe),Ut!==null&&(a&&Ut.alternate!==null&&xt.delete(Ut.key===null?bt:Ut.key),ne=w(Ut,ne,bt),ft===null?at=Ut:ft.sibling=Ut,ft=Ut);return a&&xt.forEach(function(r4){return l(ue,r4)}),fn&&Ni(ue,bt),at}function _n(ue,ne,pe,Fe){if(typeof pe=="object"&&pe!==null&&pe.type===W&&pe.key===null&&(pe=pe.props.children),typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case E:e:{for(var at=pe.key,ft=ne;ft!==null;){if(ft.key===at){if(at=pe.type,at===W){if(ft.tag===7){u(ue,ft.sibling),ne=y(ft,pe.props.children),ne.return=ue,ue=ne;break e}}else if(ft.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===q&&Vy(at)===ft.type){u(ue,ft.sibling),ne=y(ft,pe.props),ne.ref=Ul(ue,ft,pe),ne.return=ue,ue=ne;break e}u(ue,ft);break}else l(ue,ft);ft=ft.sibling}pe.type===W?(ne=Ai(pe.props.children,ue.mode,Fe,pe.key),ne.return=ue,ue=ne):(Fe=au(pe.type,pe.key,pe.props,null,ue.mode,Fe),Fe.ref=Ul(ue,ne,pe),Fe.return=ue,ue=Fe)}return _(ue);case A:e:{for(ft=pe.key;ne!==null;){if(ne.key===ft)if(ne.tag===4&&ne.stateNode.containerInfo===pe.containerInfo&&ne.stateNode.implementation===pe.implementation){u(ue,ne.sibling),ne=y(ne,pe.children||[]),ne.return=ue,ue=ne;break e}else{u(ue,ne);break}else l(ue,ne);ne=ne.sibling}ne=Gh(pe,ue.mode,Fe),ne.return=ue,ue=ne}return _(ue);case q:return ft=pe._init,_n(ue,ne,ft(pe._payload),Fe)}if(Vt(pe))return Je(ue,ne,pe,Fe);if(J(pe))return nt(ue,ne,pe,Fe);Od(ue,pe)}return typeof pe=="string"&&pe!==""||typeof pe=="number"?(pe=""+pe,ne!==null&&ne.tag===6?(u(ue,ne.sibling),ne=y(ne,pe),ne.return=ue,ue=ne):(u(ue,ne),ne=Bh(pe,ue.mode,Fe),ne.return=ue,ue=ne),_(ue)):u(ue,ne)}return _n}var ho=qy(!0),Uy=qy(!1),Dd=_a(null),Ld=null,fo=null,eh=null;function th(){eh=fo=Ld=null}function nh(a){var l=Dd.current;un(Dd),a._currentValue=l}function rh(a,l,u){for(;a!==null;){var f=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,f!==null&&(f.childLanes|=l)):f!==null&&(f.childLanes&l)!==l&&(f.childLanes|=l),a===u)break;a=a.return}}function xo(a,l){Ld=a,eh=fo=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&l)!==0&&(Er=!0),a.firstContext=null)}function rs(a){var l=a._currentValue;if(eh!==a)if(a={context:a,memoizedValue:l,next:null},fo===null){if(Ld===null)throw Error(r(308));fo=a,Ld.dependencies={lanes:0,firstContext:a}}else fo=fo.next=a;return l}var Ci=null;function sh(a){Ci===null?Ci=[a]:Ci.push(a)}function By(a,l,u,f){var y=l.interleaved;return y===null?(u.next=u,sh(l)):(u.next=y.next,y.next=u),l.interleaved=u,ra(a,f)}function ra(a,l){a.lanes|=l;var u=a.alternate;for(u!==null&&(u.lanes|=l),u=a,a=a.return;a!==null;)a.childLanes|=l,u=a.alternate,u!==null&&(u.childLanes|=l),u=a,a=a.return;return u.tag===3?u.stateNode:null}var Oa=!1;function ah(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Gy(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function sa(a,l){return{eventTime:a,lane:l,tag:0,payload:null,callback:null,next:null}}function Da(a,l,u){var f=a.updateQueue;if(f===null)return null;if(f=f.shared,($t&2)!==0){var y=f.pending;return y===null?l.next=l:(l.next=y.next,y.next=l),f.pending=l,ra(a,u)}return y=f.interleaved,y===null?(l.next=l,sh(f)):(l.next=y.next,y.next=l),f.interleaved=l,ra(a,u)}function Fd(a,l,u){if(l=l.updateQueue,l!==null&&(l=l.shared,(u&4194240)!==0)){var f=l.lanes;f&=a.pendingLanes,u|=f,l.lanes=u,ym(a,u)}}function Hy(a,l){var u=a.updateQueue,f=a.alternate;if(f!==null&&(f=f.updateQueue,u===f)){var y=null,w=null;if(u=u.firstBaseUpdate,u!==null){do{var _={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};w===null?y=w=_:w=w.next=_,u=u.next}while(u!==null);w===null?y=w=l:w=w.next=l}else y=w=l;u={baseState:f.baseState,firstBaseUpdate:y,lastBaseUpdate:w,shared:f.shared,effects:f.effects},a.updateQueue=u;return}a=u.lastBaseUpdate,a===null?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=l}function $d(a,l,u,f){var y=a.updateQueue;Oa=!1;var w=y.firstBaseUpdate,_=y.lastBaseUpdate,Z=y.shared.pending;if(Z!==null){y.shared.pending=null;var ee=Z,fe=ee.next;ee.next=null,_===null?w=fe:_.next=fe,_=ee;var _e=a.alternate;_e!==null&&(_e=_e.updateQueue,Z=_e.lastBaseUpdate,Z!==_&&(Z===null?_e.firstBaseUpdate=fe:Z.next=fe,_e.lastBaseUpdate=ee))}if(w!==null){var Me=y.baseState;_=0,_e=fe=ee=null,Z=w;do{var Te=Z.lane,Ge=Z.eventTime;if((f&Te)===Te){_e!==null&&(_e=_e.next={eventTime:Ge,lane:0,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null});e:{var Je=a,nt=Z;switch(Te=l,Ge=u,nt.tag){case 1:if(Je=nt.payload,typeof Je=="function"){Me=Je.call(Ge,Me,Te);break e}Me=Je;break e;case 3:Je.flags=Je.flags&-65537|128;case 0:if(Je=nt.payload,Te=typeof Je=="function"?Je.call(Ge,Me,Te):Je,Te==null)break e;Me=D({},Me,Te);break e;case 2:Oa=!0}}Z.callback!==null&&Z.lane!==0&&(a.flags|=64,Te=y.effects,Te===null?y.effects=[Z]:Te.push(Z))}else Ge={eventTime:Ge,lane:Te,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null},_e===null?(fe=_e=Ge,ee=Me):_e=_e.next=Ge,_|=Te;if(Z=Z.next,Z===null){if(Z=y.shared.pending,Z===null)break;Te=Z,Z=Te.next,Te.next=null,y.lastBaseUpdate=Te,y.shared.pending=null}}while(!0);if(_e===null&&(ee=Me),y.baseState=ee,y.firstBaseUpdate=fe,y.lastBaseUpdate=_e,l=y.shared.interleaved,l!==null){y=l;do _|=y.lane,y=y.next;while(y!==l)}else w===null&&(y.shared.lanes=0);Ei|=_,a.lanes=_,a.memoizedState=Me}}function Ky(a,l,u){if(a=l.effects,l.effects=null,a!==null)for(l=0;l<a.length;l++){var f=a[l],y=f.callback;if(y!==null){if(f.callback=null,f=u,typeof y!="function")throw Error(r(191,y));y.call(f)}}}var Bl={},Os=_a(Bl),Gl=_a(Bl),Hl=_a(Bl);function Si(a){if(a===Bl)throw Error(r(174));return a}function ih(a,l){switch(rn(Hl,l),rn(Gl,a),rn(Os,Bl),a=l.nodeType,a){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:ie(null,"");break;default:a=a===8?l.parentNode:l,l=a.namespaceURI||null,a=a.tagName,l=ie(l,a)}un(Os),rn(Os,l)}function go(){un(Os),un(Gl),un(Hl)}function Wy(a){Si(Hl.current);var l=Si(Os.current),u=ie(l,a.type);l!==u&&(rn(Gl,a),rn(Os,u))}function oh(a){Gl.current===a&&(un(Os),un(Gl))}var gn=_a(0);function zd(a){for(var l=a;l!==null;){if(l.tag===13){var u=l.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var lh=[];function ch(){for(var a=0;a<lh.length;a++)lh[a]._workInProgressVersionPrimary=null;lh.length=0}var Vd=R.ReactCurrentDispatcher,dh=R.ReactCurrentBatchConfig,ki=0,vn=null,Vn=null,Kn=null,qd=!1,Kl=!1,Wl=0,ST=0;function lr(){throw Error(r(321))}function uh(a,l){if(l===null)return!1;for(var u=0;u<l.length&&u<a.length;u++)if(!hs(a[u],l[u]))return!1;return!0}function ph(a,l,u,f,y,w){if(ki=w,vn=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,Vd.current=a===null||a.memoizedState===null?TT:RT,a=u(f,y),Kl){w=0;do{if(Kl=!1,Wl=0,25<=w)throw Error(r(301));w+=1,Kn=Vn=null,l.updateQueue=null,Vd.current=AT,a=u(f,y)}while(Kl)}if(Vd.current=Gd,l=Vn!==null&&Vn.next!==null,ki=0,Kn=Vn=vn=null,qd=!1,l)throw Error(r(300));return a}function mh(){var a=Wl!==0;return Wl=0,a}function Ds(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kn===null?vn.memoizedState=Kn=a:Kn=Kn.next=a,Kn}function ss(){if(Vn===null){var a=vn.alternate;a=a!==null?a.memoizedState:null}else a=Vn.next;var l=Kn===null?vn.memoizedState:Kn.next;if(l!==null)Kn=l,Vn=a;else{if(a===null)throw Error(r(310));Vn=a,a={memoizedState:Vn.memoizedState,baseState:Vn.baseState,baseQueue:Vn.baseQueue,queue:Vn.queue,next:null},Kn===null?vn.memoizedState=Kn=a:Kn=Kn.next=a}return Kn}function Ql(a,l){return typeof l=="function"?l(a):l}function hh(a){var l=ss(),u=l.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=a;var f=Vn,y=f.baseQueue,w=u.pending;if(w!==null){if(y!==null){var _=y.next;y.next=w.next,w.next=_}f.baseQueue=y=w,u.pending=null}if(y!==null){w=y.next,f=f.baseState;var Z=_=null,ee=null,fe=w;do{var _e=fe.lane;if((ki&_e)===_e)ee!==null&&(ee=ee.next={lane:0,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null}),f=fe.hasEagerState?fe.eagerState:a(f,fe.action);else{var Me={lane:_e,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null};ee===null?(Z=ee=Me,_=f):ee=ee.next=Me,vn.lanes|=_e,Ei|=_e}fe=fe.next}while(fe!==null&&fe!==w);ee===null?_=f:ee.next=Z,hs(f,l.memoizedState)||(Er=!0),l.memoizedState=f,l.baseState=_,l.baseQueue=ee,u.lastRenderedState=f}if(a=u.interleaved,a!==null){y=a;do w=y.lane,vn.lanes|=w,Ei|=w,y=y.next;while(y!==a)}else y===null&&(u.lanes=0);return[l.memoizedState,u.dispatch]}function fh(a){var l=ss(),u=l.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=a;var f=u.dispatch,y=u.pending,w=l.memoizedState;if(y!==null){u.pending=null;var _=y=y.next;do w=a(w,_.action),_=_.next;while(_!==y);hs(w,l.memoizedState)||(Er=!0),l.memoizedState=w,l.baseQueue===null&&(l.baseState=w),u.lastRenderedState=w}return[w,f]}function Qy(){}function Yy(a,l){var u=vn,f=ss(),y=l(),w=!hs(f.memoizedState,y);if(w&&(f.memoizedState=y,Er=!0),f=f.queue,xh(Jy.bind(null,u,f,a),[a]),f.getSnapshot!==l||w||Kn!==null&&Kn.memoizedState.tag&1){if(u.flags|=2048,Yl(9,Xy.bind(null,u,f,y,l),void 0,null),Wn===null)throw Error(r(349));(ki&30)!==0||Zy(u,l,y)}return y}function Zy(a,l,u){a.flags|=16384,a={getSnapshot:l,value:u},l=vn.updateQueue,l===null?(l={lastEffect:null,stores:null},vn.updateQueue=l,l.stores=[a]):(u=l.stores,u===null?l.stores=[a]:u.push(a))}function Xy(a,l,u,f){l.value=u,l.getSnapshot=f,ej(l)&&tj(a)}function Jy(a,l,u){return u(function(){ej(l)&&tj(a)})}function ej(a){var l=a.getSnapshot;a=a.value;try{var u=l();return!hs(a,u)}catch{return!0}}function tj(a){var l=ra(a,1);l!==null&&ys(l,a,1,-1)}function nj(a){var l=Ds();return typeof a=="function"&&(a=a()),l.memoizedState=l.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ql,lastRenderedState:a},l.queue=a,a=a.dispatch=PT.bind(null,vn,a),[l.memoizedState,a]}function Yl(a,l,u,f){return a={tag:a,create:l,destroy:u,deps:f,next:null},l=vn.updateQueue,l===null?(l={lastEffect:null,stores:null},vn.updateQueue=l,l.lastEffect=a.next=a):(u=l.lastEffect,u===null?l.lastEffect=a.next=a:(f=u.next,u.next=a,a.next=f,l.lastEffect=a)),a}function rj(){return ss().memoizedState}function Ud(a,l,u,f){var y=Ds();vn.flags|=a,y.memoizedState=Yl(1|l,u,void 0,f===void 0?null:f)}function Bd(a,l,u,f){var y=ss();f=f===void 0?null:f;var w=void 0;if(Vn!==null){var _=Vn.memoizedState;if(w=_.destroy,f!==null&&uh(f,_.deps)){y.memoizedState=Yl(l,u,w,f);return}}vn.flags|=a,y.memoizedState=Yl(1|l,u,w,f)}function sj(a,l){return Ud(8390656,8,a,l)}function xh(a,l){return Bd(2048,8,a,l)}function aj(a,l){return Bd(4,2,a,l)}function ij(a,l){return Bd(4,4,a,l)}function oj(a,l){if(typeof l=="function")return a=a(),l(a),function(){l(null)};if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function lj(a,l,u){return u=u!=null?u.concat([a]):null,Bd(4,4,oj.bind(null,l,a),u)}function gh(){}function cj(a,l){var u=ss();l=l===void 0?null:l;var f=u.memoizedState;return f!==null&&l!==null&&uh(l,f[1])?f[0]:(u.memoizedState=[a,l],a)}function dj(a,l){var u=ss();l=l===void 0?null:l;var f=u.memoizedState;return f!==null&&l!==null&&uh(l,f[1])?f[0]:(a=a(),u.memoizedState=[a,l],a)}function uj(a,l,u){return(ki&21)===0?(a.baseState&&(a.baseState=!1,Er=!0),a.memoizedState=u):(hs(u,l)||(u=Vv(),vn.lanes|=u,Ei|=u,a.baseState=!0),l)}function kT(a,l){var u=Zt;Zt=u!==0&&4>u?u:4,a(!0);var f=dh.transition;dh.transition={};try{a(!1),l()}finally{Zt=u,dh.transition=f}}function pj(){return ss().memoizedState}function ET(a,l,u){var f=za(a);if(u={lane:f,action:u,hasEagerState:!1,eagerState:null,next:null},mj(a))hj(l,u);else if(u=By(a,l,u,f),u!==null){var y=jr();ys(u,a,f,y),fj(u,l,f)}}function PT(a,l,u){var f=za(a),y={lane:f,action:u,hasEagerState:!1,eagerState:null,next:null};if(mj(a))hj(l,y);else{var w=a.alternate;if(a.lanes===0&&(w===null||w.lanes===0)&&(w=l.lastRenderedReducer,w!==null))try{var _=l.lastRenderedState,Z=w(_,u);if(y.hasEagerState=!0,y.eagerState=Z,hs(Z,_)){var ee=l.interleaved;ee===null?(y.next=y,sh(l)):(y.next=ee.next,ee.next=y),l.interleaved=y;return}}catch{}u=By(a,l,y,f),u!==null&&(y=jr(),ys(u,a,f,y),fj(u,l,f))}}function mj(a){var l=a.alternate;return a===vn||l!==null&&l===vn}function hj(a,l){Kl=qd=!0;var u=a.pending;u===null?l.next=l:(l.next=u.next,u.next=l),a.pending=l}function fj(a,l,u){if((u&4194240)!==0){var f=l.lanes;f&=a.pendingLanes,u|=f,l.lanes=u,ym(a,u)}}var Gd={readContext:rs,useCallback:lr,useContext:lr,useEffect:lr,useImperativeHandle:lr,useInsertionEffect:lr,useLayoutEffect:lr,useMemo:lr,useReducer:lr,useRef:lr,useState:lr,useDebugValue:lr,useDeferredValue:lr,useTransition:lr,useMutableSource:lr,useSyncExternalStore:lr,useId:lr,unstable_isNewReconciler:!1},TT={readContext:rs,useCallback:function(a,l){return Ds().memoizedState=[a,l===void 0?null:l],a},useContext:rs,useEffect:sj,useImperativeHandle:function(a,l,u){return u=u!=null?u.concat([a]):null,Ud(4194308,4,oj.bind(null,l,a),u)},useLayoutEffect:function(a,l){return Ud(4194308,4,a,l)},useInsertionEffect:function(a,l){return Ud(4,2,a,l)},useMemo:function(a,l){var u=Ds();return l=l===void 0?null:l,a=a(),u.memoizedState=[a,l],a},useReducer:function(a,l,u){var f=Ds();return l=u!==void 0?u(l):l,f.memoizedState=f.baseState=l,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:l},f.queue=a,a=a.dispatch=ET.bind(null,vn,a),[f.memoizedState,a]},useRef:function(a){var l=Ds();return a={current:a},l.memoizedState=a},useState:nj,useDebugValue:gh,useDeferredValue:function(a){return Ds().memoizedState=a},useTransition:function(){var a=nj(!1),l=a[0];return a=kT.bind(null,a[1]),Ds().memoizedState=a,[l,a]},useMutableSource:function(){},useSyncExternalStore:function(a,l,u){var f=vn,y=Ds();if(fn){if(u===void 0)throw Error(r(407));u=u()}else{if(u=l(),Wn===null)throw Error(r(349));(ki&30)!==0||Zy(f,l,u)}y.memoizedState=u;var w={value:u,getSnapshot:l};return y.queue=w,sj(Jy.bind(null,f,w,a),[a]),f.flags|=2048,Yl(9,Xy.bind(null,f,w,u,l),void 0,null),u},useId:function(){var a=Ds(),l=Wn.identifierPrefix;if(fn){var u=na,f=ta;u=(f&~(1<<32-Jn(f)-1)).toString(32)+u,l=":"+l+"R"+u,u=Wl++,0<u&&(l+="H"+u.toString(32)),l+=":"}else u=ST++,l=":"+l+"r"+u.toString(32)+":";return a.memoizedState=l},unstable_isNewReconciler:!1},RT={readContext:rs,useCallback:cj,useContext:rs,useEffect:xh,useImperativeHandle:lj,useInsertionEffect:aj,useLayoutEffect:ij,useMemo:dj,useReducer:hh,useRef:rj,useState:function(){return hh(Ql)},useDebugValue:gh,useDeferredValue:function(a){var l=ss();return uj(l,Vn.memoizedState,a)},useTransition:function(){var a=hh(Ql)[0],l=ss().memoizedState;return[a,l]},useMutableSource:Qy,useSyncExternalStore:Yy,useId:pj,unstable_isNewReconciler:!1},AT={readContext:rs,useCallback:cj,useContext:rs,useEffect:xh,useImperativeHandle:lj,useInsertionEffect:aj,useLayoutEffect:ij,useMemo:dj,useReducer:fh,useRef:rj,useState:function(){return fh(Ql)},useDebugValue:gh,useDeferredValue:function(a){var l=ss();return Vn===null?l.memoizedState=a:uj(l,Vn.memoizedState,a)},useTransition:function(){var a=fh(Ql)[0],l=ss().memoizedState;return[a,l]},useMutableSource:Qy,useSyncExternalStore:Yy,useId:pj,unstable_isNewReconciler:!1};function xs(a,l){if(a&&a.defaultProps){l=D({},l),a=a.defaultProps;for(var u in a)l[u]===void 0&&(l[u]=a[u]);return l}return l}function vh(a,l,u,f){l=a.memoizedState,u=u(f,l),u=u==null?l:D({},l,u),a.memoizedState=u,a.lanes===0&&(a.updateQueue.baseState=u)}var Hd={isMounted:function(a){return(a=a._reactInternals)?_s(a)===a:!1},enqueueSetState:function(a,l,u){a=a._reactInternals;var f=jr(),y=za(a),w=sa(f,y);w.payload=l,u!=null&&(w.callback=u),l=Da(a,w,y),l!==null&&(ys(l,a,y,f),Fd(l,a,y))},enqueueReplaceState:function(a,l,u){a=a._reactInternals;var f=jr(),y=za(a),w=sa(f,y);w.tag=1,w.payload=l,u!=null&&(w.callback=u),l=Da(a,w,y),l!==null&&(ys(l,a,y,f),Fd(l,a,y))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var u=jr(),f=za(a),y=sa(u,f);y.tag=2,l!=null&&(y.callback=l),l=Da(a,y,f),l!==null&&(ys(l,a,f,u),Fd(l,a,f))}};function xj(a,l,u,f,y,w,_){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(f,w,_):l.prototype&&l.prototype.isPureReactComponent?!Dl(u,f)||!Dl(y,w):!0}function gj(a,l,u){var f=!1,y=Ia,w=l.contextType;return typeof w=="object"&&w!==null?w=rs(w):(y=kr(l)?bi:or.current,f=l.contextTypes,w=(f=f!=null)?co(a,y):Ia),l=new l(u,w),a.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=Hd,a.stateNode=l,l._reactInternals=a,f&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=y,a.__reactInternalMemoizedMaskedChildContext=w),l}function vj(a,l,u,f){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(u,f),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(u,f),l.state!==a&&Hd.enqueueReplaceState(l,l.state,null)}function yh(a,l,u,f){var y=a.stateNode;y.props=u,y.state=a.memoizedState,y.refs={},ah(a);var w=l.contextType;typeof w=="object"&&w!==null?y.context=rs(w):(w=kr(l)?bi:or.current,y.context=co(a,w)),y.state=a.memoizedState,w=l.getDerivedStateFromProps,typeof w=="function"&&(vh(a,l,w,u),y.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(l=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),l!==y.state&&Hd.enqueueReplaceState(y,y.state,null),$d(a,u,y,f),y.state=a.memoizedState),typeof y.componentDidMount=="function"&&(a.flags|=4194308)}function vo(a,l){try{var u="",f=l;do u+=oe(f),f=f.return;while(f);var y=u}catch(w){y=`
Error generating stack: `+w.message+`
`+w.stack}return{value:a,source:l,stack:y,digest:null}}function jh(a,l,u){return{value:a,source:null,stack:u??null,digest:l??null}}function bh(a,l){try{console.error(l.value)}catch(u){setTimeout(function(){throw u})}}var _T=typeof WeakMap=="function"?WeakMap:Map;function yj(a,l,u){u=sa(-1,u),u.tag=3,u.payload={element:null};var f=l.value;return u.callback=function(){Jd||(Jd=!0,Dh=f),bh(a,l)},u}function jj(a,l,u){u=sa(-1,u),u.tag=3;var f=a.type.getDerivedStateFromError;if(typeof f=="function"){var y=l.value;u.payload=function(){return f(y)},u.callback=function(){bh(a,l)}}var w=a.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(u.callback=function(){bh(a,l),typeof f!="function"&&(Fa===null?Fa=new Set([this]):Fa.add(this));var _=l.stack;this.componentDidCatch(l.value,{componentStack:_!==null?_:""})}),u}function bj(a,l,u){var f=a.pingCache;if(f===null){f=a.pingCache=new _T;var y=new Set;f.set(l,y)}else y=f.get(l),y===void 0&&(y=new Set,f.set(l,y));y.has(u)||(y.add(u),a=HT.bind(null,a,l,u),l.then(a,a))}function wj(a){do{var l;if((l=a.tag===13)&&(l=a.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return a;a=a.return}while(a!==null);return null}function Nj(a,l,u,f,y){return(a.mode&1)===0?(a===l?a.flags|=65536:(a.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(l=sa(-1,1),l.tag=2,Da(u,l,1))),u.lanes|=1),a):(a.flags|=65536,a.lanes=y,a)}var IT=R.ReactCurrentOwner,Er=!1;function yr(a,l,u,f){l.child=a===null?Uy(l,null,u,f):ho(l,a.child,u,f)}function Cj(a,l,u,f,y){u=u.render;var w=l.ref;return xo(l,y),f=ph(a,l,u,f,w,y),u=mh(),a!==null&&!Er?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~y,aa(a,l,y)):(fn&&u&&Qm(l),l.flags|=1,yr(a,l,f,y),l.child)}function Sj(a,l,u,f,y){if(a===null){var w=u.type;return typeof w=="function"&&!Uh(w)&&w.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(l.tag=15,l.type=w,kj(a,l,w,f,y)):(a=au(u.type,null,f,l,l.mode,y),a.ref=l.ref,a.return=l,l.child=a)}if(w=a.child,(a.lanes&y)===0){var _=w.memoizedProps;if(u=u.compare,u=u!==null?u:Dl,u(_,f)&&a.ref===l.ref)return aa(a,l,y)}return l.flags|=1,a=qa(w,f),a.ref=l.ref,a.return=l,l.child=a}function kj(a,l,u,f,y){if(a!==null){var w=a.memoizedProps;if(Dl(w,f)&&a.ref===l.ref)if(Er=!1,l.pendingProps=f=w,(a.lanes&y)!==0)(a.flags&131072)!==0&&(Er=!0);else return l.lanes=a.lanes,aa(a,l,y)}return wh(a,l,u,f,y)}function Ej(a,l,u){var f=l.pendingProps,y=f.children,w=a!==null?a.memoizedState:null;if(f.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},rn(jo,Ur),Ur|=u;else{if((u&1073741824)===0)return a=w!==null?w.baseLanes|u:u,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:a,cachePool:null,transitions:null},l.updateQueue=null,rn(jo,Ur),Ur|=a,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=w!==null?w.baseLanes:u,rn(jo,Ur),Ur|=f}else w!==null?(f=w.baseLanes|u,l.memoizedState=null):f=u,rn(jo,Ur),Ur|=f;return yr(a,l,y,u),l.child}function Pj(a,l){var u=l.ref;(a===null&&u!==null||a!==null&&a.ref!==u)&&(l.flags|=512,l.flags|=2097152)}function wh(a,l,u,f,y){var w=kr(u)?bi:or.current;return w=co(l,w),xo(l,y),u=ph(a,l,u,f,w,y),f=mh(),a!==null&&!Er?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~y,aa(a,l,y)):(fn&&f&&Qm(l),l.flags|=1,yr(a,l,u,y),l.child)}function Tj(a,l,u,f,y){if(kr(u)){var w=!0;Rd(l)}else w=!1;if(xo(l,y),l.stateNode===null)Wd(a,l),gj(l,u,f),yh(l,u,f,y),f=!0;else if(a===null){var _=l.stateNode,Z=l.memoizedProps;_.props=Z;var ee=_.context,fe=u.contextType;typeof fe=="object"&&fe!==null?fe=rs(fe):(fe=kr(u)?bi:or.current,fe=co(l,fe));var _e=u.getDerivedStateFromProps,Me=typeof _e=="function"||typeof _.getSnapshotBeforeUpdate=="function";Me||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(Z!==f||ee!==fe)&&vj(l,_,f,fe),Oa=!1;var Te=l.memoizedState;_.state=Te,$d(l,f,_,y),ee=l.memoizedState,Z!==f||Te!==ee||Sr.current||Oa?(typeof _e=="function"&&(vh(l,u,_e,f),ee=l.memoizedState),(Z=Oa||xj(l,u,Z,f,Te,ee,fe))?(Me||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(l.flags|=4194308)):(typeof _.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=f,l.memoizedState=ee),_.props=f,_.state=ee,_.context=fe,f=Z):(typeof _.componentDidMount=="function"&&(l.flags|=4194308),f=!1)}else{_=l.stateNode,Gy(a,l),Z=l.memoizedProps,fe=l.type===l.elementType?Z:xs(l.type,Z),_.props=fe,Me=l.pendingProps,Te=_.context,ee=u.contextType,typeof ee=="object"&&ee!==null?ee=rs(ee):(ee=kr(u)?bi:or.current,ee=co(l,ee));var Ge=u.getDerivedStateFromProps;(_e=typeof Ge=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(Z!==Me||Te!==ee)&&vj(l,_,f,ee),Oa=!1,Te=l.memoizedState,_.state=Te,$d(l,f,_,y);var Je=l.memoizedState;Z!==Me||Te!==Je||Sr.current||Oa?(typeof Ge=="function"&&(vh(l,u,Ge,f),Je=l.memoizedState),(fe=Oa||xj(l,u,fe,f,Te,Je,ee)||!1)?(_e||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(f,Je,ee),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(f,Je,ee)),typeof _.componentDidUpdate=="function"&&(l.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof _.componentDidUpdate!="function"||Z===a.memoizedProps&&Te===a.memoizedState||(l.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||Z===a.memoizedProps&&Te===a.memoizedState||(l.flags|=1024),l.memoizedProps=f,l.memoizedState=Je),_.props=f,_.state=Je,_.context=ee,f=fe):(typeof _.componentDidUpdate!="function"||Z===a.memoizedProps&&Te===a.memoizedState||(l.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||Z===a.memoizedProps&&Te===a.memoizedState||(l.flags|=1024),f=!1)}return Nh(a,l,u,f,w,y)}function Nh(a,l,u,f,y,w){Pj(a,l);var _=(l.flags&128)!==0;if(!f&&!_)return y&&My(l,u,!1),aa(a,l,w);f=l.stateNode,IT.current=l;var Z=_&&typeof u.getDerivedStateFromError!="function"?null:f.render();return l.flags|=1,a!==null&&_?(l.child=ho(l,a.child,null,w),l.child=ho(l,null,Z,w)):yr(a,l,Z,w),l.memoizedState=f.state,y&&My(l,u,!0),l.child}function Rj(a){var l=a.stateNode;l.pendingContext?_y(a,l.pendingContext,l.pendingContext!==l.context):l.context&&_y(a,l.context,!1),ih(a,l.containerInfo)}function Aj(a,l,u,f,y){return mo(),Jm(y),l.flags|=256,yr(a,l,u,f),l.child}var Ch={dehydrated:null,treeContext:null,retryLane:0};function Sh(a){return{baseLanes:a,cachePool:null,transitions:null}}function _j(a,l,u){var f=l.pendingProps,y=gn.current,w=!1,_=(l.flags&128)!==0,Z;if((Z=_)||(Z=a!==null&&a.memoizedState===null?!1:(y&2)!==0),Z?(w=!0,l.flags&=-129):(a===null||a.memoizedState!==null)&&(y|=1),rn(gn,y&1),a===null)return Xm(l),a=l.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((l.mode&1)===0?l.lanes=1:a.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(_=f.children,a=f.fallback,w?(f=l.mode,w=l.child,_={mode:"hidden",children:_},(f&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=_):w=iu(_,f,0,null),a=Ai(a,f,u,null),w.return=l,a.return=l,w.sibling=a,l.child=w,l.child.memoizedState=Sh(u),l.memoizedState=Ch,a):kh(l,_));if(y=a.memoizedState,y!==null&&(Z=y.dehydrated,Z!==null))return MT(a,l,_,f,Z,y,u);if(w){w=f.fallback,_=l.mode,y=a.child,Z=y.sibling;var ee={mode:"hidden",children:f.children};return(_&1)===0&&l.child!==y?(f=l.child,f.childLanes=0,f.pendingProps=ee,l.deletions=null):(f=qa(y,ee),f.subtreeFlags=y.subtreeFlags&14680064),Z!==null?w=qa(Z,w):(w=Ai(w,_,u,null),w.flags|=2),w.return=l,f.return=l,f.sibling=w,l.child=f,f=w,w=l.child,_=a.child.memoizedState,_=_===null?Sh(u):{baseLanes:_.baseLanes|u,cachePool:null,transitions:_.transitions},w.memoizedState=_,w.childLanes=a.childLanes&~u,l.memoizedState=Ch,f}return w=a.child,a=w.sibling,f=qa(w,{mode:"visible",children:f.children}),(l.mode&1)===0&&(f.lanes=u),f.return=l,f.sibling=null,a!==null&&(u=l.deletions,u===null?(l.deletions=[a],l.flags|=16):u.push(a)),l.child=f,l.memoizedState=null,f}function kh(a,l){return l=iu({mode:"visible",children:l},a.mode,0,null),l.return=a,a.child=l}function Kd(a,l,u,f){return f!==null&&Jm(f),ho(l,a.child,null,u),a=kh(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function MT(a,l,u,f,y,w,_){if(u)return l.flags&256?(l.flags&=-257,f=jh(Error(r(422))),Kd(a,l,_,f)):l.memoizedState!==null?(l.child=a.child,l.flags|=128,null):(w=f.fallback,y=l.mode,f=iu({mode:"visible",children:f.children},y,0,null),w=Ai(w,y,_,null),w.flags|=2,f.return=l,w.return=l,f.sibling=w,l.child=f,(l.mode&1)!==0&&ho(l,a.child,null,_),l.child.memoizedState=Sh(_),l.memoizedState=Ch,w);if((l.mode&1)===0)return Kd(a,l,_,null);if(y.data==="$!"){if(f=y.nextSibling&&y.nextSibling.dataset,f)var Z=f.dgst;return f=Z,w=Error(r(419)),f=jh(w,f,void 0),Kd(a,l,_,f)}if(Z=(_&a.childLanes)!==0,Er||Z){if(f=Wn,f!==null){switch(_&-_){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=(y&(f.suspendedLanes|_))!==0?0:y,y!==0&&y!==w.retryLane&&(w.retryLane=y,ra(a,y),ys(f,a,y,-1))}return qh(),f=jh(Error(r(421))),Kd(a,l,_,f)}return y.data==="$?"?(l.flags|=128,l.child=a.child,l=KT.bind(null,a),y._reactRetry=l,null):(a=w.treeContext,qr=Aa(y.nextSibling),Vr=l,fn=!0,fs=null,a!==null&&(ts[ns++]=ta,ts[ns++]=na,ts[ns++]=wi,ta=a.id,na=a.overflow,wi=l),l=kh(l,f.children),l.flags|=4096,l)}function Ij(a,l,u){a.lanes|=l;var f=a.alternate;f!==null&&(f.lanes|=l),rh(a.return,l,u)}function Eh(a,l,u,f,y){var w=a.memoizedState;w===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:f,tail:u,tailMode:y}:(w.isBackwards=l,w.rendering=null,w.renderingStartTime=0,w.last=f,w.tail=u,w.tailMode=y)}function Mj(a,l,u){var f=l.pendingProps,y=f.revealOrder,w=f.tail;if(yr(a,l,f.children,u),f=gn.current,(f&2)!==0)f=f&1|2,l.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Ij(a,u,l);else if(a.tag===19)Ij(a,u,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}f&=1}if(rn(gn,f),(l.mode&1)===0)l.memoizedState=null;else switch(y){case"forwards":for(u=l.child,y=null;u!==null;)a=u.alternate,a!==null&&zd(a)===null&&(y=u),u=u.sibling;u=y,u===null?(y=l.child,l.child=null):(y=u.sibling,u.sibling=null),Eh(l,!1,y,u,w);break;case"backwards":for(u=null,y=l.child,l.child=null;y!==null;){if(a=y.alternate,a!==null&&zd(a)===null){l.child=y;break}a=y.sibling,y.sibling=u,u=y,y=a}Eh(l,!0,u,null,w);break;case"together":Eh(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Wd(a,l){(l.mode&1)===0&&a!==null&&(a.alternate=null,l.alternate=null,l.flags|=2)}function aa(a,l,u){if(a!==null&&(l.dependencies=a.dependencies),Ei|=l.lanes,(u&l.childLanes)===0)return null;if(a!==null&&l.child!==a.child)throw Error(r(153));if(l.child!==null){for(a=l.child,u=qa(a,a.pendingProps),l.child=u,u.return=l;a.sibling!==null;)a=a.sibling,u=u.sibling=qa(a,a.pendingProps),u.return=l;u.sibling=null}return l.child}function OT(a,l,u){switch(l.tag){case 3:Rj(l),mo();break;case 5:Wy(l);break;case 1:kr(l.type)&&Rd(l);break;case 4:ih(l,l.stateNode.containerInfo);break;case 10:var f=l.type._context,y=l.memoizedProps.value;rn(Dd,f._currentValue),f._currentValue=y;break;case 13:if(f=l.memoizedState,f!==null)return f.dehydrated!==null?(rn(gn,gn.current&1),l.flags|=128,null):(u&l.child.childLanes)!==0?_j(a,l,u):(rn(gn,gn.current&1),a=aa(a,l,u),a!==null?a.sibling:null);rn(gn,gn.current&1);break;case 19:if(f=(u&l.childLanes)!==0,(a.flags&128)!==0){if(f)return Mj(a,l,u);l.flags|=128}if(y=l.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),rn(gn,gn.current),f)break;return null;case 22:case 23:return l.lanes=0,Ej(a,l,u)}return aa(a,l,u)}var Oj,Ph,Dj,Lj;Oj=function(a,l){for(var u=l.child;u!==null;){if(u.tag===5||u.tag===6)a.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},Ph=function(){},Dj=function(a,l,u,f){var y=a.memoizedProps;if(y!==f){a=l.stateNode,Si(Os.current);var w=null;switch(u){case"input":y=Ye(a,y),f=Ye(a,f),w=[];break;case"select":y=D({},y,{value:void 0}),f=D({},f,{value:void 0}),w=[];break;case"textarea":y=L(a,y),f=L(a,f),w=[];break;default:typeof y.onClick!="function"&&typeof f.onClick=="function"&&(a.onclick=Ed)}tn(u,f);var _;u=null;for(fe in y)if(!f.hasOwnProperty(fe)&&y.hasOwnProperty(fe)&&y[fe]!=null)if(fe==="style"){var Z=y[fe];for(_ in Z)Z.hasOwnProperty(_)&&(u||(u={}),u[_]="")}else fe!=="dangerouslySetInnerHTML"&&fe!=="children"&&fe!=="suppressContentEditableWarning"&&fe!=="suppressHydrationWarning"&&fe!=="autoFocus"&&(i.hasOwnProperty(fe)?w||(w=[]):(w=w||[]).push(fe,null));for(fe in f){var ee=f[fe];if(Z=y?.[fe],f.hasOwnProperty(fe)&&ee!==Z&&(ee!=null||Z!=null))if(fe==="style")if(Z){for(_ in Z)!Z.hasOwnProperty(_)||ee&&ee.hasOwnProperty(_)||(u||(u={}),u[_]="");for(_ in ee)ee.hasOwnProperty(_)&&Z[_]!==ee[_]&&(u||(u={}),u[_]=ee[_])}else u||(w||(w=[]),w.push(fe,u)),u=ee;else fe==="dangerouslySetInnerHTML"?(ee=ee?ee.__html:void 0,Z=Z?Z.__html:void 0,ee!=null&&Z!==ee&&(w=w||[]).push(fe,ee)):fe==="children"?typeof ee!="string"&&typeof ee!="number"||(w=w||[]).push(fe,""+ee):fe!=="suppressContentEditableWarning"&&fe!=="suppressHydrationWarning"&&(i.hasOwnProperty(fe)?(ee!=null&&fe==="onScroll"&&dn("scroll",a),w||Z===ee||(w=[])):(w=w||[]).push(fe,ee))}u&&(w=w||[]).push("style",u);var fe=w;(l.updateQueue=fe)&&(l.flags|=4)}},Lj=function(a,l,u,f){u!==f&&(l.flags|=4)};function Zl(a,l){if(!fn)switch(a.tailMode){case"hidden":l=a.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?a.tail=null:u.sibling=null;break;case"collapsed":u=a.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:f.sibling=null}}function cr(a){var l=a.alternate!==null&&a.alternate.child===a.child,u=0,f=0;if(l)for(var y=a.child;y!==null;)u|=y.lanes|y.childLanes,f|=y.subtreeFlags&14680064,f|=y.flags&14680064,y.return=a,y=y.sibling;else for(y=a.child;y!==null;)u|=y.lanes|y.childLanes,f|=y.subtreeFlags,f|=y.flags,y.return=a,y=y.sibling;return a.subtreeFlags|=f,a.childLanes=u,l}function DT(a,l,u){var f=l.pendingProps;switch(Ym(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cr(l),null;case 1:return kr(l.type)&&Td(),cr(l),null;case 3:return f=l.stateNode,go(),un(Sr),un(or),ch(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(a===null||a.child===null)&&(Md(l)?l.flags|=4:a===null||a.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,fs!==null&&($h(fs),fs=null))),Ph(a,l),cr(l),null;case 5:oh(l);var y=Si(Hl.current);if(u=l.type,a!==null&&l.stateNode!=null)Dj(a,l,u,f,y),a.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!f){if(l.stateNode===null)throw Error(r(166));return cr(l),null}if(a=Si(Os.current),Md(l)){f=l.stateNode,u=l.type;var w=l.memoizedProps;switch(f[Ms]=l,f[Vl]=w,a=(l.mode&1)!==0,u){case"dialog":dn("cancel",f),dn("close",f);break;case"iframe":case"object":case"embed":dn("load",f);break;case"video":case"audio":for(y=0;y<Fl.length;y++)dn(Fl[y],f);break;case"source":dn("error",f);break;case"img":case"image":case"link":dn("error",f),dn("load",f);break;case"details":dn("toggle",f);break;case"input":Qe(f,w),dn("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!w.multiple},dn("invalid",f);break;case"textarea":de(f,w),dn("invalid",f)}tn(u,w),y=null;for(var _ in w)if(w.hasOwnProperty(_)){var Z=w[_];_==="children"?typeof Z=="string"?f.textContent!==Z&&(w.suppressHydrationWarning!==!0&&kd(f.textContent,Z,a),y=["children",Z]):typeof Z=="number"&&f.textContent!==""+Z&&(w.suppressHydrationWarning!==!0&&kd(f.textContent,Z,a),y=["children",""+Z]):i.hasOwnProperty(_)&&Z!=null&&_==="onScroll"&&dn("scroll",f)}switch(u){case"input":Be(f),cn(f,w,!0);break;case"textarea":Be(f),ze(f);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(f.onclick=Ed)}f=y,l.updateQueue=f,f!==null&&(l.flags|=4)}else{_=y.nodeType===9?y:y.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=M(u)),a==="http://www.w3.org/1999/xhtml"?u==="script"?(a=_.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof f.is=="string"?a=_.createElement(u,{is:f.is}):(a=_.createElement(u),u==="select"&&(_=a,f.multiple?_.multiple=!0:f.size&&(_.size=f.size))):a=_.createElementNS(a,u),a[Ms]=l,a[Vl]=f,Oj(a,l,!1,!1),l.stateNode=a;e:{switch(_=Sn(u,f),u){case"dialog":dn("cancel",a),dn("close",a),y=f;break;case"iframe":case"object":case"embed":dn("load",a),y=f;break;case"video":case"audio":for(y=0;y<Fl.length;y++)dn(Fl[y],a);y=f;break;case"source":dn("error",a),y=f;break;case"img":case"image":case"link":dn("error",a),dn("load",a),y=f;break;case"details":dn("toggle",a),y=f;break;case"input":Qe(a,f),y=Ye(a,f),dn("invalid",a);break;case"option":y=f;break;case"select":a._wrapperState={wasMultiple:!!f.multiple},y=D({},f,{value:void 0}),dn("invalid",a);break;case"textarea":de(a,f),y=L(a,f),dn("invalid",a);break;default:y=f}tn(u,y),Z=y;for(w in Z)if(Z.hasOwnProperty(w)){var ee=Z[w];w==="style"?An(a,ee):w==="dangerouslySetInnerHTML"?(ee=ee?ee.__html:void 0,ee!=null&&qe(a,ee)):w==="children"?typeof ee=="string"?(u!=="textarea"||ee!=="")&&Ze(a,ee):typeof ee=="number"&&Ze(a,""+ee):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(i.hasOwnProperty(w)?ee!=null&&w==="onScroll"&&dn("scroll",a):ee!=null&&P(a,w,ee,_))}switch(u){case"input":Be(a),cn(a,f,!1);break;case"textarea":Be(a),ze(a);break;case"option":f.value!=null&&a.setAttribute("value",""+Se(f.value));break;case"select":a.multiple=!!f.multiple,w=f.value,w!=null?tt(a,!!f.multiple,w,!1):f.defaultValue!=null&&tt(a,!!f.multiple,f.defaultValue,!0);break;default:typeof y.onClick=="function"&&(a.onclick=Ed)}switch(u){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}}f&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return cr(l),null;case 6:if(a&&l.stateNode!=null)Lj(a,l,a.memoizedProps,f);else{if(typeof f!="string"&&l.stateNode===null)throw Error(r(166));if(u=Si(Hl.current),Si(Os.current),Md(l)){if(f=l.stateNode,u=l.memoizedProps,f[Ms]=l,(w=f.nodeValue!==u)&&(a=Vr,a!==null))switch(a.tag){case 3:kd(f.nodeValue,u,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&kd(f.nodeValue,u,(a.mode&1)!==0)}w&&(l.flags|=4)}else f=(u.nodeType===9?u:u.ownerDocument).createTextNode(f),f[Ms]=l,l.stateNode=f}return cr(l),null;case 13:if(un(gn),f=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(fn&&qr!==null&&(l.mode&1)!==0&&(l.flags&128)===0)zy(),mo(),l.flags|=98560,w=!1;else if(w=Md(l),f!==null&&f.dehydrated!==null){if(a===null){if(!w)throw Error(r(318));if(w=l.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(r(317));w[Ms]=l}else mo(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;cr(l),w=!1}else fs!==null&&($h(fs),fs=null),w=!0;if(!w)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=u,l):(f=f!==null,f!==(a!==null&&a.memoizedState!==null)&&f&&(l.child.flags|=8192,(l.mode&1)!==0&&(a===null||(gn.current&1)!==0?qn===0&&(qn=3):qh())),l.updateQueue!==null&&(l.flags|=4),cr(l),null);case 4:return go(),Ph(a,l),a===null&&$l(l.stateNode.containerInfo),cr(l),null;case 10:return nh(l.type._context),cr(l),null;case 17:return kr(l.type)&&Td(),cr(l),null;case 19:if(un(gn),w=l.memoizedState,w===null)return cr(l),null;if(f=(l.flags&128)!==0,_=w.rendering,_===null)if(f)Zl(w,!1);else{if(qn!==0||a!==null&&(a.flags&128)!==0)for(a=l.child;a!==null;){if(_=zd(a),_!==null){for(l.flags|=128,Zl(w,!1),f=_.updateQueue,f!==null&&(l.updateQueue=f,l.flags|=4),l.subtreeFlags=0,f=u,u=l.child;u!==null;)w=u,a=f,w.flags&=14680066,_=w.alternate,_===null?(w.childLanes=0,w.lanes=a,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=_.childLanes,w.lanes=_.lanes,w.child=_.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=_.memoizedProps,w.memoizedState=_.memoizedState,w.updateQueue=_.updateQueue,w.type=_.type,a=_.dependencies,w.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),u=u.sibling;return rn(gn,gn.current&1|2),l.child}a=a.sibling}w.tail!==null&&Yt()>bo&&(l.flags|=128,f=!0,Zl(w,!1),l.lanes=4194304)}else{if(!f)if(a=zd(_),a!==null){if(l.flags|=128,f=!0,u=a.updateQueue,u!==null&&(l.updateQueue=u,l.flags|=4),Zl(w,!0),w.tail===null&&w.tailMode==="hidden"&&!_.alternate&&!fn)return cr(l),null}else 2*Yt()-w.renderingStartTime>bo&&u!==1073741824&&(l.flags|=128,f=!0,Zl(w,!1),l.lanes=4194304);w.isBackwards?(_.sibling=l.child,l.child=_):(u=w.last,u!==null?u.sibling=_:l.child=_,w.last=_)}return w.tail!==null?(l=w.tail,w.rendering=l,w.tail=l.sibling,w.renderingStartTime=Yt(),l.sibling=null,u=gn.current,rn(gn,f?u&1|2:u&1),l):(cr(l),null);case 22:case 23:return Vh(),f=l.memoizedState!==null,a!==null&&a.memoizedState!==null!==f&&(l.flags|=8192),f&&(l.mode&1)!==0?(Ur&1073741824)!==0&&(cr(l),l.subtreeFlags&6&&(l.flags|=8192)):cr(l),null;case 24:return null;case 25:return null}throw Error(r(156,l.tag))}function LT(a,l){switch(Ym(l),l.tag){case 1:return kr(l.type)&&Td(),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return go(),un(Sr),un(or),ch(),a=l.flags,(a&65536)!==0&&(a&128)===0?(l.flags=a&-65537|128,l):null;case 5:return oh(l),null;case 13:if(un(gn),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(r(340));mo()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return un(gn),null;case 4:return go(),null;case 10:return nh(l.type._context),null;case 22:case 23:return Vh(),null;case 24:return null;default:return null}}var Qd=!1,dr=!1,FT=typeof WeakSet=="function"?WeakSet:Set,Xe=null;function yo(a,l){var u=a.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(f){kn(a,l,f)}else u.current=null}function Th(a,l,u){try{u()}catch(f){kn(a,l,f)}}var Fj=!1;function $T(a,l){if(Vm=fd,a=xy(),Im(a)){if("selectionStart"in a)var u={start:a.selectionStart,end:a.selectionEnd};else e:{u=(u=a.ownerDocument)&&u.defaultView||window;var f=u.getSelection&&u.getSelection();if(f&&f.rangeCount!==0){u=f.anchorNode;var y=f.anchorOffset,w=f.focusNode;f=f.focusOffset;try{u.nodeType,w.nodeType}catch{u=null;break e}var _=0,Z=-1,ee=-1,fe=0,_e=0,Me=a,Te=null;t:for(;;){for(var Ge;Me!==u||y!==0&&Me.nodeType!==3||(Z=_+y),Me!==w||f!==0&&Me.nodeType!==3||(ee=_+f),Me.nodeType===3&&(_+=Me.nodeValue.length),(Ge=Me.firstChild)!==null;)Te=Me,Me=Ge;for(;;){if(Me===a)break t;if(Te===u&&++fe===y&&(Z=_),Te===w&&++_e===f&&(ee=_),(Ge=Me.nextSibling)!==null)break;Me=Te,Te=Me.parentNode}Me=Ge}u=Z===-1||ee===-1?null:{start:Z,end:ee}}else u=null}u=u||{start:0,end:0}}else u=null;for(qm={focusedElem:a,selectionRange:u},fd=!1,Xe=l;Xe!==null;)if(l=Xe,a=l.child,(l.subtreeFlags&1028)!==0&&a!==null)a.return=l,Xe=a;else for(;Xe!==null;){l=Xe;try{var Je=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(Je!==null){var nt=Je.memoizedProps,_n=Je.memoizedState,ue=l.stateNode,ne=ue.getSnapshotBeforeUpdate(l.elementType===l.type?nt:xs(l.type,nt),_n);ue.__reactInternalSnapshotBeforeUpdate=ne}break;case 3:var pe=l.stateNode.containerInfo;pe.nodeType===1?pe.textContent="":pe.nodeType===9&&pe.documentElement&&pe.removeChild(pe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Fe){kn(l,l.return,Fe)}if(a=l.sibling,a!==null){a.return=l.return,Xe=a;break}Xe=l.return}return Je=Fj,Fj=!1,Je}function Xl(a,l,u){var f=l.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var y=f=f.next;do{if((y.tag&a)===a){var w=y.destroy;y.destroy=void 0,w!==void 0&&Th(l,u,w)}y=y.next}while(y!==f)}}function Yd(a,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var u=l=l.next;do{if((u.tag&a)===a){var f=u.create;u.destroy=f()}u=u.next}while(u!==l)}}function Rh(a){var l=a.ref;if(l!==null){var u=a.stateNode;a.tag,a=u,typeof l=="function"?l(a):l.current=a}}function $j(a){var l=a.alternate;l!==null&&(a.alternate=null,$j(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&(delete l[Ms],delete l[Vl],delete l[Hm],delete l[bT],delete l[wT])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function zj(a){return a.tag===5||a.tag===3||a.tag===4}function Vj(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||zj(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Ah(a,l,u){var f=a.tag;if(f===5||f===6)a=a.stateNode,l?u.nodeType===8?u.parentNode.insertBefore(a,l):u.insertBefore(a,l):(u.nodeType===8?(l=u.parentNode,l.insertBefore(a,u)):(l=u,l.appendChild(a)),u=u._reactRootContainer,u!=null||l.onclick!==null||(l.onclick=Ed));else if(f!==4&&(a=a.child,a!==null))for(Ah(a,l,u),a=a.sibling;a!==null;)Ah(a,l,u),a=a.sibling}function _h(a,l,u){var f=a.tag;if(f===5||f===6)a=a.stateNode,l?u.insertBefore(a,l):u.appendChild(a);else if(f!==4&&(a=a.child,a!==null))for(_h(a,l,u),a=a.sibling;a!==null;)_h(a,l,u),a=a.sibling}var er=null,gs=!1;function La(a,l,u){for(u=u.child;u!==null;)qj(a,l,u),u=u.sibling}function qj(a,l,u){if(lt&&typeof lt.onCommitFiberUnmount=="function")try{lt.onCommitFiberUnmount(Ce,u)}catch{}switch(u.tag){case 5:dr||yo(u,l);case 6:var f=er,y=gs;er=null,La(a,l,u),er=f,gs=y,er!==null&&(gs?(a=er,u=u.stateNode,a.nodeType===8?a.parentNode.removeChild(u):a.removeChild(u)):er.removeChild(u.stateNode));break;case 18:er!==null&&(gs?(a=er,u=u.stateNode,a.nodeType===8?Gm(a.parentNode,u):a.nodeType===1&&Gm(a,u),Rl(a)):Gm(er,u.stateNode));break;case 4:f=er,y=gs,er=u.stateNode.containerInfo,gs=!0,La(a,l,u),er=f,gs=y;break;case 0:case 11:case 14:case 15:if(!dr&&(f=u.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){y=f=f.next;do{var w=y,_=w.destroy;w=w.tag,_!==void 0&&((w&2)!==0||(w&4)!==0)&&Th(u,l,_),y=y.next}while(y!==f)}La(a,l,u);break;case 1:if(!dr&&(yo(u,l),f=u.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=u.memoizedProps,f.state=u.memoizedState,f.componentWillUnmount()}catch(Z){kn(u,l,Z)}La(a,l,u);break;case 21:La(a,l,u);break;case 22:u.mode&1?(dr=(f=dr)||u.memoizedState!==null,La(a,l,u),dr=f):La(a,l,u);break;default:La(a,l,u)}}function Uj(a){var l=a.updateQueue;if(l!==null){a.updateQueue=null;var u=a.stateNode;u===null&&(u=a.stateNode=new FT),l.forEach(function(f){var y=WT.bind(null,a,f);u.has(f)||(u.add(f),f.then(y,y))})}}function vs(a,l){var u=l.deletions;if(u!==null)for(var f=0;f<u.length;f++){var y=u[f];try{var w=a,_=l,Z=_;e:for(;Z!==null;){switch(Z.tag){case 5:er=Z.stateNode,gs=!1;break e;case 3:er=Z.stateNode.containerInfo,gs=!0;break e;case 4:er=Z.stateNode.containerInfo,gs=!0;break e}Z=Z.return}if(er===null)throw Error(r(160));qj(w,_,y),er=null,gs=!1;var ee=y.alternate;ee!==null&&(ee.return=null),y.return=null}catch(fe){kn(y,l,fe)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)Bj(l,a),l=l.sibling}function Bj(a,l){var u=a.alternate,f=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(vs(l,a),Ls(a),f&4){try{Xl(3,a,a.return),Yd(3,a)}catch(nt){kn(a,a.return,nt)}try{Xl(5,a,a.return)}catch(nt){kn(a,a.return,nt)}}break;case 1:vs(l,a),Ls(a),f&512&&u!==null&&yo(u,u.return);break;case 5:if(vs(l,a),Ls(a),f&512&&u!==null&&yo(u,u.return),a.flags&32){var y=a.stateNode;try{Ze(y,"")}catch(nt){kn(a,a.return,nt)}}if(f&4&&(y=a.stateNode,y!=null)){var w=a.memoizedProps,_=u!==null?u.memoizedProps:w,Z=a.type,ee=a.updateQueue;if(a.updateQueue=null,ee!==null)try{Z==="input"&&w.type==="radio"&&w.name!=null&&mt(y,w),Sn(Z,_);var fe=Sn(Z,w);for(_=0;_<ee.length;_+=2){var _e=ee[_],Me=ee[_+1];_e==="style"?An(y,Me):_e==="dangerouslySetInnerHTML"?qe(y,Me):_e==="children"?Ze(y,Me):P(y,_e,Me,fe)}switch(Z){case"input":ht(y,w);break;case"textarea":ge(y,w);break;case"select":var Te=y._wrapperState.wasMultiple;y._wrapperState.wasMultiple=!!w.multiple;var Ge=w.value;Ge!=null?tt(y,!!w.multiple,Ge,!1):Te!==!!w.multiple&&(w.defaultValue!=null?tt(y,!!w.multiple,w.defaultValue,!0):tt(y,!!w.multiple,w.multiple?[]:"",!1))}y[Vl]=w}catch(nt){kn(a,a.return,nt)}}break;case 6:if(vs(l,a),Ls(a),f&4){if(a.stateNode===null)throw Error(r(162));y=a.stateNode,w=a.memoizedProps;try{y.nodeValue=w}catch(nt){kn(a,a.return,nt)}}break;case 3:if(vs(l,a),Ls(a),f&4&&u!==null&&u.memoizedState.isDehydrated)try{Rl(l.containerInfo)}catch(nt){kn(a,a.return,nt)}break;case 4:vs(l,a),Ls(a);break;case 13:vs(l,a),Ls(a),y=a.child,y.flags&8192&&(w=y.memoizedState!==null,y.stateNode.isHidden=w,!w||y.alternate!==null&&y.alternate.memoizedState!==null||(Oh=Yt())),f&4&&Uj(a);break;case 22:if(_e=u!==null&&u.memoizedState!==null,a.mode&1?(dr=(fe=dr)||_e,vs(l,a),dr=fe):vs(l,a),Ls(a),f&8192){if(fe=a.memoizedState!==null,(a.stateNode.isHidden=fe)&&!_e&&(a.mode&1)!==0)for(Xe=a,_e=a.child;_e!==null;){for(Me=Xe=_e;Xe!==null;){switch(Te=Xe,Ge=Te.child,Te.tag){case 0:case 11:case 14:case 15:Xl(4,Te,Te.return);break;case 1:yo(Te,Te.return);var Je=Te.stateNode;if(typeof Je.componentWillUnmount=="function"){f=Te,u=Te.return;try{l=f,Je.props=l.memoizedProps,Je.state=l.memoizedState,Je.componentWillUnmount()}catch(nt){kn(f,u,nt)}}break;case 5:yo(Te,Te.return);break;case 22:if(Te.memoizedState!==null){Kj(Me);continue}}Ge!==null?(Ge.return=Te,Xe=Ge):Kj(Me)}_e=_e.sibling}e:for(_e=null,Me=a;;){if(Me.tag===5){if(_e===null){_e=Me;try{y=Me.stateNode,fe?(w=y.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(Z=Me.stateNode,ee=Me.memoizedProps.style,_=ee!=null&&ee.hasOwnProperty("display")?ee.display:null,Z.style.display=Lt("display",_))}catch(nt){kn(a,a.return,nt)}}}else if(Me.tag===6){if(_e===null)try{Me.stateNode.nodeValue=fe?"":Me.memoizedProps}catch(nt){kn(a,a.return,nt)}}else if((Me.tag!==22&&Me.tag!==23||Me.memoizedState===null||Me===a)&&Me.child!==null){Me.child.return=Me,Me=Me.child;continue}if(Me===a)break e;for(;Me.sibling===null;){if(Me.return===null||Me.return===a)break e;_e===Me&&(_e=null),Me=Me.return}_e===Me&&(_e=null),Me.sibling.return=Me.return,Me=Me.sibling}}break;case 19:vs(l,a),Ls(a),f&4&&Uj(a);break;case 21:break;default:vs(l,a),Ls(a)}}function Ls(a){var l=a.flags;if(l&2){try{e:{for(var u=a.return;u!==null;){if(zj(u)){var f=u;break e}u=u.return}throw Error(r(160))}switch(f.tag){case 5:var y=f.stateNode;f.flags&32&&(Ze(y,""),f.flags&=-33);var w=Vj(a);_h(a,w,y);break;case 3:case 4:var _=f.stateNode.containerInfo,Z=Vj(a);Ah(a,Z,_);break;default:throw Error(r(161))}}catch(ee){kn(a,a.return,ee)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function zT(a,l,u){Xe=a,Gj(a)}function Gj(a,l,u){for(var f=(a.mode&1)!==0;Xe!==null;){var y=Xe,w=y.child;if(y.tag===22&&f){var _=y.memoizedState!==null||Qd;if(!_){var Z=y.alternate,ee=Z!==null&&Z.memoizedState!==null||dr;Z=Qd;var fe=dr;if(Qd=_,(dr=ee)&&!fe)for(Xe=y;Xe!==null;)_=Xe,ee=_.child,_.tag===22&&_.memoizedState!==null?Wj(y):ee!==null?(ee.return=_,Xe=ee):Wj(y);for(;w!==null;)Xe=w,Gj(w),w=w.sibling;Xe=y,Qd=Z,dr=fe}Hj(a)}else(y.subtreeFlags&8772)!==0&&w!==null?(w.return=y,Xe=w):Hj(a)}}function Hj(a){for(;Xe!==null;){var l=Xe;if((l.flags&8772)!==0){var u=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:dr||Yd(5,l);break;case 1:var f=l.stateNode;if(l.flags&4&&!dr)if(u===null)f.componentDidMount();else{var y=l.elementType===l.type?u.memoizedProps:xs(l.type,u.memoizedProps);f.componentDidUpdate(y,u.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var w=l.updateQueue;w!==null&&Ky(l,w,f);break;case 3:var _=l.updateQueue;if(_!==null){if(u=null,l.child!==null)switch(l.child.tag){case 5:u=l.child.stateNode;break;case 1:u=l.child.stateNode}Ky(l,_,u)}break;case 5:var Z=l.stateNode;if(u===null&&l.flags&4){u=Z;var ee=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":ee.autoFocus&&u.focus();break;case"img":ee.src&&(u.src=ee.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var fe=l.alternate;if(fe!==null){var _e=fe.memoizedState;if(_e!==null){var Me=_e.dehydrated;Me!==null&&Rl(Me)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}dr||l.flags&512&&Rh(l)}catch(Te){kn(l,l.return,Te)}}if(l===a){Xe=null;break}if(u=l.sibling,u!==null){u.return=l.return,Xe=u;break}Xe=l.return}}function Kj(a){for(;Xe!==null;){var l=Xe;if(l===a){Xe=null;break}var u=l.sibling;if(u!==null){u.return=l.return,Xe=u;break}Xe=l.return}}function Wj(a){for(;Xe!==null;){var l=Xe;try{switch(l.tag){case 0:case 11:case 15:var u=l.return;try{Yd(4,l)}catch(ee){kn(l,u,ee)}break;case 1:var f=l.stateNode;if(typeof f.componentDidMount=="function"){var y=l.return;try{f.componentDidMount()}catch(ee){kn(l,y,ee)}}var w=l.return;try{Rh(l)}catch(ee){kn(l,w,ee)}break;case 5:var _=l.return;try{Rh(l)}catch(ee){kn(l,_,ee)}}}catch(ee){kn(l,l.return,ee)}if(l===a){Xe=null;break}var Z=l.sibling;if(Z!==null){Z.return=l.return,Xe=Z;break}Xe=l.return}}var VT=Math.ceil,Zd=R.ReactCurrentDispatcher,Ih=R.ReactCurrentOwner,as=R.ReactCurrentBatchConfig,$t=0,Wn=null,Dn=null,tr=0,Ur=0,jo=_a(0),qn=0,Jl=null,Ei=0,Xd=0,Mh=0,ec=null,Pr=null,Oh=0,bo=1/0,ia=null,Jd=!1,Dh=null,Fa=null,eu=!1,$a=null,tu=0,tc=0,Lh=null,nu=-1,ru=0;function jr(){return($t&6)!==0?Yt():nu!==-1?nu:nu=Yt()}function za(a){return(a.mode&1)===0?1:($t&2)!==0&&tr!==0?tr&-tr:CT.transition!==null?(ru===0&&(ru=Vv()),ru):(a=Zt,a!==0||(a=window.event,a=a===void 0?16:Yv(a.type)),a)}function ys(a,l,u,f){if(50<tc)throw tc=0,Lh=null,Error(r(185));Sl(a,u,f),(($t&2)===0||a!==Wn)&&(a===Wn&&(($t&2)===0&&(Xd|=u),qn===4&&Va(a,tr)),Tr(a,f),u===1&&$t===0&&(l.mode&1)===0&&(bo=Yt()+500,Ad&&Ma()))}function Tr(a,l){var u=a.callbackNode;CP(a,l);var f=pd(a,a===Wn?tr:0);if(f===0)u!==null&&Zi(u),a.callbackNode=null,a.callbackPriority=0;else if(l=f&-f,a.callbackPriority!==l){if(u!=null&&Zi(u),l===1)a.tag===0?NT(Yj.bind(null,a)):Oy(Yj.bind(null,a)),yT(function(){($t&6)===0&&Ma()}),u=null;else{switch(qv(f)){case 1:u=Nl;break;case 4:u=cd;break;case 16:u=Ji;break;case 536870912:u=Ve;break;default:u=Ji}u=s0(u,Qj.bind(null,a))}a.callbackPriority=l,a.callbackNode=u}}function Qj(a,l){if(nu=-1,ru=0,($t&6)!==0)throw Error(r(327));var u=a.callbackNode;if(wo()&&a.callbackNode!==u)return null;var f=pd(a,a===Wn?tr:0);if(f===0)return null;if((f&30)!==0||(f&a.expiredLanes)!==0||l)l=su(a,f);else{l=f;var y=$t;$t|=2;var w=Xj();(Wn!==a||tr!==l)&&(ia=null,bo=Yt()+500,Ti(a,l));do try{BT();break}catch(Z){Zj(a,Z)}while(!0);th(),Zd.current=w,$t=y,Dn!==null?l=0:(Wn=null,tr=0,l=qn)}if(l!==0){if(l===2&&(y=gm(a),y!==0&&(f=y,l=Fh(a,y))),l===1)throw u=Jl,Ti(a,0),Va(a,f),Tr(a,Yt()),u;if(l===6)Va(a,f);else{if(y=a.current.alternate,(f&30)===0&&!qT(y)&&(l=su(a,f),l===2&&(w=gm(a),w!==0&&(f=w,l=Fh(a,w))),l===1))throw u=Jl,Ti(a,0),Va(a,f),Tr(a,Yt()),u;switch(a.finishedWork=y,a.finishedLanes=f,l){case 0:case 1:throw Error(r(345));case 2:Ri(a,Pr,ia);break;case 3:if(Va(a,f),(f&130023424)===f&&(l=Oh+500-Yt(),10<l)){if(pd(a,0)!==0)break;if(y=a.suspendedLanes,(y&f)!==f){jr(),a.pingedLanes|=a.suspendedLanes&y;break}a.timeoutHandle=Bm(Ri.bind(null,a,Pr,ia),l);break}Ri(a,Pr,ia);break;case 4:if(Va(a,f),(f&4194240)===f)break;for(l=a.eventTimes,y=-1;0<f;){var _=31-Jn(f);w=1<<_,_=l[_],_>y&&(y=_),f&=~w}if(f=y,f=Yt()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*VT(f/1960))-f,10<f){a.timeoutHandle=Bm(Ri.bind(null,a,Pr,ia),f);break}Ri(a,Pr,ia);break;case 5:Ri(a,Pr,ia);break;default:throw Error(r(329))}}}return Tr(a,Yt()),a.callbackNode===u?Qj.bind(null,a):null}function Fh(a,l){var u=ec;return a.current.memoizedState.isDehydrated&&(Ti(a,l).flags|=256),a=su(a,l),a!==2&&(l=Pr,Pr=u,l!==null&&$h(l)),a}function $h(a){Pr===null?Pr=a:Pr.push.apply(Pr,a)}function qT(a){for(var l=a;;){if(l.flags&16384){var u=l.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var f=0;f<u.length;f++){var y=u[f],w=y.getSnapshot;y=y.value;try{if(!hs(w(),y))return!1}catch{return!1}}}if(u=l.child,l.subtreeFlags&16384&&u!==null)u.return=l,l=u;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Va(a,l){for(l&=~Mh,l&=~Xd,a.suspendedLanes|=l,a.pingedLanes&=~l,a=a.expirationTimes;0<l;){var u=31-Jn(l),f=1<<u;a[u]=-1,l&=~f}}function Yj(a){if(($t&6)!==0)throw Error(r(327));wo();var l=pd(a,0);if((l&1)===0)return Tr(a,Yt()),null;var u=su(a,l);if(a.tag!==0&&u===2){var f=gm(a);f!==0&&(l=f,u=Fh(a,f))}if(u===1)throw u=Jl,Ti(a,0),Va(a,l),Tr(a,Yt()),u;if(u===6)throw Error(r(345));return a.finishedWork=a.current.alternate,a.finishedLanes=l,Ri(a,Pr,ia),Tr(a,Yt()),null}function zh(a,l){var u=$t;$t|=1;try{return a(l)}finally{$t=u,$t===0&&(bo=Yt()+500,Ad&&Ma())}}function Pi(a){$a!==null&&$a.tag===0&&($t&6)===0&&wo();var l=$t;$t|=1;var u=as.transition,f=Zt;try{if(as.transition=null,Zt=1,a)return a()}finally{Zt=f,as.transition=u,$t=l,($t&6)===0&&Ma()}}function Vh(){Ur=jo.current,un(jo)}function Ti(a,l){a.finishedWork=null,a.finishedLanes=0;var u=a.timeoutHandle;if(u!==-1&&(a.timeoutHandle=-1,vT(u)),Dn!==null)for(u=Dn.return;u!==null;){var f=u;switch(Ym(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&Td();break;case 3:go(),un(Sr),un(or),ch();break;case 5:oh(f);break;case 4:go();break;case 13:un(gn);break;case 19:un(gn);break;case 10:nh(f.type._context);break;case 22:case 23:Vh()}u=u.return}if(Wn=a,Dn=a=qa(a.current,null),tr=Ur=l,qn=0,Jl=null,Mh=Xd=Ei=0,Pr=ec=null,Ci!==null){for(l=0;l<Ci.length;l++)if(u=Ci[l],f=u.interleaved,f!==null){u.interleaved=null;var y=f.next,w=u.pending;if(w!==null){var _=w.next;w.next=y,f.next=_}u.pending=f}Ci=null}return a}function Zj(a,l){do{var u=Dn;try{if(th(),Vd.current=Gd,qd){for(var f=vn.memoizedState;f!==null;){var y=f.queue;y!==null&&(y.pending=null),f=f.next}qd=!1}if(ki=0,Kn=Vn=vn=null,Kl=!1,Wl=0,Ih.current=null,u===null||u.return===null){qn=1,Jl=l,Dn=null;break}e:{var w=a,_=u.return,Z=u,ee=l;if(l=tr,Z.flags|=32768,ee!==null&&typeof ee=="object"&&typeof ee.then=="function"){var fe=ee,_e=Z,Me=_e.tag;if((_e.mode&1)===0&&(Me===0||Me===11||Me===15)){var Te=_e.alternate;Te?(_e.updateQueue=Te.updateQueue,_e.memoizedState=Te.memoizedState,_e.lanes=Te.lanes):(_e.updateQueue=null,_e.memoizedState=null)}var Ge=wj(_);if(Ge!==null){Ge.flags&=-257,Nj(Ge,_,Z,w,l),Ge.mode&1&&bj(w,fe,l),l=Ge,ee=fe;var Je=l.updateQueue;if(Je===null){var nt=new Set;nt.add(ee),l.updateQueue=nt}else Je.add(ee);break e}else{if((l&1)===0){bj(w,fe,l),qh();break e}ee=Error(r(426))}}else if(fn&&Z.mode&1){var _n=wj(_);if(_n!==null){(_n.flags&65536)===0&&(_n.flags|=256),Nj(_n,_,Z,w,l),Jm(vo(ee,Z));break e}}w=ee=vo(ee,Z),qn!==4&&(qn=2),ec===null?ec=[w]:ec.push(w),w=_;do{switch(w.tag){case 3:w.flags|=65536,l&=-l,w.lanes|=l;var ue=yj(w,ee,l);Hy(w,ue);break e;case 1:Z=ee;var ne=w.type,pe=w.stateNode;if((w.flags&128)===0&&(typeof ne.getDerivedStateFromError=="function"||pe!==null&&typeof pe.componentDidCatch=="function"&&(Fa===null||!Fa.has(pe)))){w.flags|=65536,l&=-l,w.lanes|=l;var Fe=jj(w,Z,l);Hy(w,Fe);break e}}w=w.return}while(w!==null)}e0(u)}catch(at){l=at,Dn===u&&u!==null&&(Dn=u=u.return);continue}break}while(!0)}function Xj(){var a=Zd.current;return Zd.current=Gd,a===null?Gd:a}function qh(){(qn===0||qn===3||qn===2)&&(qn=4),Wn===null||(Ei&268435455)===0&&(Xd&268435455)===0||Va(Wn,tr)}function su(a,l){var u=$t;$t|=2;var f=Xj();(Wn!==a||tr!==l)&&(ia=null,Ti(a,l));do try{UT();break}catch(y){Zj(a,y)}while(!0);if(th(),$t=u,Zd.current=f,Dn!==null)throw Error(r(261));return Wn=null,tr=0,qn}function UT(){for(;Dn!==null;)Jj(Dn)}function BT(){for(;Dn!==null&&!Xi();)Jj(Dn)}function Jj(a){var l=r0(a.alternate,a,Ur);a.memoizedProps=a.pendingProps,l===null?e0(a):Dn=l,Ih.current=null}function e0(a){var l=a;do{var u=l.alternate;if(a=l.return,(l.flags&32768)===0){if(u=DT(u,l,Ur),u!==null){Dn=u;return}}else{if(u=LT(u,l),u!==null){u.flags&=32767,Dn=u;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{qn=6,Dn=null;return}}if(l=l.sibling,l!==null){Dn=l;return}Dn=l=a}while(l!==null);qn===0&&(qn=5)}function Ri(a,l,u){var f=Zt,y=as.transition;try{as.transition=null,Zt=1,GT(a,l,u,f)}finally{as.transition=y,Zt=f}return null}function GT(a,l,u,f){do wo();while($a!==null);if(($t&6)!==0)throw Error(r(327));u=a.finishedWork;var y=a.finishedLanes;if(u===null)return null;if(a.finishedWork=null,a.finishedLanes=0,u===a.current)throw Error(r(177));a.callbackNode=null,a.callbackPriority=0;var w=u.lanes|u.childLanes;if(SP(a,w),a===Wn&&(Dn=Wn=null,tr=0),(u.subtreeFlags&2064)===0&&(u.flags&2064)===0||eu||(eu=!0,s0(Ji,function(){return wo(),null})),w=(u.flags&15990)!==0,(u.subtreeFlags&15990)!==0||w){w=as.transition,as.transition=null;var _=Zt;Zt=1;var Z=$t;$t|=4,Ih.current=null,$T(a,u),Bj(u,a),uT(qm),fd=!!Vm,qm=Vm=null,a.current=u,zT(u),qt(),$t=Z,Zt=_,as.transition=w}else a.current=u;if(eu&&(eu=!1,$a=a,tu=y),w=a.pendingLanes,w===0&&(Fa=null),Ft(u.stateNode),Tr(a,Yt()),l!==null)for(f=a.onRecoverableError,u=0;u<l.length;u++)y=l[u],f(y.value,{componentStack:y.stack,digest:y.digest});if(Jd)throw Jd=!1,a=Dh,Dh=null,a;return(tu&1)!==0&&a.tag!==0&&wo(),w=a.pendingLanes,(w&1)!==0?a===Lh?tc++:(tc=0,Lh=a):tc=0,Ma(),null}function wo(){if($a!==null){var a=qv(tu),l=as.transition,u=Zt;try{if(as.transition=null,Zt=16>a?16:a,$a===null)var f=!1;else{if(a=$a,$a=null,tu=0,($t&6)!==0)throw Error(r(331));var y=$t;for($t|=4,Xe=a.current;Xe!==null;){var w=Xe,_=w.child;if((Xe.flags&16)!==0){var Z=w.deletions;if(Z!==null){for(var ee=0;ee<Z.length;ee++){var fe=Z[ee];for(Xe=fe;Xe!==null;){var _e=Xe;switch(_e.tag){case 0:case 11:case 15:Xl(8,_e,w)}var Me=_e.child;if(Me!==null)Me.return=_e,Xe=Me;else for(;Xe!==null;){_e=Xe;var Te=_e.sibling,Ge=_e.return;if($j(_e),_e===fe){Xe=null;break}if(Te!==null){Te.return=Ge,Xe=Te;break}Xe=Ge}}}var Je=w.alternate;if(Je!==null){var nt=Je.child;if(nt!==null){Je.child=null;do{var _n=nt.sibling;nt.sibling=null,nt=_n}while(nt!==null)}}Xe=w}}if((w.subtreeFlags&2064)!==0&&_!==null)_.return=w,Xe=_;else e:for(;Xe!==null;){if(w=Xe,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:Xl(9,w,w.return)}var ue=w.sibling;if(ue!==null){ue.return=w.return,Xe=ue;break e}Xe=w.return}}var ne=a.current;for(Xe=ne;Xe!==null;){_=Xe;var pe=_.child;if((_.subtreeFlags&2064)!==0&&pe!==null)pe.return=_,Xe=pe;else e:for(_=ne;Xe!==null;){if(Z=Xe,(Z.flags&2048)!==0)try{switch(Z.tag){case 0:case 11:case 15:Yd(9,Z)}}catch(at){kn(Z,Z.return,at)}if(Z===_){Xe=null;break e}var Fe=Z.sibling;if(Fe!==null){Fe.return=Z.return,Xe=Fe;break e}Xe=Z.return}}if($t=y,Ma(),lt&&typeof lt.onPostCommitFiberRoot=="function")try{lt.onPostCommitFiberRoot(Ce,a)}catch{}f=!0}return f}finally{Zt=u,as.transition=l}}return!1}function t0(a,l,u){l=vo(u,l),l=yj(a,l,1),a=Da(a,l,1),l=jr(),a!==null&&(Sl(a,1,l),Tr(a,l))}function kn(a,l,u){if(a.tag===3)t0(a,a,u);else for(;l!==null;){if(l.tag===3){t0(l,a,u);break}else if(l.tag===1){var f=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Fa===null||!Fa.has(f))){a=vo(u,a),a=jj(l,a,1),l=Da(l,a,1),a=jr(),l!==null&&(Sl(l,1,a),Tr(l,a));break}}l=l.return}}function HT(a,l,u){var f=a.pingCache;f!==null&&f.delete(l),l=jr(),a.pingedLanes|=a.suspendedLanes&u,Wn===a&&(tr&u)===u&&(qn===4||qn===3&&(tr&130023424)===tr&&500>Yt()-Oh?Ti(a,0):Mh|=u),Tr(a,l)}function n0(a,l){l===0&&((a.mode&1)===0?l=1:(l=ud,ud<<=1,(ud&130023424)===0&&(ud=4194304)));var u=jr();a=ra(a,l),a!==null&&(Sl(a,l,u),Tr(a,u))}function KT(a){var l=a.memoizedState,u=0;l!==null&&(u=l.retryLane),n0(a,u)}function WT(a,l){var u=0;switch(a.tag){case 13:var f=a.stateNode,y=a.memoizedState;y!==null&&(u=y.retryLane);break;case 19:f=a.stateNode;break;default:throw Error(r(314))}f!==null&&f.delete(l),n0(a,u)}var r0;r0=function(a,l,u){if(a!==null)if(a.memoizedProps!==l.pendingProps||Sr.current)Er=!0;else{if((a.lanes&u)===0&&(l.flags&128)===0)return Er=!1,OT(a,l,u);Er=(a.flags&131072)!==0}else Er=!1,fn&&(l.flags&1048576)!==0&&Dy(l,Id,l.index);switch(l.lanes=0,l.tag){case 2:var f=l.type;Wd(a,l),a=l.pendingProps;var y=co(l,or.current);xo(l,u),y=ph(null,l,f,a,y,u);var w=mh();return l.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,kr(f)?(w=!0,Rd(l)):w=!1,l.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,ah(l),y.updater=Hd,l.stateNode=y,y._reactInternals=l,yh(l,f,a,u),l=Nh(null,l,f,!0,w,u)):(l.tag=0,fn&&w&&Qm(l),yr(null,l,y,u),l=l.child),l;case 16:f=l.elementType;e:{switch(Wd(a,l),a=l.pendingProps,y=f._init,f=y(f._payload),l.type=f,y=l.tag=YT(f),a=xs(f,a),y){case 0:l=wh(null,l,f,a,u);break e;case 1:l=Tj(null,l,f,a,u);break e;case 11:l=Cj(null,l,f,a,u);break e;case 14:l=Sj(null,l,f,xs(f.type,a),u);break e}throw Error(r(306,f,""))}return l;case 0:return f=l.type,y=l.pendingProps,y=l.elementType===f?y:xs(f,y),wh(a,l,f,y,u);case 1:return f=l.type,y=l.pendingProps,y=l.elementType===f?y:xs(f,y),Tj(a,l,f,y,u);case 3:e:{if(Rj(l),a===null)throw Error(r(387));f=l.pendingProps,w=l.memoizedState,y=w.element,Gy(a,l),$d(l,f,null,u);var _=l.memoizedState;if(f=_.element,w.isDehydrated)if(w={element:f,isDehydrated:!1,cache:_.cache,pendingSuspenseBoundaries:_.pendingSuspenseBoundaries,transitions:_.transitions},l.updateQueue.baseState=w,l.memoizedState=w,l.flags&256){y=vo(Error(r(423)),l),l=Aj(a,l,f,u,y);break e}else if(f!==y){y=vo(Error(r(424)),l),l=Aj(a,l,f,u,y);break e}else for(qr=Aa(l.stateNode.containerInfo.firstChild),Vr=l,fn=!0,fs=null,u=Uy(l,null,f,u),l.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(mo(),f===y){l=aa(a,l,u);break e}yr(a,l,f,u)}l=l.child}return l;case 5:return Wy(l),a===null&&Xm(l),f=l.type,y=l.pendingProps,w=a!==null?a.memoizedProps:null,_=y.children,Um(f,y)?_=null:w!==null&&Um(f,w)&&(l.flags|=32),Pj(a,l),yr(a,l,_,u),l.child;case 6:return a===null&&Xm(l),null;case 13:return _j(a,l,u);case 4:return ih(l,l.stateNode.containerInfo),f=l.pendingProps,a===null?l.child=ho(l,null,f,u):yr(a,l,f,u),l.child;case 11:return f=l.type,y=l.pendingProps,y=l.elementType===f?y:xs(f,y),Cj(a,l,f,y,u);case 7:return yr(a,l,l.pendingProps,u),l.child;case 8:return yr(a,l,l.pendingProps.children,u),l.child;case 12:return yr(a,l,l.pendingProps.children,u),l.child;case 10:e:{if(f=l.type._context,y=l.pendingProps,w=l.memoizedProps,_=y.value,rn(Dd,f._currentValue),f._currentValue=_,w!==null)if(hs(w.value,_)){if(w.children===y.children&&!Sr.current){l=aa(a,l,u);break e}}else for(w=l.child,w!==null&&(w.return=l);w!==null;){var Z=w.dependencies;if(Z!==null){_=w.child;for(var ee=Z.firstContext;ee!==null;){if(ee.context===f){if(w.tag===1){ee=sa(-1,u&-u),ee.tag=2;var fe=w.updateQueue;if(fe!==null){fe=fe.shared;var _e=fe.pending;_e===null?ee.next=ee:(ee.next=_e.next,_e.next=ee),fe.pending=ee}}w.lanes|=u,ee=w.alternate,ee!==null&&(ee.lanes|=u),rh(w.return,u,l),Z.lanes|=u;break}ee=ee.next}}else if(w.tag===10)_=w.type===l.type?null:w.child;else if(w.tag===18){if(_=w.return,_===null)throw Error(r(341));_.lanes|=u,Z=_.alternate,Z!==null&&(Z.lanes|=u),rh(_,u,l),_=w.sibling}else _=w.child;if(_!==null)_.return=w;else for(_=w;_!==null;){if(_===l){_=null;break}if(w=_.sibling,w!==null){w.return=_.return,_=w;break}_=_.return}w=_}yr(a,l,y.children,u),l=l.child}return l;case 9:return y=l.type,f=l.pendingProps.children,xo(l,u),y=rs(y),f=f(y),l.flags|=1,yr(a,l,f,u),l.child;case 14:return f=l.type,y=xs(f,l.pendingProps),y=xs(f.type,y),Sj(a,l,f,y,u);case 15:return kj(a,l,l.type,l.pendingProps,u);case 17:return f=l.type,y=l.pendingProps,y=l.elementType===f?y:xs(f,y),Wd(a,l),l.tag=1,kr(f)?(a=!0,Rd(l)):a=!1,xo(l,u),gj(l,f,y),yh(l,f,y,u),Nh(null,l,f,!0,a,u);case 19:return Mj(a,l,u);case 22:return Ej(a,l,u)}throw Error(r(156,l.tag))};function s0(a,l){return yi(a,l)}function QT(a,l,u,f){this.tag=a,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function is(a,l,u,f){return new QT(a,l,u,f)}function Uh(a){return a=a.prototype,!(!a||!a.isReactComponent)}function YT(a){if(typeof a=="function")return Uh(a)?1:0;if(a!=null){if(a=a.$$typeof,a===O)return 11;if(a===$)return 14}return 2}function qa(a,l){var u=a.alternate;return u===null?(u=is(a.tag,l,a.key,a.mode),u.elementType=a.elementType,u.type=a.type,u.stateNode=a.stateNode,u.alternate=a,a.alternate=u):(u.pendingProps=l,u.type=a.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=a.flags&14680064,u.childLanes=a.childLanes,u.lanes=a.lanes,u.child=a.child,u.memoizedProps=a.memoizedProps,u.memoizedState=a.memoizedState,u.updateQueue=a.updateQueue,l=a.dependencies,u.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},u.sibling=a.sibling,u.index=a.index,u.ref=a.ref,u}function au(a,l,u,f,y,w){var _=2;if(f=a,typeof a=="function")Uh(a)&&(_=1);else if(typeof a=="string")_=5;else e:switch(a){case W:return Ai(u.children,y,w,l);case X:_=8,y|=8;break;case se:return a=is(12,u,l,y|2),a.elementType=se,a.lanes=w,a;case F:return a=is(13,u,l,y),a.elementType=F,a.lanes=w,a;case U:return a=is(19,u,l,y),a.elementType=U,a.lanes=w,a;case le:return iu(u,y,w,l);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case V:_=10;break e;case G:_=9;break e;case O:_=11;break e;case $:_=14;break e;case q:_=16,f=null;break e}throw Error(r(130,a==null?a:typeof a,""))}return l=is(_,u,l,y),l.elementType=a,l.type=f,l.lanes=w,l}function Ai(a,l,u,f){return a=is(7,a,f,l),a.lanes=u,a}function iu(a,l,u,f){return a=is(22,a,f,l),a.elementType=le,a.lanes=u,a.stateNode={isHidden:!1},a}function Bh(a,l,u){return a=is(6,a,null,l),a.lanes=u,a}function Gh(a,l,u){return l=is(4,a.children!==null?a.children:[],a.key,l),l.lanes=u,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}function ZT(a,l,u,f,y){this.tag=l,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vm(0),this.expirationTimes=vm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vm(0),this.identifierPrefix=f,this.onRecoverableError=y,this.mutableSourceEagerHydrationData=null}function Hh(a,l,u,f,y,w,_,Z,ee){return a=new ZT(a,l,u,Z,ee),l===1?(l=1,w===!0&&(l|=8)):l=0,w=is(3,null,null,l),a.current=w,w.stateNode=a,w.memoizedState={element:f,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},ah(w),a}function XT(a,l,u){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:A,key:f==null?null:""+f,children:a,containerInfo:l,implementation:u}}function a0(a){if(!a)return Ia;a=a._reactInternals;e:{if(_s(a)!==a||a.tag!==1)throw Error(r(170));var l=a;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(kr(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(r(171))}if(a.tag===1){var u=a.type;if(kr(u))return Iy(a,u,l)}return l}function i0(a,l,u,f,y,w,_,Z,ee){return a=Hh(u,f,!0,a,y,w,_,Z,ee),a.context=a0(null),u=a.current,f=jr(),y=za(u),w=sa(f,y),w.callback=l??null,Da(u,w,y),a.current.lanes=y,Sl(a,y,f),Tr(a,f),a}function ou(a,l,u,f){var y=l.current,w=jr(),_=za(y);return u=a0(u),l.context===null?l.context=u:l.pendingContext=u,l=sa(w,_),l.payload={element:a},f=f===void 0?null:f,f!==null&&(l.callback=f),a=Da(y,l,_),a!==null&&(ys(a,y,_,w),Fd(a,y,_)),_}function lu(a){return a=a.current,a.child?(a.child.tag===5,a.child.stateNode):null}function o0(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var u=a.retryLane;a.retryLane=u!==0&&u<l?u:l}}function Kh(a,l){o0(a,l),(a=a.alternate)&&o0(a,l)}function JT(){return null}var l0=typeof reportError=="function"?reportError:function(a){console.error(a)};function Wh(a){this._internalRoot=a}cu.prototype.render=Wh.prototype.render=function(a){var l=this._internalRoot;if(l===null)throw Error(r(409));ou(a,l,null,null)},cu.prototype.unmount=Wh.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var l=a.containerInfo;Pi(function(){ou(null,a,null,null)}),l[Js]=null}};function cu(a){this._internalRoot=a}cu.prototype.unstable_scheduleHydration=function(a){if(a){var l=Gv();a={blockedOn:null,target:a,priority:l};for(var u=0;u<Pa.length&&l!==0&&l<Pa[u].priority;u++);Pa.splice(u,0,a),u===0&&Wv(a)}};function Qh(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function du(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function c0(){}function e4(a,l,u,f,y){if(y){if(typeof f=="function"){var w=f;f=function(){var fe=lu(_);w.call(fe)}}var _=i0(l,f,a,0,null,!1,!1,"",c0);return a._reactRootContainer=_,a[Js]=_.current,$l(a.nodeType===8?a.parentNode:a),Pi(),_}for(;y=a.lastChild;)a.removeChild(y);if(typeof f=="function"){var Z=f;f=function(){var fe=lu(ee);Z.call(fe)}}var ee=Hh(a,0,!1,null,null,!1,!1,"",c0);return a._reactRootContainer=ee,a[Js]=ee.current,$l(a.nodeType===8?a.parentNode:a),Pi(function(){ou(l,ee,u,f)}),ee}function uu(a,l,u,f,y){var w=u._reactRootContainer;if(w){var _=w;if(typeof y=="function"){var Z=y;y=function(){var ee=lu(_);Z.call(ee)}}ou(l,_,a,y)}else _=e4(u,l,a,y,f);return lu(_)}Uv=function(a){switch(a.tag){case 3:var l=a.stateNode;if(l.current.memoizedState.isDehydrated){var u=Cl(l.pendingLanes);u!==0&&(ym(l,u|1),Tr(l,Yt()),($t&6)===0&&(bo=Yt()+500,Ma()))}break;case 13:Pi(function(){var f=ra(a,1);if(f!==null){var y=jr();ys(f,a,1,y)}}),Kh(a,1)}},jm=function(a){if(a.tag===13){var l=ra(a,134217728);if(l!==null){var u=jr();ys(l,a,134217728,u)}Kh(a,134217728)}},Bv=function(a){if(a.tag===13){var l=za(a),u=ra(a,l);if(u!==null){var f=jr();ys(u,a,l,f)}Kh(a,l)}},Gv=function(){return Zt},Hv=function(a,l){var u=Zt;try{return Zt=a,l()}finally{Zt=u}},Ts=function(a,l,u){switch(l){case"input":if(ht(a,u),l=u.name,u.type==="radio"&&l!=null){for(u=a;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<u.length;l++){var f=u[l];if(f!==a&&f.form===a.form){var y=Pd(f);if(!y)throw Error(r(90));ve(f),ht(f,y)}}}break;case"textarea":ge(a,u);break;case"select":l=u.value,l!=null&&tt(a,!!u.multiple,l,!1)}},Ee=zh,H=Pi;var t4={usingClientEntryPoint:!1,Events:[ql,oo,Pd,Rs,te,zh]},nc={findFiberByHostInstance:ji,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},n4={bundleType:nc.bundleType,version:nc.version,rendererPackageName:nc.rendererPackageName,rendererConfig:nc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:R.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=wl(a),a===null?null:a.stateNode},findFiberByHostInstance:nc.findFiberByHostInstance||JT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var pu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!pu.isDisabled&&pu.supportsFiber)try{Ce=pu.inject(n4),lt=pu}catch{}}return Rr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=t4,Rr.createPortal=function(a,l){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Qh(l))throw Error(r(200));return XT(a,l,null,u)},Rr.createRoot=function(a,l){if(!Qh(a))throw Error(r(299));var u=!1,f="",y=l0;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onRecoverableError!==void 0&&(y=l.onRecoverableError)),l=Hh(a,1,!1,null,null,u,!1,f,y),a[Js]=l.current,$l(a.nodeType===8?a.parentNode:a),new Wh(l)},Rr.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(r(188)):(a=Object.keys(a).join(","),Error(r(268,a)));return a=wl(l),a=a===null?null:a.stateNode,a},Rr.flushSync=function(a){return Pi(a)},Rr.hydrate=function(a,l,u){if(!du(l))throw Error(r(200));return uu(null,a,l,!0,u)},Rr.hydrateRoot=function(a,l,u){if(!Qh(a))throw Error(r(405));var f=u!=null&&u.hydratedSources||null,y=!1,w="",_=l0;if(u!=null&&(u.unstable_strictMode===!0&&(y=!0),u.identifierPrefix!==void 0&&(w=u.identifierPrefix),u.onRecoverableError!==void 0&&(_=u.onRecoverableError)),l=i0(l,null,a,1,u??null,y,!1,w,_),a[Js]=l.current,$l(a),f)for(a=0;a<f.length;a++)u=f[a],y=u._getVersion,y=y(u._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[u,y]:l.mutableSourceEagerHydrationData.push(u,y);return new cu(l)},Rr.render=function(a,l,u){if(!du(l))throw Error(r(200));return uu(null,a,l,!1,u)},Rr.unmountComponentAtNode=function(a){if(!du(a))throw Error(r(40));return a._reactRootContainer?(Pi(function(){uu(null,null,a,!1,function(){a._reactRootContainer=null,a[Js]=null})}),!0):!1},Rr.unstable_batchedUpdates=zh,Rr.unstable_renderSubtreeIntoContainer=function(a,l,u,f){if(!du(u))throw Error(r(200));if(a==null||a._reactInternals===void 0)throw Error(r(38));return uu(a,l,u,!1,f)},Rr.version="18.3.1-next-f1338f8080-20240426",Rr}var g0;function Jw(){if(g0)return Xh.exports;g0=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(n){console.error(n)}}return t(),Xh.exports=d4(),Xh.exports}var v0;function u4(){if(v0)return mu;v0=1;var t=Jw();return mu.createRoot=t.createRoot,mu.hydrateRoot=t.hydrateRoot,mu}var p4=u4(),x=bp();const ut=jp(x),eg=s4({__proto__:null,default:ut},[x]);function m4(t,n){if(t instanceof RegExp)return{keys:!1,pattern:t};var r,s,i,o,c=[],d="",p=t.split("/");for(p[0]||p.shift();i=p.shift();)r=i[0],r==="*"?(c.push(r),d+=i[1]==="?"?"(?:/(.*))?":"/(.*)"):r===":"?(s=i.indexOf("?",1),o=i.indexOf(".",1),c.push(i.substring(1,~s?s:~o?o:i.length)),d+=~s&&!~o?"(?:/([^/]+?))?":"/([^/]+?)",~o&&(d+=(~s?"?":"")+"\\"+i.substring(o))):d+="/"+i;return{keys:c,pattern:new RegExp("^"+d+(n?"(?=$|/)":"/?$"),"i")}}var tf={exports:{}},nf={};var y0;function h4(){if(y0)return nf;y0=1;var t=bp();function n(g,v){return g===v&&(g!==0||1/g===1/v)||g!==g&&v!==v}var r=typeof Object.is=="function"?Object.is:n,s=t.useState,i=t.useEffect,o=t.useLayoutEffect,c=t.useDebugValue;function d(g,v){var j=v(),N=s({inst:{value:j,getSnapshot:v}}),b=N[0].inst,C=N[1];return o(function(){b.value=j,b.getSnapshot=v,p(b)&&C({inst:b})},[g,j,v]),i(function(){return p(b)&&C({inst:b}),g(function(){p(b)&&C({inst:b})})},[g]),c(j),j}function p(g){var v=g.getSnapshot;g=g.value;try{var j=v();return!r(g,j)}catch{return!0}}function m(g,v){return v()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?m:d;return nf.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:h,nf}var j0;function f4(){return j0||(j0=1,tf.exports=h4()),tf.exports}var x4=f4();const g4=eg.useInsertionEffect,v4=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",y4=v4?x.useLayoutEffect:x.useEffect,j4=g4||y4,eN=t=>{const n=x.useRef([t,(...r)=>n[0](...r)]).current;return j4(()=>{n[0]=t}),n[1]},b4="popstate",tg="pushState",ng="replaceState",w4="hashchange",b0=[b4,tg,ng,w4],N4=t=>{for(const n of b0)addEventListener(n,t);return()=>{for(const n of b0)removeEventListener(n,t)}},tN=(t,n)=>x4.useSyncExternalStore(N4,t,n),C4=()=>location.search,S4=({ssrSearch:t=""}={})=>tN(C4,()=>t),w0=()=>location.pathname,k4=({ssrPath:t}={})=>tN(w0,t?()=>t:w0),E4=(t,{replace:n=!1,state:r=null}={})=>history[n?ng:tg](r,"",t),P4=(t={})=>[k4(t),E4],N0=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[N0]>"u"){for(const t of[tg,ng]){const n=history[t];history[t]=function(){const r=n.apply(this,arguments),s=new Event(t);return s.arguments=arguments,dispatchEvent(s),r}}Object.defineProperty(window,N0,{value:!0})}const T4=(t,n)=>n.toLowerCase().indexOf(t.toLowerCase())?"~"+n:n.slice(t.length)||"/",nN=(t="")=>t==="/"?"":t,R4=(t,n)=>t[0]==="~"?t.slice(1):nN(n)+t,A4=(t="",n)=>T4(C0(nN(t)),C0(n)),C0=t=>{try{return decodeURI(t)}catch{return t}},rN={hook:P4,searchHook:S4,parser:m4,base:"",ssrPath:void 0,ssrSearch:void 0,hrefs:t=>t},sN=x.createContext(rN),Uc=()=>x.useContext(sN),aN={},iN=x.createContext(aN),_4=()=>x.useContext(iN),wp=t=>{const[n,r]=t.hook(t);return[A4(t.base,n),eN((s,i)=>r(R4(s,t.base),i))]},ol=()=>wp(Uc()),oN=(t,n,r,s)=>{const{pattern:i,keys:o}=n instanceof RegExp?{keys:!1,pattern:n}:t(n||"*",s),c=i.exec(r)||[],[d,...p]=c;return d!==void 0?[!0,(()=>{const m=o!==!1?Object.fromEntries(o.map((g,v)=>[g,p[v]])):c.groups;let h={...p};return m&&Object.assign(h,m),h})(),...s?[d]:[]]:[!1,null]},I4=({children:t,...n})=>{const r=Uc(),s=n.hook?rN:r;let i=s;const[o,c]=n.ssrPath?.split("?")??[];c&&(n.ssrSearch=c,n.ssrPath=o),n.hrefs=n.hrefs??n.hook?.hrefs;let d=x.useRef({}),p=d.current,m=p;for(let h in s){const g=h==="base"?s[h]+(n[h]||""):n[h]||s[h];p===m&&g!==m[h]&&(d.current=m={...m}),m[h]=g,g!==s[h]&&(i=m)}return x.createElement(sN.Provider,{value:i,children:t})},S0=({children:t,component:n},r)=>n?x.createElement(n,{params:r}):typeof t=="function"?t(r):t,M4=t=>{let n=x.useRef(aN),r=n.current;for(const s in t)t[s]!==r[s]&&(r=t);return Object.keys(t).length===0&&(r=t),n.current=r},En=({path:t,nest:n,match:r,...s})=>{const i=Uc(),[o]=wp(i),[c,d,p]=r??oN(i.parser,t,o,n),m=M4({..._4(),...d});if(!c)return null;const h=p?x.createElement(I4,{base:p},S0(s,m)):S0(s,m);return x.createElement(iN.Provider,{value:m,children:h})},Ja=x.forwardRef((t,n)=>{const r=Uc(),[s,i]=wp(r),{to:o="",href:c=o,onClick:d,asChild:p,children:m,className:h,replace:g,state:v,...j}=t,N=eN(C=>{C.ctrlKey||C.metaKey||C.altKey||C.shiftKey||C.button!==0||(d?.(C),C.defaultPrevented||(C.preventDefault(),i(c,t)))}),b=r.hrefs(c[0]==="~"?c.slice(1):r.base+c,r);return p&&x.isValidElement(m)?x.cloneElement(m,{onClick:N,href:b}):x.createElement("a",{...j,onClick:N,href:b,className:h?.call?h(s===c):h,children:m,ref:n})}),lN=t=>Array.isArray(t)?t.flatMap(n=>lN(n&&n.type===x.Fragment?n.props.children:n)):[t],O4=({children:t,location:n})=>{const r=Uc(),[s]=wp(r);for(const i of lN(t)){let o=0;if(x.isValidElement(i)&&(o=oN(r.parser,i.props.path,n||s,i.props.nest))[0])return x.cloneElement(i,{match:o})}return null};var ll=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Oi=typeof window>"u"||"Deno"in globalThis;function ls(){}function D4(t,n){return typeof t=="function"?t(n):t}function Zf(t){return typeof t=="number"&&t>=0&&t!==1/0}function cN(t,n){return Math.max(t+(n||0)-Date.now(),0)}function Do(t,n){return typeof t=="function"?t(n):t}function ws(t,n){return typeof t=="function"?t(n):t}function k0(t,n){const{type:r="all",exact:s,fetchStatus:i,predicate:o,queryKey:c,stale:d}=t;if(c){if(s){if(n.queryHash!==rg(c,n.options))return!1}else if(!Sc(n.queryKey,c))return!1}if(r!=="all"){const p=n.isActive();if(r==="active"&&!p||r==="inactive"&&p)return!1}return!(typeof d=="boolean"&&n.isStale()!==d||i&&i!==n.state.fetchStatus||o&&!o(n))}function E0(t,n){const{exact:r,status:s,predicate:i,mutationKey:o}=t;if(o){if(!n.options.mutationKey)return!1;if(r){if(Di(n.options.mutationKey)!==Di(o))return!1}else if(!Sc(n.options.mutationKey,o))return!1}return!(s&&n.state.status!==s||i&&!i(n))}function rg(t,n){return(n?.queryKeyHashFn||Di)(t)}function Di(t){return JSON.stringify(t,(n,r)=>Xf(r)?Object.keys(r).sort().reduce((s,i)=>(s[i]=r[i],s),{}):r)}function Sc(t,n){return t===n?!0:typeof t!=typeof n?!1:t&&n&&typeof t=="object"&&typeof n=="object"?!Object.keys(n).some(r=>!Sc(t[r],n[r])):!1}function dN(t,n){if(t===n)return t;const r=P0(t)&&P0(n);if(r||Xf(t)&&Xf(n)){const s=r?t:Object.keys(t),i=s.length,o=r?n:Object.keys(n),c=o.length,d=r?[]:{};let p=0;for(let m=0;m<c;m++){const h=r?m:o[m];(!r&&s.includes(h)||r)&&t[h]===void 0&&n[h]===void 0?(d[h]=void 0,p++):(d[h]=dN(t[h],n[h]),d[h]===t[h]&&t[h]!==void 0&&p++)}return i===c&&p===i?t:d}return n}function $u(t,n){if(!n||Object.keys(t).length!==Object.keys(n).length)return!1;for(const r in t)if(t[r]!==n[r])return!1;return!0}function P0(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Xf(t){if(!T0(t))return!1;const n=t.constructor;if(n===void 0)return!0;const r=n.prototype;return!(!T0(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function T0(t){return Object.prototype.toString.call(t)==="[object Object]"}function L4(t){return new Promise(n=>{setTimeout(n,t)})}function Jf(t,n,r){return typeof r.structuralSharing=="function"?r.structuralSharing(t,n):r.structuralSharing!==!1?dN(t,n):n}function F4(t,n,r=0){const s=[...t,n];return r&&s.length>r?s.slice(1):s}function $4(t,n,r=0){const s=[n,...t];return r&&s.length>r?s.slice(0,-1):s}var sg=Symbol();function uN(t,n){return!t.queryFn&&n?.initialPromise?()=>n.initialPromise:!t.queryFn||t.queryFn===sg?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var z4=class extends ll{#e;#t;#r;constructor(){super(),this.#r=t=>{if(!Oi&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#r=t,this.#t?.(),this.#t=t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},ag=new z4,V4=class extends ll{#e=!0;#t;#r;constructor(){super(),this.#r=t=>{if(!Oi&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#r=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(r=>{r(t)}))}isOnline(){return this.#e}},zu=new V4;function ex(){let t,n;const r=new Promise((i,o)=>{t=i,n=o});r.status="pending",r.catch(()=>{});function s(i){Object.assign(r,i),delete r.resolve,delete r.reject}return r.resolve=i=>{s({status:"fulfilled",value:i}),t(i)},r.reject=i=>{s({status:"rejected",reason:i}),n(i)},r}function q4(t){return Math.min(1e3*2**t,3e4)}function pN(t){return(t??"online")==="online"?zu.isOnline():!0}var mN=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function rf(t){return t instanceof mN}function hN(t){let n=!1,r=0,s=!1,i;const o=ex(),c=b=>{s||(v(new mN(b)),t.abort?.())},d=()=>{n=!0},p=()=>{n=!1},m=()=>ag.isFocused()&&(t.networkMode==="always"||zu.isOnline())&&t.canRun(),h=()=>pN(t.networkMode)&&t.canRun(),g=b=>{s||(s=!0,t.onSuccess?.(b),i?.(),o.resolve(b))},v=b=>{s||(s=!0,t.onError?.(b),i?.(),o.reject(b))},j=()=>new Promise(b=>{i=C=>{(s||m())&&b(C)},t.onPause?.()}).then(()=>{i=void 0,s||t.onContinue?.()}),N=()=>{if(s)return;let b;const C=r===0?t.initialPromise:void 0;try{b=C??t.fn()}catch(S){b=Promise.reject(S)}Promise.resolve(b).then(g).catch(S=>{if(s)return;const k=t.retry??(Oi?0:3),P=t.retryDelay??q4,R=typeof P=="function"?P(r,S):P,E=k===!0||typeof k=="number"&&r<k||typeof k=="function"&&k(r,S);if(n||!E){v(S);return}r++,t.onFail?.(r,S),L4(R).then(()=>m()?void 0:j()).then(()=>{n?v(S):N()})})};return{promise:o,cancel:c,continue:()=>(i?.(),o),cancelRetry:d,continueRetry:p,canStart:h,start:()=>(h()?N():j().then(N),o)}}function U4(){let t=[],n=0,r=d=>{d()},s=d=>{d()},i=d=>setTimeout(d,0);const o=d=>{n?t.push(d):i(()=>{r(d)})},c=()=>{const d=t;t=[],d.length&&i(()=>{s(()=>{d.forEach(p=>{r(p)})})})};return{batch:d=>{let p;n++;try{p=d()}finally{n--,n||c()}return p},batchCalls:d=>(...p)=>{o(()=>{d(...p)})},schedule:o,setNotifyFunction:d=>{r=d},setBatchNotifyFunction:d=>{s=d},setScheduler:d=>{i=d}}}var Bn=U4(),fN=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Zf(this.gcTime)&&(this.#e=setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Oi?1/0:300*1e3))}clearGcTimeout(){this.#e&&(clearTimeout(this.#e),this.#e=void 0)}},B4=class extends fN{#e;#t;#r;#n;#i;#a;constructor(t){super(),this.#a=!1,this.#i=t.defaultOptions,this.setOptions(t.options),this.observers=[],this.#r=t.cache,this.queryKey=t.queryKey,this.queryHash=t.queryHash,this.#e=G4(this.options),this.state=t.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#n?.promise}setOptions(t){this.options={...this.#i,...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#r.remove(this)}setData(t,n){const r=Jf(this.state.data,t,this.options);return this.#s({data:r,type:"success",dataUpdatedAt:n?.updatedAt,manual:n?.manual}),r}setState(t,n){this.#s({type:"setState",state:t,setStateOptions:n})}cancel(t){const n=this.#n?.promise;return this.#n?.cancel(t),n?n.then(ls).catch(ls):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(t=>ws(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===sg||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!cN(this.state.dataUpdatedAt,t)}onFocus(){this.observers.find(n=>n.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#n?.continue()}onOnline(){this.observers.find(n=>n.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#n?.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),this.#r.notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(this.#n&&(this.#a?this.#n.cancel({revert:!0}):this.#n.cancelRetry()),this.scheduleGc()),this.#r.notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#s({type:"invalidate"})}fetch(t,n){if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&n?.cancelRefetch)this.cancel({silent:!0});else if(this.#n)return this.#n.continueRetry(),this.#n.promise}if(t&&this.setOptions(t),!this.options.queryFn){const d=this.observers.find(p=>p.options.queryFn);d&&this.setOptions(d.options)}const r=new AbortController,s=d=>{Object.defineProperty(d,"signal",{enumerable:!0,get:()=>(this.#a=!0,r.signal)})},i=()=>{const d=uN(this.options,n),p={queryKey:this.queryKey,meta:this.meta};return s(p),this.#a=!1,this.options.persister?this.options.persister(d,p,this):d(p)},o={fetchOptions:n,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:i};s(o),this.options.behavior?.onFetch(o,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==o.fetchOptions?.meta)&&this.#s({type:"fetch",meta:o.fetchOptions?.meta});const c=d=>{rf(d)&&d.silent||this.#s({type:"error",error:d}),rf(d)||(this.#r.config.onError?.(d,this),this.#r.config.onSettled?.(this.state.data,d,this)),this.scheduleGc()};return this.#n=hN({initialPromise:n?.initialPromise,fn:o.fetchFn,abort:r.abort.bind(r),onSuccess:d=>{if(d===void 0){c(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(d)}catch(p){c(p);return}this.#r.config.onSuccess?.(d,this),this.#r.config.onSettled?.(d,this.state.error,this),this.scheduleGc()},onError:c,onFail:(d,p)=>{this.#s({type:"failed",failureCount:d,error:p})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}),this.#n.start()}#s(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...xN(r.data,this.options),fetchMeta:t.meta??null};case"success":return{...r,data:t.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=t.error;return rf(s)&&s.revert&&this.#t?{...this.#t,fetchStatus:"idle"}:{...r,error:s,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),Bn.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),this.#r.notify({query:this,type:"updated",action:t})})}};function xN(t,n){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:pN(n.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function G4(t){const n=typeof t.initialData=="function"?t.initialData():t.initialData,r=n!==void 0,s=r?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:n,dataUpdateCount:0,dataUpdatedAt:r?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var H4=class extends ll{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,n,r){const s=n.queryKey,i=n.queryHash??rg(s,n);let o=this.get(i);return o||(o=new B4({cache:this,queryKey:s,queryHash:i,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(s)}),this.add(o)),o}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=this.#e.get(t.queryHash);n&&(t.destroy(),n===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Bn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>k0(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>k0(t,r)):n}notify(t){Bn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){Bn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Bn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},K4=class extends fN{#e;#t;#r;constructor(t){super(),this.mutationId=t.mutationId,this.#t=t.mutationCache,this.#e=[],this.state=t.state||gN(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#e.includes(t)||(this.#e.push(t),this.clearGcTimeout(),this.#t.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#e=this.#e.filter(n=>n!==t),this.scheduleGc(),this.#t.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#e.length||(this.state.status==="pending"?this.scheduleGc():this.#t.remove(this))}continue(){return this.#r?.continue()??this.execute(this.state.variables)}async execute(t){this.#r=hN({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(s,i)=>{this.#n({type:"failed",failureCount:s,error:i})},onPause:()=>{this.#n({type:"pause"})},onContinue:()=>{this.#n({type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#t.canRun(this)});const n=this.state.status==="pending",r=!this.#r.canStart();try{if(!n){this.#n({type:"pending",variables:t,isPaused:r}),await this.#t.config.onMutate?.(t,this);const i=await this.options.onMutate?.(t);i!==this.state.context&&this.#n({type:"pending",context:i,variables:t,isPaused:r})}const s=await this.#r.start();return await this.#t.config.onSuccess?.(s,t,this.state.context,this),await this.options.onSuccess?.(s,t,this.state.context),await this.#t.config.onSettled?.(s,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(s,null,t,this.state.context),this.#n({type:"success",data:s}),s}catch(s){try{throw await this.#t.config.onError?.(s,t,this.state.context,this),await this.options.onError?.(s,t,this.state.context),await this.#t.config.onSettled?.(void 0,s,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,s,t,this.state.context),s}finally{this.#n({type:"error",error:s})}}finally{this.#t.runNext(this)}}#n(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Bn.batch(()=>{this.#e.forEach(r=>{r.onMutationUpdate(t)}),this.#t.notify({mutation:this,type:"updated",action:t})})}};function gN(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var W4=class extends ll{constructor(t={}){super(),this.config=t,this.#e=new Map,this.#t=Date.now()}#e;#t;build(t,n,r){const s=new K4({mutationCache:this,mutationId:++this.#t,options:t.defaultMutationOptions(n),state:r});return this.add(s),s}add(t){const n=hu(t),r=this.#e.get(n)??[];r.push(t),this.#e.set(n,r),this.notify({type:"added",mutation:t})}remove(t){const n=hu(t);if(this.#e.has(n)){const r=this.#e.get(n)?.filter(s=>s!==t);r&&(r.length===0?this.#e.delete(n):this.#e.set(n,r))}this.notify({type:"removed",mutation:t})}canRun(t){const n=this.#e.get(hu(t))?.find(r=>r.state.status==="pending");return!n||n===t}runNext(t){return this.#e.get(hu(t))?.find(r=>r!==t&&r.state.isPaused)?.continue()??Promise.resolve()}clear(){Bn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}getAll(){return[...this.#e.values()].flat()}find(t){const n={exact:!0,...t};return this.getAll().find(r=>E0(n,r))}findAll(t={}){return this.getAll().filter(n=>E0(t,n))}notify(t){Bn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return Bn.batch(()=>Promise.all(t.map(n=>n.continue().catch(ls))))}};function hu(t){return t.options.scope?.id??String(t.mutationId)}function R0(t){return{onFetch:(n,r)=>{const s=n.options,i=n.fetchOptions?.meta?.fetchMore?.direction,o=n.state.data?.pages||[],c=n.state.data?.pageParams||[];let d={pages:[],pageParams:[]},p=0;const m=async()=>{let h=!1;const g=N=>{Object.defineProperty(N,"signal",{enumerable:!0,get:()=>(n.signal.aborted?h=!0:n.signal.addEventListener("abort",()=>{h=!0}),n.signal)})},v=uN(n.options,n.fetchOptions),j=async(N,b,C)=>{if(h)return Promise.reject();if(b==null&&N.pages.length)return Promise.resolve(N);const S={queryKey:n.queryKey,pageParam:b,direction:C?"backward":"forward",meta:n.options.meta};g(S);const k=await v(S),{maxPages:P}=n.options,R=C?$4:F4;return{pages:R(N.pages,k,P),pageParams:R(N.pageParams,b,P)}};if(i&&o.length){const N=i==="backward",b=N?Q4:A0,C={pages:o,pageParams:c},S=b(s,C);d=await j(C,S,N)}else{const N=t??o.length;do{const b=p===0?c[0]??s.initialPageParam:A0(s,d);if(p>0&&b==null)break;d=await j(d,b),p++}while(p<N)}return d};n.options.persister?n.fetchFn=()=>n.options.persister?.(m,{queryKey:n.queryKey,meta:n.options.meta,signal:n.signal},r):n.fetchFn=m}}}function A0(t,{pages:n,pageParams:r}){const s=n.length-1;return n.length>0?t.getNextPageParam(n[s],n,r[s],r):void 0}function Q4(t,{pages:n,pageParams:r}){return n.length>0?t.getPreviousPageParam?.(n[0],n,r[0],r):void 0}var Y4=class{#e;#t;#r;#n;#i;#a;#s;#o;constructor(t={}){this.#e=t.queryCache||new H4,this.#t=t.mutationCache||new W4,this.#r=t.defaultOptions||{},this.#n=new Map,this.#i=new Map,this.#a=0}mount(){this.#a++,this.#a===1&&(this.#s=ag.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#o=zu.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#a--,this.#a===0&&(this.#s?.(),this.#s=void 0,this.#o?.(),this.#o=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const n=this.defaultQueryOptions({queryKey:t});return this.#e.get(n.queryHash)?.state.data}ensureQueryData(t){const n=this.getQueryData(t.queryKey);if(n===void 0)return this.fetchQuery(t);{const r=this.defaultQueryOptions(t),s=this.#e.build(this,r);return t.revalidateIfStale&&s.isStaleByTime(Do(r.staleTime,s))&&this.prefetchQuery(r),Promise.resolve(n)}}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:n,state:r})=>{const s=r.data;return[n,s]})}setQueryData(t,n,r){const s=this.defaultQueryOptions({queryKey:t}),o=this.#e.get(s.queryHash)?.state.data,c=D4(n,o);if(c!==void 0)return this.#e.build(this,s).setData(c,{...r,manual:!0})}setQueriesData(t,n,r){return Bn.batch(()=>this.#e.findAll(t).map(({queryKey:s})=>[s,this.setQueryData(s,n,r)]))}getQueryState(t){const n=this.defaultQueryOptions({queryKey:t});return this.#e.get(n.queryHash)?.state}removeQueries(t){const n=this.#e;Bn.batch(()=>{n.findAll(t).forEach(r=>{n.remove(r)})})}resetQueries(t,n){const r=this.#e,s={type:"active",...t};return Bn.batch(()=>(r.findAll(t).forEach(i=>{i.reset()}),this.refetchQueries(s,n)))}cancelQueries(t={},n={}){const r={revert:!0,...n},s=Bn.batch(()=>this.#e.findAll(t).map(i=>i.cancel(r)));return Promise.all(s).then(ls).catch(ls)}invalidateQueries(t={},n={}){return Bn.batch(()=>{if(this.#e.findAll(t).forEach(s=>{s.invalidate()}),t.refetchType==="none")return Promise.resolve();const r={...t,type:t.refetchType??t.type??"active"};return this.refetchQueries(r,n)})}refetchQueries(t={},n){const r={...n,cancelRefetch:n?.cancelRefetch??!0},s=Bn.batch(()=>this.#e.findAll(t).filter(i=>!i.isDisabled()).map(i=>{let o=i.fetch(void 0,r);return r.throwOnError||(o=o.catch(ls)),i.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(s).then(ls)}fetchQuery(t){const n=this.defaultQueryOptions(t);n.retry===void 0&&(n.retry=!1);const r=this.#e.build(this,n);return r.isStaleByTime(Do(n.staleTime,r))?r.fetch(n):Promise.resolve(r.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(ls).catch(ls)}fetchInfiniteQuery(t){return t.behavior=R0(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(ls).catch(ls)}ensureInfiniteQueryData(t){return t.behavior=R0(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return zu.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#r}setDefaultOptions(t){this.#r=t}setQueryDefaults(t,n){this.#n.set(Di(t),{queryKey:t,defaultOptions:n})}getQueryDefaults(t){const n=[...this.#n.values()];let r={};return n.forEach(s=>{Sc(t,s.queryKey)&&(r={...r,...s.defaultOptions})}),r}setMutationDefaults(t,n){this.#i.set(Di(t),{mutationKey:t,defaultOptions:n})}getMutationDefaults(t){const n=[...this.#i.values()];let r={};return n.forEach(s=>{Sc(t,s.mutationKey)&&(r={...r,...s.defaultOptions})}),r}defaultQueryOptions(t){if(t._defaulted)return t;const n={...this.#r.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return n.queryHash||(n.queryHash=rg(n.queryKey,n)),n.refetchOnReconnect===void 0&&(n.refetchOnReconnect=n.networkMode!=="always"),n.throwOnError===void 0&&(n.throwOnError=!!n.suspense),!n.networkMode&&n.persister&&(n.networkMode="offlineFirst"),n.enabled!==!0&&n.queryFn===sg&&(n.enabled=!1),n}defaultMutationOptions(t){return t?._defaulted?t:{...this.#r.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},Z4=class extends ll{constructor(t,n){super(),this.options=n,this.#e=t,this.#o=null,this.#s=ex(),this.options.experimental_prefetchInRender||this.#s.reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}#e;#t=void 0;#r=void 0;#n=void 0;#i;#a;#s;#o;#f;#p;#m;#c;#d;#l;#h=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),_0(this.#t,this.options)?this.#u():this.updateResult(),this.#y())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return tx(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return tx(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#j(),this.#b(),this.#t.removeObserver(this)}setOptions(t,n){const r=this.options,s=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof ws(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#w(),this.#t.setOptions(this.options),r._defaulted&&!$u(this.options,r)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const i=this.hasListeners();i&&I0(this.#t,s,this.options,r)&&this.#u(),this.updateResult(n),i&&(this.#t!==s||ws(this.options.enabled,this.#t)!==ws(r.enabled,this.#t)||Do(this.options.staleTime,this.#t)!==Do(r.staleTime,this.#t))&&this.#x();const o=this.#g();i&&(this.#t!==s||ws(this.options.enabled,this.#t)!==ws(r.enabled,this.#t)||o!==this.#l)&&this.#v(o)}getOptimisticResult(t){const n=this.#e.getQueryCache().build(this.#e,t),r=this.createResult(n,t);return J4(this,r)&&(this.#n=r,this.#a=this.options,this.#i=this.#t.state),r}getCurrentResult(){return this.#n}trackResult(t,n){const r={};return Object.keys(t).forEach(s=>{Object.defineProperty(r,s,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(s),n?.(s),t[s])})}),r}trackProp(t){this.#h.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=this.#e.defaultQueryOptions(t),r=this.#e.getQueryCache().build(this.#e,n);return r.fetch().then(()=>this.createResult(r,n))}fetch(t){return this.#u({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#n))}#u(t){this.#w();let n=this.#t.fetch(this.options,t);return t?.throwOnError||(n=n.catch(ls)),n}#x(){this.#j();const t=Do(this.options.staleTime,this.#t);if(Oi||this.#n.isStale||!Zf(t))return;const r=cN(this.#n.dataUpdatedAt,t)+1;this.#c=setTimeout(()=>{this.#n.isStale||this.updateResult()},r)}#g(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#v(t){this.#b(),this.#l=t,!(Oi||ws(this.options.enabled,this.#t)===!1||!Zf(this.#l)||this.#l===0)&&(this.#d=setInterval(()=>{(this.options.refetchIntervalInBackground||ag.isFocused())&&this.#u()},this.#l))}#y(){this.#x(),this.#v(this.#g())}#j(){this.#c&&(clearTimeout(this.#c),this.#c=void 0)}#b(){this.#d&&(clearInterval(this.#d),this.#d=void 0)}createResult(t,n){const r=this.#t,s=this.options,i=this.#n,o=this.#i,c=this.#a,p=t!==r?t.state:this.#r,{state:m}=t;let h={...m},g=!1,v;if(n._optimisticResults){const W=this.hasListeners(),X=!W&&_0(t,n),se=W&&I0(t,r,n,s);(X||se)&&(h={...h,...xN(m.data,t.options)}),n._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:j,errorUpdatedAt:N,status:b}=h;if(n.select&&h.data!==void 0)if(i&&h.data===o?.data&&n.select===this.#f)v=this.#p;else try{this.#f=n.select,v=n.select(h.data),v=Jf(i?.data,v,n),this.#p=v,this.#o=null}catch(W){this.#o=W}else v=h.data;if(n.placeholderData!==void 0&&v===void 0&&b==="pending"){let W;if(i?.isPlaceholderData&&n.placeholderData===c?.placeholderData)W=i.data;else if(W=typeof n.placeholderData=="function"?n.placeholderData(this.#m?.state.data,this.#m):n.placeholderData,n.select&&W!==void 0)try{W=n.select(W),this.#o=null}catch(X){this.#o=X}W!==void 0&&(b="success",v=Jf(i?.data,W,n),g=!0)}this.#o&&(j=this.#o,v=this.#p,N=Date.now(),b="error");const C=h.fetchStatus==="fetching",S=b==="pending",k=b==="error",P=S&&C,R=v!==void 0,A={status:b,fetchStatus:h.fetchStatus,isPending:S,isSuccess:b==="success",isError:k,isInitialLoading:P,isLoading:P,data:v,dataUpdatedAt:h.dataUpdatedAt,error:j,errorUpdatedAt:N,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>p.dataUpdateCount||h.errorUpdateCount>p.errorUpdateCount,isFetching:C,isRefetching:C&&!S,isLoadingError:k&&!R,isPaused:h.fetchStatus==="paused",isPlaceholderData:g,isRefetchError:k&&R,isStale:ig(t,n),refetch:this.refetch,promise:this.#s};if(this.options.experimental_prefetchInRender){const W=V=>{A.status==="error"?V.reject(A.error):A.data!==void 0&&V.resolve(A.data)},X=()=>{const V=this.#s=A.promise=ex();W(V)},se=this.#s;switch(se.status){case"pending":t.queryHash===r.queryHash&&W(se);break;case"fulfilled":(A.status==="error"||A.data!==se.value)&&X();break;case"rejected":(A.status!=="error"||A.error!==se.reason)&&X();break}}return A}updateResult(t){const n=this.#n,r=this.createResult(this.#t,this.options);if(this.#i=this.#t.state,this.#a=this.options,this.#i.data!==void 0&&(this.#m=this.#t),$u(r,n))return;this.#n=r;const s={},i=()=>{if(!n)return!0;const{notifyOnChangeProps:o}=this.options,c=typeof o=="function"?o():o;if(c==="all"||!c&&!this.#h.size)return!0;const d=new Set(c??this.#h);return this.options.throwOnError&&d.add("error"),Object.keys(this.#n).some(p=>{const m=p;return this.#n[m]!==n[m]&&d.has(m)})};t?.listeners!==!1&&i()&&(s.listeners=!0),this.#N({...s,...t})}#w(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const n=this.#t;this.#t=t,this.#r=t.state,this.hasListeners()&&(n?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#y()}#N(t){Bn.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(this.#n)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function X4(t,n){return ws(n.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&n.retryOnMount===!1)}function _0(t,n){return X4(t,n)||t.state.data!==void 0&&tx(t,n,n.refetchOnMount)}function tx(t,n,r){if(ws(n.enabled,t)!==!1){const s=typeof r=="function"?r(t):r;return s==="always"||s!==!1&&ig(t,n)}return!1}function I0(t,n,r,s){return(t!==n||ws(s.enabled,t)===!1)&&(!r.suspense||t.state.status!=="error")&&ig(t,r)}function ig(t,n){return ws(n.enabled,t)!==!1&&t.isStaleByTime(Do(n.staleTime,t))}function J4(t,n){return!$u(t.getCurrentResult(),n)}var eR=class extends ll{#e;#t=void 0;#r;#n;constructor(n,r){super(),this.#e=n,this.setOptions(r),this.bindMethods(),this.#i()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){const r=this.options;this.options=this.#e.defaultMutationOptions(n),$u(this.options,r)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#r,observer:this}),r?.mutationKey&&this.options.mutationKey&&Di(r.mutationKey)!==Di(this.options.mutationKey)?this.reset():this.#r?.state.status==="pending"&&this.#r.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#r?.removeObserver(this)}onMutationUpdate(n){this.#i(),this.#a(n)}getCurrentResult(){return this.#t}reset(){this.#r?.removeObserver(this),this.#r=void 0,this.#i(),this.#a()}mutate(n,r){return this.#n=r,this.#r?.removeObserver(this),this.#r=this.#e.getMutationCache().build(this.#e,this.options),this.#r.addObserver(this),this.#r.execute(n)}#i(){const n=this.#r?.state??gN();this.#t={...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset}}#a(n){Bn.batch(()=>{if(this.#n&&this.hasListeners()){const r=this.#t.variables,s=this.#t.context;n?.type==="success"?(this.#n.onSuccess?.(n.data,r,s),this.#n.onSettled?.(n.data,null,r,s)):n?.type==="error"&&(this.#n.onError?.(n.error,r,s),this.#n.onSettled?.(void 0,n.error,r,s))}this.listeners.forEach(r=>{r(this.#t)})})}},vN=x.createContext(void 0),og=t=>{const n=x.useContext(vN);if(!n)throw new Error("No QueryClient set, use QueryClientProvider to set one");return n},tR=({client:t,children:n})=>(x.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),e.jsx(vN.Provider,{value:t,children:n})),yN=x.createContext(!1),nR=()=>x.useContext(yN);yN.Provider;function rR(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var sR=x.createContext(rR()),aR=()=>x.useContext(sR);function jN(t,n){return typeof t=="function"?t(...n):!!t}function nx(){}var iR=(t,n)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(n.isReset()||(t.retryOnMount=!1))},oR=t=>{x.useEffect(()=>{t.clearReset()},[t])},lR=({result:t,errorResetBoundary:n,throwOnError:r,query:s})=>t.isError&&!n.isReset()&&!t.isFetching&&s&&jN(r,[t.error,s]),cR=t=>{t.suspense&&(t.staleTime===void 0&&(t.staleTime=1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},dR=(t,n)=>t.isLoading&&t.isFetching&&!n,uR=(t,n)=>t?.suspense&&n.isPending,M0=(t,n,r)=>n.fetchOptimistic(t).catch(()=>{r.clearReset()});function pR(t,n,r){const s=og(),i=nR(),o=aR(),c=s.defaultQueryOptions(t);s.getDefaultOptions().queries?._experimental_beforeQuery?.(c),c._optimisticResults=i?"isRestoring":"optimistic",cR(c),iR(c,o),oR(o);const d=!s.getQueryCache().get(c.queryHash),[p]=x.useState(()=>new n(s,c)),m=p.getOptimisticResult(c);if(x.useSyncExternalStore(x.useCallback(h=>{const g=i?nx:p.subscribe(Bn.batchCalls(h));return p.updateResult(),g},[p,i]),()=>p.getCurrentResult(),()=>p.getCurrentResult()),x.useEffect(()=>{p.setOptions(c,{listeners:!1})},[c,p]),uR(c,m))throw M0(c,p,o);if(lR({result:m,errorResetBoundary:o,throwOnError:c.throwOnError,query:s.getQueryCache().get(c.queryHash)}))throw m.error;return s.getDefaultOptions().queries?._experimental_afterQuery?.(c,m),c.experimental_prefetchInRender&&!Oi&&dR(m,i)&&(d?M0(c,p,o):s.getQueryCache().get(c.queryHash)?.promise)?.catch(nx).finally(()=>{p.updateResult()}),c.notifyOnChangeProps?m:p.trackResult(m)}function Ke(t,n){return pR(t,Z4)}function ye(t,n){const r=og(),[s]=x.useState(()=>new eR(r,t));x.useEffect(()=>{s.setOptions(t)},[s,t]);const i=x.useSyncExternalStore(x.useCallback(c=>s.subscribe(Bn.batchCalls(c)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),o=x.useCallback((c,d)=>{s.mutate(c,d).catch(nx)},[s]);if(i.error&&jN(s.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:o,mutateAsync:i.mutate}}async function bN(t){if(!t.ok){const n=await t.text()||t.statusText;throw new Error(`${t.status}: ${n}`)}}async function je(t,n,r){const s=await fetch(n,{method:t,headers:r?{"Content-Type":"application/json"}:{},body:r?JSON.stringify(r):void 0,credentials:"include"});return await bN(s),s}const mR=({on401:t})=>async({queryKey:n})=>{const r=await fetch(n.join("/"),{credentials:"include"});return await bN(r),await r.json()},ae=new Y4({defaultOptions:{queries:{queryFn:mR({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),hR=1,fR=1e6;let sf=0;function xR(){return sf=(sf+1)%Number.MAX_SAFE_INTEGER,sf.toString()}const af=new Map,O0=t=>{if(af.has(t))return;const n=setTimeout(()=>{af.delete(t),vc({type:"REMOVE_TOAST",toastId:t})},fR);af.set(t,n)},gR=(t,n)=>{switch(n.type){case"ADD_TOAST":return{...t,toasts:[n.toast,...t.toasts].slice(0,hR)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(r=>r.id===n.toast.id?{...r,...n.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=n;return r?O0(r):t.toasts.forEach(s=>{O0(s.id)}),{...t,toasts:t.toasts.map(s=>s.id===r||r===void 0?{...s,open:!1}:s)}}case"REMOVE_TOAST":return n.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(r=>r.id!==n.toastId)}}},_u=[];let Iu={toasts:[]};function vc(t){Iu=gR(Iu,t),_u.forEach(n=>{n(Iu)})}function vR({...t}){const n=xR(),r=i=>vc({type:"UPDATE_TOAST",toast:{...i,id:n}}),s=()=>vc({type:"DISMISS_TOAST",toastId:n});return vc({type:"ADD_TOAST",toast:{...t,id:n,open:!0,onOpenChange:i=>{i||s()}}}),{id:n,dismiss:s,update:r}}function nn(){const[t,n]=x.useState(Iu);return x.useEffect(()=>(_u.push(n),()=>{const r=_u.indexOf(n);r>-1&&_u.splice(r,1)}),[t]),{...t,toast:vR,dismiss:r=>vc({type:"DISMISS_TOAST",toastId:r})}}var cl=Jw();const yR=jp(cl);function De(t,n,{checkForDefaultPrevented:r=!0}={}){return function(i){if(t?.(i),r===!1||!i.defaultPrevented)return n?.(i)}}function D0(t,n){if(typeof t=="function")return t(n);t!=null&&(t.current=n)}function Bc(...t){return n=>{let r=!1;const s=t.map(i=>{const o=D0(i,n);return!r&&typeof o=="function"&&(r=!0),o});if(r)return()=>{for(let i=0;i<s.length;i++){const o=s[i];typeof o=="function"?o():D0(t[i],null)}}}}function vt(...t){return x.useCallback(Bc(...t),t)}function jR(t,n){const r=x.createContext(n),s=o=>{const{children:c,...d}=o,p=x.useMemo(()=>d,Object.values(d));return e.jsx(r.Provider,{value:p,children:c})};s.displayName=t+"Provider";function i(o){const c=x.useContext(r);if(c)return c;if(n!==void 0)return n;throw new Error(`\`${o}\` must be used within \`${t}\``)}return[s,i]}function Zn(t,n=[]){let r=[];function s(o,c){const d=x.createContext(c),p=r.length;r=[...r,c];const m=g=>{const{scope:v,children:j,...N}=g,b=v?.[t]?.[p]||d,C=x.useMemo(()=>N,Object.values(N));return e.jsx(b.Provider,{value:C,children:j})};m.displayName=o+"Provider";function h(g,v){const j=v?.[t]?.[p]||d,N=x.useContext(j);if(N)return N;if(c!==void 0)return c;throw new Error(`\`${g}\` must be used within \`${o}\``)}return[m,h]}const i=()=>{const o=r.map(c=>x.createContext(c));return function(d){const p=d?.[t]||o;return x.useMemo(()=>({[`__scope${t}`]:{...d,[t]:p}}),[d,p])}};return i.scopeName=t,[s,bR(i,...n)]}function bR(...t){const n=t[0];if(t.length===1)return n;const r=()=>{const s=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(o){const c=s.reduce((d,{useScope:p,scopeName:m})=>{const g=p(o)[`__scope${m}`];return{...d,...g}},{});return x.useMemo(()=>({[`__scope${n.scopeName}`]:c}),[c])}};return r.scopeName=n.scopeName,r}function Li(t){const n=wR(t),r=x.forwardRef((s,i)=>{const{children:o,...c}=s,d=x.Children.toArray(o),p=d.find(NR);if(p){const m=p.props.children,h=d.map(g=>g===p?x.Children.count(m)>1?x.Children.only(null):x.isValidElement(m)?m.props.children:null:g);return e.jsx(n,{...c,ref:i,children:x.isValidElement(m)?x.cloneElement(m,void 0,h):null})}return e.jsx(n,{...c,ref:i,children:o})});return r.displayName=`${t}.Slot`,r}var Np=Li("Slot");function wR(t){const n=x.forwardRef((r,s)=>{const{children:i,...o}=r;if(x.isValidElement(i)){const c=SR(i),d=CR(o,i.props);return i.type!==x.Fragment&&(d.ref=s?Bc(s,c):c),x.cloneElement(i,d)}return x.Children.count(i)>1?x.Children.only(null):null});return n.displayName=`${t}.SlotClone`,n}var wN=Symbol("radix.slottable");function NN(t){const n=({children:r})=>e.jsx(e.Fragment,{children:r});return n.displayName=`${t}.Slottable`,n.__radixId=wN,n}function NR(t){return x.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===wN}function CR(t,n){const r={...n};for(const s in n){const i=t[s],o=n[s];/^on[A-Z]/.test(s)?i&&o?r[s]=(...d)=>{o(...d),i(...d)}:i&&(r[s]=i):s==="style"?r[s]={...i,...o}:s==="className"&&(r[s]=[i,o].filter(Boolean).join(" "))}return{...t,...r}}function SR(t){let n=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=n&&"isReactWarning"in n&&n.isReactWarning;return r?t.ref:(n=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=n&&"isReactWarning"in n&&n.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function dl(t){const n=t+"CollectionProvider",[r,s]=Zn(n),[i,o]=r(n,{collectionRef:{current:null},itemMap:new Map}),c=b=>{const{scope:C,children:S}=b,k=ut.useRef(null),P=ut.useRef(new Map).current;return e.jsx(i,{scope:C,itemMap:P,collectionRef:k,children:S})};c.displayName=n;const d=t+"CollectionSlot",p=Li(d),m=ut.forwardRef((b,C)=>{const{scope:S,children:k}=b,P=o(d,S),R=vt(C,P.collectionRef);return e.jsx(p,{ref:R,children:k})});m.displayName=d;const h=t+"CollectionItemSlot",g="data-radix-collection-item",v=Li(h),j=ut.forwardRef((b,C)=>{const{scope:S,children:k,...P}=b,R=ut.useRef(null),E=vt(C,R),A=o(h,S);return ut.useEffect(()=>(A.itemMap.set(R,{ref:R,...P}),()=>{A.itemMap.delete(R)})),e.jsx(v,{[g]:"",ref:E,children:k})});j.displayName=h;function N(b){const C=o(t+"CollectionConsumer",b);return ut.useCallback(()=>{const k=C.collectionRef.current;if(!k)return[];const P=Array.from(k.querySelectorAll(`[${g}]`));return Array.from(C.itemMap.values()).sort((A,W)=>P.indexOf(A.ref.current)-P.indexOf(W.ref.current))},[C.collectionRef,C.itemMap])}return[{Provider:c,Slot:m,ItemSlot:j},N,s]}var kR=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],et=kR.reduce((t,n)=>{const r=Li(`Primitive.${n}`),s=x.forwardRef((i,o)=>{const{asChild:c,...d}=i,p=c?r:n;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(p,{...d,ref:o})});return s.displayName=`Primitive.${n}`,{...t,[n]:s}},{});function lg(t,n){t&&cl.flushSync(()=>t.dispatchEvent(n))}function wn(t){const n=x.useRef(t);return x.useEffect(()=>{n.current=t}),x.useMemo(()=>(...r)=>n.current?.(...r),[])}function ER(t,n=globalThis?.document){const r=wn(t);x.useEffect(()=>{const s=i=>{i.key==="Escape"&&r(i)};return n.addEventListener("keydown",s,{capture:!0}),()=>n.removeEventListener("keydown",s,{capture:!0})},[r,n])}var PR="DismissableLayer",rx="dismissableLayer.update",TR="dismissableLayer.pointerDownOutside",RR="dismissableLayer.focusOutside",L0,CN=x.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),ul=x.forwardRef((t,n)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:o,onInteractOutside:c,onDismiss:d,...p}=t,m=x.useContext(CN),[h,g]=x.useState(null),v=h?.ownerDocument??globalThis?.document,[,j]=x.useState({}),N=vt(n,W=>g(W)),b=Array.from(m.layers),[C]=[...m.layersWithOutsidePointerEventsDisabled].slice(-1),S=b.indexOf(C),k=h?b.indexOf(h):-1,P=m.layersWithOutsidePointerEventsDisabled.size>0,R=k>=S,E=_R(W=>{const X=W.target,se=[...m.branches].some(V=>V.contains(X));!R||se||(i?.(W),c?.(W),W.defaultPrevented||d?.())},v),A=IR(W=>{const X=W.target;[...m.branches].some(V=>V.contains(X))||(o?.(W),c?.(W),W.defaultPrevented||d?.())},v);return ER(W=>{k===m.layers.size-1&&(s?.(W),!W.defaultPrevented&&d&&(W.preventDefault(),d()))},v),x.useEffect(()=>{if(h)return r&&(m.layersWithOutsidePointerEventsDisabled.size===0&&(L0=v.body.style.pointerEvents,v.body.style.pointerEvents="none"),m.layersWithOutsidePointerEventsDisabled.add(h)),m.layers.add(h),F0(),()=>{r&&m.layersWithOutsidePointerEventsDisabled.size===1&&(v.body.style.pointerEvents=L0)}},[h,v,r,m]),x.useEffect(()=>()=>{h&&(m.layers.delete(h),m.layersWithOutsidePointerEventsDisabled.delete(h),F0())},[h,m]),x.useEffect(()=>{const W=()=>j({});return document.addEventListener(rx,W),()=>document.removeEventListener(rx,W)},[]),e.jsx(et.div,{...p,ref:N,style:{pointerEvents:P?R?"auto":"none":void 0,...t.style},onFocusCapture:De(t.onFocusCapture,A.onFocusCapture),onBlurCapture:De(t.onBlurCapture,A.onBlurCapture),onPointerDownCapture:De(t.onPointerDownCapture,E.onPointerDownCapture)})});ul.displayName=PR;var AR="DismissableLayerBranch",SN=x.forwardRef((t,n)=>{const r=x.useContext(CN),s=x.useRef(null),i=vt(n,s);return x.useEffect(()=>{const o=s.current;if(o)return r.branches.add(o),()=>{r.branches.delete(o)}},[r.branches]),e.jsx(et.div,{...t,ref:i})});SN.displayName=AR;function _R(t,n=globalThis?.document){const r=wn(t),s=x.useRef(!1),i=x.useRef(()=>{});return x.useEffect(()=>{const o=d=>{if(d.target&&!s.current){let p=function(){kN(TR,r,m,{discrete:!0})};const m={originalEvent:d};d.pointerType==="touch"?(n.removeEventListener("click",i.current),i.current=p,n.addEventListener("click",i.current,{once:!0})):p()}else n.removeEventListener("click",i.current);s.current=!1},c=window.setTimeout(()=>{n.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(c),n.removeEventListener("pointerdown",o),n.removeEventListener("click",i.current)}},[n,r]),{onPointerDownCapture:()=>s.current=!0}}function IR(t,n=globalThis?.document){const r=wn(t),s=x.useRef(!1);return x.useEffect(()=>{const i=o=>{o.target&&!s.current&&kN(RR,r,{originalEvent:o},{discrete:!1})};return n.addEventListener("focusin",i),()=>n.removeEventListener("focusin",i)},[n,r]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function F0(){const t=new CustomEvent(rx);document.dispatchEvent(t)}function kN(t,n,r,{discrete:s}){const i=r.originalEvent.target,o=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});n&&i.addEventListener(t,n,{once:!0}),s?lg(i,o):i.dispatchEvent(o)}var MR=ul,OR=SN,On=globalThis?.document?x.useLayoutEffect:()=>{},DR="Portal",Gc=x.forwardRef((t,n)=>{const{container:r,...s}=t,[i,o]=x.useState(!1);On(()=>o(!0),[]);const c=r||i&&globalThis?.document?.body;return c?yR.createPortal(e.jsx(et.div,{...s,ref:n}),c):null});Gc.displayName=DR;function LR(t,n){return x.useReducer((r,s)=>n[r][s]??r,t)}var gr=t=>{const{present:n,children:r}=t,s=FR(n),i=typeof r=="function"?r({present:s.isPresent}):x.Children.only(r),o=vt(s.ref,$R(i));return typeof r=="function"||s.isPresent?x.cloneElement(i,{ref:o}):null};gr.displayName="Presence";function FR(t){const[n,r]=x.useState(),s=x.useRef({}),i=x.useRef(t),o=x.useRef("none"),c=t?"mounted":"unmounted",[d,p]=LR(c,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return x.useEffect(()=>{const m=fu(s.current);o.current=d==="mounted"?m:"none"},[d]),On(()=>{const m=s.current,h=i.current;if(h!==t){const v=o.current,j=fu(m);t?p("MOUNT"):j==="none"||m?.display==="none"?p("UNMOUNT"):p(h&&v!==j?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,p]),On(()=>{if(n){let m;const h=n.ownerDocument.defaultView??window,g=j=>{const b=fu(s.current).includes(j.animationName);if(j.target===n&&b&&(p("ANIMATION_END"),!i.current)){const C=n.style.animationFillMode;n.style.animationFillMode="forwards",m=h.setTimeout(()=>{n.style.animationFillMode==="forwards"&&(n.style.animationFillMode=C)})}},v=j=>{j.target===n&&(o.current=fu(s.current))};return n.addEventListener("animationstart",v),n.addEventListener("animationcancel",g),n.addEventListener("animationend",g),()=>{h.clearTimeout(m),n.removeEventListener("animationstart",v),n.removeEventListener("animationcancel",g),n.removeEventListener("animationend",g)}}else p("ANIMATION_END")},[n,p]),{isPresent:["mounted","unmountSuspended"].includes(d),ref:x.useCallback(m=>{m&&(s.current=getComputedStyle(m)),r(m)},[])}}function fu(t){return t?.animationName||"none"}function $R(t){let n=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=n&&"isReactWarning"in n&&n.isReactWarning;return r?t.ref:(n=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=n&&"isReactWarning"in n&&n.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function Zr({prop:t,defaultProp:n,onChange:r=()=>{}}){const[s,i]=zR({defaultProp:n,onChange:r}),o=t!==void 0,c=o?t:s,d=wn(r),p=x.useCallback(m=>{if(o){const g=typeof m=="function"?m(t):m;g!==t&&d(g)}else i(m)},[o,t,i,d]);return[c,p]}function zR({defaultProp:t,onChange:n}){const r=x.useState(t),[s]=r,i=x.useRef(s),o=wn(n);return x.useEffect(()=>{i.current!==s&&(o(s),i.current=s)},[s,i,o]),r}var VR="VisuallyHidden",Hc=x.forwardRef((t,n)=>e.jsx(et.span,{...t,ref:n,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));Hc.displayName=VR;var qR=Hc,cg="ToastProvider",[dg,UR,BR]=dl("Toast"),[EN]=Zn("Toast",[BR]),[GR,Cp]=EN(cg),PN=t=>{const{__scopeToast:n,label:r="Notification",duration:s=5e3,swipeDirection:i="right",swipeThreshold:o=50,children:c}=t,[d,p]=x.useState(null),[m,h]=x.useState(0),g=x.useRef(!1),v=x.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${cg}\`. Expected non-empty \`string\`.`),e.jsx(dg.Provider,{scope:n,children:e.jsx(GR,{scope:n,label:r,duration:s,swipeDirection:i,swipeThreshold:o,toastCount:m,viewport:d,onViewportChange:p,onToastAdd:x.useCallback(()=>h(j=>j+1),[]),onToastRemove:x.useCallback(()=>h(j=>j-1),[]),isFocusedToastEscapeKeyDownRef:g,isClosePausedRef:v,children:c})})};PN.displayName=cg;var TN="ToastViewport",HR=["F8"],sx="toast.viewportPause",ax="toast.viewportResume",RN=x.forwardRef((t,n)=>{const{__scopeToast:r,hotkey:s=HR,label:i="Notifications ({hotkey})",...o}=t,c=Cp(TN,r),d=UR(r),p=x.useRef(null),m=x.useRef(null),h=x.useRef(null),g=x.useRef(null),v=vt(n,g,c.onViewportChange),j=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),N=c.toastCount>0;x.useEffect(()=>{const C=S=>{s.length!==0&&s.every(P=>S[P]||S.code===P)&&g.current?.focus()};return document.addEventListener("keydown",C),()=>document.removeEventListener("keydown",C)},[s]),x.useEffect(()=>{const C=p.current,S=g.current;if(N&&C&&S){const k=()=>{if(!c.isClosePausedRef.current){const A=new CustomEvent(sx);S.dispatchEvent(A),c.isClosePausedRef.current=!0}},P=()=>{if(c.isClosePausedRef.current){const A=new CustomEvent(ax);S.dispatchEvent(A),c.isClosePausedRef.current=!1}},R=A=>{!C.contains(A.relatedTarget)&&P()},E=()=>{C.contains(document.activeElement)||P()};return C.addEventListener("focusin",k),C.addEventListener("focusout",R),C.addEventListener("pointermove",k),C.addEventListener("pointerleave",E),window.addEventListener("blur",k),window.addEventListener("focus",P),()=>{C.removeEventListener("focusin",k),C.removeEventListener("focusout",R),C.removeEventListener("pointermove",k),C.removeEventListener("pointerleave",E),window.removeEventListener("blur",k),window.removeEventListener("focus",P)}}},[N,c.isClosePausedRef]);const b=x.useCallback(({tabbingDirection:C})=>{const k=d().map(P=>{const R=P.ref.current,E=[R,...aA(R)];return C==="forwards"?E:E.reverse()});return(C==="forwards"?k.reverse():k).flat()},[d]);return x.useEffect(()=>{const C=g.current;if(C){const S=k=>{const P=k.altKey||k.ctrlKey||k.metaKey;if(k.key==="Tab"&&!P){const E=document.activeElement,A=k.shiftKey;if(k.target===C&&A){m.current?.focus();return}const se=b({tabbingDirection:A?"backwards":"forwards"}),V=se.findIndex(G=>G===E);of(se.slice(V+1))?k.preventDefault():A?m.current?.focus():h.current?.focus()}};return C.addEventListener("keydown",S),()=>C.removeEventListener("keydown",S)}},[d,b]),e.jsxs(OR,{ref:p,role:"region","aria-label":i.replace("{hotkey}",j),tabIndex:-1,style:{pointerEvents:N?void 0:"none"},children:[N&&e.jsx(ix,{ref:m,onFocusFromOutsideViewport:()=>{const C=b({tabbingDirection:"forwards"});of(C)}}),e.jsx(dg.Slot,{scope:r,children:e.jsx(et.ol,{tabIndex:-1,...o,ref:v})}),N&&e.jsx(ix,{ref:h,onFocusFromOutsideViewport:()=>{const C=b({tabbingDirection:"backwards"});of(C)}})]})});RN.displayName=TN;var AN="ToastFocusProxy",ix=x.forwardRef((t,n)=>{const{__scopeToast:r,onFocusFromOutsideViewport:s,...i}=t,o=Cp(AN,r);return e.jsx(Hc,{"aria-hidden":!0,tabIndex:0,...i,ref:n,style:{position:"fixed"},onFocus:c=>{const d=c.relatedTarget;!o.viewport?.contains(d)&&s()}})});ix.displayName=AN;var Sp="Toast",KR="toast.swipeStart",WR="toast.swipeMove",QR="toast.swipeCancel",YR="toast.swipeEnd",_N=x.forwardRef((t,n)=>{const{forceMount:r,open:s,defaultOpen:i,onOpenChange:o,...c}=t,[d=!0,p]=Zr({prop:s,defaultProp:i,onChange:o});return e.jsx(gr,{present:r||d,children:e.jsx(JR,{open:d,...c,ref:n,onClose:()=>p(!1),onPause:wn(t.onPause),onResume:wn(t.onResume),onSwipeStart:De(t.onSwipeStart,m=>{m.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:De(t.onSwipeMove,m=>{const{x:h,y:g}=m.detail.delta;m.currentTarget.setAttribute("data-swipe","move"),m.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${h}px`),m.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${g}px`)}),onSwipeCancel:De(t.onSwipeCancel,m=>{m.currentTarget.setAttribute("data-swipe","cancel"),m.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),m.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),m.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),m.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:De(t.onSwipeEnd,m=>{const{x:h,y:g}=m.detail.delta;m.currentTarget.setAttribute("data-swipe","end"),m.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),m.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),m.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${h}px`),m.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${g}px`),p(!1)})})})});_N.displayName=Sp;var[ZR,XR]=EN(Sp,{onClose(){}}),JR=x.forwardRef((t,n)=>{const{__scopeToast:r,type:s="foreground",duration:i,open:o,onClose:c,onEscapeKeyDown:d,onPause:p,onResume:m,onSwipeStart:h,onSwipeMove:g,onSwipeCancel:v,onSwipeEnd:j,...N}=t,b=Cp(Sp,r),[C,S]=x.useState(null),k=vt(n,U=>S(U)),P=x.useRef(null),R=x.useRef(null),E=i||b.duration,A=x.useRef(0),W=x.useRef(E),X=x.useRef(0),{onToastAdd:se,onToastRemove:V}=b,G=wn(()=>{C?.contains(document.activeElement)&&b.viewport?.focus(),c()}),O=x.useCallback(U=>{!U||U===1/0||(window.clearTimeout(X.current),A.current=new Date().getTime(),X.current=window.setTimeout(G,U))},[G]);x.useEffect(()=>{const U=b.viewport;if(U){const $=()=>{O(W.current),m?.()},q=()=>{const le=new Date().getTime()-A.current;W.current=W.current-le,window.clearTimeout(X.current),p?.()};return U.addEventListener(sx,q),U.addEventListener(ax,$),()=>{U.removeEventListener(sx,q),U.removeEventListener(ax,$)}}},[b.viewport,E,p,m,O]),x.useEffect(()=>{o&&!b.isClosePausedRef.current&&O(E)},[o,E,b.isClosePausedRef,O]),x.useEffect(()=>(se(),()=>V()),[se,V]);const F=x.useMemo(()=>C?$N(C):null,[C]);return b.viewport?e.jsxs(e.Fragment,{children:[F&&e.jsx(eA,{__scopeToast:r,role:"status","aria-live":s==="foreground"?"assertive":"polite","aria-atomic":!0,children:F}),e.jsx(ZR,{scope:r,onClose:G,children:cl.createPortal(e.jsx(dg.ItemSlot,{scope:r,children:e.jsx(MR,{asChild:!0,onEscapeKeyDown:De(d,()=>{b.isFocusedToastEscapeKeyDownRef.current||G(),b.isFocusedToastEscapeKeyDownRef.current=!1}),children:e.jsx(et.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":o?"open":"closed","data-swipe-direction":b.swipeDirection,...N,ref:k,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:De(t.onKeyDown,U=>{U.key==="Escape"&&(d?.(U.nativeEvent),U.nativeEvent.defaultPrevented||(b.isFocusedToastEscapeKeyDownRef.current=!0,G()))}),onPointerDown:De(t.onPointerDown,U=>{U.button===0&&(P.current={x:U.clientX,y:U.clientY})}),onPointerMove:De(t.onPointerMove,U=>{if(!P.current)return;const $=U.clientX-P.current.x,q=U.clientY-P.current.y,le=!!R.current,K=["left","right"].includes(b.swipeDirection),J=["left","up"].includes(b.swipeDirection)?Math.min:Math.max,D=K?J(0,$):0,I=K?0:J(0,q),re=U.pointerType==="touch"?10:2,T={x:D,y:I},Y={originalEvent:U,delta:T};le?(R.current=T,xu(WR,g,Y,{discrete:!1})):$0(T,b.swipeDirection,re)?(R.current=T,xu(KR,h,Y,{discrete:!1}),U.target.setPointerCapture(U.pointerId)):(Math.abs($)>re||Math.abs(q)>re)&&(P.current=null)}),onPointerUp:De(t.onPointerUp,U=>{const $=R.current,q=U.target;if(q.hasPointerCapture(U.pointerId)&&q.releasePointerCapture(U.pointerId),R.current=null,P.current=null,$){const le=U.currentTarget,K={originalEvent:U,delta:$};$0($,b.swipeDirection,b.swipeThreshold)?xu(YR,j,K,{discrete:!0}):xu(QR,v,K,{discrete:!0}),le.addEventListener("click",J=>J.preventDefault(),{once:!0})}})})})}),b.viewport)})]}):null}),eA=t=>{const{__scopeToast:n,children:r,...s}=t,i=Cp(Sp,n),[o,c]=x.useState(!1),[d,p]=x.useState(!1);return rA(()=>c(!0)),x.useEffect(()=>{const m=window.setTimeout(()=>p(!0),1e3);return()=>window.clearTimeout(m)},[]),d?null:e.jsx(Gc,{asChild:!0,children:e.jsx(Hc,{...s,children:o&&e.jsxs(e.Fragment,{children:[i.label," ",r]})})})},tA="ToastTitle",IN=x.forwardRef((t,n)=>{const{__scopeToast:r,...s}=t;return e.jsx(et.div,{...s,ref:n})});IN.displayName=tA;var nA="ToastDescription",MN=x.forwardRef((t,n)=>{const{__scopeToast:r,...s}=t;return e.jsx(et.div,{...s,ref:n})});MN.displayName=nA;var ON="ToastAction",DN=x.forwardRef((t,n)=>{const{altText:r,...s}=t;return r.trim()?e.jsx(FN,{altText:r,asChild:!0,children:e.jsx(ug,{...s,ref:n})}):(console.error(`Invalid prop \`altText\` supplied to \`${ON}\`. Expected non-empty \`string\`.`),null)});DN.displayName=ON;var LN="ToastClose",ug=x.forwardRef((t,n)=>{const{__scopeToast:r,...s}=t,i=XR(LN,r);return e.jsx(FN,{asChild:!0,children:e.jsx(et.button,{type:"button",...s,ref:n,onClick:De(t.onClick,i.onClose)})})});ug.displayName=LN;var FN=x.forwardRef((t,n)=>{const{__scopeToast:r,altText:s,...i}=t;return e.jsx(et.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":s||void 0,...i,ref:n})});function $N(t){const n=[];return Array.from(t.childNodes).forEach(s=>{if(s.nodeType===s.TEXT_NODE&&s.textContent&&n.push(s.textContent),sA(s)){const i=s.ariaHidden||s.hidden||s.style.display==="none",o=s.dataset.radixToastAnnounceExclude==="";if(!i)if(o){const c=s.dataset.radixToastAnnounceAlt;c&&n.push(c)}else n.push(...$N(s))}}),n}function xu(t,n,r,{discrete:s}){const i=r.originalEvent.currentTarget,o=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:r});n&&i.addEventListener(t,n,{once:!0}),s?lg(i,o):i.dispatchEvent(o)}var $0=(t,n,r=0)=>{const s=Math.abs(t.x),i=Math.abs(t.y),o=s>i;return n==="left"||n==="right"?o&&s>r:!o&&i>r};function rA(t=()=>{}){const n=wn(t);On(()=>{let r=0,s=0;return r=window.requestAnimationFrame(()=>s=window.requestAnimationFrame(n)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(s)}},[n])}function sA(t){return t.nodeType===t.ELEMENT_NODE}function aA(t){const n=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const i=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||i?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)n.push(r.currentNode);return n}function of(t){const n=document.activeElement;return t.some(r=>r===n?!0:(r.focus(),document.activeElement!==n))}var iA=PN,zN=RN,VN=_N,qN=IN,UN=MN,BN=DN,GN=ug;function HN(t){var n,r,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(n=0;n<i;n++)t[n]&&(r=HN(t[n]))&&(s&&(s+=" "),s+=r)}else for(r in t)t[r]&&(s&&(s+=" "),s+=r);return s}function KN(){for(var t,n,r=0,s="",i=arguments.length;r<i;r++)(t=arguments[r])&&(n=HN(t))&&(s&&(s+=" "),s+=n);return s}const z0=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,V0=KN,Bi=(t,n)=>r=>{var s;if(n?.variants==null)return V0(t,r?.class,r?.className);const{variants:i,defaultVariants:o}=n,c=Object.keys(i).map(m=>{const h=r?.[m],g=o?.[m];if(h===null)return null;const v=z0(h)||z0(g);return i[m][v]}),d=r&&Object.entries(r).reduce((m,h)=>{let[g,v]=h;return v===void 0||(m[g]=v),m},{}),p=n==null||(s=n.compoundVariants)===null||s===void 0?void 0:s.reduce((m,h)=>{let{class:g,className:v,...j}=h;return Object.entries(j).every(N=>{let[b,C]=N;return Array.isArray(C)?C.includes({...o,...d}[b]):{...o,...d}[b]===C})?[...m,g,v]:m},[]);return V0(t,c,p,r?.class,r?.className)};const oA=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),WN=(...t)=>t.filter((n,r,s)=>!!n&&s.indexOf(n)===r).join(" ");var lA={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const cA=x.forwardRef(({color:t="currentColor",size:n=24,strokeWidth:r=2,absoluteStrokeWidth:s,className:i="",children:o,iconNode:c,...d},p)=>x.createElement("svg",{ref:p,...lA,width:n,height:n,stroke:t,strokeWidth:s?Number(r)*24/Number(n):r,className:WN("lucide",i),...d},[...c.map(([m,h])=>x.createElement(m,h)),...Array.isArray(o)?o:[o]]));const ke=(t,n)=>{const r=x.forwardRef(({className:s,...i},o)=>x.createElement(cA,{ref:o,iconNode:n,className:WN(`lucide-${oA(t)}`,s),...i}));return r.displayName=`${t}`,r};const Kc=ke("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);const dA=ke("Anchor",[["path",{d:"M12 22V8",key:"qkxhtm"}],["path",{d:"M5 12H2a10 10 0 0 0 20 0h-3",key:"1hv3nh"}],["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}]]);const q0=ke("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);const uA=ke("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);const QN=ke("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);const Io=ke("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);const pA=ke("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);const mA=ke("AudioWaveform",[["path",{d:"M2 13a2 2 0 0 0 2-2V7a2 2 0 0 1 4 0v13a2 2 0 0 0 4 0V4a2 2 0 0 1 4 0v13a2 2 0 0 0 4 0v-4a2 2 0 0 1 2-2",key:"57tc96"}]]);const gu=ke("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);const Vu=ke("BookMarked",[["path",{d:"M10 2v8l3-3 3 3V2",key:"sqw3rj"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);const mn=ke("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);const Or=ke("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);const hA=ke("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);const fA=ke("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);const Tn=ke("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const Qs=ke("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);const YN=ke("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const Wc=ke("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const kp=ke("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);const Dr=ke("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const Xt=ke("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);const Us=ke("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const U0=ke("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const ZN=ke("CircleMinus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);const XN=ke("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);const lf=ke("CircleStop",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]]);const Hs=ke("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);const JN=ke("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);const qu=ke("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);const Cn=ke("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);const Uu=ke("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);const xA=ke("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);const sc=ke("Crosshair",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]]);const gA=ke("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);const Fi=ke("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);const xn=ke("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);const vA=ke("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);const fr=ke("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const yA=ke("Feather",[["path",{d:"M12.67 19a2 2 0 0 0 1.416-.588l6.154-6.172a6 6 0 0 0-8.49-8.49L5.586 9.914A2 2 0 0 0 5 11.328V18a1 1 0 0 0 1 1z",key:"18jl4k"}],["path",{d:"M16 8 2 22",key:"vp34q"}],["path",{d:"M17.5 15H9",key:"1oz8nu"}]]);const jA=ke("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);const bA=ke("FilePen",[["path",{d:"M12.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v9.5",key:"1couwa"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]]);const yt=ke("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);const wA=ke("FileX",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m14.5 12.5-5 5",key:"b62r18"}],["path",{d:"m9.5 12.5 5 5",key:"1rk7el"}]]);const NA=ke("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);const kc=ke("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);const e1=ke("GitCompare",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["path",{d:"M11 18H8a2 2 0 0 1-2-2V9",key:"19pyzm"}]]);const Ya=ke("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);const CA=ke("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);const SA=ke("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);const t1=ke("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);const kA=ke("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);const Mi=ke("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);const yc=ke("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);const EA=ke("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);const PA=ke("LayoutTemplate",[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"9",height:"7",x:"3",y:"14",rx:"1",key:"jqznyg"}],["rect",{width:"5",height:"7",x:"16",y:"14",rx:"1",key:"q5h2i8"}]]);const pa=ke("Library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]]);const B0=ke("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);const n1=ke("ListOrdered",[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]);const be=ke("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);const TA=ke("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);const RA=ke("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);const AA=ke("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);const r1=ke("Merge",[["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22",key:"1hyw0i"}],["path",{d:"m20 22-5-5",key:"1m27yz"}]]);const $i=ke("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);const Bu=ke("Microscope",[["path",{d:"M6 18h8",key:"1borvv"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M14 22a7 7 0 1 0 0-14h-1",key:"1jwaiy"}],["path",{d:"M9 14h2",key:"197e7h"}],["path",{d:"M9 12a2 2 0 0 1-2-2V6h6v4a2 2 0 0 1-2 2Z",key:"1bmzmy"}],["path",{d:"M12 6V3a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v3",key:"1drr47"}]]);const _A=ke("Milestone",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M12 3v3",key:"1n5kay"}],["path",{d:"M4 6a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1h13a2 2 0 0 0 1.152-.365l3.424-2.317a1 1 0 0 0 0-1.635l-3.424-2.318A2 2 0 0 0 17 6z",key:"1btarq"}]]);const IA=ke("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);const MA=ke("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);const Ep=ke("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);const OA=ke("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]]);const ox=ke("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);const DA=ke("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);const Ec=ke("PenTool",[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]);const LA=ke("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);const ar=ke("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);const Yn=ke("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);const Nr=ke("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const Ns=ke("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);const Gu=ke("Replace",[["path",{d:"M14 4a2 2 0 0 1 2-2",key:"1w2hp7"}],["path",{d:"M16 10a2 2 0 0 1-2-2",key:"shjach"}],["path",{d:"M20 2a2 2 0 0 1 2 2",key:"188mtx"}],["path",{d:"M22 8a2 2 0 0 1-2 2",key:"ddf4tu"}],["path",{d:"m3 7 3 3 3-3",key:"x25e72"}],["path",{d:"M6 10V5a3 3 0 0 1 3-3h1",key:"3y3t5z"}],["rect",{x:"2",y:"14",width:"8",height:"8",rx:"2",key:"4rksxw"}]]);const Ho=ke("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);const Pp=ke("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);const s1=ke("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);const Hu=ke("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);const FA=ke("ScrollText",[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]]);const ma=ke("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);const $A=ke("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);const a1=ke("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const zA=ke("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const Ko=ke("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);const G0=ke("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);const pg=ke("Skull",[["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z",key:"1o5pge"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}]]);const xr=ke("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);const i1=ke("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);const Ku=ke("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);const Wu=ke("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);const VA=ke("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);const Qu=ke("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);const qA=ke("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);const UA=ke("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);const Rn=ke("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);const Pc=ke("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);const on=ke("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const o1=ke("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);const ha=ke("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);const ri=ke("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);const pl=ke("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);const da=ke("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);const BA=ke("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);const Gn=ke("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);const us=ke("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),mg="-",GA=t=>{const n=KA(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:s}=t;return{getClassGroupId:c=>{const d=c.split(mg);return d[0]===""&&d.length!==1&&d.shift(),l1(d,n)||HA(c)},getConflictingClassGroupIds:(c,d)=>{const p=r[c]||[];return d&&s[c]?[...p,...s[c]]:p}}},l1=(t,n)=>{if(t.length===0)return n.classGroupId;const r=t[0],s=n.nextPart.get(r),i=s?l1(t.slice(1),s):void 0;if(i)return i;if(n.validators.length===0)return;const o=t.join(mg);return n.validators.find(({validator:c})=>c(o))?.classGroupId},H0=/^\[(.+)\]$/,HA=t=>{if(H0.test(t)){const n=H0.exec(t)[1],r=n?.substring(0,n.indexOf(":"));if(r)return"arbitrary.."+r}},KA=t=>{const{theme:n,prefix:r}=t,s={nextPart:new Map,validators:[]};return QA(Object.entries(t.classGroups),r).forEach(([o,c])=>{lx(c,s,o,n)}),s},lx=(t,n,r,s)=>{t.forEach(i=>{if(typeof i=="string"){const o=i===""?n:K0(n,i);o.classGroupId=r;return}if(typeof i=="function"){if(WA(i)){lx(i(s),n,r,s);return}n.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([o,c])=>{lx(c,K0(n,o),r,s)})})},K0=(t,n)=>{let r=t;return n.split(mg).forEach(s=>{r.nextPart.has(s)||r.nextPart.set(s,{nextPart:new Map,validators:[]}),r=r.nextPart.get(s)}),r},WA=t=>t.isThemeGetter,QA=(t,n)=>n?t.map(([r,s])=>{const i=s.map(o=>typeof o=="string"?n+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([c,d])=>[n+c,d])):o);return[r,i]}):t,YA=t=>{if(t<1)return{get:()=>{},set:()=>{}};let n=0,r=new Map,s=new Map;const i=(o,c)=>{r.set(o,c),n++,n>t&&(n=0,s=r,r=new Map)};return{get(o){let c=r.get(o);if(c!==void 0)return c;if((c=s.get(o))!==void 0)return i(o,c),c},set(o,c){r.has(o)?r.set(o,c):i(o,c)}}},c1="!",ZA=t=>{const{separator:n,experimentalParseClassName:r}=t,s=n.length===1,i=n[0],o=n.length,c=d=>{const p=[];let m=0,h=0,g;for(let C=0;C<d.length;C++){let S=d[C];if(m===0){if(S===i&&(s||d.slice(C,C+o)===n)){p.push(d.slice(h,C)),h=C+o;continue}if(S==="/"){g=C;continue}}S==="["?m++:S==="]"&&m--}const v=p.length===0?d:d.substring(h),j=v.startsWith(c1),N=j?v.substring(1):v,b=g&&g>h?g-h:void 0;return{modifiers:p,hasImportantModifier:j,baseClassName:N,maybePostfixModifierPosition:b}};return r?d=>r({className:d,parseClassName:c}):c},XA=t=>{if(t.length<=1)return t;const n=[];let r=[];return t.forEach(s=>{s[0]==="["?(n.push(...r.sort(),s),r=[]):r.push(s)}),n.push(...r.sort()),n},JA=t=>({cache:YA(t.cacheSize),parseClassName:ZA(t),...GA(t)}),e_=/\s+/,t_=(t,n)=>{const{parseClassName:r,getClassGroupId:s,getConflictingClassGroupIds:i}=n,o=[],c=t.trim().split(e_);let d="";for(let p=c.length-1;p>=0;p-=1){const m=c[p],{modifiers:h,hasImportantModifier:g,baseClassName:v,maybePostfixModifierPosition:j}=r(m);let N=!!j,b=s(N?v.substring(0,j):v);if(!b){if(!N){d=m+(d.length>0?" "+d:d);continue}if(b=s(v),!b){d=m+(d.length>0?" "+d:d);continue}N=!1}const C=XA(h).join(":"),S=g?C+c1:C,k=S+b;if(o.includes(k))continue;o.push(k);const P=i(b,N);for(let R=0;R<P.length;++R){const E=P[R];o.push(S+E)}d=m+(d.length>0?" "+d:d)}return d};function n_(){let t=0,n,r,s="";for(;t<arguments.length;)(n=arguments[t++])&&(r=d1(n))&&(s&&(s+=" "),s+=r);return s}const d1=t=>{if(typeof t=="string")return t;let n,r="";for(let s=0;s<t.length;s++)t[s]&&(n=d1(t[s]))&&(r&&(r+=" "),r+=n);return r};function r_(t,...n){let r,s,i,o=c;function c(p){const m=n.reduce((h,g)=>g(h),t());return r=JA(m),s=r.cache.get,i=r.cache.set,o=d,d(p)}function d(p){const m=s(p);if(m)return m;const h=t_(p,r);return i(p,h),h}return function(){return o(n_.apply(null,arguments))}}const pn=t=>{const n=r=>r[t]||[];return n.isThemeGetter=!0,n},u1=/^\[(?:([a-z-]+):)?(.+)\]$/i,s_=/^\d+\/\d+$/,a_=new Set(["px","full","screen"]),i_=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,o_=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,l_=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,c_=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,d_=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,oa=t=>Lo(t)||a_.has(t)||s_.test(t),Ba=t=>ml(t,"length",v_),Lo=t=>!!t&&!Number.isNaN(Number(t)),cf=t=>ml(t,"number",Lo),ac=t=>!!t&&Number.isInteger(Number(t)),u_=t=>t.endsWith("%")&&Lo(t.slice(0,-1)),_t=t=>u1.test(t),Ga=t=>i_.test(t),p_=new Set(["length","size","percentage"]),m_=t=>ml(t,p_,p1),h_=t=>ml(t,"position",p1),f_=new Set(["image","url"]),x_=t=>ml(t,f_,j_),g_=t=>ml(t,"",y_),ic=()=>!0,ml=(t,n,r)=>{const s=u1.exec(t);return s?s[1]?typeof n=="string"?s[1]===n:n.has(s[1]):r(s[2]):!1},v_=t=>o_.test(t)&&!l_.test(t),p1=()=>!1,y_=t=>c_.test(t),j_=t=>d_.test(t),b_=()=>{const t=pn("colors"),n=pn("spacing"),r=pn("blur"),s=pn("brightness"),i=pn("borderColor"),o=pn("borderRadius"),c=pn("borderSpacing"),d=pn("borderWidth"),p=pn("contrast"),m=pn("grayscale"),h=pn("hueRotate"),g=pn("invert"),v=pn("gap"),j=pn("gradientColorStops"),N=pn("gradientColorStopPositions"),b=pn("inset"),C=pn("margin"),S=pn("opacity"),k=pn("padding"),P=pn("saturate"),R=pn("scale"),E=pn("sepia"),A=pn("skew"),W=pn("space"),X=pn("translate"),se=()=>["auto","contain","none"],V=()=>["auto","hidden","clip","visible","scroll"],G=()=>["auto",_t,n],O=()=>[_t,n],F=()=>["",oa,Ba],U=()=>["auto",Lo,_t],$=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],q=()=>["solid","dashed","dotted","double","none"],le=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],K=()=>["start","end","center","between","around","evenly","stretch"],J=()=>["","0",_t],D=()=>["auto","avoid","all","avoid-page","page","left","right","column"],I=()=>[Lo,_t];return{cacheSize:500,separator:":",theme:{colors:[ic],spacing:[oa,Ba],blur:["none","",Ga,_t],brightness:I(),borderColor:[t],borderRadius:["none","","full",Ga,_t],borderSpacing:O(),borderWidth:F(),contrast:I(),grayscale:J(),hueRotate:I(),invert:J(),gap:O(),gradientColorStops:[t],gradientColorStopPositions:[u_,Ba],inset:G(),margin:G(),opacity:I(),padding:O(),saturate:I(),scale:I(),sepia:J(),skew:I(),space:O(),translate:O()},classGroups:{aspect:[{aspect:["auto","square","video",_t]}],container:["container"],columns:[{columns:[Ga]}],"break-after":[{"break-after":D()}],"break-before":[{"break-before":D()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...$(),_t]}],overflow:[{overflow:V()}],"overflow-x":[{"overflow-x":V()}],"overflow-y":[{"overflow-y":V()}],overscroll:[{overscroll:se()}],"overscroll-x":[{"overscroll-x":se()}],"overscroll-y":[{"overscroll-y":se()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",ac,_t]}],basis:[{basis:G()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",_t]}],grow:[{grow:J()}],shrink:[{shrink:J()}],order:[{order:["first","last","none",ac,_t]}],"grid-cols":[{"grid-cols":[ic]}],"col-start-end":[{col:["auto",{span:["full",ac,_t]},_t]}],"col-start":[{"col-start":U()}],"col-end":[{"col-end":U()}],"grid-rows":[{"grid-rows":[ic]}],"row-start-end":[{row:["auto",{span:[ac,_t]},_t]}],"row-start":[{"row-start":U()}],"row-end":[{"row-end":U()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",_t]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",_t]}],gap:[{gap:[v]}],"gap-x":[{"gap-x":[v]}],"gap-y":[{"gap-y":[v]}],"justify-content":[{justify:["normal",...K()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...K(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...K(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[k]}],px:[{px:[k]}],py:[{py:[k]}],ps:[{ps:[k]}],pe:[{pe:[k]}],pt:[{pt:[k]}],pr:[{pr:[k]}],pb:[{pb:[k]}],pl:[{pl:[k]}],m:[{m:[C]}],mx:[{mx:[C]}],my:[{my:[C]}],ms:[{ms:[C]}],me:[{me:[C]}],mt:[{mt:[C]}],mr:[{mr:[C]}],mb:[{mb:[C]}],ml:[{ml:[C]}],"space-x":[{"space-x":[W]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[W]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",_t,n]}],"min-w":[{"min-w":[_t,n,"min","max","fit"]}],"max-w":[{"max-w":[_t,n,"none","full","min","max","fit","prose",{screen:[Ga]},Ga]}],h:[{h:[_t,n,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[_t,n,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[_t,n,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[_t,n,"auto","min","max","fit"]}],"font-size":[{text:["base",Ga,Ba]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",cf]}],"font-family":[{font:[ic]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",_t]}],"line-clamp":[{"line-clamp":["none",Lo,cf]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",oa,_t]}],"list-image":[{"list-image":["none",_t]}],"list-style-type":[{list:["none","disc","decimal",_t]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[S]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[S]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...q(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",oa,Ba]}],"underline-offset":[{"underline-offset":["auto",oa,_t]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:O()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",_t]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",_t]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[S]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...$(),h_]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",m_]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},x_]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[N]}],"gradient-via-pos":[{via:[N]}],"gradient-to-pos":[{to:[N]}],"gradient-from":[{from:[j]}],"gradient-via":[{via:[j]}],"gradient-to":[{to:[j]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[d]}],"border-w-x":[{"border-x":[d]}],"border-w-y":[{"border-y":[d]}],"border-w-s":[{"border-s":[d]}],"border-w-e":[{"border-e":[d]}],"border-w-t":[{"border-t":[d]}],"border-w-r":[{"border-r":[d]}],"border-w-b":[{"border-b":[d]}],"border-w-l":[{"border-l":[d]}],"border-opacity":[{"border-opacity":[S]}],"border-style":[{border:[...q(),"hidden"]}],"divide-x":[{"divide-x":[d]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[d]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[S]}],"divide-style":[{divide:q()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...q()]}],"outline-offset":[{"outline-offset":[oa,_t]}],"outline-w":[{outline:[oa,Ba]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:F()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[S]}],"ring-offset-w":[{"ring-offset":[oa,Ba]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Ga,g_]}],"shadow-color":[{shadow:[ic]}],opacity:[{opacity:[S]}],"mix-blend":[{"mix-blend":[...le(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":le()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[s]}],contrast:[{contrast:[p]}],"drop-shadow":[{"drop-shadow":["","none",Ga,_t]}],grayscale:[{grayscale:[m]}],"hue-rotate":[{"hue-rotate":[h]}],invert:[{invert:[g]}],saturate:[{saturate:[P]}],sepia:[{sepia:[E]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[p]}],"backdrop-grayscale":[{"backdrop-grayscale":[m]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[h]}],"backdrop-invert":[{"backdrop-invert":[g]}],"backdrop-opacity":[{"backdrop-opacity":[S]}],"backdrop-saturate":[{"backdrop-saturate":[P]}],"backdrop-sepia":[{"backdrop-sepia":[E]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[c]}],"border-spacing-x":[{"border-spacing-x":[c]}],"border-spacing-y":[{"border-spacing-y":[c]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",_t]}],duration:[{duration:I()}],ease:[{ease:["linear","in","out","in-out",_t]}],delay:[{delay:I()}],animate:[{animate:["none","spin","ping","pulse","bounce",_t]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[R]}],"scale-x":[{"scale-x":[R]}],"scale-y":[{"scale-y":[R]}],rotate:[{rotate:[ac,_t]}],"translate-x":[{"translate-x":[X]}],"translate-y":[{"translate-y":[X]}],"skew-x":[{"skew-x":[A]}],"skew-y":[{"skew-y":[A]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",_t]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",_t]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":O()}],"scroll-mx":[{"scroll-mx":O()}],"scroll-my":[{"scroll-my":O()}],"scroll-ms":[{"scroll-ms":O()}],"scroll-me":[{"scroll-me":O()}],"scroll-mt":[{"scroll-mt":O()}],"scroll-mr":[{"scroll-mr":O()}],"scroll-mb":[{"scroll-mb":O()}],"scroll-ml":[{"scroll-ml":O()}],"scroll-p":[{"scroll-p":O()}],"scroll-px":[{"scroll-px":O()}],"scroll-py":[{"scroll-py":O()}],"scroll-ps":[{"scroll-ps":O()}],"scroll-pe":[{"scroll-pe":O()}],"scroll-pt":[{"scroll-pt":O()}],"scroll-pr":[{"scroll-pr":O()}],"scroll-pb":[{"scroll-pb":O()}],"scroll-pl":[{"scroll-pl":O()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",_t]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[oa,Ba,cf]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},w_=r_(b_);function Ae(...t){return w_(KN(t))}const N_=iA,m1=x.forwardRef(({className:t,...n},r)=>e.jsx(zN,{ref:r,className:Ae("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...n}));m1.displayName=zN.displayName;const C_=Bi("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),h1=x.forwardRef(({className:t,variant:n,...r},s)=>e.jsx(VN,{ref:s,className:Ae(C_({variant:n}),t),...r}));h1.displayName=VN.displayName;const S_=x.forwardRef(({className:t,...n},r)=>e.jsx(BN,{ref:r,className:Ae("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...n}));S_.displayName=BN.displayName;const f1=x.forwardRef(({className:t,...n},r)=>e.jsx(GN,{ref:r,className:Ae("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...n,children:e.jsx(Gn,{className:"h-4 w-4"})}));f1.displayName=GN.displayName;const x1=x.forwardRef(({className:t,...n},r)=>e.jsx(qN,{ref:r,className:Ae("text-sm font-semibold",t),...n}));x1.displayName=qN.displayName;const g1=x.forwardRef(({className:t,...n},r)=>e.jsx(UN,{ref:r,className:Ae("text-sm opacity-90",t),...n}));g1.displayName=UN.displayName;function k_(){const{toasts:t}=nn();return e.jsxs(N_,{children:[t.map(function({id:n,title:r,description:s,action:i,...o}){return e.jsxs(h1,{...o,children:[e.jsxs("div",{className:"grid gap-1",children:[r&&e.jsx(x1,{children:r}),s&&e.jsx(g1,{children:s})]}),i,e.jsx(f1,{})]},n)}),e.jsx(m1,{})]})}var E_=eg[" useId ".trim().toString()]||(()=>{}),P_=0;function Qr(t){const[n,r]=x.useState(E_());return On(()=>{r(s=>s??String(P_++))},[t]),n?`radix-${n}`:""}const T_=["top","right","bottom","left"],ii=Math.min,Hr=Math.max,Yu=Math.round,vu=Math.floor,Bs=t=>({x:t,y:t}),R_={left:"right",right:"left",bottom:"top",top:"bottom"},A_={start:"end",end:"start"};function cx(t,n,r){return Hr(t,ii(n,r))}function fa(t,n){return typeof t=="function"?t(n):t}function xa(t){return t.split("-")[0]}function hl(t){return t.split("-")[1]}function hg(t){return t==="x"?"y":"x"}function fg(t){return t==="y"?"height":"width"}function oi(t){return["top","bottom"].includes(xa(t))?"y":"x"}function xg(t){return hg(oi(t))}function __(t,n,r){r===void 0&&(r=!1);const s=hl(t),i=xg(t),o=fg(i);let c=i==="x"?s===(r?"end":"start")?"right":"left":s==="start"?"bottom":"top";return n.reference[o]>n.floating[o]&&(c=Zu(c)),[c,Zu(c)]}function I_(t){const n=Zu(t);return[dx(t),n,dx(n)]}function dx(t){return t.replace(/start|end/g,n=>A_[n])}function M_(t,n,r){const s=["left","right"],i=["right","left"],o=["top","bottom"],c=["bottom","top"];switch(t){case"top":case"bottom":return r?n?i:s:n?s:i;case"left":case"right":return n?o:c;default:return[]}}function O_(t,n,r,s){const i=hl(t);let o=M_(xa(t),r==="start",s);return i&&(o=o.map(c=>c+"-"+i),n&&(o=o.concat(o.map(dx)))),o}function Zu(t){return t.replace(/left|right|bottom|top/g,n=>R_[n])}function D_(t){return{top:0,right:0,bottom:0,left:0,...t}}function v1(t){return typeof t!="number"?D_(t):{top:t,right:t,bottom:t,left:t}}function Xu(t){const{x:n,y:r,width:s,height:i}=t;return{width:s,height:i,top:r,left:n,right:n+s,bottom:r+i,x:n,y:r}}function W0(t,n,r){let{reference:s,floating:i}=t;const o=oi(n),c=xg(n),d=fg(c),p=xa(n),m=o==="y",h=s.x+s.width/2-i.width/2,g=s.y+s.height/2-i.height/2,v=s[d]/2-i[d]/2;let j;switch(p){case"top":j={x:h,y:s.y-i.height};break;case"bottom":j={x:h,y:s.y+s.height};break;case"right":j={x:s.x+s.width,y:g};break;case"left":j={x:s.x-i.width,y:g};break;default:j={x:s.x,y:s.y}}switch(hl(n)){case"start":j[c]-=v*(r&&m?-1:1);break;case"end":j[c]+=v*(r&&m?-1:1);break}return j}const L_=async(t,n,r)=>{const{placement:s="bottom",strategy:i="absolute",middleware:o=[],platform:c}=r,d=o.filter(Boolean),p=await(c.isRTL==null?void 0:c.isRTL(n));let m=await c.getElementRects({reference:t,floating:n,strategy:i}),{x:h,y:g}=W0(m,s,p),v=s,j={},N=0;for(let b=0;b<d.length;b++){const{name:C,fn:S}=d[b],{x:k,y:P,data:R,reset:E}=await S({x:h,y:g,initialPlacement:s,placement:v,strategy:i,middlewareData:j,rects:m,platform:c,elements:{reference:t,floating:n}});h=k??h,g=P??g,j={...j,[C]:{...j[C],...R}},E&&N<=50&&(N++,typeof E=="object"&&(E.placement&&(v=E.placement),E.rects&&(m=E.rects===!0?await c.getElementRects({reference:t,floating:n,strategy:i}):E.rects),{x:h,y:g}=W0(m,v,p)),b=-1)}return{x:h,y:g,placement:v,strategy:i,middlewareData:j}};async function Tc(t,n){var r;n===void 0&&(n={});const{x:s,y:i,platform:o,rects:c,elements:d,strategy:p}=t,{boundary:m="clippingAncestors",rootBoundary:h="viewport",elementContext:g="floating",altBoundary:v=!1,padding:j=0}=fa(n,t),N=v1(j),C=d[v?g==="floating"?"reference":"floating":g],S=Xu(await o.getClippingRect({element:(r=await(o.isElement==null?void 0:o.isElement(C)))==null||r?C:C.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(d.floating)),boundary:m,rootBoundary:h,strategy:p})),k=g==="floating"?{x:s,y:i,width:c.floating.width,height:c.floating.height}:c.reference,P=await(o.getOffsetParent==null?void 0:o.getOffsetParent(d.floating)),R=await(o.isElement==null?void 0:o.isElement(P))?await(o.getScale==null?void 0:o.getScale(P))||{x:1,y:1}:{x:1,y:1},E=Xu(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:d,rect:k,offsetParent:P,strategy:p}):k);return{top:(S.top-E.top+N.top)/R.y,bottom:(E.bottom-S.bottom+N.bottom)/R.y,left:(S.left-E.left+N.left)/R.x,right:(E.right-S.right+N.right)/R.x}}const F_=t=>({name:"arrow",options:t,async fn(n){const{x:r,y:s,placement:i,rects:o,platform:c,elements:d,middlewareData:p}=n,{element:m,padding:h=0}=fa(t,n)||{};if(m==null)return{};const g=v1(h),v={x:r,y:s},j=xg(i),N=fg(j),b=await c.getDimensions(m),C=j==="y",S=C?"top":"left",k=C?"bottom":"right",P=C?"clientHeight":"clientWidth",R=o.reference[N]+o.reference[j]-v[j]-o.floating[N],E=v[j]-o.reference[j],A=await(c.getOffsetParent==null?void 0:c.getOffsetParent(m));let W=A?A[P]:0;(!W||!await(c.isElement==null?void 0:c.isElement(A)))&&(W=d.floating[P]||o.floating[N]);const X=R/2-E/2,se=W/2-b[N]/2-1,V=ii(g[S],se),G=ii(g[k],se),O=V,F=W-b[N]-G,U=W/2-b[N]/2+X,$=cx(O,U,F),q=!p.arrow&&hl(i)!=null&&U!==$&&o.reference[N]/2-(U<O?V:G)-b[N]/2<0,le=q?U<O?U-O:U-F:0;return{[j]:v[j]+le,data:{[j]:$,centerOffset:U-$-le,...q&&{alignmentOffset:le}},reset:q}}}),$_=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(n){var r,s;const{placement:i,middlewareData:o,rects:c,initialPlacement:d,platform:p,elements:m}=n,{mainAxis:h=!0,crossAxis:g=!0,fallbackPlacements:v,fallbackStrategy:j="bestFit",fallbackAxisSideDirection:N="none",flipAlignment:b=!0,...C}=fa(t,n);if((r=o.arrow)!=null&&r.alignmentOffset)return{};const S=xa(i),k=oi(d),P=xa(d)===d,R=await(p.isRTL==null?void 0:p.isRTL(m.floating)),E=v||(P||!b?[Zu(d)]:I_(d)),A=N!=="none";!v&&A&&E.push(...O_(d,b,N,R));const W=[d,...E],X=await Tc(n,C),se=[];let V=((s=o.flip)==null?void 0:s.overflows)||[];if(h&&se.push(X[S]),g){const U=__(i,c,R);se.push(X[U[0]],X[U[1]])}if(V=[...V,{placement:i,overflows:se}],!se.every(U=>U<=0)){var G,O;const U=(((G=o.flip)==null?void 0:G.index)||0)+1,$=W[U];if($)return{data:{index:U,overflows:V},reset:{placement:$}};let q=(O=V.filter(le=>le.overflows[0]<=0).sort((le,K)=>le.overflows[1]-K.overflows[1])[0])==null?void 0:O.placement;if(!q)switch(j){case"bestFit":{var F;const le=(F=V.filter(K=>{if(A){const J=oi(K.placement);return J===k||J==="y"}return!0}).map(K=>[K.placement,K.overflows.filter(J=>J>0).reduce((J,D)=>J+D,0)]).sort((K,J)=>K[1]-J[1])[0])==null?void 0:F[0];le&&(q=le);break}case"initialPlacement":q=d;break}if(i!==q)return{reset:{placement:q}}}return{}}}};function Q0(t,n){return{top:t.top-n.height,right:t.right-n.width,bottom:t.bottom-n.height,left:t.left-n.width}}function Y0(t){return T_.some(n=>t[n]>=0)}const z_=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(n){const{rects:r}=n,{strategy:s="referenceHidden",...i}=fa(t,n);switch(s){case"referenceHidden":{const o=await Tc(n,{...i,elementContext:"reference"}),c=Q0(o,r.reference);return{data:{referenceHiddenOffsets:c,referenceHidden:Y0(c)}}}case"escaped":{const o=await Tc(n,{...i,altBoundary:!0}),c=Q0(o,r.floating);return{data:{escapedOffsets:c,escaped:Y0(c)}}}default:return{}}}}};async function V_(t,n){const{placement:r,platform:s,elements:i}=t,o=await(s.isRTL==null?void 0:s.isRTL(i.floating)),c=xa(r),d=hl(r),p=oi(r)==="y",m=["left","top"].includes(c)?-1:1,h=o&&p?-1:1,g=fa(n,t);let{mainAxis:v,crossAxis:j,alignmentAxis:N}=typeof g=="number"?{mainAxis:g,crossAxis:0,alignmentAxis:null}:{mainAxis:g.mainAxis||0,crossAxis:g.crossAxis||0,alignmentAxis:g.alignmentAxis};return d&&typeof N=="number"&&(j=d==="end"?N*-1:N),p?{x:j*h,y:v*m}:{x:v*m,y:j*h}}const q_=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(n){var r,s;const{x:i,y:o,placement:c,middlewareData:d}=n,p=await V_(n,t);return c===((r=d.offset)==null?void 0:r.placement)&&(s=d.arrow)!=null&&s.alignmentOffset?{}:{x:i+p.x,y:o+p.y,data:{...p,placement:c}}}}},U_=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(n){const{x:r,y:s,placement:i}=n,{mainAxis:o=!0,crossAxis:c=!1,limiter:d={fn:C=>{let{x:S,y:k}=C;return{x:S,y:k}}},...p}=fa(t,n),m={x:r,y:s},h=await Tc(n,p),g=oi(xa(i)),v=hg(g);let j=m[v],N=m[g];if(o){const C=v==="y"?"top":"left",S=v==="y"?"bottom":"right",k=j+h[C],P=j-h[S];j=cx(k,j,P)}if(c){const C=g==="y"?"top":"left",S=g==="y"?"bottom":"right",k=N+h[C],P=N-h[S];N=cx(k,N,P)}const b=d.fn({...n,[v]:j,[g]:N});return{...b,data:{x:b.x-r,y:b.y-s,enabled:{[v]:o,[g]:c}}}}}},B_=function(t){return t===void 0&&(t={}),{options:t,fn(n){const{x:r,y:s,placement:i,rects:o,middlewareData:c}=n,{offset:d=0,mainAxis:p=!0,crossAxis:m=!0}=fa(t,n),h={x:r,y:s},g=oi(i),v=hg(g);let j=h[v],N=h[g];const b=fa(d,n),C=typeof b=="number"?{mainAxis:b,crossAxis:0}:{mainAxis:0,crossAxis:0,...b};if(p){const P=v==="y"?"height":"width",R=o.reference[v]-o.floating[P]+C.mainAxis,E=o.reference[v]+o.reference[P]-C.mainAxis;j<R?j=R:j>E&&(j=E)}if(m){var S,k;const P=v==="y"?"width":"height",R=["top","left"].includes(xa(i)),E=o.reference[g]-o.floating[P]+(R&&((S=c.offset)==null?void 0:S[g])||0)+(R?0:C.crossAxis),A=o.reference[g]+o.reference[P]+(R?0:((k=c.offset)==null?void 0:k[g])||0)-(R?C.crossAxis:0);N<E?N=E:N>A&&(N=A)}return{[v]:j,[g]:N}}}},G_=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(n){var r,s;const{placement:i,rects:o,platform:c,elements:d}=n,{apply:p=()=>{},...m}=fa(t,n),h=await Tc(n,m),g=xa(i),v=hl(i),j=oi(i)==="y",{width:N,height:b}=o.floating;let C,S;g==="top"||g==="bottom"?(C=g,S=v===(await(c.isRTL==null?void 0:c.isRTL(d.floating))?"start":"end")?"left":"right"):(S=g,C=v==="end"?"top":"bottom");const k=b-h.top-h.bottom,P=N-h.left-h.right,R=ii(b-h[C],k),E=ii(N-h[S],P),A=!n.middlewareData.shift;let W=R,X=E;if((r=n.middlewareData.shift)!=null&&r.enabled.x&&(X=P),(s=n.middlewareData.shift)!=null&&s.enabled.y&&(W=k),A&&!v){const V=Hr(h.left,0),G=Hr(h.right,0),O=Hr(h.top,0),F=Hr(h.bottom,0);j?X=N-2*(V!==0||G!==0?V+G:Hr(h.left,h.right)):W=b-2*(O!==0||F!==0?O+F:Hr(h.top,h.bottom))}await p({...n,availableWidth:X,availableHeight:W});const se=await c.getDimensions(d.floating);return N!==se.width||b!==se.height?{reset:{rects:!0}}:{}}}};function Tp(){return typeof window<"u"}function fl(t){return y1(t)?(t.nodeName||"").toLowerCase():"#document"}function Yr(t){var n;return(t==null||(n=t.ownerDocument)==null?void 0:n.defaultView)||window}function Ys(t){var n;return(n=(y1(t)?t.ownerDocument:t.document)||window.document)==null?void 0:n.documentElement}function y1(t){return Tp()?t instanceof Node||t instanceof Yr(t).Node:!1}function ks(t){return Tp()?t instanceof Element||t instanceof Yr(t).Element:!1}function Ks(t){return Tp()?t instanceof HTMLElement||t instanceof Yr(t).HTMLElement:!1}function Z0(t){return!Tp()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Yr(t).ShadowRoot}function Qc(t){const{overflow:n,overflowX:r,overflowY:s,display:i}=Es(t);return/auto|scroll|overlay|hidden|clip/.test(n+s+r)&&!["inline","contents"].includes(i)}function H_(t){return["table","td","th"].includes(fl(t))}function Rp(t){return[":popover-open",":modal"].some(n=>{try{return t.matches(n)}catch{return!1}})}function gg(t){const n=vg(),r=ks(t)?Es(t):t;return["transform","translate","scale","rotate","perspective"].some(s=>r[s]?r[s]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!n&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!n&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(s=>(r.willChange||"").includes(s))||["paint","layout","strict","content"].some(s=>(r.contain||"").includes(s))}function K_(t){let n=li(t);for(;Ks(n)&&!Wo(n);){if(gg(n))return n;if(Rp(n))return null;n=li(n)}return null}function vg(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Wo(t){return["html","body","#document"].includes(fl(t))}function Es(t){return Yr(t).getComputedStyle(t)}function Ap(t){return ks(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function li(t){if(fl(t)==="html")return t;const n=t.assignedSlot||t.parentNode||Z0(t)&&t.host||Ys(t);return Z0(n)?n.host:n}function j1(t){const n=li(t);return Wo(n)?t.ownerDocument?t.ownerDocument.body:t.body:Ks(n)&&Qc(n)?n:j1(n)}function Rc(t,n,r){var s;n===void 0&&(n=[]),r===void 0&&(r=!0);const i=j1(t),o=i===((s=t.ownerDocument)==null?void 0:s.body),c=Yr(i);if(o){const d=ux(c);return n.concat(c,c.visualViewport||[],Qc(i)?i:[],d&&r?Rc(d):[])}return n.concat(i,Rc(i,[],r))}function ux(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function b1(t){const n=Es(t);let r=parseFloat(n.width)||0,s=parseFloat(n.height)||0;const i=Ks(t),o=i?t.offsetWidth:r,c=i?t.offsetHeight:s,d=Yu(r)!==o||Yu(s)!==c;return d&&(r=o,s=c),{width:r,height:s,$:d}}function yg(t){return ks(t)?t:t.contextElement}function Fo(t){const n=yg(t);if(!Ks(n))return Bs(1);const r=n.getBoundingClientRect(),{width:s,height:i,$:o}=b1(n);let c=(o?Yu(r.width):r.width)/s,d=(o?Yu(r.height):r.height)/i;return(!c||!Number.isFinite(c))&&(c=1),(!d||!Number.isFinite(d))&&(d=1),{x:c,y:d}}const W_=Bs(0);function w1(t){const n=Yr(t);return!vg()||!n.visualViewport?W_:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function Q_(t,n,r){return n===void 0&&(n=!1),!r||n&&r!==Yr(t)?!1:n}function zi(t,n,r,s){n===void 0&&(n=!1),r===void 0&&(r=!1);const i=t.getBoundingClientRect(),o=yg(t);let c=Bs(1);n&&(s?ks(s)&&(c=Fo(s)):c=Fo(t));const d=Q_(o,r,s)?w1(o):Bs(0);let p=(i.left+d.x)/c.x,m=(i.top+d.y)/c.y,h=i.width/c.x,g=i.height/c.y;if(o){const v=Yr(o),j=s&&ks(s)?Yr(s):s;let N=v,b=ux(N);for(;b&&s&&j!==N;){const C=Fo(b),S=b.getBoundingClientRect(),k=Es(b),P=S.left+(b.clientLeft+parseFloat(k.paddingLeft))*C.x,R=S.top+(b.clientTop+parseFloat(k.paddingTop))*C.y;p*=C.x,m*=C.y,h*=C.x,g*=C.y,p+=P,m+=R,N=Yr(b),b=ux(N)}}return Xu({width:h,height:g,x:p,y:m})}function jg(t,n){const r=Ap(t).scrollLeft;return n?n.left+r:zi(Ys(t)).left+r}function N1(t,n,r){r===void 0&&(r=!1);const s=t.getBoundingClientRect(),i=s.left+n.scrollLeft-(r?0:jg(t,s)),o=s.top+n.scrollTop;return{x:i,y:o}}function Y_(t){let{elements:n,rect:r,offsetParent:s,strategy:i}=t;const o=i==="fixed",c=Ys(s),d=n?Rp(n.floating):!1;if(s===c||d&&o)return r;let p={scrollLeft:0,scrollTop:0},m=Bs(1);const h=Bs(0),g=Ks(s);if((g||!g&&!o)&&((fl(s)!=="body"||Qc(c))&&(p=Ap(s)),Ks(s))){const j=zi(s);m=Fo(s),h.x=j.x+s.clientLeft,h.y=j.y+s.clientTop}const v=c&&!g&&!o?N1(c,p,!0):Bs(0);return{width:r.width*m.x,height:r.height*m.y,x:r.x*m.x-p.scrollLeft*m.x+h.x+v.x,y:r.y*m.y-p.scrollTop*m.y+h.y+v.y}}function Z_(t){return Array.from(t.getClientRects())}function X_(t){const n=Ys(t),r=Ap(t),s=t.ownerDocument.body,i=Hr(n.scrollWidth,n.clientWidth,s.scrollWidth,s.clientWidth),o=Hr(n.scrollHeight,n.clientHeight,s.scrollHeight,s.clientHeight);let c=-r.scrollLeft+jg(t);const d=-r.scrollTop;return Es(s).direction==="rtl"&&(c+=Hr(n.clientWidth,s.clientWidth)-i),{width:i,height:o,x:c,y:d}}function J_(t,n){const r=Yr(t),s=Ys(t),i=r.visualViewport;let o=s.clientWidth,c=s.clientHeight,d=0,p=0;if(i){o=i.width,c=i.height;const m=vg();(!m||m&&n==="fixed")&&(d=i.offsetLeft,p=i.offsetTop)}return{width:o,height:c,x:d,y:p}}function eI(t,n){const r=zi(t,!0,n==="fixed"),s=r.top+t.clientTop,i=r.left+t.clientLeft,o=Ks(t)?Fo(t):Bs(1),c=t.clientWidth*o.x,d=t.clientHeight*o.y,p=i*o.x,m=s*o.y;return{width:c,height:d,x:p,y:m}}function X0(t,n,r){let s;if(n==="viewport")s=J_(t,r);else if(n==="document")s=X_(Ys(t));else if(ks(n))s=eI(n,r);else{const i=w1(t);s={x:n.x-i.x,y:n.y-i.y,width:n.width,height:n.height}}return Xu(s)}function C1(t,n){const r=li(t);return r===n||!ks(r)||Wo(r)?!1:Es(r).position==="fixed"||C1(r,n)}function tI(t,n){const r=n.get(t);if(r)return r;let s=Rc(t,[],!1).filter(d=>ks(d)&&fl(d)!=="body"),i=null;const o=Es(t).position==="fixed";let c=o?li(t):t;for(;ks(c)&&!Wo(c);){const d=Es(c),p=gg(c);!p&&d.position==="fixed"&&(i=null),(o?!p&&!i:!p&&d.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||Qc(c)&&!p&&C1(t,c))?s=s.filter(h=>h!==c):i=d,c=li(c)}return n.set(t,s),s}function nI(t){let{element:n,boundary:r,rootBoundary:s,strategy:i}=t;const c=[...r==="clippingAncestors"?Rp(n)?[]:tI(n,this._c):[].concat(r),s],d=c[0],p=c.reduce((m,h)=>{const g=X0(n,h,i);return m.top=Hr(g.top,m.top),m.right=ii(g.right,m.right),m.bottom=ii(g.bottom,m.bottom),m.left=Hr(g.left,m.left),m},X0(n,d,i));return{width:p.right-p.left,height:p.bottom-p.top,x:p.left,y:p.top}}function rI(t){const{width:n,height:r}=b1(t);return{width:n,height:r}}function sI(t,n,r){const s=Ks(n),i=Ys(n),o=r==="fixed",c=zi(t,!0,o,n);let d={scrollLeft:0,scrollTop:0};const p=Bs(0);if(s||!s&&!o)if((fl(n)!=="body"||Qc(i))&&(d=Ap(n)),s){const v=zi(n,!0,o,n);p.x=v.x+n.clientLeft,p.y=v.y+n.clientTop}else i&&(p.x=jg(i));const m=i&&!s&&!o?N1(i,d):Bs(0),h=c.left+d.scrollLeft-p.x-m.x,g=c.top+d.scrollTop-p.y-m.y;return{x:h,y:g,width:c.width,height:c.height}}function df(t){return Es(t).position==="static"}function J0(t,n){if(!Ks(t)||Es(t).position==="fixed")return null;if(n)return n(t);let r=t.offsetParent;return Ys(t)===r&&(r=r.ownerDocument.body),r}function S1(t,n){const r=Yr(t);if(Rp(t))return r;if(!Ks(t)){let i=li(t);for(;i&&!Wo(i);){if(ks(i)&&!df(i))return i;i=li(i)}return r}let s=J0(t,n);for(;s&&H_(s)&&df(s);)s=J0(s,n);return s&&Wo(s)&&df(s)&&!gg(s)?r:s||K_(t)||r}const aI=async function(t){const n=this.getOffsetParent||S1,r=this.getDimensions,s=await r(t.floating);return{reference:sI(t.reference,await n(t.floating),t.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function iI(t){return Es(t).direction==="rtl"}const oI={convertOffsetParentRelativeRectToViewportRelativeRect:Y_,getDocumentElement:Ys,getClippingRect:nI,getOffsetParent:S1,getElementRects:aI,getClientRects:Z_,getDimensions:rI,getScale:Fo,isElement:ks,isRTL:iI};function k1(t,n){return t.x===n.x&&t.y===n.y&&t.width===n.width&&t.height===n.height}function lI(t,n){let r=null,s;const i=Ys(t);function o(){var d;clearTimeout(s),(d=r)==null||d.disconnect(),r=null}function c(d,p){d===void 0&&(d=!1),p===void 0&&(p=1),o();const m=t.getBoundingClientRect(),{left:h,top:g,width:v,height:j}=m;if(d||n(),!v||!j)return;const N=vu(g),b=vu(i.clientWidth-(h+v)),C=vu(i.clientHeight-(g+j)),S=vu(h),P={rootMargin:-N+"px "+-b+"px "+-C+"px "+-S+"px",threshold:Hr(0,ii(1,p))||1};let R=!0;function E(A){const W=A[0].intersectionRatio;if(W!==p){if(!R)return c();W?c(!1,W):s=setTimeout(()=>{c(!1,1e-7)},1e3)}W===1&&!k1(m,t.getBoundingClientRect())&&c(),R=!1}try{r=new IntersectionObserver(E,{...P,root:i.ownerDocument})}catch{r=new IntersectionObserver(E,P)}r.observe(t)}return c(!0),o}function cI(t,n,r,s){s===void 0&&(s={});const{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:c=typeof ResizeObserver=="function",layoutShift:d=typeof IntersectionObserver=="function",animationFrame:p=!1}=s,m=yg(t),h=i||o?[...m?Rc(m):[],...Rc(n)]:[];h.forEach(S=>{i&&S.addEventListener("scroll",r,{passive:!0}),o&&S.addEventListener("resize",r)});const g=m&&d?lI(m,r):null;let v=-1,j=null;c&&(j=new ResizeObserver(S=>{let[k]=S;k&&k.target===m&&j&&(j.unobserve(n),cancelAnimationFrame(v),v=requestAnimationFrame(()=>{var P;(P=j)==null||P.observe(n)})),r()}),m&&!p&&j.observe(m),j.observe(n));let N,b=p?zi(t):null;p&&C();function C(){const S=zi(t);b&&!k1(b,S)&&r(),b=S,N=requestAnimationFrame(C)}return r(),()=>{var S;h.forEach(k=>{i&&k.removeEventListener("scroll",r),o&&k.removeEventListener("resize",r)}),g?.(),(S=j)==null||S.disconnect(),j=null,p&&cancelAnimationFrame(N)}}const dI=q_,uI=U_,pI=$_,mI=G_,hI=z_,eb=F_,fI=B_,xI=(t,n,r)=>{const s=new Map,i={platform:oI,...r},o={...i.platform,_c:s};return L_(t,n,{...i,platform:o})};var Mu=typeof document<"u"?x.useLayoutEffect:x.useEffect;function Ju(t,n){if(t===n)return!0;if(typeof t!=typeof n)return!1;if(typeof t=="function"&&t.toString()===n.toString())return!0;let r,s,i;if(t&&n&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==n.length)return!1;for(s=r;s--!==0;)if(!Ju(t[s],n[s]))return!1;return!0}if(i=Object.keys(t),r=i.length,r!==Object.keys(n).length)return!1;for(s=r;s--!==0;)if(!{}.hasOwnProperty.call(n,i[s]))return!1;for(s=r;s--!==0;){const o=i[s];if(!(o==="_owner"&&t.$$typeof)&&!Ju(t[o],n[o]))return!1}return!0}return t!==t&&n!==n}function E1(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function tb(t,n){const r=E1(t);return Math.round(n*r)/r}function uf(t){const n=x.useRef(t);return Mu(()=>{n.current=t}),n}function gI(t){t===void 0&&(t={});const{placement:n="bottom",strategy:r="absolute",middleware:s=[],platform:i,elements:{reference:o,floating:c}={},transform:d=!0,whileElementsMounted:p,open:m}=t,[h,g]=x.useState({x:0,y:0,strategy:r,placement:n,middlewareData:{},isPositioned:!1}),[v,j]=x.useState(s);Ju(v,s)||j(s);const[N,b]=x.useState(null),[C,S]=x.useState(null),k=x.useCallback(K=>{K!==A.current&&(A.current=K,b(K))},[]),P=x.useCallback(K=>{K!==W.current&&(W.current=K,S(K))},[]),R=o||N,E=c||C,A=x.useRef(null),W=x.useRef(null),X=x.useRef(h),se=p!=null,V=uf(p),G=uf(i),O=uf(m),F=x.useCallback(()=>{if(!A.current||!W.current)return;const K={placement:n,strategy:r,middleware:v};G.current&&(K.platform=G.current),xI(A.current,W.current,K).then(J=>{const D={...J,isPositioned:O.current!==!1};U.current&&!Ju(X.current,D)&&(X.current=D,cl.flushSync(()=>{g(D)}))})},[v,n,r,G,O]);Mu(()=>{m===!1&&X.current.isPositioned&&(X.current.isPositioned=!1,g(K=>({...K,isPositioned:!1})))},[m]);const U=x.useRef(!1);Mu(()=>(U.current=!0,()=>{U.current=!1}),[]),Mu(()=>{if(R&&(A.current=R),E&&(W.current=E),R&&E){if(V.current)return V.current(R,E,F);F()}},[R,E,F,V,se]);const $=x.useMemo(()=>({reference:A,floating:W,setReference:k,setFloating:P}),[k,P]),q=x.useMemo(()=>({reference:R,floating:E}),[R,E]),le=x.useMemo(()=>{const K={position:r,left:0,top:0};if(!q.floating)return K;const J=tb(q.floating,h.x),D=tb(q.floating,h.y);return d?{...K,transform:"translate("+J+"px, "+D+"px)",...E1(q.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:J,top:D}},[r,d,q.floating,h.x,h.y]);return x.useMemo(()=>({...h,update:F,refs:$,elements:q,floatingStyles:le}),[h,F,$,q,le])}const vI=t=>{function n(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:s,padding:i}=typeof t=="function"?t(r):t;return s&&n(s)?s.current!=null?eb({element:s.current,padding:i}).fn(r):{}:s?eb({element:s,padding:i}).fn(r):{}}}},yI=(t,n)=>({...dI(t),options:[t,n]}),jI=(t,n)=>({...uI(t),options:[t,n]}),bI=(t,n)=>({...fI(t),options:[t,n]}),wI=(t,n)=>({...pI(t),options:[t,n]}),NI=(t,n)=>({...mI(t),options:[t,n]}),CI=(t,n)=>({...hI(t),options:[t,n]}),SI=(t,n)=>({...vI(t),options:[t,n]});var kI="Arrow",P1=x.forwardRef((t,n)=>{const{children:r,width:s=10,height:i=5,...o}=t;return e.jsx(et.svg,{...o,ref:n,width:s,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:e.jsx("polygon",{points:"0,0 30,0 15,10"})})});P1.displayName=kI;var EI=P1;function _p(t){const[n,r]=x.useState(void 0);return On(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const s=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const o=i[0];let c,d;if("borderBoxSize"in o){const p=o.borderBoxSize,m=Array.isArray(p)?p[0]:p;c=m.inlineSize,d=m.blockSize}else c=t.offsetWidth,d=t.offsetHeight;r({width:c,height:d})});return s.observe(t,{box:"border-box"}),()=>s.unobserve(t)}else r(void 0)},[t]),n}var bg="Popper",[T1,xl]=Zn(bg),[PI,R1]=T1(bg),A1=t=>{const{__scopePopper:n,children:r}=t,[s,i]=x.useState(null);return e.jsx(PI,{scope:n,anchor:s,onAnchorChange:i,children:r})};A1.displayName=bg;var _1="PopperAnchor",I1=x.forwardRef((t,n)=>{const{__scopePopper:r,virtualRef:s,...i}=t,o=R1(_1,r),c=x.useRef(null),d=vt(n,c);return x.useEffect(()=>{o.onAnchorChange(s?.current||c.current)}),s?null:e.jsx(et.div,{...i,ref:d})});I1.displayName=_1;var wg="PopperContent",[TI,RI]=T1(wg),M1=x.forwardRef((t,n)=>{const{__scopePopper:r,side:s="bottom",sideOffset:i=0,align:o="center",alignOffset:c=0,arrowPadding:d=0,avoidCollisions:p=!0,collisionBoundary:m=[],collisionPadding:h=0,sticky:g="partial",hideWhenDetached:v=!1,updatePositionStrategy:j="optimized",onPlaced:N,...b}=t,C=R1(wg,r),[S,k]=x.useState(null),P=vt(n,xe=>k(xe)),[R,E]=x.useState(null),A=_p(R),W=A?.width??0,X=A?.height??0,se=s+(o!=="center"?"-"+o:""),V=typeof h=="number"?h:{top:0,right:0,bottom:0,left:0,...h},G=Array.isArray(m)?m:[m],O=G.length>0,F={padding:V,boundary:G.filter(_I),altBoundary:O},{refs:U,floatingStyles:$,placement:q,isPositioned:le,middlewareData:K}=gI({strategy:"fixed",placement:se,whileElementsMounted:(...xe)=>cI(...xe,{animationFrame:j==="always"}),elements:{reference:C.anchor},middleware:[yI({mainAxis:i+X,alignmentAxis:c}),p&&jI({mainAxis:!0,crossAxis:!1,limiter:g==="partial"?bI():void 0,...F}),p&&wI({...F}),NI({...F,apply:({elements:xe,rects:Se,availableWidth:Oe,availableHeight:Pe})=>{const{width:Be,height:ve}=Se.reference,We=xe.floating.style;We.setProperty("--radix-popper-available-width",`${Oe}px`),We.setProperty("--radix-popper-available-height",`${Pe}px`),We.setProperty("--radix-popper-anchor-width",`${Be}px`),We.setProperty("--radix-popper-anchor-height",`${ve}px`)}}),R&&SI({element:R,padding:d}),II({arrowWidth:W,arrowHeight:X}),v&&CI({strategy:"referenceHidden",...F})]}),[J,D]=L1(q),I=wn(N);On(()=>{le&&I?.()},[le,I]);const re=K.arrow?.x,T=K.arrow?.y,Y=K.arrow?.centerOffset!==0,[oe,Ne]=x.useState();return On(()=>{S&&Ne(window.getComputedStyle(S).zIndex)},[S]),e.jsx("div",{ref:U.setFloating,"data-radix-popper-content-wrapper":"",style:{...$,transform:le?$.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:oe,"--radix-popper-transform-origin":[K.transformOrigin?.x,K.transformOrigin?.y].join(" "),...K.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:e.jsx(TI,{scope:r,placedSide:J,onArrowChange:E,arrowX:re,arrowY:T,shouldHideArrow:Y,children:e.jsx(et.div,{"data-side":J,"data-align":D,...b,ref:P,style:{...b.style,animation:le?void 0:"none"}})})})});M1.displayName=wg;var O1="PopperArrow",AI={top:"bottom",right:"left",bottom:"top",left:"right"},D1=x.forwardRef(function(n,r){const{__scopePopper:s,...i}=n,o=RI(O1,s),c=AI[o.placedSide];return e.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[c]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:e.jsx(EI,{...i,ref:r,style:{...i.style,display:"block"}})})});D1.displayName=O1;function _I(t){return t!==null}var II=t=>({name:"transformOrigin",options:t,fn(n){const{placement:r,rects:s,middlewareData:i}=n,c=i.arrow?.centerOffset!==0,d=c?0:t.arrowWidth,p=c?0:t.arrowHeight,[m,h]=L1(r),g={start:"0%",center:"50%",end:"100%"}[h],v=(i.arrow?.x??0)+d/2,j=(i.arrow?.y??0)+p/2;let N="",b="";return m==="bottom"?(N=c?g:`${v}px`,b=`${-p}px`):m==="top"?(N=c?g:`${v}px`,b=`${s.floating.height+p}px`):m==="right"?(N=`${-p}px`,b=c?g:`${j}px`):m==="left"&&(N=`${s.floating.width+p}px`,b=c?g:`${j}px`),{data:{x:N,y:b}}}});function L1(t){const[n,r="center"]=t.split("-");return[n,r]}var Ng=A1,Cg=I1,Sg=M1,kg=D1,[Ip]=Zn("Tooltip",[xl]),Mp=xl(),F1="TooltipProvider",MI=700,px="tooltip.open",[OI,Eg]=Ip(F1),$1=t=>{const{__scopeTooltip:n,delayDuration:r=MI,skipDelayDuration:s=300,disableHoverableContent:i=!1,children:o}=t,c=x.useRef(!0),d=x.useRef(!1),p=x.useRef(0);return x.useEffect(()=>{const m=p.current;return()=>window.clearTimeout(m)},[]),e.jsx(OI,{scope:n,isOpenDelayedRef:c,delayDuration:r,onOpen:x.useCallback(()=>{window.clearTimeout(p.current),c.current=!1},[]),onClose:x.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>c.current=!0,s)},[s]),isPointerInTransitRef:d,onPointerInTransitChange:x.useCallback(m=>{d.current=m},[]),disableHoverableContent:i,children:o})};$1.displayName=F1;var Op="Tooltip",[DI,Dp]=Ip(Op),z1=t=>{const{__scopeTooltip:n,children:r,open:s,defaultOpen:i=!1,onOpenChange:o,disableHoverableContent:c,delayDuration:d}=t,p=Eg(Op,t.__scopeTooltip),m=Mp(n),[h,g]=x.useState(null),v=Qr(),j=x.useRef(0),N=c??p.disableHoverableContent,b=d??p.delayDuration,C=x.useRef(!1),[S=!1,k]=Zr({prop:s,defaultProp:i,onChange:W=>{W?(p.onOpen(),document.dispatchEvent(new CustomEvent(px))):p.onClose(),o?.(W)}}),P=x.useMemo(()=>S?C.current?"delayed-open":"instant-open":"closed",[S]),R=x.useCallback(()=>{window.clearTimeout(j.current),j.current=0,C.current=!1,k(!0)},[k]),E=x.useCallback(()=>{window.clearTimeout(j.current),j.current=0,k(!1)},[k]),A=x.useCallback(()=>{window.clearTimeout(j.current),j.current=window.setTimeout(()=>{C.current=!0,k(!0),j.current=0},b)},[b,k]);return x.useEffect(()=>()=>{j.current&&(window.clearTimeout(j.current),j.current=0)},[]),e.jsx(Ng,{...m,children:e.jsx(DI,{scope:n,contentId:v,open:S,stateAttribute:P,trigger:h,onTriggerChange:g,onTriggerEnter:x.useCallback(()=>{p.isOpenDelayedRef.current?A():R()},[p.isOpenDelayedRef,A,R]),onTriggerLeave:x.useCallback(()=>{N?E():(window.clearTimeout(j.current),j.current=0)},[E,N]),onOpen:R,onClose:E,disableHoverableContent:N,children:r})})};z1.displayName=Op;var mx="TooltipTrigger",V1=x.forwardRef((t,n)=>{const{__scopeTooltip:r,...s}=t,i=Dp(mx,r),o=Eg(mx,r),c=Mp(r),d=x.useRef(null),p=vt(n,d,i.onTriggerChange),m=x.useRef(!1),h=x.useRef(!1),g=x.useCallback(()=>m.current=!1,[]);return x.useEffect(()=>()=>document.removeEventListener("pointerup",g),[g]),e.jsx(Cg,{asChild:!0,...c,children:e.jsx(et.button,{"aria-describedby":i.open?i.contentId:void 0,"data-state":i.stateAttribute,...s,ref:p,onPointerMove:De(t.onPointerMove,v=>{v.pointerType!=="touch"&&!h.current&&!o.isPointerInTransitRef.current&&(i.onTriggerEnter(),h.current=!0)}),onPointerLeave:De(t.onPointerLeave,()=>{i.onTriggerLeave(),h.current=!1}),onPointerDown:De(t.onPointerDown,()=>{i.open&&i.onClose(),m.current=!0,document.addEventListener("pointerup",g,{once:!0})}),onFocus:De(t.onFocus,()=>{m.current||i.onOpen()}),onBlur:De(t.onBlur,i.onClose),onClick:De(t.onClick,i.onClose)})})});V1.displayName=mx;var LI="TooltipPortal",[p9,FI]=Ip(LI,{forceMount:void 0}),Qo="TooltipContent",q1=x.forwardRef((t,n)=>{const r=FI(Qo,t.__scopeTooltip),{forceMount:s=r.forceMount,side:i="top",...o}=t,c=Dp(Qo,t.__scopeTooltip);return e.jsx(gr,{present:s||c.open,children:c.disableHoverableContent?e.jsx(U1,{side:i,...o,ref:n}):e.jsx($I,{side:i,...o,ref:n})})}),$I=x.forwardRef((t,n)=>{const r=Dp(Qo,t.__scopeTooltip),s=Eg(Qo,t.__scopeTooltip),i=x.useRef(null),o=vt(n,i),[c,d]=x.useState(null),{trigger:p,onClose:m}=r,h=i.current,{onPointerInTransitChange:g}=s,v=x.useCallback(()=>{d(null),g(!1)},[g]),j=x.useCallback((N,b)=>{const C=N.currentTarget,S={x:N.clientX,y:N.clientY},k=BI(S,C.getBoundingClientRect()),P=GI(S,k),R=HI(b.getBoundingClientRect()),E=WI([...P,...R]);d(E),g(!0)},[g]);return x.useEffect(()=>()=>v(),[v]),x.useEffect(()=>{if(p&&h){const N=C=>j(C,h),b=C=>j(C,p);return p.addEventListener("pointerleave",N),h.addEventListener("pointerleave",b),()=>{p.removeEventListener("pointerleave",N),h.removeEventListener("pointerleave",b)}}},[p,h,j,v]),x.useEffect(()=>{if(c){const N=b=>{const C=b.target,S={x:b.clientX,y:b.clientY},k=p?.contains(C)||h?.contains(C),P=!KI(S,c);k?v():P&&(v(),m())};return document.addEventListener("pointermove",N),()=>document.removeEventListener("pointermove",N)}},[p,h,c,m,v]),e.jsx(U1,{...t,ref:o})}),[zI,VI]=Ip(Op,{isInside:!1}),qI=NN("TooltipContent"),U1=x.forwardRef((t,n)=>{const{__scopeTooltip:r,children:s,"aria-label":i,onEscapeKeyDown:o,onPointerDownOutside:c,...d}=t,p=Dp(Qo,r),m=Mp(r),{onClose:h}=p;return x.useEffect(()=>(document.addEventListener(px,h),()=>document.removeEventListener(px,h)),[h]),x.useEffect(()=>{if(p.trigger){const g=v=>{v.target?.contains(p.trigger)&&h()};return window.addEventListener("scroll",g,{capture:!0}),()=>window.removeEventListener("scroll",g,{capture:!0})}},[p.trigger,h]),e.jsx(ul,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:c,onFocusOutside:g=>g.preventDefault(),onDismiss:h,children:e.jsxs(Sg,{"data-state":p.stateAttribute,...m,...d,ref:n,style:{...d.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(qI,{children:s}),e.jsx(zI,{scope:r,isInside:!0,children:e.jsx(qR,{id:p.contentId,role:"tooltip",children:i||s})})]})})});q1.displayName=Qo;var B1="TooltipArrow",UI=x.forwardRef((t,n)=>{const{__scopeTooltip:r,...s}=t,i=Mp(r);return VI(B1,r).isInside?null:e.jsx(kg,{...i,...s,ref:n})});UI.displayName=B1;function BI(t,n){const r=Math.abs(n.top-t.y),s=Math.abs(n.bottom-t.y),i=Math.abs(n.right-t.x),o=Math.abs(n.left-t.x);switch(Math.min(r,s,i,o)){case o:return"left";case i:return"right";case r:return"top";case s:return"bottom";default:throw new Error("unreachable")}}function GI(t,n,r=5){const s=[];switch(n){case"top":s.push({x:t.x-r,y:t.y+r},{x:t.x+r,y:t.y+r});break;case"bottom":s.push({x:t.x-r,y:t.y-r},{x:t.x+r,y:t.y-r});break;case"left":s.push({x:t.x+r,y:t.y-r},{x:t.x+r,y:t.y+r});break;case"right":s.push({x:t.x-r,y:t.y-r},{x:t.x-r,y:t.y+r});break}return s}function HI(t){const{top:n,right:r,bottom:s,left:i}=t;return[{x:i,y:n},{x:r,y:n},{x:r,y:s},{x:i,y:s}]}function KI(t,n){const{x:r,y:s}=t;let i=!1;for(let o=0,c=n.length-1;o<n.length;c=o++){const d=n[o].x,p=n[o].y,m=n[c].x,h=n[c].y;p>s!=h>s&&r<(m-d)*(s-p)/(h-p)+d&&(i=!i)}return i}function WI(t){const n=t.slice();return n.sort((r,s)=>r.x<s.x?-1:r.x>s.x?1:r.y<s.y?-1:r.y>s.y?1:0),QI(n)}function QI(t){if(t.length<=1)return t.slice();const n=[];for(let s=0;s<t.length;s++){const i=t[s];for(;n.length>=2;){const o=n[n.length-1],c=n[n.length-2];if((o.x-c.x)*(i.y-c.y)>=(o.y-c.y)*(i.x-c.x))n.pop();else break}n.push(i)}n.pop();const r=[];for(let s=t.length-1;s>=0;s--){const i=t[s];for(;r.length>=2;){const o=r[r.length-1],c=r[r.length-2];if((o.x-c.x)*(i.y-c.y)>=(o.y-c.y)*(i.x-c.x))r.pop();else break}r.push(i)}return r.pop(),n.length===1&&r.length===1&&n[0].x===r[0].x&&n[0].y===r[0].y?n:n.concat(r)}var YI=$1,ZI=z1,XI=V1,G1=q1;const H1=YI,ei=ZI,ti=XI,ua=x.forwardRef(({className:t,sideOffset:n=4,...r},s)=>e.jsx(G1,{ref:s,sideOffset:n,className:Ae("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",t),...r}));ua.displayName=G1.displayName;const K1=x.createContext(void 0);function JI({children:t}){const[n,r]=x.useState(()=>{if(typeof window<"u"){const i=localStorage.getItem("theme");return i||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}return"dark"});x.useEffect(()=>{const i=window.document.documentElement;i.classList.remove("light","dark"),i.classList.add(n),localStorage.setItem("theme",n)},[n]);const s=()=>{r(n==="dark"?"light":"dark")};return e.jsx(K1.Provider,{value:{theme:n,setTheme:r,toggleTheme:s},children:t})}function eM(){const t=x.useContext(K1);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t}const Pg=Bi("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover-elevate active-elevate-2",{variants:{variant:{default:"bg-primary text-primary-foreground border border-primary-border",destructive:"bg-destructive text-destructive-foreground border border-destructive-border",outline:" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none ",secondary:"border bg-secondary text-secondary-foreground border border-secondary-border ",ghost:"border border-transparent"},size:{default:"min-h-9 px-4 py-2",sm:"min-h-8 rounded-md px-3 text-xs",lg:"min-h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),B=x.forwardRef(({className:t,variant:n,size:r,asChild:s=!1,...i},o)=>{const c=s?Np:"button";return e.jsx(c,{className:Ae(Pg({variant:n,size:r,className:t})),ref:o,...i})});B.displayName="Button";function tM(){const{theme:t,toggleTheme:n}=eM();return e.jsx(B,{variant:"ghost",size:"icon",onClick:n,"data-testid":"button-theme-toggle",children:t==="dark"?e.jsx(VA,{className:"h-5 w-5"}):e.jsx(IA,{className:"h-5 w-5"})})}const pf=768;function nM(){const[t,n]=x.useState(void 0);return x.useEffect(()=>{const r=window.matchMedia(`(max-width: ${pf-1}px)`),s=()=>{n(window.innerWidth<pf)};return r.addEventListener("change",s),n(window.innerWidth<pf),()=>r.removeEventListener("change",s)},[]),!!t}const gt=x.forwardRef(({className:t,type:n,...r},s)=>e.jsx("input",{type:n,className:Ae("flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...r}));gt.displayName="Input";var rM="Separator",nb="horizontal",sM=["horizontal","vertical"],W1=x.forwardRef((t,n)=>{const{decorative:r,orientation:s=nb,...i}=t,o=aM(s)?s:nb,d=r?{role:"none"}:{"aria-orientation":o==="vertical"?o:void 0,role:"separator"};return e.jsx(et.div,{"data-orientation":o,...d,...i,ref:n})});W1.displayName=rM;function aM(t){return sM.includes(t)}var Q1=W1;const Mo=x.forwardRef(({className:t,orientation:n="horizontal",decorative:r=!0,...s},i)=>e.jsx(Q1,{ref:i,decorative:r,orientation:n,className:Ae("shrink-0 bg-border",n==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...s}));Mo.displayName=Q1.displayName;var mf="focusScope.autoFocusOnMount",hf="focusScope.autoFocusOnUnmount",rb={bubbles:!1,cancelable:!0},iM="FocusScope",Lp=x.forwardRef((t,n)=>{const{loop:r=!1,trapped:s=!1,onMountAutoFocus:i,onUnmountAutoFocus:o,...c}=t,[d,p]=x.useState(null),m=wn(i),h=wn(o),g=x.useRef(null),v=vt(n,b=>p(b)),j=x.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;x.useEffect(()=>{if(s){let b=function(P){if(j.paused||!d)return;const R=P.target;d.contains(R)?g.current=R:Qa(g.current,{select:!0})},C=function(P){if(j.paused||!d)return;const R=P.relatedTarget;R!==null&&(d.contains(R)||Qa(g.current,{select:!0}))},S=function(P){if(document.activeElement===document.body)for(const E of P)E.removedNodes.length>0&&Qa(d)};document.addEventListener("focusin",b),document.addEventListener("focusout",C);const k=new MutationObserver(S);return d&&k.observe(d,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",C),k.disconnect()}}},[s,d,j.paused]),x.useEffect(()=>{if(d){ab.add(j);const b=document.activeElement;if(!d.contains(b)){const S=new CustomEvent(mf,rb);d.addEventListener(mf,m),d.dispatchEvent(S),S.defaultPrevented||(oM(pM(Y1(d)),{select:!0}),document.activeElement===b&&Qa(d))}return()=>{d.removeEventListener(mf,m),setTimeout(()=>{const S=new CustomEvent(hf,rb);d.addEventListener(hf,h),d.dispatchEvent(S),S.defaultPrevented||Qa(b??document.body,{select:!0}),d.removeEventListener(hf,h),ab.remove(j)},0)}}},[d,m,h,j]);const N=x.useCallback(b=>{if(!r&&!s||j.paused)return;const C=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,S=document.activeElement;if(C&&S){const k=b.currentTarget,[P,R]=lM(k);P&&R?!b.shiftKey&&S===R?(b.preventDefault(),r&&Qa(P,{select:!0})):b.shiftKey&&S===P&&(b.preventDefault(),r&&Qa(R,{select:!0})):S===k&&b.preventDefault()}},[r,s,j.paused]);return e.jsx(et.div,{tabIndex:-1,...c,ref:v,onKeyDown:N})});Lp.displayName=iM;function oM(t,{select:n=!1}={}){const r=document.activeElement;for(const s of t)if(Qa(s,{select:n}),document.activeElement!==r)return}function lM(t){const n=Y1(t),r=sb(n,t),s=sb(n.reverse(),t);return[r,s]}function Y1(t){const n=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const i=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||i?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)n.push(r.currentNode);return n}function sb(t,n){for(const r of t)if(!cM(r,{upTo:n}))return r}function cM(t,{upTo:n}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(n!==void 0&&t===n)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function dM(t){return t instanceof HTMLInputElement&&"select"in t}function Qa(t,{select:n=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&dM(t)&&n&&t.select()}}var ab=uM();function uM(){let t=[];return{add(n){const r=t[0];n!==r&&r?.pause(),t=ib(t,n),t.unshift(n)},remove(n){t=ib(t,n),t[0]?.resume()}}}function ib(t,n){const r=[...t],s=r.indexOf(n);return s!==-1&&r.splice(s,1),r}function pM(t){return t.filter(n=>n.tagName!=="A")}var ff=0;function Tg(){x.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??ob()),document.body.insertAdjacentElement("beforeend",t[1]??ob()),ff++,()=>{ff===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(n=>n.remove()),ff--}},[])}function ob(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var $s=function(){return $s=Object.assign||function(n){for(var r,s=1,i=arguments.length;s<i;s++){r=arguments[s];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])}return n},$s.apply(this,arguments)};function Z1(t,n){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&n.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(t);i<s.length;i++)n.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(t,s[i])&&(r[s[i]]=t[s[i]]);return r}function mM(t,n,r){if(r||arguments.length===2)for(var s=0,i=n.length,o;s<i;s++)(o||!(s in n))&&(o||(o=Array.prototype.slice.call(n,0,s)),o[s]=n[s]);return t.concat(o||Array.prototype.slice.call(n))}var Ou="right-scroll-bar-position",Du="width-before-scroll-bar",hM="with-scroll-bars-hidden",fM="--removed-body-scroll-bar-size";function xf(t,n){return typeof t=="function"?t(n):t&&(t.current=n),t}function xM(t,n){var r=x.useState(function(){return{value:t,callback:n,facade:{get current(){return r.value},set current(s){var i=r.value;i!==s&&(r.value=s,r.callback(s,i))}}}})[0];return r.callback=n,r.facade}var gM=typeof window<"u"?x.useLayoutEffect:x.useEffect,lb=new WeakMap;function vM(t,n){var r=xM(null,function(s){return t.forEach(function(i){return xf(i,s)})});return gM(function(){var s=lb.get(r);if(s){var i=new Set(s),o=new Set(t),c=r.current;i.forEach(function(d){o.has(d)||xf(d,null)}),o.forEach(function(d){i.has(d)||xf(d,c)})}lb.set(r,t)},[t]),r}function yM(t){return t}function jM(t,n){n===void 0&&(n=yM);var r=[],s=!1,i={read:function(){if(s)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:t},useMedium:function(o){var c=n(o,s);return r.push(c),function(){r=r.filter(function(d){return d!==c})}},assignSyncMedium:function(o){for(s=!0;r.length;){var c=r;r=[],c.forEach(o)}r={push:function(d){return o(d)},filter:function(){return r}}},assignMedium:function(o){s=!0;var c=[];if(r.length){var d=r;r=[],d.forEach(o),c=r}var p=function(){var h=c;c=[],h.forEach(o)},m=function(){return Promise.resolve().then(p)};m(),r={push:function(h){c.push(h),m()},filter:function(h){return c=c.filter(h),r}}}};return i}function bM(t){t===void 0&&(t={});var n=jM(null);return n.options=$s({async:!0,ssr:!1},t),n}var X1=function(t){var n=t.sideCar,r=Z1(t,["sideCar"]);if(!n)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var s=n.read();if(!s)throw new Error("Sidecar medium not found");return x.createElement(s,$s({},r))};X1.isSideCarExport=!0;function wM(t,n){return t.useMedium(n),X1}var J1=bM(),gf=function(){},Fp=x.forwardRef(function(t,n){var r=x.useRef(null),s=x.useState({onScrollCapture:gf,onWheelCapture:gf,onTouchMoveCapture:gf}),i=s[0],o=s[1],c=t.forwardProps,d=t.children,p=t.className,m=t.removeScrollBar,h=t.enabled,g=t.shards,v=t.sideCar,j=t.noIsolation,N=t.inert,b=t.allowPinchZoom,C=t.as,S=C===void 0?"div":C,k=t.gapMode,P=Z1(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),R=v,E=vM([r,n]),A=$s($s({},P),i);return x.createElement(x.Fragment,null,h&&x.createElement(R,{sideCar:J1,removeScrollBar:m,shards:g,noIsolation:j,inert:N,setCallbacks:o,allowPinchZoom:!!b,lockRef:r,gapMode:k}),c?x.cloneElement(x.Children.only(d),$s($s({},A),{ref:E})):x.createElement(S,$s({},A,{className:p,ref:E}),d))});Fp.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Fp.classNames={fullWidth:Du,zeroRight:Ou};var NM=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function CM(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var n=NM();return n&&t.setAttribute("nonce",n),t}function SM(t,n){t.styleSheet?t.styleSheet.cssText=n:t.appendChild(document.createTextNode(n))}function kM(t){var n=document.head||document.getElementsByTagName("head")[0];n.appendChild(t)}var EM=function(){var t=0,n=null;return{add:function(r){t==0&&(n=CM())&&(SM(n,r),kM(n)),t++},remove:function(){t--,!t&&n&&(n.parentNode&&n.parentNode.removeChild(n),n=null)}}},PM=function(){var t=EM();return function(n,r){x.useEffect(function(){return t.add(n),function(){t.remove()}},[n&&r])}},eC=function(){var t=PM(),n=function(r){var s=r.styles,i=r.dynamic;return t(s,i),null};return n},TM={left:0,top:0,right:0,gap:0},vf=function(t){return parseInt(t||"",10)||0},RM=function(t){var n=window.getComputedStyle(document.body),r=n[t==="padding"?"paddingLeft":"marginLeft"],s=n[t==="padding"?"paddingTop":"marginTop"],i=n[t==="padding"?"paddingRight":"marginRight"];return[vf(r),vf(s),vf(i)]},AM=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return TM;var n=RM(t),r=document.documentElement.clientWidth,s=window.innerWidth;return{left:n[0],top:n[1],right:n[2],gap:Math.max(0,s-r+n[2]-n[0])}},_M=eC(),$o="data-scroll-locked",IM=function(t,n,r,s){var i=t.left,o=t.top,c=t.right,d=t.gap;return r===void 0&&(r="margin"),`
  .`.concat(hM,` {
   overflow: hidden `).concat(s,`;
   padding-right: `).concat(d,"px ").concat(s,`;
  }
  body[`).concat($o,`] {
    overflow: hidden `).concat(s,`;
    overscroll-behavior: contain;
    `).concat([n&&"position: relative ".concat(s,";"),r==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(c,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(d,"px ").concat(s,`;
    `),r==="padding"&&"padding-right: ".concat(d,"px ").concat(s,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Ou,` {
    right: `).concat(d,"px ").concat(s,`;
  }
  
  .`).concat(Du,` {
    margin-right: `).concat(d,"px ").concat(s,`;
  }
  
  .`).concat(Ou," .").concat(Ou,` {
    right: 0 `).concat(s,`;
  }
  
  .`).concat(Du," .").concat(Du,` {
    margin-right: 0 `).concat(s,`;
  }
  
  body[`).concat($o,`] {
    `).concat(fM,": ").concat(d,`px;
  }
`)},cb=function(){var t=parseInt(document.body.getAttribute($o)||"0",10);return isFinite(t)?t:0},MM=function(){x.useEffect(function(){return document.body.setAttribute($o,(cb()+1).toString()),function(){var t=cb()-1;t<=0?document.body.removeAttribute($o):document.body.setAttribute($o,t.toString())}},[])},OM=function(t){var n=t.noRelative,r=t.noImportant,s=t.gapMode,i=s===void 0?"margin":s;MM();var o=x.useMemo(function(){return AM(i)},[i]);return x.createElement(_M,{styles:IM(o,!n,i,r?"":"!important")})},hx=!1;if(typeof window<"u")try{var yu=Object.defineProperty({},"passive",{get:function(){return hx=!0,!0}});window.addEventListener("test",yu,yu),window.removeEventListener("test",yu,yu)}catch{hx=!1}var No=hx?{passive:!1}:!1,DM=function(t){return t.tagName==="TEXTAREA"},tC=function(t,n){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[n]!=="hidden"&&!(r.overflowY===r.overflowX&&!DM(t)&&r[n]==="visible")},LM=function(t){return tC(t,"overflowY")},FM=function(t){return tC(t,"overflowX")},db=function(t,n){var r=n.ownerDocument,s=n;do{typeof ShadowRoot<"u"&&s instanceof ShadowRoot&&(s=s.host);var i=nC(t,s);if(i){var o=rC(t,s),c=o[1],d=o[2];if(c>d)return!0}s=s.parentNode}while(s&&s!==r.body);return!1},$M=function(t){var n=t.scrollTop,r=t.scrollHeight,s=t.clientHeight;return[n,r,s]},zM=function(t){var n=t.scrollLeft,r=t.scrollWidth,s=t.clientWidth;return[n,r,s]},nC=function(t,n){return t==="v"?LM(n):FM(n)},rC=function(t,n){return t==="v"?$M(n):zM(n)},VM=function(t,n){return t==="h"&&n==="rtl"?-1:1},qM=function(t,n,r,s,i){var o=VM(t,window.getComputedStyle(n).direction),c=o*s,d=r.target,p=n.contains(d),m=!1,h=c>0,g=0,v=0;do{var j=rC(t,d),N=j[0],b=j[1],C=j[2],S=b-C-o*N;(N||S)&&nC(t,d)&&(g+=S,v+=N),d instanceof ShadowRoot?d=d.host:d=d.parentNode}while(!p&&d!==document.body||p&&(n.contains(d)||n===d));return(h&&Math.abs(g)<1||!h&&Math.abs(v)<1)&&(m=!0),m},ju=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},ub=function(t){return[t.deltaX,t.deltaY]},pb=function(t){return t&&"current"in t?t.current:t},UM=function(t,n){return t[0]===n[0]&&t[1]===n[1]},BM=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},GM=0,Co=[];function HM(t){var n=x.useRef([]),r=x.useRef([0,0]),s=x.useRef(),i=x.useState(GM++)[0],o=x.useState(eC)[0],c=x.useRef(t);x.useEffect(function(){c.current=t},[t]),x.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var b=mM([t.lockRef.current],(t.shards||[]).map(pb),!0).filter(Boolean);return b.forEach(function(C){return C.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),b.forEach(function(C){return C.classList.remove("allow-interactivity-".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var d=x.useCallback(function(b,C){if("touches"in b&&b.touches.length===2||b.type==="wheel"&&b.ctrlKey)return!c.current.allowPinchZoom;var S=ju(b),k=r.current,P="deltaX"in b?b.deltaX:k[0]-S[0],R="deltaY"in b?b.deltaY:k[1]-S[1],E,A=b.target,W=Math.abs(P)>Math.abs(R)?"h":"v";if("touches"in b&&W==="h"&&A.type==="range")return!1;var X=db(W,A);if(!X)return!0;if(X?E=W:(E=W==="v"?"h":"v",X=db(W,A)),!X)return!1;if(!s.current&&"changedTouches"in b&&(P||R)&&(s.current=E),!E)return!0;var se=s.current||E;return qM(se,C,b,se==="h"?P:R)},[]),p=x.useCallback(function(b){var C=b;if(!(!Co.length||Co[Co.length-1]!==o)){var S="deltaY"in C?ub(C):ju(C),k=n.current.filter(function(E){return E.name===C.type&&(E.target===C.target||C.target===E.shadowParent)&&UM(E.delta,S)})[0];if(k&&k.should){C.cancelable&&C.preventDefault();return}if(!k){var P=(c.current.shards||[]).map(pb).filter(Boolean).filter(function(E){return E.contains(C.target)}),R=P.length>0?d(C,P[0]):!c.current.noIsolation;R&&C.cancelable&&C.preventDefault()}}},[]),m=x.useCallback(function(b,C,S,k){var P={name:b,delta:C,target:S,should:k,shadowParent:KM(S)};n.current.push(P),setTimeout(function(){n.current=n.current.filter(function(R){return R!==P})},1)},[]),h=x.useCallback(function(b){r.current=ju(b),s.current=void 0},[]),g=x.useCallback(function(b){m(b.type,ub(b),b.target,d(b,t.lockRef.current))},[]),v=x.useCallback(function(b){m(b.type,ju(b),b.target,d(b,t.lockRef.current))},[]);x.useEffect(function(){return Co.push(o),t.setCallbacks({onScrollCapture:g,onWheelCapture:g,onTouchMoveCapture:v}),document.addEventListener("wheel",p,No),document.addEventListener("touchmove",p,No),document.addEventListener("touchstart",h,No),function(){Co=Co.filter(function(b){return b!==o}),document.removeEventListener("wheel",p,No),document.removeEventListener("touchmove",p,No),document.removeEventListener("touchstart",h,No)}},[]);var j=t.removeScrollBar,N=t.inert;return x.createElement(x.Fragment,null,N?x.createElement(o,{styles:BM(i)}):null,j?x.createElement(OM,{gapMode:t.gapMode}):null)}function KM(t){for(var n=null;t!==null;)t instanceof ShadowRoot&&(n=t.host,t=t.host),t=t.parentNode;return n}const WM=wM(J1,HM);var $p=x.forwardRef(function(t,n){return x.createElement(Fp,$s({},t,{ref:n,sideCar:WM}))});$p.classNames=Fp.classNames;var QM=function(t){if(typeof document>"u")return null;var n=Array.isArray(t)?t[0]:t;return n.ownerDocument.body},So=new WeakMap,bu=new WeakMap,wu={},yf=0,sC=function(t){return t&&(t.host||sC(t.parentNode))},YM=function(t,n){return n.map(function(r){if(t.contains(r))return r;var s=sC(r);return s&&t.contains(s)?s:(console.error("aria-hidden",r,"in not contained inside",t,". Doing nothing"),null)}).filter(function(r){return!!r})},ZM=function(t,n,r,s){var i=YM(n,Array.isArray(t)?t:[t]);wu[r]||(wu[r]=new WeakMap);var o=wu[r],c=[],d=new Set,p=new Set(i),m=function(g){!g||d.has(g)||(d.add(g),m(g.parentNode))};i.forEach(m);var h=function(g){!g||p.has(g)||Array.prototype.forEach.call(g.children,function(v){if(d.has(v))h(v);else try{var j=v.getAttribute(s),N=j!==null&&j!=="false",b=(So.get(v)||0)+1,C=(o.get(v)||0)+1;So.set(v,b),o.set(v,C),c.push(v),b===1&&N&&bu.set(v,!0),C===1&&v.setAttribute(r,"true"),N||v.setAttribute(s,"true")}catch(S){console.error("aria-hidden: cannot operate on ",v,S)}})};return h(n),d.clear(),yf++,function(){c.forEach(function(g){var v=So.get(g)-1,j=o.get(g)-1;So.set(g,v),o.set(g,j),v||(bu.has(g)||g.removeAttribute(s),bu.delete(g)),j||g.removeAttribute(r)}),yf--,yf||(So=new WeakMap,So=new WeakMap,bu=new WeakMap,wu={})}},Rg=function(t,n,r){r===void 0&&(r="data-aria-hidden");var s=Array.from(Array.isArray(t)?t:[t]),i=QM(t);return i?(s.push.apply(s,Array.from(i.querySelectorAll("[aria-live]"))),ZM(s,i,r,"aria-hidden")):function(){return null}},Ag="Dialog",[aC,iC]=Zn(Ag),[XM,Ps]=aC(Ag),oC=t=>{const{__scopeDialog:n,children:r,open:s,defaultOpen:i,onOpenChange:o,modal:c=!0}=t,d=x.useRef(null),p=x.useRef(null),[m=!1,h]=Zr({prop:s,defaultProp:i,onChange:o});return e.jsx(XM,{scope:n,triggerRef:d,contentRef:p,contentId:Qr(),titleId:Qr(),descriptionId:Qr(),open:m,onOpenChange:h,onOpenToggle:x.useCallback(()=>h(g=>!g),[h]),modal:c,children:r})};oC.displayName=Ag;var lC="DialogTrigger",cC=x.forwardRef((t,n)=>{const{__scopeDialog:r,...s}=t,i=Ps(lC,r),o=vt(n,i.triggerRef);return e.jsx(et.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":Mg(i.open),...s,ref:o,onClick:De(t.onClick,i.onOpenToggle)})});cC.displayName=lC;var _g="DialogPortal",[JM,dC]=aC(_g,{forceMount:void 0}),uC=t=>{const{__scopeDialog:n,forceMount:r,children:s,container:i}=t,o=Ps(_g,n);return e.jsx(JM,{scope:n,forceMount:r,children:x.Children.map(s,c=>e.jsx(gr,{present:r||o.open,children:e.jsx(Gc,{asChild:!0,container:i,children:c})}))})};uC.displayName=_g;var ep="DialogOverlay",pC=x.forwardRef((t,n)=>{const r=dC(ep,t.__scopeDialog),{forceMount:s=r.forceMount,...i}=t,o=Ps(ep,t.__scopeDialog);return o.modal?e.jsx(gr,{present:s||o.open,children:e.jsx(tO,{...i,ref:n})}):null});pC.displayName=ep;var eO=Li("DialogOverlay.RemoveScroll"),tO=x.forwardRef((t,n)=>{const{__scopeDialog:r,...s}=t,i=Ps(ep,r);return e.jsx($p,{as:eO,allowPinchZoom:!0,shards:[i.contentRef],children:e.jsx(et.div,{"data-state":Mg(i.open),...s,ref:n,style:{pointerEvents:"auto",...s.style}})})}),Vi="DialogContent",mC=x.forwardRef((t,n)=>{const r=dC(Vi,t.__scopeDialog),{forceMount:s=r.forceMount,...i}=t,o=Ps(Vi,t.__scopeDialog);return e.jsx(gr,{present:s||o.open,children:o.modal?e.jsx(nO,{...i,ref:n}):e.jsx(rO,{...i,ref:n})})});mC.displayName=Vi;var nO=x.forwardRef((t,n)=>{const r=Ps(Vi,t.__scopeDialog),s=x.useRef(null),i=vt(n,r.contentRef,s);return x.useEffect(()=>{const o=s.current;if(o)return Rg(o)},[]),e.jsx(hC,{...t,ref:i,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:De(t.onCloseAutoFocus,o=>{o.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:De(t.onPointerDownOutside,o=>{const c=o.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0;(c.button===2||d)&&o.preventDefault()}),onFocusOutside:De(t.onFocusOutside,o=>o.preventDefault())})}),rO=x.forwardRef((t,n)=>{const r=Ps(Vi,t.__scopeDialog),s=x.useRef(!1),i=x.useRef(!1);return e.jsx(hC,{...t,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{t.onCloseAutoFocus?.(o),o.defaultPrevented||(s.current||r.triggerRef.current?.focus(),o.preventDefault()),s.current=!1,i.current=!1},onInteractOutside:o=>{t.onInteractOutside?.(o),o.defaultPrevented||(s.current=!0,o.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const c=o.target;r.triggerRef.current?.contains(c)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&i.current&&o.preventDefault()}})}),hC=x.forwardRef((t,n)=>{const{__scopeDialog:r,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:o,...c}=t,d=Ps(Vi,r),p=x.useRef(null),m=vt(n,p);return Tg(),e.jsxs(e.Fragment,{children:[e.jsx(Lp,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:i,onUnmountAutoFocus:o,children:e.jsx(ul,{role:"dialog",id:d.contentId,"aria-describedby":d.descriptionId,"aria-labelledby":d.titleId,"data-state":Mg(d.open),...c,ref:m,onDismiss:()=>d.onOpenChange(!1)})}),e.jsxs(e.Fragment,{children:[e.jsx(aO,{titleId:d.titleId}),e.jsx(oO,{contentRef:p,descriptionId:d.descriptionId})]})]})}),Ig="DialogTitle",fC=x.forwardRef((t,n)=>{const{__scopeDialog:r,...s}=t,i=Ps(Ig,r);return e.jsx(et.h2,{id:i.titleId,...s,ref:n})});fC.displayName=Ig;var xC="DialogDescription",gC=x.forwardRef((t,n)=>{const{__scopeDialog:r,...s}=t,i=Ps(xC,r);return e.jsx(et.p,{id:i.descriptionId,...s,ref:n})});gC.displayName=xC;var vC="DialogClose",yC=x.forwardRef((t,n)=>{const{__scopeDialog:r,...s}=t,i=Ps(vC,r);return e.jsx(et.button,{type:"button",...s,ref:n,onClick:De(t.onClick,()=>i.onOpenChange(!1))})});yC.displayName=vC;function Mg(t){return t?"open":"closed"}var jC="DialogTitleWarning",[sO,bC]=jR(jC,{contentName:Vi,titleName:Ig,docsSlug:"dialog"}),aO=({titleId:t})=>{const n=bC(jC),r=`\`${n.contentName}\` requires a \`${n.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${n.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${n.docsSlug}`;return x.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},iO="DialogDescriptionWarning",oO=({contentRef:t,descriptionId:n})=>{const s=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${bC(iO).contentName}}.`;return x.useEffect(()=>{const i=t.current?.getAttribute("aria-describedby");n&&i&&(document.getElementById(n)||console.warn(s))},[s,t,n]),null},Og=oC,wC=cC,Dg=uC,Yc=pC,Zc=mC,Xc=fC,Jc=gC,zp=yC;const lO=Og,cO=Dg,NC=x.forwardRef(({className:t,...n},r)=>e.jsx(Yc,{className:Ae("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n,ref:r}));NC.displayName=Yc.displayName;const dO=Bi("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),CC=x.forwardRef(({side:t="right",className:n,children:r,...s},i)=>e.jsxs(cO,{children:[e.jsx(NC,{}),e.jsxs(Zc,{ref:i,className:Ae(dO({side:t}),n),...s,children:[r,e.jsxs(zp,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(Gn,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));CC.displayName=Zc.displayName;const SC=({className:t,...n})=>e.jsx("div",{className:Ae("flex flex-col space-y-2 text-center sm:text-left",t),...n});SC.displayName="SheetHeader";const kC=x.forwardRef(({className:t,...n},r)=>e.jsx(Xc,{ref:r,className:Ae("text-lg font-semibold text-foreground",t),...n}));kC.displayName=Xc.displayName;const EC=x.forwardRef(({className:t,...n},r)=>e.jsx(Jc,{ref:r,className:Ae("text-sm text-muted-foreground",t),...n}));EC.displayName=Jc.displayName;function jf({className:t,...n}){return e.jsx("div",{className:Ae("animate-pulse rounded-md bg-muted",t),...n})}const uO="sidebar_state",pO=3600*24*7,mO="16rem",hO="18rem",fO="3rem",xO="b",PC=x.createContext(null);function Lg(){const t=x.useContext(PC);if(!t)throw new Error("useSidebar must be used within a SidebarProvider.");return t}function gO({defaultOpen:t=!0,open:n,onOpenChange:r,className:s,style:i,children:o,...c}){const d=nM(),[p,m]=x.useState(!1),[h,g]=x.useState(t),v=n??h,j=x.useCallback(S=>{const k=typeof S=="function"?S(v):S;r?r(k):g(k),document.cookie=`${uO}=${k}; path=/; max-age=${pO}`},[r,v]),N=x.useCallback(()=>d?m(S=>!S):j(S=>!S),[d,j,m]);x.useEffect(()=>{const S=k=>{k.key===xO&&(k.metaKey||k.ctrlKey)&&(k.preventDefault(),N())};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[N]);const b=v?"expanded":"collapsed",C=x.useMemo(()=>({state:b,open:v,setOpen:j,isMobile:d,openMobile:p,setOpenMobile:m,toggleSidebar:N}),[b,v,j,d,p,m,N]);return e.jsx(PC.Provider,{value:C,children:e.jsx(H1,{delayDuration:0,children:e.jsx("div",{"data-slot":"sidebar-wrapper",style:{"--sidebar-width":mO,"--sidebar-width-icon":fO,...i},className:Ae("group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full",s),...c,children:o})})})}function vO({side:t="left",variant:n="sidebar",collapsible:r="offcanvas",className:s,children:i,...o}){const{isMobile:c,state:d,openMobile:p,setOpenMobile:m}=Lg();return r==="none"?e.jsx("div",{"data-slot":"sidebar",className:Ae("bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col",s),...o,children:i}):c?e.jsx(lO,{open:p,onOpenChange:m,...o,children:e.jsxs(CC,{"data-sidebar":"sidebar","data-slot":"sidebar","data-mobile":"true",className:"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden",style:{"--sidebar-width":hO},side:t,children:[e.jsxs(SC,{className:"sr-only",children:[e.jsx(kC,{children:"Sidebar"}),e.jsx(EC,{children:"Displays the mobile sidebar."})]}),e.jsx("div",{className:"flex h-full w-full flex-col",children:i})]})}):e.jsxs("div",{className:"group peer text-sidebar-foreground hidden md:block","data-state":d,"data-collapsible":d==="collapsed"?r:"","data-variant":n,"data-side":t,"data-slot":"sidebar",children:[e.jsx("div",{"data-slot":"sidebar-gap",className:Ae("relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",n==="floating"||n==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]":"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]")}),e.jsx("div",{"data-slot":"sidebar-container",className:Ae("fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex",t==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",n==="floating"||n==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]":"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l",s),...o,children:e.jsx("div",{"data-sidebar":"sidebar","data-slot":"sidebar-inner",className:"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm",children:i})})]})}function yO({className:t,onClick:n,...r}){const{toggleSidebar:s}=Lg();return e.jsxs(B,{"data-sidebar":"trigger","data-slot":"sidebar-trigger",variant:"ghost",size:"icon",className:Ae("h-7 w-7",t),onClick:i=>{n?.(i),s()},...r,children:[e.jsx(OA,{}),e.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})}function jO({className:t,...n}){return e.jsx("div",{"data-slot":"sidebar-header","data-sidebar":"header",className:Ae("flex flex-col gap-2 p-2",t),...n})}function bO({className:t,...n}){return e.jsx("div",{"data-slot":"sidebar-footer","data-sidebar":"footer",className:Ae("flex flex-col gap-2 p-2",t),...n})}function wO({className:t,...n}){return e.jsx("div",{"data-slot":"sidebar-content","data-sidebar":"content",className:Ae("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",t),...n})}function bf({className:t,...n}){return e.jsx("div",{"data-slot":"sidebar-group","data-sidebar":"group",className:Ae("relative flex w-full min-w-0 flex-col p-2",t),...n})}function wf({className:t,asChild:n=!1,...r}){const s=n?Np:"div";return e.jsx(s,{"data-slot":"sidebar-group-label","data-sidebar":"group-label",className:Ae("text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",t),...r})}function Nf({className:t,...n}){return e.jsx("div",{"data-slot":"sidebar-group-content","data-sidebar":"group-content",className:Ae("w-full text-sm",t),...n})}function Cf({className:t,...n}){return e.jsx("ul",{"data-slot":"sidebar-menu","data-sidebar":"menu",className:Ae("flex w-full min-w-0 flex-col gap-1",t),...n})}function Sf({className:t,...n}){return e.jsx("li",{"data-slot":"sidebar-menu-item","data-sidebar":"menu-item",className:Ae("group/menu-item relative",t),...n})}const NO=Bi("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:p-0!"}},defaultVariants:{variant:"default",size:"default"}});function kf({asChild:t=!1,isActive:n=!1,variant:r="default",size:s="default",tooltip:i,className:o,...c}){const d=t?Np:"button",{isMobile:p,state:m}=Lg(),h=e.jsx(d,{"data-slot":"sidebar-menu-button","data-sidebar":"menu-button","data-size":s,"data-active":n,className:Ae(NO({variant:r,size:s}),o),...c});return i?(typeof i=="string"&&(i={children:i}),e.jsxs(ei,{children:[e.jsx(ti,{asChild:!0,children:h}),e.jsx(ua,{side:"right",align:"center",hidden:m!=="collapsed"||p,...i})]})):h}function Ac(t,[n,r]){return Math.min(r,Math.max(n,t))}var CO=x.createContext(void 0);function Gi(t){const n=x.useContext(CO);return t||n||"ltr"}function Vp(t){const n=x.useRef({value:t,previous:t});return x.useMemo(()=>(n.current.value!==t&&(n.current.previous=n.current.value,n.current.value=t),n.current.previous),[t])}var SO=[" ","Enter","ArrowUp","ArrowDown"],kO=[" ","Enter"],ed="Select",[qp,Up,EO]=dl(ed),[gl]=Zn(ed,[EO,xl]),Bp=xl(),[PO,mi]=gl(ed),[TO,RO]=gl(ed),TC=t=>{const{__scopeSelect:n,children:r,open:s,defaultOpen:i,onOpenChange:o,value:c,defaultValue:d,onValueChange:p,dir:m,name:h,autoComplete:g,disabled:v,required:j,form:N}=t,b=Bp(n),[C,S]=x.useState(null),[k,P]=x.useState(null),[R,E]=x.useState(!1),A=Gi(m),[W=!1,X]=Zr({prop:s,defaultProp:i,onChange:o}),[se,V]=Zr({prop:c,defaultProp:d,onChange:p}),G=x.useRef(null),O=C?N||!!C.closest("form"):!0,[F,U]=x.useState(new Set),$=Array.from(F).map(q=>q.props.value).join(";");return e.jsx(Ng,{...b,children:e.jsxs(PO,{required:j,scope:n,trigger:C,onTriggerChange:S,valueNode:k,onValueNodeChange:P,valueNodeHasChildren:R,onValueNodeHasChildrenChange:E,contentId:Qr(),value:se,onValueChange:V,open:W,onOpenChange:X,dir:A,triggerPointerDownPosRef:G,disabled:v,children:[e.jsx(qp.Provider,{scope:n,children:e.jsx(TO,{scope:t.__scopeSelect,onNativeOptionAdd:x.useCallback(q=>{U(le=>new Set(le).add(q))},[]),onNativeOptionRemove:x.useCallback(q=>{U(le=>{const K=new Set(le);return K.delete(q),K})},[]),children:r})}),O?e.jsxs(tS,{"aria-hidden":!0,required:j,tabIndex:-1,name:h,autoComplete:g,value:se,onChange:q=>V(q.target.value),disabled:v,form:N,children:[se===void 0?e.jsx("option",{value:""}):null,Array.from(F)]},$):null]})})};TC.displayName=ed;var RC="SelectTrigger",AC=x.forwardRef((t,n)=>{const{__scopeSelect:r,disabled:s=!1,...i}=t,o=Bp(r),c=mi(RC,r),d=c.disabled||s,p=vt(n,c.onTriggerChange),m=Up(r),h=x.useRef("touch"),[g,v,j]=nS(b=>{const C=m().filter(P=>!P.disabled),S=C.find(P=>P.value===c.value),k=rS(C,b,S);k!==void 0&&c.onValueChange(k.value)}),N=b=>{d||(c.onOpenChange(!0),j()),b&&(c.triggerPointerDownPosRef.current={x:Math.round(b.pageX),y:Math.round(b.pageY)})};return e.jsx(Cg,{asChild:!0,...o,children:e.jsx(et.button,{type:"button",role:"combobox","aria-controls":c.contentId,"aria-expanded":c.open,"aria-required":c.required,"aria-autocomplete":"none",dir:c.dir,"data-state":c.open?"open":"closed",disabled:d,"data-disabled":d?"":void 0,"data-placeholder":eS(c.value)?"":void 0,...i,ref:p,onClick:De(i.onClick,b=>{b.currentTarget.focus(),h.current!=="mouse"&&N(b)}),onPointerDown:De(i.onPointerDown,b=>{h.current=b.pointerType;const C=b.target;C.hasPointerCapture(b.pointerId)&&C.releasePointerCapture(b.pointerId),b.button===0&&b.ctrlKey===!1&&b.pointerType==="mouse"&&(N(b),b.preventDefault())}),onKeyDown:De(i.onKeyDown,b=>{const C=g.current!=="";!(b.ctrlKey||b.altKey||b.metaKey)&&b.key.length===1&&v(b.key),!(C&&b.key===" ")&&SO.includes(b.key)&&(N(),b.preventDefault())})})})});AC.displayName=RC;var _C="SelectValue",IC=x.forwardRef((t,n)=>{const{__scopeSelect:r,className:s,style:i,children:o,placeholder:c="",...d}=t,p=mi(_C,r),{onValueNodeHasChildrenChange:m}=p,h=o!==void 0,g=vt(n,p.onValueNodeChange);return On(()=>{m(h)},[m,h]),e.jsx(et.span,{...d,ref:g,style:{pointerEvents:"none"},children:eS(p.value)?e.jsx(e.Fragment,{children:c}):o})});IC.displayName=_C;var AO="SelectIcon",MC=x.forwardRef((t,n)=>{const{__scopeSelect:r,children:s,...i}=t;return e.jsx(et.span,{"aria-hidden":!0,...i,ref:n,children:s||""})});MC.displayName=AO;var _O="SelectPortal",OC=t=>e.jsx(Gc,{asChild:!0,...t});OC.displayName=_O;var qi="SelectContent",DC=x.forwardRef((t,n)=>{const r=mi(qi,t.__scopeSelect),[s,i]=x.useState();if(On(()=>{i(new DocumentFragment)},[]),!r.open){const o=s;return o?cl.createPortal(e.jsx(LC,{scope:t.__scopeSelect,children:e.jsx(qp.Slot,{scope:t.__scopeSelect,children:e.jsx("div",{children:t.children})})}),o):null}return e.jsx(FC,{...t,ref:n})});DC.displayName=qi;var bs=10,[LC,hi]=gl(qi),IO="SelectContentImpl",MO=Li("SelectContent.RemoveScroll"),FC=x.forwardRef((t,n)=>{const{__scopeSelect:r,position:s="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:o,onPointerDownOutside:c,side:d,sideOffset:p,align:m,alignOffset:h,arrowPadding:g,collisionBoundary:v,collisionPadding:j,sticky:N,hideWhenDetached:b,avoidCollisions:C,...S}=t,k=mi(qi,r),[P,R]=x.useState(null),[E,A]=x.useState(null),W=vt(n,xe=>R(xe)),[X,se]=x.useState(null),[V,G]=x.useState(null),O=Up(r),[F,U]=x.useState(!1),$=x.useRef(!1);x.useEffect(()=>{if(P)return Rg(P)},[P]),Tg();const q=x.useCallback(xe=>{const[Se,...Oe]=O().map(ve=>ve.ref.current),[Pe]=Oe.slice(-1),Be=document.activeElement;for(const ve of xe)if(ve===Be||(ve?.scrollIntoView({block:"nearest"}),ve===Se&&E&&(E.scrollTop=0),ve===Pe&&E&&(E.scrollTop=E.scrollHeight),ve?.focus(),document.activeElement!==Be))return},[O,E]),le=x.useCallback(()=>q([X,P]),[q,X,P]);x.useEffect(()=>{F&&le()},[F,le]);const{onOpenChange:K,triggerPointerDownPosRef:J}=k;x.useEffect(()=>{if(P){let xe={x:0,y:0};const Se=Pe=>{xe={x:Math.abs(Math.round(Pe.pageX)-(J.current?.x??0)),y:Math.abs(Math.round(Pe.pageY)-(J.current?.y??0))}},Oe=Pe=>{xe.x<=10&&xe.y<=10?Pe.preventDefault():P.contains(Pe.target)||K(!1),document.removeEventListener("pointermove",Se),J.current=null};return J.current!==null&&(document.addEventListener("pointermove",Se),document.addEventListener("pointerup",Oe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Se),document.removeEventListener("pointerup",Oe,{capture:!0})}}},[P,K,J]),x.useEffect(()=>{const xe=()=>K(!1);return window.addEventListener("blur",xe),window.addEventListener("resize",xe),()=>{window.removeEventListener("blur",xe),window.removeEventListener("resize",xe)}},[K]);const[D,I]=nS(xe=>{const Se=O().filter(Be=>!Be.disabled),Oe=Se.find(Be=>Be.ref.current===document.activeElement),Pe=rS(Se,xe,Oe);Pe&&setTimeout(()=>Pe.ref.current.focus())}),re=x.useCallback((xe,Se,Oe)=>{const Pe=!$.current&&!Oe;(k.value!==void 0&&k.value===Se||Pe)&&(se(xe),Pe&&($.current=!0))},[k.value]),T=x.useCallback(()=>P?.focus(),[P]),Y=x.useCallback((xe,Se,Oe)=>{const Pe=!$.current&&!Oe;(k.value!==void 0&&k.value===Se||Pe)&&G(xe)},[k.value]),oe=s==="popper"?fx:$C,Ne=oe===fx?{side:d,sideOffset:p,align:m,alignOffset:h,arrowPadding:g,collisionBoundary:v,collisionPadding:j,sticky:N,hideWhenDetached:b,avoidCollisions:C}:{};return e.jsx(LC,{scope:r,content:P,viewport:E,onViewportChange:A,itemRefCallback:re,selectedItem:X,onItemLeave:T,itemTextRefCallback:Y,focusSelectedItem:le,selectedItemText:V,position:s,isPositioned:F,searchRef:D,children:e.jsx($p,{as:MO,allowPinchZoom:!0,children:e.jsx(Lp,{asChild:!0,trapped:k.open,onMountAutoFocus:xe=>{xe.preventDefault()},onUnmountAutoFocus:De(i,xe=>{k.trigger?.focus({preventScroll:!0}),xe.preventDefault()}),children:e.jsx(ul,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:c,onFocusOutside:xe=>xe.preventDefault(),onDismiss:()=>k.onOpenChange(!1),children:e.jsx(oe,{role:"listbox",id:k.contentId,"data-state":k.open?"open":"closed",dir:k.dir,onContextMenu:xe=>xe.preventDefault(),...S,...Ne,onPlaced:()=>U(!0),ref:W,style:{display:"flex",flexDirection:"column",outline:"none",...S.style},onKeyDown:De(S.onKeyDown,xe=>{const Se=xe.ctrlKey||xe.altKey||xe.metaKey;if(xe.key==="Tab"&&xe.preventDefault(),!Se&&xe.key.length===1&&I(xe.key),["ArrowUp","ArrowDown","Home","End"].includes(xe.key)){let Pe=O().filter(Be=>!Be.disabled).map(Be=>Be.ref.current);if(["ArrowUp","End"].includes(xe.key)&&(Pe=Pe.slice().reverse()),["ArrowUp","ArrowDown"].includes(xe.key)){const Be=xe.target,ve=Pe.indexOf(Be);Pe=Pe.slice(ve+1)}setTimeout(()=>q(Pe)),xe.preventDefault()}})})})})})})});FC.displayName=IO;var OO="SelectItemAlignedPosition",$C=x.forwardRef((t,n)=>{const{__scopeSelect:r,onPlaced:s,...i}=t,o=mi(qi,r),c=hi(qi,r),[d,p]=x.useState(null),[m,h]=x.useState(null),g=vt(n,W=>h(W)),v=Up(r),j=x.useRef(!1),N=x.useRef(!0),{viewport:b,selectedItem:C,selectedItemText:S,focusSelectedItem:k}=c,P=x.useCallback(()=>{if(o.trigger&&o.valueNode&&d&&m&&b&&C&&S){const W=o.trigger.getBoundingClientRect(),X=m.getBoundingClientRect(),se=o.valueNode.getBoundingClientRect(),V=S.getBoundingClientRect();if(o.dir!=="rtl"){const Be=V.left-X.left,ve=se.left-Be,We=W.left-ve,Ye=W.width+We,Qe=Math.max(Ye,X.width),mt=window.innerWidth-bs,ht=Ac(ve,[bs,Math.max(bs,mt-Qe)]);d.style.minWidth=Ye+"px",d.style.left=ht+"px"}else{const Be=X.right-V.right,ve=window.innerWidth-se.right-Be,We=window.innerWidth-W.right-ve,Ye=W.width+We,Qe=Math.max(Ye,X.width),mt=window.innerWidth-bs,ht=Ac(ve,[bs,Math.max(bs,mt-Qe)]);d.style.minWidth=Ye+"px",d.style.right=ht+"px"}const G=v(),O=window.innerHeight-bs*2,F=b.scrollHeight,U=window.getComputedStyle(m),$=parseInt(U.borderTopWidth,10),q=parseInt(U.paddingTop,10),le=parseInt(U.borderBottomWidth,10),K=parseInt(U.paddingBottom,10),J=$+q+F+K+le,D=Math.min(C.offsetHeight*5,J),I=window.getComputedStyle(b),re=parseInt(I.paddingTop,10),T=parseInt(I.paddingBottom,10),Y=W.top+W.height/2-bs,oe=O-Y,Ne=C.offsetHeight/2,xe=C.offsetTop+Ne,Se=$+q+xe,Oe=J-Se;if(Se<=Y){const Be=G.length>0&&C===G[G.length-1].ref.current;d.style.bottom="0px";const ve=m.clientHeight-b.offsetTop-b.offsetHeight,We=Math.max(oe,Ne+(Be?T:0)+ve+le),Ye=Se+We;d.style.height=Ye+"px"}else{const Be=G.length>0&&C===G[0].ref.current;d.style.top="0px";const We=Math.max(Y,$+b.offsetTop+(Be?re:0)+Ne)+Oe;d.style.height=We+"px",b.scrollTop=Se-Y+b.offsetTop}d.style.margin=`${bs}px 0`,d.style.minHeight=D+"px",d.style.maxHeight=O+"px",s?.(),requestAnimationFrame(()=>j.current=!0)}},[v,o.trigger,o.valueNode,d,m,b,C,S,o.dir,s]);On(()=>P(),[P]);const[R,E]=x.useState();On(()=>{m&&E(window.getComputedStyle(m).zIndex)},[m]);const A=x.useCallback(W=>{W&&N.current===!0&&(P(),k?.(),N.current=!1)},[P,k]);return e.jsx(LO,{scope:r,contentWrapper:d,shouldExpandOnScrollRef:j,onScrollButtonChange:A,children:e.jsx("div",{ref:p,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:R},children:e.jsx(et.div,{...i,ref:g,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});$C.displayName=OO;var DO="SelectPopperPosition",fx=x.forwardRef((t,n)=>{const{__scopeSelect:r,align:s="start",collisionPadding:i=bs,...o}=t,c=Bp(r);return e.jsx(Sg,{...c,...o,ref:n,align:s,collisionPadding:i,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});fx.displayName=DO;var[LO,Fg]=gl(qi,{}),xx="SelectViewport",zC=x.forwardRef((t,n)=>{const{__scopeSelect:r,nonce:s,...i}=t,o=hi(xx,r),c=Fg(xx,r),d=vt(n,o.onViewportChange),p=x.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),e.jsx(qp.Slot,{scope:r,children:e.jsx(et.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:d,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:De(i.onScroll,m=>{const h=m.currentTarget,{contentWrapper:g,shouldExpandOnScrollRef:v}=c;if(v?.current&&g){const j=Math.abs(p.current-h.scrollTop);if(j>0){const N=window.innerHeight-bs*2,b=parseFloat(g.style.minHeight),C=parseFloat(g.style.height),S=Math.max(b,C);if(S<N){const k=S+j,P=Math.min(N,k),R=k-P;g.style.height=P+"px",g.style.bottom==="0px"&&(h.scrollTop=R>0?R:0,g.style.justifyContent="flex-end")}}}p.current=h.scrollTop})})})]})});zC.displayName=xx;var VC="SelectGroup",[FO,$O]=gl(VC),qC=x.forwardRef((t,n)=>{const{__scopeSelect:r,...s}=t,i=Qr();return e.jsx(FO,{scope:r,id:i,children:e.jsx(et.div,{role:"group","aria-labelledby":i,...s,ref:n})})});qC.displayName=VC;var UC="SelectLabel",BC=x.forwardRef((t,n)=>{const{__scopeSelect:r,...s}=t,i=$O(UC,r);return e.jsx(et.div,{id:i.id,...s,ref:n})});BC.displayName=UC;var tp="SelectItem",[zO,GC]=gl(tp),HC=x.forwardRef((t,n)=>{const{__scopeSelect:r,value:s,disabled:i=!1,textValue:o,...c}=t,d=mi(tp,r),p=hi(tp,r),m=d.value===s,[h,g]=x.useState(o??""),[v,j]=x.useState(!1),N=vt(n,k=>p.itemRefCallback?.(k,s,i)),b=Qr(),C=x.useRef("touch"),S=()=>{i||(d.onValueChange(s),d.onOpenChange(!1))};if(s==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(zO,{scope:r,value:s,disabled:i,textId:b,isSelected:m,onItemTextChange:x.useCallback(k=>{g(P=>P||(k?.textContent??"").trim())},[]),children:e.jsx(qp.ItemSlot,{scope:r,value:s,disabled:i,textValue:h,children:e.jsx(et.div,{role:"option","aria-labelledby":b,"data-highlighted":v?"":void 0,"aria-selected":m&&v,"data-state":m?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...c,ref:N,onFocus:De(c.onFocus,()=>j(!0)),onBlur:De(c.onBlur,()=>j(!1)),onClick:De(c.onClick,()=>{C.current!=="mouse"&&S()}),onPointerUp:De(c.onPointerUp,()=>{C.current==="mouse"&&S()}),onPointerDown:De(c.onPointerDown,k=>{C.current=k.pointerType}),onPointerMove:De(c.onPointerMove,k=>{C.current=k.pointerType,i?p.onItemLeave?.():C.current==="mouse"&&k.currentTarget.focus({preventScroll:!0})}),onPointerLeave:De(c.onPointerLeave,k=>{k.currentTarget===document.activeElement&&p.onItemLeave?.()}),onKeyDown:De(c.onKeyDown,k=>{p.searchRef?.current!==""&&k.key===" "||(kO.includes(k.key)&&S(),k.key===" "&&k.preventDefault())})})})})});HC.displayName=tp;var fc="SelectItemText",KC=x.forwardRef((t,n)=>{const{__scopeSelect:r,className:s,style:i,...o}=t,c=mi(fc,r),d=hi(fc,r),p=GC(fc,r),m=RO(fc,r),[h,g]=x.useState(null),v=vt(n,S=>g(S),p.onItemTextChange,S=>d.itemTextRefCallback?.(S,p.value,p.disabled)),j=h?.textContent,N=x.useMemo(()=>e.jsx("option",{value:p.value,disabled:p.disabled,children:j},p.value),[p.disabled,p.value,j]),{onNativeOptionAdd:b,onNativeOptionRemove:C}=m;return On(()=>(b(N),()=>C(N)),[b,C,N]),e.jsxs(e.Fragment,{children:[e.jsx(et.span,{id:p.textId,...o,ref:v}),p.isSelected&&c.valueNode&&!c.valueNodeHasChildren?cl.createPortal(o.children,c.valueNode):null]})});KC.displayName=fc;var WC="SelectItemIndicator",QC=x.forwardRef((t,n)=>{const{__scopeSelect:r,...s}=t;return GC(WC,r).isSelected?e.jsx(et.span,{"aria-hidden":!0,...s,ref:n}):null});QC.displayName=WC;var gx="SelectScrollUpButton",YC=x.forwardRef((t,n)=>{const r=hi(gx,t.__scopeSelect),s=Fg(gx,t.__scopeSelect),[i,o]=x.useState(!1),c=vt(n,s.onScrollButtonChange);return On(()=>{if(r.viewport&&r.isPositioned){let d=function(){const m=p.scrollTop>0;o(m)};const p=r.viewport;return d(),p.addEventListener("scroll",d),()=>p.removeEventListener("scroll",d)}},[r.viewport,r.isPositioned]),i?e.jsx(XC,{...t,ref:c,onAutoScroll:()=>{const{viewport:d,selectedItem:p}=r;d&&p&&(d.scrollTop=d.scrollTop-p.offsetHeight)}}):null});YC.displayName=gx;var vx="SelectScrollDownButton",ZC=x.forwardRef((t,n)=>{const r=hi(vx,t.__scopeSelect),s=Fg(vx,t.__scopeSelect),[i,o]=x.useState(!1),c=vt(n,s.onScrollButtonChange);return On(()=>{if(r.viewport&&r.isPositioned){let d=function(){const m=p.scrollHeight-p.clientHeight,h=Math.ceil(p.scrollTop)<m;o(h)};const p=r.viewport;return d(),p.addEventListener("scroll",d),()=>p.removeEventListener("scroll",d)}},[r.viewport,r.isPositioned]),i?e.jsx(XC,{...t,ref:c,onAutoScroll:()=>{const{viewport:d,selectedItem:p}=r;d&&p&&(d.scrollTop=d.scrollTop+p.offsetHeight)}}):null});ZC.displayName=vx;var XC=x.forwardRef((t,n)=>{const{__scopeSelect:r,onAutoScroll:s,...i}=t,o=hi("SelectScrollButton",r),c=x.useRef(null),d=Up(r),p=x.useCallback(()=>{c.current!==null&&(window.clearInterval(c.current),c.current=null)},[]);return x.useEffect(()=>()=>p(),[p]),On(()=>{d().find(h=>h.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[d]),e.jsx(et.div,{"aria-hidden":!0,...i,ref:n,style:{flexShrink:0,...i.style},onPointerDown:De(i.onPointerDown,()=>{c.current===null&&(c.current=window.setInterval(s,50))}),onPointerMove:De(i.onPointerMove,()=>{o.onItemLeave?.(),c.current===null&&(c.current=window.setInterval(s,50))}),onPointerLeave:De(i.onPointerLeave,()=>{p()})})}),VO="SelectSeparator",JC=x.forwardRef((t,n)=>{const{__scopeSelect:r,...s}=t;return e.jsx(et.div,{"aria-hidden":!0,...s,ref:n})});JC.displayName=VO;var yx="SelectArrow",qO=x.forwardRef((t,n)=>{const{__scopeSelect:r,...s}=t,i=Bp(r),o=mi(yx,r),c=hi(yx,r);return o.open&&c.position==="popper"?e.jsx(kg,{...i,...s,ref:n}):null});qO.displayName=yx;function eS(t){return t===""||t===void 0}var tS=x.forwardRef((t,n)=>{const{value:r,...s}=t,i=x.useRef(null),o=vt(n,i),c=Vp(r);return x.useEffect(()=>{const d=i.current,p=window.HTMLSelectElement.prototype,h=Object.getOwnPropertyDescriptor(p,"value").set;if(c!==r&&h){const g=new Event("change",{bubbles:!0});h.call(d,r),d.dispatchEvent(g)}},[c,r]),e.jsx(Hc,{asChild:!0,children:e.jsx("select",{...s,ref:o,defaultValue:r})})});tS.displayName="BubbleSelect";function nS(t){const n=wn(t),r=x.useRef(""),s=x.useRef(0),i=x.useCallback(c=>{const d=r.current+c;n(d),(function p(m){r.current=m,window.clearTimeout(s.current),m!==""&&(s.current=window.setTimeout(()=>p(""),1e3))})(d)},[n]),o=x.useCallback(()=>{r.current="",window.clearTimeout(s.current)},[]);return x.useEffect(()=>()=>window.clearTimeout(s.current),[]),[r,i,o]}function rS(t,n,r){const i=n.length>1&&Array.from(n).every(m=>m===n[0])?n[0]:n,o=r?t.indexOf(r):-1;let c=UO(t,Math.max(o,0));i.length===1&&(c=c.filter(m=>m!==r));const p=c.find(m=>m.textValue.toLowerCase().startsWith(i.toLowerCase()));return p!==r?p:void 0}function UO(t,n){return t.map((r,s)=>t[(n+s)%t.length])}var BO=TC,sS=AC,GO=IC,HO=MC,KO=OC,aS=DC,WO=zC,QO=qC,iS=BC,oS=HC,YO=KC,ZO=QC,lS=YC,cS=ZC,dS=JC;const Pt=BO,mb=QO,Tt=GO,St=x.forwardRef(({className:t,children:n,...r},s)=>e.jsxs(sS,{ref:s,className:Ae("flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...r,children:[n,e.jsx(HO,{asChild:!0,children:e.jsx(Qs,{className:"h-4 w-4 opacity-50"})})]}));St.displayName=sS.displayName;const uS=x.forwardRef(({className:t,...n},r)=>e.jsx(lS,{ref:r,className:Ae("flex cursor-default items-center justify-center py-1",t),...n,children:e.jsx(kp,{className:"h-4 w-4"})}));uS.displayName=lS.displayName;const pS=x.forwardRef(({className:t,...n},r)=>e.jsx(cS,{ref:r,className:Ae("flex cursor-default items-center justify-center py-1",t),...n,children:e.jsx(Qs,{className:"h-4 w-4"})}));pS.displayName=cS.displayName;const kt=x.forwardRef(({className:t,children:n,position:r="popper",...s},i)=>e.jsx(KO,{children:e.jsxs(aS,{ref:i,className:Ae("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...s,children:[e.jsx(uS,{}),e.jsx(WO,{className:Ae("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),e.jsx(pS,{})]})}));kt.displayName=aS.displayName;const jx=x.forwardRef(({className:t,...n},r)=>e.jsx(iS,{ref:r,className:Ae("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...n}));jx.displayName=iS.displayName;const ce=x.forwardRef(({className:t,children:n,...r},s)=>e.jsxs(oS,{ref:s,className:Ae("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ZO,{children:e.jsx(Tn,{className:"h-4 w-4"})})}),e.jsx(YO,{children:n})]}));ce.displayName=oS.displayName;const mS=x.forwardRef(({className:t,...n},r)=>e.jsx(dS,{ref:r,className:Ae("-mx-1 my-1 h-px bg-muted",t),...n}));mS.displayName=dS.displayName;const XO=[{title:"Panel Principal",url:"/",icon:EA},{title:"Generar Gua",url:"/generate-guide",icon:xr},{title:"Generar Serie",url:"/generate-series-guide",icon:pa},{title:"Guas de Estilo",url:"/style-guides",icon:Ep},{title:"Manuscrito",url:"/manuscript",icon:mn},{title:"Biblia del Mundo",url:"/world-bible",icon:Ya},{title:"Logs de Pensamiento",url:"/thought-logs",icon:Or}],JO=[{title:"Importar Libros",url:"/translations",icon:ha},{title:"Libros Importados",url:"/imported-manuscripts",icon:mn},{title:"Exportar y Traducir",url:"/export",icon:xn},{title:"Comparar Versiones",url:"/compare",icon:e1},{title:"Reeditar Manuscrito",url:"/reedit",icon:DA},{title:"Auditor Literario",url:"/auditor",icon:Bu},{title:"Manuscritos Corregidos",url:"/corrected-manuscripts",icon:Hu},{title:"Auto-Corrector",url:"/auto-corrector",icon:us}],e3=[{title:"Pseudnimos",url:"/pseudonyms",icon:ri},{title:"Series",url:"/series",icon:pa},{title:"Cola de Proyectos",url:"/queue",icon:n1},{title:"Lecciones de Escritura",url:"/writing-lessons",icon:CA},{title:"Historial de Costos",url:"/costs-history",icon:Fi},{title:"Configuracin",url:"/config",icon:a1}];function t3(){const[t]=ol(),{toast:n}=nn(),{data:r}=Ke({queryKey:["/api/ai-provider"]}),s=ye({mutationFn:async i=>je("/api/ai-provider","POST",{provider:i}),onSuccess:(i,o)=>{ae.invalidateQueries({queryKey:["/api/ai-provider"]}),n({title:"Motor de IA actualizado",description:`Ahora usando ${o==="gemini"?"Gemini (rpido)":"DeepSeek (econmico)"}`})},onError:()=>{n({title:"Error",description:"No se pudo cambiar el motor de IA",variant:"destructive"})}});return e.jsxs(vO,{children:[e.jsx(jO,{className:"border-b border-sidebar-border p-4",children:e.jsxs(Ja,{href:"/",className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-md bg-primary text-primary-foreground",children:e.jsx(yA,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-semibold text-lg",children:"LitAgents"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Orquestador Literario"})]})]})}),e.jsxs(wO,{children:[e.jsxs(bf,{children:[e.jsx(wf,{children:"Navegacin"}),e.jsx(Nf,{children:e.jsx(Cf,{children:XO.map(i=>e.jsx(Sf,{children:e.jsx(kf,{asChild:!0,isActive:t===i.url,"data-testid":`nav-${i.url.replace("/","")||"dashboard"}`,children:e.jsxs(Ja,{href:i.url,children:[e.jsx(i.icon,{className:"h-4 w-4"}),e.jsx("span",{children:i.title})]})})},i.title))})})]}),e.jsxs(bf,{children:[e.jsx(wf,{children:"Manuscritos"}),e.jsx(Nf,{children:e.jsx(Cf,{children:JO.map(i=>e.jsx(Sf,{children:e.jsx(kf,{asChild:!0,isActive:t===i.url,"data-testid":`nav-${i.url.replace("/","")}`,children:e.jsxs(Ja,{href:i.url,children:[e.jsx(i.icon,{className:"h-4 w-4"}),e.jsx("span",{children:i.title})]})})},i.title))})})]}),e.jsxs(bf,{children:[e.jsx(wf,{children:"Sistema"}),e.jsx(Nf,{children:e.jsx(Cf,{children:e3.map(i=>e.jsx(Sf,{children:e.jsx(kf,{asChild:!0,isActive:t===i.url,"data-testid":`nav-${i.url.replace("/","")}`,children:e.jsxs(Ja,{href:i.url,children:[e.jsx(i.icon,{className:"h-4 w-4"}),e.jsx("span",{children:i.title})]})})},i.title))})})]})]}),e.jsxs(bO,{className:"border-t border-sidebar-border p-4 space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs text-muted-foreground",children:"Motor de IA"}),e.jsxs(Pt,{value:r?.current||"deepseek",onValueChange:i=>{s.mutate(i)},disabled:s.isPending,children:[e.jsx(St,{className:"w-full h-8 text-xs","data-testid":"select-ai-provider",children:e.jsx(Tt,{placeholder:"Seleccionar motor"})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"gemini",disabled:!r?.available?.gemini,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(us,{className:"h-3 w-3 text-amber-500"}),e.jsx("span",{children:"Gemini (Rpido)"})]})}),e.jsx(ce,{value:"deepseek",disabled:!r?.available?.deepseek,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xr,{className:"h-3 w-3 text-blue-500"}),e.jsx("span",{children:"DeepSeek (Econmico)"})]})})]})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground/60 text-center",children:r?.current==="gemini"?"Gemini 3 Pro - Rpido":"DeepSeek V3/R1 - Econmico"})]})]})}const hS=x.createContext(null);function n3({children:t}){const[n,r]=x.useState(null),{data:s=[],isLoading:i}=Ke({queryKey:["/api/projects"],refetchInterval:3e3}),o=s.filter(p=>p.status!=="archived"),c=()=>{if(o.length===0)return;const p=o.find(m=>m.status==="generating");return p||o.reduce((m,h)=>h.id>m.id?h:m,o[0])},d=n?s.find(p=>p.id===n):c();return x.useEffect(()=>{if(!n&&o.length>0){const p=c();p&&r(p.id)}},[o,n]),e.jsx(hS.Provider,{value:{projects:s,isLoading:i,selectedProjectId:n,setSelectedProjectId:r,currentProject:d},children:t})}function fi(){const t=x.useContext(hS);if(!t)throw new Error("useProject must be used within a ProjectProvider");return t}const r3=Bi("whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 hover-elevate ",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow-xs",secondary:"border-transparent bg-secondary text-secondary-foreground",destructive:"border-transparent bg-destructive text-destructive-foreground shadow-xs",outline:" border [border-color:var(--badge-outline)] shadow-xs"}},defaultVariants:{variant:"default"}});function Q({className:t,variant:n,...r}){return e.jsx("div",{className:Ae(r3({variant:n}),t),...r})}const hb={idle:"Pendiente",generating:"Generando",completed:"Completado",archived:"Archivado",paused:"Pausado",cancelled:"Cancelado",error:"Error",failed_final_review:"Revisin Fallida",final_review_in_progress:"Revisando",awaiting_approval:"Aprobacin",awaiting_final_review:"Pendiente Revisin"},fb={idle:"bg-yellow-500/20 text-yellow-600 dark:text-yellow-400",generating:"bg-blue-500/20 text-blue-600 dark:text-blue-400",completed:"bg-green-500/20 text-green-600 dark:text-green-400",archived:"bg-gray-500/20 text-gray-600 dark:text-gray-400",paused:"bg-orange-500/20 text-orange-600 dark:text-orange-400",cancelled:"bg-gray-500/20 text-gray-600 dark:text-gray-400",error:"bg-red-500/20 text-red-600 dark:text-red-400",failed_final_review:"bg-red-500/20 text-red-600 dark:text-red-400",final_review_in_progress:"bg-purple-500/20 text-purple-600 dark:text-purple-400",awaiting_approval:"bg-amber-500/20 text-amber-600 dark:text-amber-400",awaiting_final_review:"bg-indigo-500/20 text-indigo-600 dark:text-indigo-400"};function s3({projects:t,selectedProjectId:n,onSelectProject:r}){const s=t.filter(o=>o.status!=="archived"),i=t.filter(o=>o.status==="archived");return t.length===0?null:e.jsxs(Pt,{value:n?.toString()||"",onValueChange:o=>r(parseInt(o)),children:[e.jsx(St,{className:"w-[280px]","data-testid":"select-project",children:e.jsx(Tt,{placeholder:"Seleccionar proyecto"})}),e.jsxs(kt,{children:[s.length>0&&e.jsxs(mb,{children:[e.jsx(jx,{children:"Proyectos Activos"}),s.map(o=>e.jsx(ce,{value:o.id.toString(),"data-testid":`select-project-${o.id}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate max-w-[180px]",children:o.title}),e.jsx(Q,{variant:"secondary",className:`text-xs ${fb[o.status]||""}`,children:hb[o.status]||o.status})]})},o.id))]}),i.length>0&&e.jsxs(e.Fragment,{children:[s.length>0&&e.jsx(mS,{}),e.jsxs(mb,{children:[e.jsx(jx,{children:"Archivados"}),i.map(o=>e.jsx(ce,{value:o.id.toString(),"data-testid":`select-project-archived-${o.id}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate max-w-[180px] opacity-70",children:o.title}),e.jsx(Q,{variant:"secondary",className:`text-xs ${fb[o.status]||""}`,children:hb[o.status]||o.status})]})},o.id))]})]})]})]})}const me=x.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:Ae("shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm",t),...n}));me.displayName="Card";const Re=x.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:Ae("flex flex-col space-y-1.5 p-6",t),...n}));Re.displayName="CardHeader";const Ie=x.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:Ae("text-2xl font-semibold leading-none tracking-tight",t),...n}));Ie.displayName="CardTitle";const At=x.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:Ae("text-sm text-muted-foreground",t),...n}));At.displayName="CardDescription";const he=x.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:Ae("p-6 pt-0",t),...n}));he.displayName="CardContent";const a3=x.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:Ae("flex items-center p-6 pt-0",t),...n}));a3.displayName="CardFooter";var i3="Label",fS=x.forwardRef((t,n)=>e.jsx(et.label,{...t,ref:n,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(t.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));fS.displayName=i3;var xS=fS;const o3=Bi("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),st=x.forwardRef(({className:t,...n},r)=>e.jsx(xS,{ref:r,className:Ae(o3(),t),...n}));st.displayName=xS.displayName;function l3({onLoginSuccess:t}){const[n,r]=x.useState(""),[s,i]=x.useState(!1),{toast:o}=nn(),c=async d=>{if(d.preventDefault(),!n.trim()){o({title:"Error",description:"Por favor, introduce la contrasea",variant:"destructive"});return}i(!0);try{(await(await je("POST","/api/auth/login",{password:n})).json()).success&&(o({title:"Acceso concedido",description:"Bienvenido a LitAgents"}),t())}catch{o({title:"Acceso denegado",description:"Contrasea incorrecta",variant:"destructive"})}finally{i(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:e.jsxs(me,{className:"w-full max-w-md",children:[e.jsxs(Re,{className:"text-center space-y-2",children:[e.jsx("div",{className:"flex justify-center mb-2",children:e.jsx("div",{className:"p-3 bg-primary/10 rounded-full",children:e.jsx(mn,{className:"h-8 w-8 text-primary"})})}),e.jsx(Ie,{className:"text-2xl",children:"LitAgents"}),e.jsx(At,{children:"Sistema de Orquestacin de Agentes Literarios"})]}),e.jsx(he,{children:e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{htmlFor:"password",children:"Contrasea de acceso"}),e.jsxs("div",{className:"relative",children:[e.jsx(RA,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(gt,{id:"password",type:"password",placeholder:"Introduce la contrasea",value:n,onChange:d=>r(d.target.value),className:"pl-10",autoFocus:!0,"data-testid":"input-password"})]})]}),e.jsx(B,{type:"submit",className:"w-full",disabled:s,"data-testid":"button-login",children:s?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}),"Verificando..."]}):"Acceder"})]})})]})})}const Pn=Og,gS=wC,c3=Dg,vS=x.forwardRef(({className:t,...n},r)=>e.jsx(Yc,{ref:r,className:Ae("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n}));vS.displayName=Yc.displayName;const yn=x.forwardRef(({className:t,children:n,...r},s)=>e.jsxs(c3,{children:[e.jsx(vS,{}),e.jsxs(Zc,{ref:s,className:Ae("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[n,e.jsxs(zp,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Gn,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));yn.displayName=Zc.displayName;const jn=({className:t,...n})=>e.jsx("div",{className:Ae("flex flex-col space-y-1.5 text-center sm:text-left",t),...n});jn.displayName="DialogHeader";const Ir=({className:t,...n})=>e.jsx("div",{className:Ae("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...n});Ir.displayName="DialogFooter";const bn=x.forwardRef(({className:t,...n},r)=>e.jsx(Xc,{ref:r,className:Ae("text-lg font-semibold leading-none tracking-tight",t),...n}));bn.displayName=Xc.displayName;const $n=x.forwardRef(({className:t,...n},r)=>e.jsx(Jc,{ref:r,className:Ae("text-sm text-muted-foreground",t),...n}));$n.displayName=Jc.displayName;var Ef="rovingFocusGroup.onEntryFocus",d3={bubbles:!1,cancelable:!0},Gp="RovingFocusGroup",[bx,yS,u3]=dl(Gp),[p3,Hp]=Zn(Gp,[u3]),[m3,h3]=p3(Gp),jS=x.forwardRef((t,n)=>e.jsx(bx.Provider,{scope:t.__scopeRovingFocusGroup,children:e.jsx(bx.Slot,{scope:t.__scopeRovingFocusGroup,children:e.jsx(f3,{...t,ref:n})})}));jS.displayName=Gp;var f3=x.forwardRef((t,n)=>{const{__scopeRovingFocusGroup:r,orientation:s,loop:i=!1,dir:o,currentTabStopId:c,defaultCurrentTabStopId:d,onCurrentTabStopIdChange:p,onEntryFocus:m,preventScrollOnEntryFocus:h=!1,...g}=t,v=x.useRef(null),j=vt(n,v),N=Gi(o),[b=null,C]=Zr({prop:c,defaultProp:d,onChange:p}),[S,k]=x.useState(!1),P=wn(m),R=yS(r),E=x.useRef(!1),[A,W]=x.useState(0);return x.useEffect(()=>{const X=v.current;if(X)return X.addEventListener(Ef,P),()=>X.removeEventListener(Ef,P)},[P]),e.jsx(m3,{scope:r,orientation:s,dir:N,loop:i,currentTabStopId:b,onItemFocus:x.useCallback(X=>C(X),[C]),onItemShiftTab:x.useCallback(()=>k(!0),[]),onFocusableItemAdd:x.useCallback(()=>W(X=>X+1),[]),onFocusableItemRemove:x.useCallback(()=>W(X=>X-1),[]),children:e.jsx(et.div,{tabIndex:S||A===0?-1:0,"data-orientation":s,...g,ref:j,style:{outline:"none",...t.style},onMouseDown:De(t.onMouseDown,()=>{E.current=!0}),onFocus:De(t.onFocus,X=>{const se=!E.current;if(X.target===X.currentTarget&&se&&!S){const V=new CustomEvent(Ef,d3);if(X.currentTarget.dispatchEvent(V),!V.defaultPrevented){const G=R().filter(q=>q.focusable),O=G.find(q=>q.active),F=G.find(q=>q.id===b),$=[O,F,...G].filter(Boolean).map(q=>q.ref.current);NS($,h)}}E.current=!1}),onBlur:De(t.onBlur,()=>k(!1))})})}),bS="RovingFocusGroupItem",wS=x.forwardRef((t,n)=>{const{__scopeRovingFocusGroup:r,focusable:s=!0,active:i=!1,tabStopId:o,...c}=t,d=Qr(),p=o||d,m=h3(bS,r),h=m.currentTabStopId===p,g=yS(r),{onFocusableItemAdd:v,onFocusableItemRemove:j}=m;return x.useEffect(()=>{if(s)return v(),()=>j()},[s,v,j]),e.jsx(bx.ItemSlot,{scope:r,id:p,focusable:s,active:i,children:e.jsx(et.span,{tabIndex:h?0:-1,"data-orientation":m.orientation,...c,ref:n,onMouseDown:De(t.onMouseDown,N=>{s?m.onItemFocus(p):N.preventDefault()}),onFocus:De(t.onFocus,()=>m.onItemFocus(p)),onKeyDown:De(t.onKeyDown,N=>{if(N.key==="Tab"&&N.shiftKey){m.onItemShiftTab();return}if(N.target!==N.currentTarget)return;const b=v3(N,m.orientation,m.dir);if(b!==void 0){if(N.metaKey||N.ctrlKey||N.altKey||N.shiftKey)return;N.preventDefault();let S=g().filter(k=>k.focusable).map(k=>k.ref.current);if(b==="last")S.reverse();else if(b==="prev"||b==="next"){b==="prev"&&S.reverse();const k=S.indexOf(N.currentTarget);S=m.loop?y3(S,k+1):S.slice(k+1)}setTimeout(()=>NS(S))}})})})});wS.displayName=bS;var x3={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function g3(t,n){return n!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function v3(t,n,r){const s=g3(t.key,r);if(!(n==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(n==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return x3[s]}function NS(t,n=!1){const r=document.activeElement;for(const s of t)if(s===r||(s.focus({preventScroll:n}),document.activeElement!==r))return}function y3(t,n){return t.map((r,s)=>t[(n+s)%t.length])}var CS=jS,SS=wS,$g="Tabs",[j3]=Zn($g,[Hp]),kS=Hp(),[b3,zg]=j3($g),ES=x.forwardRef((t,n)=>{const{__scopeTabs:r,value:s,onValueChange:i,defaultValue:o,orientation:c="horizontal",dir:d,activationMode:p="automatic",...m}=t,h=Gi(d),[g,v]=Zr({prop:s,onChange:i,defaultProp:o});return e.jsx(b3,{scope:r,baseId:Qr(),value:g,onValueChange:v,orientation:c,dir:h,activationMode:p,children:e.jsx(et.div,{dir:h,"data-orientation":c,...m,ref:n})})});ES.displayName=$g;var PS="TabsList",TS=x.forwardRef((t,n)=>{const{__scopeTabs:r,loop:s=!0,...i}=t,o=zg(PS,r),c=kS(r);return e.jsx(CS,{asChild:!0,...c,orientation:o.orientation,dir:o.dir,loop:s,children:e.jsx(et.div,{role:"tablist","aria-orientation":o.orientation,...i,ref:n})})});TS.displayName=PS;var RS="TabsTrigger",AS=x.forwardRef((t,n)=>{const{__scopeTabs:r,value:s,disabled:i=!1,...o}=t,c=zg(RS,r),d=kS(r),p=MS(c.baseId,s),m=OS(c.baseId,s),h=s===c.value;return e.jsx(SS,{asChild:!0,...d,focusable:!i,active:h,children:e.jsx(et.button,{type:"button",role:"tab","aria-selected":h,"aria-controls":m,"data-state":h?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:p,...o,ref:n,onMouseDown:De(t.onMouseDown,g=>{!i&&g.button===0&&g.ctrlKey===!1?c.onValueChange(s):g.preventDefault()}),onKeyDown:De(t.onKeyDown,g=>{[" ","Enter"].includes(g.key)&&c.onValueChange(s)}),onFocus:De(t.onFocus,()=>{const g=c.activationMode!=="manual";!h&&!i&&g&&c.onValueChange(s)})})})});AS.displayName=RS;var _S="TabsContent",IS=x.forwardRef((t,n)=>{const{__scopeTabs:r,value:s,forceMount:i,children:o,...c}=t,d=zg(_S,r),p=MS(d.baseId,s),m=OS(d.baseId,s),h=s===d.value,g=x.useRef(h);return x.useEffect(()=>{const v=requestAnimationFrame(()=>g.current=!1);return()=>cancelAnimationFrame(v)},[]),e.jsx(gr,{present:i||h,children:({present:v})=>e.jsx(et.div,{"data-state":h?"active":"inactive","data-orientation":d.orientation,role:"tabpanel","aria-labelledby":p,hidden:!v,id:m,tabIndex:0,...c,ref:n,style:{...t.style,animationDuration:g.current?"0s":void 0},children:v&&o})})});IS.displayName=_S;function MS(t,n){return`${t}-trigger-${n}`}function OS(t,n){return`${t}-content-${n}`}var w3=ES,DS=TS,LS=AS,FS=IS;const ci=w3,ga=x.forwardRef(({className:t,...n},r)=>e.jsx(DS,{ref:r,className:Ae("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...n}));ga.displayName=DS.displayName;const Bt=x.forwardRef(({className:t,...n},r)=>e.jsx(LS,{ref:r,className:Ae("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...n}));Bt.displayName=LS.displayName;const Gt=x.forwardRef(({className:t,...n},r)=>e.jsx(FS,{ref:r,className:Ae("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...n}));Gt.displayName=FS.displayName;function N3(t,n){return x.useReducer((r,s)=>n[r][s]??r,t)}var Vg="ScrollArea",[$S]=Zn(Vg),[C3,ps]=$S(Vg),zS=x.forwardRef((t,n)=>{const{__scopeScrollArea:r,type:s="hover",dir:i,scrollHideDelay:o=600,...c}=t,[d,p]=x.useState(null),[m,h]=x.useState(null),[g,v]=x.useState(null),[j,N]=x.useState(null),[b,C]=x.useState(null),[S,k]=x.useState(0),[P,R]=x.useState(0),[E,A]=x.useState(!1),[W,X]=x.useState(!1),se=vt(n,G=>p(G)),V=Gi(i);return e.jsx(C3,{scope:r,type:s,dir:V,scrollHideDelay:o,scrollArea:d,viewport:m,onViewportChange:h,content:g,onContentChange:v,scrollbarX:j,onScrollbarXChange:N,scrollbarXEnabled:E,onScrollbarXEnabledChange:A,scrollbarY:b,onScrollbarYChange:C,scrollbarYEnabled:W,onScrollbarYEnabledChange:X,onCornerWidthChange:k,onCornerHeightChange:R,children:e.jsx(et.div,{dir:V,...c,ref:se,style:{position:"relative","--radix-scroll-area-corner-width":S+"px","--radix-scroll-area-corner-height":P+"px",...t.style}})})});zS.displayName=Vg;var VS="ScrollAreaViewport",qS=x.forwardRef((t,n)=>{const{__scopeScrollArea:r,children:s,nonce:i,...o}=t,c=ps(VS,r),d=x.useRef(null),p=vt(n,d,c.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),e.jsx(et.div,{"data-radix-scroll-area-viewport":"",...o,ref:p,style:{overflowX:c.scrollbarXEnabled?"scroll":"hidden",overflowY:c.scrollbarYEnabled?"scroll":"hidden",...t.style},children:e.jsx("div",{ref:c.onContentChange,style:{minWidth:"100%",display:"table"},children:s})})]})});qS.displayName=VS;var Zs="ScrollAreaScrollbar",qg=x.forwardRef((t,n)=>{const{forceMount:r,...s}=t,i=ps(Zs,t.__scopeScrollArea),{onScrollbarXEnabledChange:o,onScrollbarYEnabledChange:c}=i,d=t.orientation==="horizontal";return x.useEffect(()=>(d?o(!0):c(!0),()=>{d?o(!1):c(!1)}),[d,o,c]),i.type==="hover"?e.jsx(S3,{...s,ref:n,forceMount:r}):i.type==="scroll"?e.jsx(k3,{...s,ref:n,forceMount:r}):i.type==="auto"?e.jsx(US,{...s,ref:n,forceMount:r}):i.type==="always"?e.jsx(Ug,{...s,ref:n}):null});qg.displayName=Zs;var S3=x.forwardRef((t,n)=>{const{forceMount:r,...s}=t,i=ps(Zs,t.__scopeScrollArea),[o,c]=x.useState(!1);return x.useEffect(()=>{const d=i.scrollArea;let p=0;if(d){const m=()=>{window.clearTimeout(p),c(!0)},h=()=>{p=window.setTimeout(()=>c(!1),i.scrollHideDelay)};return d.addEventListener("pointerenter",m),d.addEventListener("pointerleave",h),()=>{window.clearTimeout(p),d.removeEventListener("pointerenter",m),d.removeEventListener("pointerleave",h)}}},[i.scrollArea,i.scrollHideDelay]),e.jsx(gr,{present:r||o,children:e.jsx(US,{"data-state":o?"visible":"hidden",...s,ref:n})})}),k3=x.forwardRef((t,n)=>{const{forceMount:r,...s}=t,i=ps(Zs,t.__scopeScrollArea),o=t.orientation==="horizontal",c=Wp(()=>p("SCROLL_END"),100),[d,p]=N3("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return x.useEffect(()=>{if(d==="idle"){const m=window.setTimeout(()=>p("HIDE"),i.scrollHideDelay);return()=>window.clearTimeout(m)}},[d,i.scrollHideDelay,p]),x.useEffect(()=>{const m=i.viewport,h=o?"scrollLeft":"scrollTop";if(m){let g=m[h];const v=()=>{const j=m[h];g!==j&&(p("SCROLL"),c()),g=j};return m.addEventListener("scroll",v),()=>m.removeEventListener("scroll",v)}},[i.viewport,o,p,c]),e.jsx(gr,{present:r||d!=="hidden",children:e.jsx(Ug,{"data-state":d==="hidden"?"hidden":"visible",...s,ref:n,onPointerEnter:De(t.onPointerEnter,()=>p("POINTER_ENTER")),onPointerLeave:De(t.onPointerLeave,()=>p("POINTER_LEAVE"))})})}),US=x.forwardRef((t,n)=>{const r=ps(Zs,t.__scopeScrollArea),{forceMount:s,...i}=t,[o,c]=x.useState(!1),d=t.orientation==="horizontal",p=Wp(()=>{if(r.viewport){const m=r.viewport.offsetWidth<r.viewport.scrollWidth,h=r.viewport.offsetHeight<r.viewport.scrollHeight;c(d?m:h)}},10);return Yo(r.viewport,p),Yo(r.content,p),e.jsx(gr,{present:s||o,children:e.jsx(Ug,{"data-state":o?"visible":"hidden",...i,ref:n})})}),Ug=x.forwardRef((t,n)=>{const{orientation:r="vertical",...s}=t,i=ps(Zs,t.__scopeScrollArea),o=x.useRef(null),c=x.useRef(0),[d,p]=x.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),m=WS(d.viewport,d.content),h={...s,sizes:d,onSizesChange:p,hasThumb:m>0&&m<1,onThumbChange:v=>o.current=v,onThumbPointerUp:()=>c.current=0,onThumbPointerDown:v=>c.current=v};function g(v,j){return _3(v,c.current,d,j)}return r==="horizontal"?e.jsx(E3,{...h,ref:n,onThumbPositionChange:()=>{if(i.viewport&&o.current){const v=i.viewport.scrollLeft,j=xb(v,d,i.dir);o.current.style.transform=`translate3d(${j}px, 0, 0)`}},onWheelScroll:v=>{i.viewport&&(i.viewport.scrollLeft=v)},onDragScroll:v=>{i.viewport&&(i.viewport.scrollLeft=g(v,i.dir))}}):r==="vertical"?e.jsx(P3,{...h,ref:n,onThumbPositionChange:()=>{if(i.viewport&&o.current){const v=i.viewport.scrollTop,j=xb(v,d);o.current.style.transform=`translate3d(0, ${j}px, 0)`}},onWheelScroll:v=>{i.viewport&&(i.viewport.scrollTop=v)},onDragScroll:v=>{i.viewport&&(i.viewport.scrollTop=g(v))}}):null}),E3=x.forwardRef((t,n)=>{const{sizes:r,onSizesChange:s,...i}=t,o=ps(Zs,t.__scopeScrollArea),[c,d]=x.useState(),p=x.useRef(null),m=vt(n,p,o.onScrollbarXChange);return x.useEffect(()=>{p.current&&d(getComputedStyle(p.current))},[p]),e.jsx(GS,{"data-orientation":"horizontal",...i,ref:m,sizes:r,style:{bottom:0,left:o.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:o.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Kp(r)+"px",...t.style},onThumbPointerDown:h=>t.onThumbPointerDown(h.x),onDragScroll:h=>t.onDragScroll(h.x),onWheelScroll:(h,g)=>{if(o.viewport){const v=o.viewport.scrollLeft+h.deltaX;t.onWheelScroll(v),YS(v,g)&&h.preventDefault()}},onResize:()=>{p.current&&o.viewport&&c&&s({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:p.current.clientWidth,paddingStart:rp(c.paddingLeft),paddingEnd:rp(c.paddingRight)}})}})}),P3=x.forwardRef((t,n)=>{const{sizes:r,onSizesChange:s,...i}=t,o=ps(Zs,t.__scopeScrollArea),[c,d]=x.useState(),p=x.useRef(null),m=vt(n,p,o.onScrollbarYChange);return x.useEffect(()=>{p.current&&d(getComputedStyle(p.current))},[p]),e.jsx(GS,{"data-orientation":"vertical",...i,ref:m,sizes:r,style:{top:0,right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Kp(r)+"px",...t.style},onThumbPointerDown:h=>t.onThumbPointerDown(h.y),onDragScroll:h=>t.onDragScroll(h.y),onWheelScroll:(h,g)=>{if(o.viewport){const v=o.viewport.scrollTop+h.deltaY;t.onWheelScroll(v),YS(v,g)&&h.preventDefault()}},onResize:()=>{p.current&&o.viewport&&c&&s({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:p.current.clientHeight,paddingStart:rp(c.paddingTop),paddingEnd:rp(c.paddingBottom)}})}})}),[T3,BS]=$S(Zs),GS=x.forwardRef((t,n)=>{const{__scopeScrollArea:r,sizes:s,hasThumb:i,onThumbChange:o,onThumbPointerUp:c,onThumbPointerDown:d,onThumbPositionChange:p,onDragScroll:m,onWheelScroll:h,onResize:g,...v}=t,j=ps(Zs,r),[N,b]=x.useState(null),C=vt(n,se=>b(se)),S=x.useRef(null),k=x.useRef(""),P=j.viewport,R=s.content-s.viewport,E=wn(h),A=wn(p),W=Wp(g,10);function X(se){if(S.current){const V=se.clientX-S.current.left,G=se.clientY-S.current.top;m({x:V,y:G})}}return x.useEffect(()=>{const se=V=>{const G=V.target;N?.contains(G)&&E(V,R)};return document.addEventListener("wheel",se,{passive:!1}),()=>document.removeEventListener("wheel",se,{passive:!1})},[P,N,R,E]),x.useEffect(A,[s,A]),Yo(N,W),Yo(j.content,W),e.jsx(T3,{scope:r,scrollbar:N,hasThumb:i,onThumbChange:wn(o),onThumbPointerUp:wn(c),onThumbPositionChange:A,onThumbPointerDown:wn(d),children:e.jsx(et.div,{...v,ref:C,style:{position:"absolute",...v.style},onPointerDown:De(t.onPointerDown,se=>{se.button===0&&(se.target.setPointerCapture(se.pointerId),S.current=N.getBoundingClientRect(),k.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",j.viewport&&(j.viewport.style.scrollBehavior="auto"),X(se))}),onPointerMove:De(t.onPointerMove,X),onPointerUp:De(t.onPointerUp,se=>{const V=se.target;V.hasPointerCapture(se.pointerId)&&V.releasePointerCapture(se.pointerId),document.body.style.webkitUserSelect=k.current,j.viewport&&(j.viewport.style.scrollBehavior=""),S.current=null})})})}),np="ScrollAreaThumb",HS=x.forwardRef((t,n)=>{const{forceMount:r,...s}=t,i=BS(np,t.__scopeScrollArea);return e.jsx(gr,{present:r||i.hasThumb,children:e.jsx(R3,{ref:n,...s})})}),R3=x.forwardRef((t,n)=>{const{__scopeScrollArea:r,style:s,...i}=t,o=ps(np,r),c=BS(np,r),{onThumbPositionChange:d}=c,p=vt(n,g=>c.onThumbChange(g)),m=x.useRef(void 0),h=Wp(()=>{m.current&&(m.current(),m.current=void 0)},100);return x.useEffect(()=>{const g=o.viewport;if(g){const v=()=>{if(h(),!m.current){const j=I3(g,d);m.current=j,d()}};return d(),g.addEventListener("scroll",v),()=>g.removeEventListener("scroll",v)}},[o.viewport,h,d]),e.jsx(et.div,{"data-state":c.hasThumb?"visible":"hidden",...i,ref:p,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...s},onPointerDownCapture:De(t.onPointerDownCapture,g=>{const j=g.target.getBoundingClientRect(),N=g.clientX-j.left,b=g.clientY-j.top;c.onThumbPointerDown({x:N,y:b})}),onPointerUp:De(t.onPointerUp,c.onThumbPointerUp)})});HS.displayName=np;var Bg="ScrollAreaCorner",KS=x.forwardRef((t,n)=>{const r=ps(Bg,t.__scopeScrollArea),s=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&s?e.jsx(A3,{...t,ref:n}):null});KS.displayName=Bg;var A3=x.forwardRef((t,n)=>{const{__scopeScrollArea:r,...s}=t,i=ps(Bg,r),[o,c]=x.useState(0),[d,p]=x.useState(0),m=!!(o&&d);return Yo(i.scrollbarX,()=>{const h=i.scrollbarX?.offsetHeight||0;i.onCornerHeightChange(h),p(h)}),Yo(i.scrollbarY,()=>{const h=i.scrollbarY?.offsetWidth||0;i.onCornerWidthChange(h),c(h)}),m?e.jsx(et.div,{...s,ref:n,style:{width:o,height:d,position:"absolute",right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function rp(t){return t?parseInt(t,10):0}function WS(t,n){const r=t/n;return isNaN(r)?0:r}function Kp(t){const n=WS(t.viewport,t.content),r=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,s=(t.scrollbar.size-r)*n;return Math.max(s,18)}function _3(t,n,r,s="ltr"){const i=Kp(r),o=i/2,c=n||o,d=i-c,p=r.scrollbar.paddingStart+c,m=r.scrollbar.size-r.scrollbar.paddingEnd-d,h=r.content-r.viewport,g=s==="ltr"?[0,h]:[h*-1,0];return QS([p,m],g)(t)}function xb(t,n,r="ltr"){const s=Kp(n),i=n.scrollbar.paddingStart+n.scrollbar.paddingEnd,o=n.scrollbar.size-i,c=n.content-n.viewport,d=o-s,p=r==="ltr"?[0,c]:[c*-1,0],m=Ac(t,p);return QS([0,c],[0,d])(m)}function QS(t,n){return r=>{if(t[0]===t[1]||n[0]===n[1])return n[0];const s=(n[1]-n[0])/(t[1]-t[0]);return n[0]+s*(r-t[0])}}function YS(t,n){return t>0&&t<n}var I3=(t,n=()=>{})=>{let r={left:t.scrollLeft,top:t.scrollTop},s=0;return(function i(){const o={left:t.scrollLeft,top:t.scrollTop},c=r.left!==o.left,d=r.top!==o.top;(c||d)&&n(),r=o,s=window.requestAnimationFrame(i)})(),()=>window.cancelAnimationFrame(s)};function Wp(t,n){const r=wn(t),s=x.useRef(0);return x.useEffect(()=>()=>window.clearTimeout(s.current),[]),x.useCallback(()=>{window.clearTimeout(s.current),s.current=window.setTimeout(r,n)},[r,n])}function Yo(t,n){const r=wn(n);On(()=>{let s=0;if(t){const i=new ResizeObserver(()=>{cancelAnimationFrame(s),s=window.requestAnimationFrame(r)});return i.observe(t),()=>{window.cancelAnimationFrame(s),i.unobserve(t)}}},[t,r])}var ZS=zS,M3=qS,O3=KS;const jt=x.forwardRef(({className:t,children:n,...r},s)=>e.jsxs(ZS,{ref:s,className:Ae("relative overflow-hidden",t),...r,children:[e.jsx(M3,{className:"h-full w-full rounded-[inherit]",children:n}),e.jsx(XS,{}),e.jsx(O3,{})]}));jt.displayName=ZS.displayName;const XS=x.forwardRef(({className:t,orientation:n="vertical",...r},s)=>e.jsx(qg,{ref:s,orientation:n,className:Ae("flex touch-none select-none transition-colors",n==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",n==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...r,children:e.jsx(HS,{className:"relative flex-1 rounded-full bg-border"})}));XS.displayName=qg.displayName;function Mr({title:t,children:n,testId:r}){return e.jsxs("div",{className:"space-y-2","data-testid":r,children:[e.jsxs("h3",{className:"font-semibold text-base flex items-center gap-2",children:[e.jsx(Wc,{className:"h-4 w-4 text-primary"}),t]}),e.jsx("div",{className:"pl-6 text-sm text-muted-foreground space-y-2",children:n})]})}function sr({number:t,title:n,description:r}){return e.jsxs("div",{className:"flex gap-3 items-start",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center text-xs font-medium text-primary",children:t}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:n}),e.jsx("p",{className:"text-muted-foreground",children:r})]})]})}function Gg({children:t}){return e.jsxs("div",{className:"flex gap-2 items-start p-3 bg-amber-500/10 border border-amber-500/20 rounded-md",children:[e.jsx(xr,{className:"h-4 w-4 text-amber-500 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm",children:t})]})}function D3(){return e.jsx(jt,{className:"h-[60vh] pr-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(mn,{className:"h-5 w-5 text-primary"}),"LitAgents v2 - Sistema de Escritura"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Sistema de agentes autnomos que escriben novelas completas siguiendo tu visin creativa."})]}),e.jsx(Mr,{title:"Crear un nuevo proyecto",testId:"section-litagent-create",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(sr,{number:1,title:"Ir a Nuevo Proyecto",description:"Haz clic en 'Nuevo Proyecto' en el men lateral izquierdo."}),e.jsx(sr,{number:2,title:"Completar el formulario",description:"Escribe el ttulo, gnero, idioma, nmero de captulos y palabras objetivo."}),e.jsx(sr,{number:3,title:"Escribir la sinopsis",description:"Describe la trama principal, personajes y ambientacin. Cuanto ms detallada, mejor resultado."}),e.jsx(sr,{number:4,title:"Crear proyecto",description:"El sistema analizar tu sinopsis y preparar la estructura."})]})}),e.jsx(Mr,{title:"Iniciar la generacin",testId:"section-litagent-start",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(sr,{number:1,title:"Seleccionar el proyecto",description:"Elige tu proyecto del selector en la parte superior."}),e.jsx(sr,{number:2,title:"Ir al Panel de Control",description:"Navega a 'Panel de Control' en el men lateral."}),e.jsx(sr,{number:3,title:"Aadir a la cola",description:"Haz clic en 'Iniciar Generacin' o 'Aadir a Cola' si hay otros proyectos."}),e.jsx(sr,{number:4,title:"Monitorear el progreso",description:"Las tarjetas de agentes mostrarn el estado de cada etapa."})]})}),e.jsx(Mr,{title:"Agentes del sistema",testId:"section-litagent-agents",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"outline",children:"Global Architect"}),e.jsx("span",{children:"Planifica la estructura general de la novela"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"outline",children:"Chapter Architect"}),e.jsx("span",{children:"Disea las escenas de cada captulo"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"outline",children:"Ghostwriter v2"}),e.jsx("span",{children:"Escribe el contenido escena por escena"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"outline",children:"Smart Editor"}),e.jsx("span",{children:"Evala la calidad y sugiere mejoras"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"outline",children:"Summarizer"}),e.jsx("span",{children:"Resume captulos para mantener coherencia"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"outline",children:"Consistency"}),e.jsx("span",{children:"Verifica continuidad de personajes y tramas"})]})]})}),e.jsxs(Mr,{title:"Control de calidad",testId:"section-litagent-quality",children:[e.jsx("p",{children:"El sistema evala cada captulo con puntuaciones de 1 a 10:"}),e.jsxs("div",{className:"space-y-1 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Us,{className:"h-4 w-4 text-green-500"}),e.jsxs("span",{children:[e.jsx("strong",{children:"8-10:"})," Aprobado automticamente"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(on,{className:"h-4 w-4 text-amber-500"}),e.jsxs("span",{children:[e.jsx("strong",{children:"6-7:"})," Se reescribe automticamente"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(on,{className:"h-4 w-4 text-red-500"}),e.jsxs("span",{children:[e.jsx("strong",{children:"1-5:"})," Requiere intervencin manual"]})]})]})]}),e.jsx(Gg,{children:"Puedes pausar la generacin en cualquier momento. El sistema recordar dnde se qued y continuar desde ese punto cuando lo reanudes."})]})})}function L3(){return e.jsx(jt,{className:"h-[60vh] pr-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(da,{className:"h-5 w-5 text-primary"}),"Re-editor - Editor de Desarrollo"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Sistema de edicin profesional para manuscritos existentes con auditora forense y anlisis comercial."})]}),e.jsx(Mr,{title:"Importar un manuscrito",testId:"section-reeditor-import",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(sr,{number:1,title:"Ir a Re-editor",description:"Haz clic en 'Re-editor' en el men lateral."}),e.jsx(sr,{number:2,title:"Nuevo proyecto de edicin",description:"Haz clic en 'Nuevo Proyecto' en la esquina superior derecha."}),e.jsx(sr,{number:3,title:"Pegar el manuscrito",description:"Copia y pega tu texto en el rea de importacin. El sistema detectar los captulos automticamente."}),e.jsx(sr,{number:4,title:"Configurar opciones",description:"Indica el gnero, idioma y tipo de edicin deseado."})]})}),e.jsx(Mr,{title:"Fases del proceso",testId:"section-reeditor-phases",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{children:"1. Auditora Forense"}),e.jsx("span",{children:"Detecta errores de continuidad, inconsistencias y problemas"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{children:"2. Beta Reader"}),e.jsx("span",{children:"Analiza viabilidad comercial y compara con el mercado"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{children:"3. Correccin"}),e.jsx("span",{children:"Aplica correcciones quirrgicas o reescrituras segn necesidad"})]})]})}),e.jsxs(Mr,{title:"Correccin quirrgica vs Reescritura",testId:"section-reeditor-surgical",children:[e.jsx("p",{children:"El sistema decide automticamente el mejor enfoque:"}),e.jsxs("div",{className:"space-y-2 mt-2",children:[e.jsxs("div",{className:"p-2 bg-green-500/10 rounded border border-green-500/20",children:[e.jsx("p",{className:"font-medium text-green-600 dark:text-green-400",children:"Correccin Quirrgica"}),e.jsx("p",{className:"text-xs",children:"3 problemas o menos, ninguno crtico. Ahorra ~50% de tokens."})]}),e.jsxs("div",{className:"p-2 bg-amber-500/10 rounded border border-amber-500/20",children:[e.jsx("p",{className:"font-medium text-amber-600 dark:text-amber-400",children:"Reescritura Completa"}),e.jsx("p",{className:"text-xs",children:"Ms de 3 problemas o alguno crtico. Reescribe el captulo entero."})]})]})]}),e.jsxs(Mr,{title:"Auditora Forense",testId:"section-reeditor-forensic",children:[e.jsx("p",{children:"Detecta 7 tipos de violaciones:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-2",children:[e.jsx("li",{children:"Inconsistencias temporales"}),e.jsx("li",{children:"Contradicciones de personajes"}),e.jsx("li",{children:"Errores de continuidad espacial"}),e.jsx("li",{children:"Objetos que aparecen/desaparecen"}),e.jsx("li",{children:"Cambios de personalidad injustificados"}),e.jsx("li",{children:"Hilos argumentales abandonados"}),e.jsx("li",{children:"Anacronismos"})]})]}),e.jsxs(Mr,{title:"Beta Reader Comercial",testId:"section-reeditor-beta",children:[e.jsx("p",{children:"Proporciona anlisis de mercado:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-2",children:[e.jsx("li",{children:"Puntuacin de viabilidad comercial"}),e.jsx("li",{children:"Comparacin con libros exitosos del gnero"}),e.jsx("li",{children:"Fortalezas y debilidades narrativas"}),e.jsx("li",{children:"Recomendaciones de mejora"}),e.jsx("li",{children:"Pblico objetivo sugerido"})]})]}),e.jsx(Gg,{children:"Puedes ver los resultados de la auditora antes de aplicar correcciones. Esto te permite revisar qu cambios se harn."})]})})}function F3(){return e.jsx(jt,{className:"h-[60vh] pr-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(Mi,{className:"h-5 w-5 text-primary"}),"Traductor - LitTranslators 2.0"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Sistema de traduccin literaria con preservacin de estilo y revisin por hablante nativo."})]}),e.jsx(Mr,{title:"Traducir un proyecto",testId:"section-translator-howto",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(sr,{number:1,title:"Ir a Exportar",description:"Navega a 'Exportar' en el men lateral."}),e.jsx(sr,{number:2,title:"Seleccionar proyecto",description:"Elige el proyecto completado que deseas traducir."}),e.jsx(sr,{number:3,title:"Elegir idiomas",description:"Selecciona el idioma de origen y el idioma destino."}),e.jsx(sr,{number:4,title:"Seleccionar gnero",description:"Indica el gnero para adaptar el estilo de traduccin."}),e.jsx(sr,{number:5,title:"Iniciar traduccin",description:"El sistema procesar el texto en fragmentos optimizados."})]})}),e.jsx(Mr,{title:"Fases del proceso",testId:"section-translator-phases",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{children:"1. Anlisis"}),e.jsx("span",{children:"Detecta estilo, tipografa y convenciones del original"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{children:"2. Traduccin"}),e.jsx("span",{children:"Traduce por fragmentos preservando el tono y estilo"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{children:"3. Revisin Nativa"}),e.jsx("span",{children:'Un "lector beta nativo" revisa y corrige'})]})]})}),e.jsxs(Mr,{title:"Lector Beta Nativo",testId:"section-translator-native",children:[e.jsx("p",{children:"Simula un hablante nativo del idioma destino que:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-2",children:[e.jsx("li",{children:"Evala la fluidez y naturalidad del texto"}),e.jsx("li",{children:'Detecta expresiones que suenan "traducidas"'}),e.jsx("li",{children:"Verifica la adherencia al gnero literario"}),e.jsx("li",{children:"Aplica correcciones automticas"}),e.jsx("li",{children:"Da puntuaciones de calidad (1-10)"})]})]}),e.jsx(Mr,{title:"Puntuaciones del Lector Nativo",testId:"section-translator-scores",children:e.jsxs("div",{className:"space-y-2 mt-2",children:[e.jsxs("div",{className:"flex justify-between items-center gap-2 flex-wrap","data-testid":"text-score-quality",children:[e.jsx("span",{children:"Calidad General"}),e.jsx("span",{className:"text-muted-foreground",children:"Evaluacin global de la traduccin"})]}),e.jsxs("div",{className:"flex justify-between items-center gap-2 flex-wrap","data-testid":"text-score-fluency",children:[e.jsx("span",{children:"Fluidez"}),e.jsx("span",{className:"text-muted-foreground",children:"Naturalidad del lenguaje"})]}),e.jsxs("div",{className:"flex justify-between items-center gap-2 flex-wrap","data-testid":"text-score-genre",children:[e.jsx("span",{children:"Adherencia al Gnero"}),e.jsx("span",{className:"text-muted-foreground",children:"Respeto a las convenciones del gnero"})]}),e.jsxs("div",{className:"flex justify-between items-center gap-2 flex-wrap","data-testid":"text-score-cultural",children:[e.jsx("span",{children:"Adaptacin Cultural"}),e.jsx("span",{className:"text-muted-foreground",children:"Localizacin de referencias culturales"})]})]})}),e.jsx(Mr,{title:"Idiomas disponibles",testId:"section-translator-languages",children:e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsx(Q,{variant:"outline",children:"Espaol"}),e.jsx(Q,{variant:"outline",children:"Ingls (US/UK)"}),e.jsx(Q,{variant:"outline",children:"Francs"}),e.jsx(Q,{variant:"outline",children:"Alemn"}),e.jsx(Q,{variant:"outline",children:"Italiano"}),e.jsx(Q,{variant:"outline",children:"Portugus (BR/PT)"}),e.jsx(Q,{variant:"outline",children:"Japons"}),e.jsx(Q,{variant:"outline",children:"Chino"}),e.jsx(Q,{variant:"outline",children:"Coreano"})]})}),e.jsx(Gg,{children:"Las traducciones se guardan automticamente. Puedes descargarlas en formato Markdown o DOCX desde la lista de traducciones."})]})})}function $3(){const[t,n]=x.useState(!1);return e.jsxs(Pn,{open:t,onOpenChange:n,children:[e.jsx(gS,{asChild:!0,children:e.jsx(B,{variant:"ghost",size:"icon",className:"text-muted-foreground","data-testid":"button-help",children:e.jsx(U0,{className:"h-5 w-5"})})}),e.jsxs(yn,{className:"max-w-2xl",children:[e.jsx(jn,{children:e.jsxs(bn,{className:"flex items-center gap-2",children:[e.jsx(U0,{className:"h-5 w-5 text-primary"}),"Manual de Usuario"]})}),e.jsxs(ci,{defaultValue:"litagent",className:"w-full",children:[e.jsxs(ga,{className:"grid w-full grid-cols-3",children:[e.jsxs(Bt,{value:"litagent",className:"flex items-center gap-1.5","data-testid":"tab-litagent",children:[e.jsx(mn,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Escritura"})]}),e.jsxs(Bt,{value:"reeditor",className:"flex items-center gap-1.5","data-testid":"tab-reeditor",children:[e.jsx(da,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Re-editor"})]}),e.jsxs(Bt,{value:"translator",className:"flex items-center gap-1.5","data-testid":"tab-translator",children:[e.jsx(Mi,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Traductor"})]})]}),e.jsx(Gt,{value:"litagent",className:"mt-4",children:e.jsx(D3,{})}),e.jsx(Gt,{value:"reeditor",className:"mt-4",children:e.jsx(L3,{})}),e.jsx(Gt,{value:"translator",className:"mt-4",children:e.jsx(F3,{})})]})]})]})}function z3(){return e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:e.jsx(me,{className:"w-full max-w-md mx-4",children:e.jsxs(he,{className:"pt-6",children:[e.jsxs("div",{className:"flex mb-4 gap-2",children:[e.jsx(Dr,{className:"h-8 w-8 text-red-500"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),e.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}var Hg="Progress",Kg=100,[V3]=Zn(Hg),[q3,U3]=V3(Hg),JS=x.forwardRef((t,n)=>{const{__scopeProgress:r,value:s=null,max:i,getValueLabel:o=B3,...c}=t;(i||i===0)&&!gb(i)&&console.error(G3(`${i}`,"Progress"));const d=gb(i)?i:Kg;s!==null&&!vb(s,d)&&console.error(H3(`${s}`,"Progress"));const p=vb(s,d)?s:null,m=sp(p)?o(p,d):void 0;return e.jsx(q3,{scope:r,value:p,max:d,children:e.jsx(et.div,{"aria-valuemax":d,"aria-valuemin":0,"aria-valuenow":sp(p)?p:void 0,"aria-valuetext":m,role:"progressbar","data-state":nk(p,d),"data-value":p??void 0,"data-max":d,...c,ref:n})})});JS.displayName=Hg;var ek="ProgressIndicator",tk=x.forwardRef((t,n)=>{const{__scopeProgress:r,...s}=t,i=U3(ek,r);return e.jsx(et.div,{"data-state":nk(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...s,ref:n})});tk.displayName=ek;function B3(t,n){return`${Math.round(t/n*100)}%`}function nk(t,n){return t==null?"indeterminate":t===n?"complete":"loading"}function sp(t){return typeof t=="number"}function gb(t){return sp(t)&&!isNaN(t)&&t>0}function vb(t,n){return sp(t)&&!isNaN(t)&&t<=n&&t>=0}function G3(t,n){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${n}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Kg}\`.`}function H3(t,n){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${n}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Kg} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var rk=JS,K3=tk;const di=x.forwardRef(({className:t,value:n,...r},s)=>e.jsx(rk,{ref:s,className:Ae("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...r,children:e.jsx(K3,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(n||0)}%)`}})}));di.displayName=rk.displayName;const W3={architect:e.jsx(Or,{className:"h-5 w-5"}),ghostwriter:e.jsx(ar,{className:"h-5 w-5"}),editor:e.jsx(fr,{className:"h-5 w-5"}),copyeditor:e.jsx(yt,{className:"h-5 w-5"}),"final-reviewer":e.jsx(qu,{className:"h-5 w-5"}),"continuity-sentinel":e.jsx(Ko,{className:"h-5 w-5"}),"voice-auditor":e.jsx(mA,{className:"h-5 w-5"}),"semantic-detector":e.jsx(ma,{className:"h-5 w-5"}),"global-architect":e.jsx(Or,{className:"h-5 w-5"}),"chapter-architect":e.jsx(Or,{className:"h-5 w-5"}),"ghostwriter-v2":e.jsx(ar,{className:"h-5 w-5"}),"smart-editor":e.jsx(fr,{className:"h-5 w-5"}),summarizer:e.jsx(yt,{className:"h-5 w-5"}),"narrative-director":e.jsx(qu,{className:"h-5 w-5"}),"universal-consistency":e.jsx(Ko,{className:"h-5 w-5"}),"beta-reader":e.jsx(fr,{className:"h-5 w-5"}),inquisidor:e.jsx(s1,{className:"h-5 w-5"}),estilista:e.jsx(xr,{className:"h-5 w-5"}),ritmo:e.jsx(Kc,{className:"h-5 w-5"}),ensamblador:e.jsx(yc,{className:"h-5 w-5"})},Q3={architect:"bg-chart-1/10 text-chart-1",ghostwriter:"bg-chart-2/10 text-chart-2",editor:"bg-chart-3/10 text-chart-3",copyeditor:"bg-chart-4/10 text-chart-4","final-reviewer":"bg-chart-5/10 text-chart-5","continuity-sentinel":"bg-amber-500/10 text-amber-600 dark:text-amber-400","voice-auditor":"bg-violet-500/10 text-violet-600 dark:text-violet-400","semantic-detector":"bg-cyan-500/10 text-cyan-600 dark:text-cyan-400","global-architect":"bg-indigo-500/10 text-indigo-600 dark:text-indigo-400","chapter-architect":"bg-purple-500/10 text-purple-600 dark:text-purple-400","ghostwriter-v2":"bg-emerald-500/10 text-emerald-600 dark:text-emerald-400","smart-editor":"bg-rose-500/10 text-rose-600 dark:text-rose-400",summarizer:"bg-sky-500/10 text-sky-600 dark:text-sky-400","narrative-director":"bg-orange-500/10 text-orange-600 dark:text-orange-400","universal-consistency":"bg-teal-500/10 text-teal-600 dark:text-teal-400","beta-reader":"bg-pink-500/10 text-pink-600 dark:text-pink-400",inquisidor:"bg-red-500/10 text-red-600 dark:text-red-400",estilista:"bg-fuchsia-500/10 text-fuchsia-600 dark:text-fuchsia-400",ritmo:"bg-lime-500/10 text-lime-600 dark:text-lime-400",ensamblador:"bg-blue-500/10 text-blue-600 dark:text-blue-400"},Y3={idle:"bg-muted text-muted-foreground",thinking:"bg-chart-1/20 text-chart-1",writing:"bg-chart-2/20 text-chart-2",editing:"bg-chart-3/20 text-chart-3",reviewing:"bg-chart-5/20 text-chart-5",polishing:"bg-chart-4/20 text-chart-4",completed:"bg-green-500/20 text-green-600 dark:text-green-400",error:"bg-destructive/20 text-destructive",analyzing:"bg-amber-500/20 text-amber-600 dark:text-amber-400",warning:"bg-orange-500/20 text-orange-600 dark:text-orange-400"},Z3={idle:"En espera",thinking:"Pensando",writing:"Escribiendo",editing:"Editando",reviewing:"Revisando",polishing:"Puliendo",completed:"Completado",error:"Error",analyzing:"Analizando",warning:"Advertencia"};function _i({name:t,role:n,status:r,currentTask:s,progress:i=0,lastActivity:o}){const c=r!=="idle"&&r!=="completed"&&r!=="error";return e.jsxs(me,{className:`transition-all duration-300 flex flex-col ${c?"ring-1 ring-primary/30":""}`,"data-testid":`card-agent-${n}`,children:[e.jsx(Re,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-md ${Q3[n]}`,children:W3[n]}),e.jsx("div",{className:"min-w-0 flex-1",children:e.jsx(Ie,{className:"text-sm font-medium truncate",children:t})})]})}),e.jsxs(he,{className:"flex-1 flex flex-col justify-between space-y-3 pt-0",children:[e.jsxs("div",{className:"min-h-[2rem]",children:[s&&e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2","data-testid":`text-task-${n}`,children:s}),!s&&e.jsx("p",{className:"text-xs text-muted-foreground/50 italic",children:"Sin tarea asignada"})]}),c&&i>0&&e.jsx("div",{className:"space-y-1",children:e.jsx(di,{value:i,className:"h-1"})}),e.jsxs("div",{className:"flex items-center justify-between gap-2 pt-2 border-t border-border/50",children:[e.jsxs(Q,{className:`${Y3[r]} text-xs font-medium uppercase tracking-wide`,"data-testid":`badge-agent-status-${n}`,children:[c&&e.jsx(be,{className:"h-3 w-3 mr-1 animate-spin"}),Z3[r]]}),o&&e.jsx("p",{className:"text-[10px] text-muted-foreground",children:new Date(o).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})})]})]})]})}const yb=[{role:"global-architect",name:"Arquitecto Global",icon:e.jsx(Or,{className:"h-4 w-4"}),group:"planificacin"},{role:"ghostwriter-v2",name:"Escritor",icon:e.jsx(ar,{className:"h-4 w-4"}),group:"escritura"},{role:"inquisidor",name:"Inquisidor",icon:e.jsx(s1,{className:"h-4 w-4"}),group:"auditora"},{role:"estilista",name:"Estilista",icon:e.jsx(xr,{className:"h-4 w-4"}),group:"auditora"},{role:"ritmo",name:"Ritmo",icon:e.jsx(Kc,{className:"h-4 w-4"}),group:"auditora"},{role:"smart-editor",name:"Corrector",icon:e.jsx(fr,{className:"h-4 w-4"}),group:"correccin"},{role:"ensamblador",name:"Ensamblador",icon:e.jsx(yc,{className:"h-4 w-4"}),group:"final"}];function jb(t,n,r,s=[]){return r.includes(t)?"completed":s.includes(t)?"warning":n===t?"active":"pending"}function X3({currentStage:t,completedStages:n,warningStages:r=[]}){const s=yb.filter(o=>o.group==="auditora"),i=yb.filter(o=>o.group!=="auditora");return e.jsx("div",{className:"flex items-center justify-center gap-2 p-4 flex-wrap","data-testid":"process-flow",children:i.map((o,c)=>{const d=jb(o.role,t,n,r),p=o.role==="ghostwriter-v2",m=o.role==="smart-editor";return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`
                flex items-center gap-2 px-3 py-2 rounded-md transition-all duration-300
                ${d==="active"?"bg-primary text-primary-foreground animate-pulse":d==="completed"?"bg-green-500/20 text-green-600 dark:text-green-400":d==="warning"?"bg-orange-500/20 text-orange-600 dark:text-orange-400":"bg-muted text-muted-foreground"}
              `,"data-testid":`stage-${o.role}`,children:[d==="completed"?e.jsx(Tn,{className:"h-4 w-4"}):o.icon,e.jsx("span",{className:"text-sm font-medium",children:o.name})]}),p&&e.jsxs(e.Fragment,{children:[e.jsx(Io,{className:`h-4 w-4 ${n.includes(o.role)?"text-green-500":"text-muted-foreground/50"}`}),e.jsx("div",{className:"flex items-center gap-1 border border-dashed border-muted-foreground/30 rounded-md px-2 py-1","data-testid":"audit-group",children:s.map((h,g)=>{const v=jb(h.role,t,n,r);return e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("div",{className:`
                            flex items-center gap-1 px-2 py-1.5 rounded-md transition-all duration-300 text-xs
                            ${v==="active"?"bg-primary text-primary-foreground animate-pulse":v==="completed"?"bg-green-500/20 text-green-600 dark:text-green-400":v==="warning"?"bg-orange-500/20 text-orange-600 dark:text-orange-400":"bg-muted text-muted-foreground"}
                          `,"data-testid":`stage-${h.role}`,children:[v==="completed"?e.jsx(Tn,{className:"h-3 w-3"}):h.icon,e.jsx("span",{className:"font-medium",children:h.name})]}),g<s.length-1&&e.jsx("span",{className:"text-muted-foreground/40 text-xs",children:"|"})]},h.role)})}),e.jsx(Io,{className:`h-4 w-4 ${s.every(h=>n.includes(h.role))?"text-green-500":"text-muted-foreground/50"}`})]}),!p&&!m&&c<i.length-1&&e.jsx(Io,{className:`h-4 w-4 ${n.includes(o.role)?"text-green-500":"text-muted-foreground/50"}`}),m&&c<i.length-1&&e.jsx(Io,{className:`h-4 w-4 ${n.includes(o.role)?"text-green-500":"text-muted-foreground/50"}`})]},o.role)})})}const J3={thinking:e.jsx(Or,{className:"h-3.5 w-3.5"}),writing:e.jsx(ar,{className:"h-3.5 w-3.5"}),editing:e.jsx(fr,{className:"h-3.5 w-3.5"}),polishing:e.jsx(yt,{className:"h-3.5 w-3.5"}),error:e.jsx(Dr,{className:"h-3.5 w-3.5"}),success:e.jsx(Xt,{className:"h-3.5 w-3.5"}),info:e.jsx("span",{className:"h-3.5 w-3.5 inline-block text-center",children:"i"})},eD={thinking:"[PENSANDO]",writing:"[ESCRIBIENDO]",editing:"[EDITANDO]",polishing:"[PULIENDO]",error:"[ERROR]",success:"[COMPLETADO]",info:"[INFO]"},tD={thinking:"text-chart-1",writing:"text-chart-2",editing:"text-chart-3",polishing:"text-chart-4",error:"text-destructive",success:"text-green-500",info:"text-muted-foreground"};function nD(t){const n=[/Captulo\s+(-?\d+)/i,/Cap\.\s*(-?\d+)/i,/el\s+Captulo\s+(-?\d+)/i,/Checkpoint\s+#(\d+)/i];for(const r of n){const s=t.match(r);if(s)return parseInt(s[1],10)}return null}const Pf={},bb=["bg-blue-500/20 text-blue-400","bg-purple-500/20 text-purple-400","bg-amber-500/20 text-amber-400","bg-emerald-500/20 text-emerald-400","bg-rose-500/20 text-rose-400","bg-cyan-500/20 text-cyan-400","bg-orange-500/20 text-orange-400","bg-indigo-500/20 text-indigo-400"];function rD(t){if(!Pf[t]){const n=Math.abs(t)%bb.length;Pf[t]=bb[n]}return Pf[t]}function sD({logs:t,projectId:n}){const r=x.useRef(null),s=x.useRef(!1),i=x.useRef(n),o=x.useRef(0);x.useEffect(()=>{if(r.current){const d=r.current.querySelector("[data-radix-scroll-area-viewport]");if(d){const p=i.current!==n,m=o.current===0&&t.length>0;p||m?(d.scrollTop=d.scrollHeight,s.current=!1):s.current||d.scrollHeight-d.scrollTop-d.clientHeight<100&&(d.scrollTop=d.scrollHeight),i.current=n,o.current=t.length}}},[t,n]),x.useEffect(()=>{if(r.current){const d=r.current.querySelector("[data-radix-scroll-area-viewport]");if(d){const p=()=>{const m=d.scrollHeight-d.scrollTop-d.clientHeight<100;s.current=!m};return d.addEventListener("scroll",p),()=>d.removeEventListener("scroll",p)}}},[]);const c=()=>{n&&window.open(`/api/projects/${n}/export-logs-pdf`,"_blank")};return e.jsxs("div",{className:"bg-card border border-card-border rounded-md font-mono text-sm","data-testid":"console-output",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-card-border",children:[e.jsx("span",{className:"text-xs font-medium uppercase tracking-wide text-muted-foreground",children:"Consola de Agentes"}),e.jsxs("div",{className:"flex items-center gap-3",children:[n&&e.jsxs(B,{variant:"outline",size:"sm",onClick:c,"data-testid":"button-export-logs",children:[e.jsx(xn,{className:"h-3.5 w-3.5 mr-1.5"}),"Exportar Logs"]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-red-500/80"}),e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-yellow-500/80"}),e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-green-500/80"})]})]})]}),e.jsx(jt,{className:"h-64",ref:r,children:e.jsx("div",{className:"p-4 space-y-1.5",children:t.length===0?e.jsx("p",{className:"text-muted-foreground/50 text-xs",children:"Los registros de actividad aparecern aqu cuando inicies un proyecto..."}):t.map(d=>{const p=nD(d.message);return e.jsxs("div",{className:"flex items-start gap-2 leading-relaxed","data-testid":`log-entry-${d.id}`,children:[e.jsx("span",{className:"text-xs text-muted-foreground shrink-0 w-16",children:new Date(d.timestamp).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}),p!==null&&e.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded font-medium shrink-0 ${rD(p)}`,children:p===-1?"Ep":p===0?"Pr":`C${p}`}),e.jsxs("span",{className:`flex items-center gap-1 shrink-0 ${tD[d.type]}`,children:[J3[d.type],e.jsx("span",{className:"font-semibold",children:eD[d.type]})]}),e.jsx("span",{className:"text-foreground",children:d.message})]},d.id)})})})]})}var sk="AlertDialog",[aD]=Zn(sk,[iC]),ya=iC(),ak=t=>{const{__scopeAlertDialog:n,...r}=t,s=ya(n);return e.jsx(Og,{...s,...r,modal:!0})};ak.displayName=sk;var iD="AlertDialogTrigger",oD=x.forwardRef((t,n)=>{const{__scopeAlertDialog:r,...s}=t,i=ya(r);return e.jsx(wC,{...i,...s,ref:n})});oD.displayName=iD;var lD="AlertDialogPortal",ik=t=>{const{__scopeAlertDialog:n,...r}=t,s=ya(n);return e.jsx(Dg,{...s,...r})};ik.displayName=lD;var cD="AlertDialogOverlay",ok=x.forwardRef((t,n)=>{const{__scopeAlertDialog:r,...s}=t,i=ya(r);return e.jsx(Yc,{...i,...s,ref:n})});ok.displayName=cD;var zo="AlertDialogContent",[dD,uD]=aD(zo),pD=NN("AlertDialogContent"),lk=x.forwardRef((t,n)=>{const{__scopeAlertDialog:r,children:s,...i}=t,o=ya(r),c=x.useRef(null),d=vt(n,c),p=x.useRef(null);return e.jsx(sO,{contentName:zo,titleName:ck,docsSlug:"alert-dialog",children:e.jsx(dD,{scope:r,cancelRef:p,children:e.jsxs(Zc,{role:"alertdialog",...o,...i,ref:d,onOpenAutoFocus:De(i.onOpenAutoFocus,m=>{m.preventDefault(),p.current?.focus({preventScroll:!0})}),onPointerDownOutside:m=>m.preventDefault(),onInteractOutside:m=>m.preventDefault(),children:[e.jsx(pD,{children:s}),e.jsx(hD,{contentRef:c})]})})})});lk.displayName=zo;var ck="AlertDialogTitle",dk=x.forwardRef((t,n)=>{const{__scopeAlertDialog:r,...s}=t,i=ya(r);return e.jsx(Xc,{...i,...s,ref:n})});dk.displayName=ck;var uk="AlertDialogDescription",pk=x.forwardRef((t,n)=>{const{__scopeAlertDialog:r,...s}=t,i=ya(r);return e.jsx(Jc,{...i,...s,ref:n})});pk.displayName=uk;var mD="AlertDialogAction",mk=x.forwardRef((t,n)=>{const{__scopeAlertDialog:r,...s}=t,i=ya(r);return e.jsx(zp,{...i,...s,ref:n})});mk.displayName=mD;var hk="AlertDialogCancel",fk=x.forwardRef((t,n)=>{const{__scopeAlertDialog:r,...s}=t,{cancelRef:i}=uD(hk,r),o=ya(r),c=vt(n,i);return e.jsx(zp,{...o,...s,ref:c})});fk.displayName=hk;var hD=({contentRef:t})=>{const n=`\`${zo}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${zo}\` by passing a \`${uk}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${zo}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return x.useEffect(()=>{document.getElementById(t.current?.getAttribute("aria-describedby"))||console.warn(n)},[n,t]),null},fD=ak,xD=ik,xk=ok,gk=lk,vk=mk,yk=fk,jk=dk,bk=pk;const Wg=fD,gD=xD,wk=x.forwardRef(({className:t,...n},r)=>e.jsx(xk,{className:Ae("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n,ref:r}));wk.displayName=xk.displayName;const Qp=x.forwardRef(({className:t,...n},r)=>e.jsxs(gD,{children:[e.jsx(wk,{}),e.jsx(gk,{ref:r,className:Ae("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n})]}));Qp.displayName=gk.displayName;const Yp=({className:t,...n})=>e.jsx("div",{className:Ae("flex flex-col space-y-2 text-center sm:text-left",t),...n});Yp.displayName="AlertDialogHeader";const Zp=({className:t,...n})=>e.jsx("div",{className:Ae("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...n});Zp.displayName="AlertDialogFooter";const Xp=x.forwardRef(({className:t,...n},r)=>e.jsx(jk,{ref:r,className:Ae("text-lg font-semibold",t),...n}));Xp.displayName=jk.displayName;const Jp=x.forwardRef(({className:t,...n},r)=>e.jsx(bk,{ref:r,className:Ae("text-sm text-muted-foreground",t),...n}));Jp.displayName=bk.displayName;const _c=x.forwardRef(({className:t,...n},r)=>e.jsx(vk,{ref:r,className:Ae(Pg(),t),...n}));_c.displayName=vk.displayName;const em=x.forwardRef(({className:t,...n},r)=>e.jsx(yk,{ref:r,className:Ae(Pg({variant:"outline"}),"mt-2 sm:mt-0",t),...n}));em.displayName=yk.displayName;function Vs({open:t,onOpenChange:n,title:r,description:s,confirmText:i="Confirmar",cancelText:o="Cancelar",variant:c="default",onConfirm:d}){return e.jsx(Wg,{open:t,onOpenChange:n,children:e.jsxs(Qp,{children:[e.jsxs(Yp,{children:[e.jsx(Xp,{children:r}),e.jsx(Jp,{children:s})]}),e.jsxs(Zp,{children:[e.jsx(em,{children:o}),e.jsx(_c,{onClick:d,className:c==="destructive"?"bg-destructive text-destructive-foreground hover:bg-destructive/90":"",children:i})]})]})})}function vD({open:t,onOpenChange:n,title:r,description:s,onContinue:i,onRestart:o,continueText:c="Continuar",restartText:d="Reiniciar desde cero",cancelText:p="Cancelar"}){return e.jsx(Wg,{open:t,onOpenChange:n,children:e.jsxs(Qp,{children:[e.jsxs(Yp,{children:[e.jsx(Xp,{children:r}),e.jsx(Jp,{children:s})]}),e.jsxs(Zp,{className:"flex-col sm:flex-row gap-2",children:[e.jsx(em,{children:p}),e.jsx(_c,{onClick:o,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90","data-testid":"button-restart-from-scratch",children:d}),e.jsx(_c,{onClick:i,"data-testid":"button-continue-generation",children:c})]})]})})}var Qg="Collapsible",[yD,Nk]=Zn(Qg),[jD,Yg]=yD(Qg),Ck=x.forwardRef((t,n)=>{const{__scopeCollapsible:r,open:s,defaultOpen:i,disabled:o,onOpenChange:c,...d}=t,[p=!1,m]=Zr({prop:s,defaultProp:i,onChange:c});return e.jsx(jD,{scope:r,disabled:o,contentId:Qr(),open:p,onOpenToggle:x.useCallback(()=>m(h=>!h),[m]),children:e.jsx(et.div,{"data-state":ev(p),"data-disabled":o?"":void 0,...d,ref:n})})});Ck.displayName=Qg;var Sk="CollapsibleTrigger",Zg=x.forwardRef((t,n)=>{const{__scopeCollapsible:r,...s}=t,i=Yg(Sk,r);return e.jsx(et.button,{type:"button","aria-controls":i.contentId,"aria-expanded":i.open||!1,"data-state":ev(i.open),"data-disabled":i.disabled?"":void 0,disabled:i.disabled,...s,ref:n,onClick:De(t.onClick,i.onOpenToggle)})});Zg.displayName=Sk;var Xg="CollapsibleContent",Jg=x.forwardRef((t,n)=>{const{forceMount:r,...s}=t,i=Yg(Xg,t.__scopeCollapsible);return e.jsx(gr,{present:r||i.open,children:({present:o})=>e.jsx(bD,{...s,ref:n,present:o})})});Jg.displayName=Xg;var bD=x.forwardRef((t,n)=>{const{__scopeCollapsible:r,present:s,children:i,...o}=t,c=Yg(Xg,r),[d,p]=x.useState(s),m=x.useRef(null),h=vt(n,m),g=x.useRef(0),v=g.current,j=x.useRef(0),N=j.current,b=c.open||d,C=x.useRef(b),S=x.useRef(void 0);return x.useEffect(()=>{const k=requestAnimationFrame(()=>C.current=!1);return()=>cancelAnimationFrame(k)},[]),On(()=>{const k=m.current;if(k){S.current=S.current||{transitionDuration:k.style.transitionDuration,animationName:k.style.animationName},k.style.transitionDuration="0s",k.style.animationName="none";const P=k.getBoundingClientRect();g.current=P.height,j.current=P.width,C.current||(k.style.transitionDuration=S.current.transitionDuration,k.style.animationName=S.current.animationName),p(s)}},[c.open,s]),e.jsx(et.div,{"data-state":ev(c.open),"data-disabled":c.disabled?"":void 0,id:c.contentId,hidden:!b,...o,ref:h,style:{"--radix-collapsible-content-height":v?`${v}px`:void 0,"--radix-collapsible-content-width":N?`${N}px`:void 0,...t.style},children:b&&i})});function ev(t){return t?"open":"closed"}var kk=Ck,wD=Zg,ND=Jg;const CD=kk,SD=Zg,kD=Jg;function ED({projectId:t}){const{toast:n}=nn(),[r,s]=x.useState(new Set),[i,o]=x.useState(null),{data:c,isLoading:d,refetch:p}=Ke({queryKey:["/api/projects/duplicate-chapters"]}),m=t?c?.filter(N=>N.projectId===t):c,h=ye({mutationFn:async N=>je("POST",`/api/projects/${N.projectId}/duplicate-chapters/purge`,{chapterNumber:N.chapterNumber,generationKey:N.generationKey,keepGeneration:N.keepGeneration}),onSuccess:(N,b)=>{ae.invalidateQueries({queryKey:["/api/projects/duplicate-chapters"]}),ae.invalidateQueries({queryKey:["/api/projects",b.projectId,"chapters"]}),ae.invalidateQueries({queryKey:["/api/chapters"]}),n({title:"Duplicados eliminados",description:"Los captulos duplicados se han eliminado correctamente"})},onError:N=>{n({title:"Error",description:N.message||"No se pudieron eliminar los duplicados",variant:"destructive"})}}),g=N=>{s(b=>{const C=new Set(b);return C.has(N)?C.delete(N):C.add(N),C})},v=N=>new Date(N).toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"});if(d)return e.jsxs(me,{children:[e.jsx(Re,{className:"pb-3",children:e.jsxs(Ie,{className:"text-lg flex items-center gap-2",children:[e.jsx(Uu,{className:"h-5 w-5"}),"Captulos Duplicados"]})}),e.jsx(he,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Buscando duplicados..."})})]});const j=m&&m.length>0;return e.jsxs(e.Fragment,{children:[e.jsxs(me,{children:[e.jsx(Re,{className:"pb-3",children:e.jsxs(Ie,{className:"text-lg flex items-center gap-2",children:[e.jsx(Uu,{className:"h-5 w-5"}),"Captulos Duplicados",j&&e.jsxs(Q,{variant:"destructive",className:"ml-2",children:[m.reduce((N,b)=>N+b.duplicateGroups.length,0)," grupos"]})]})}),e.jsx(he,{className:"space-y-3",children:j?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[e.jsx(on,{className:"h-4 w-4 text-yellow-500"}),"Se detectaron captulos duplicados en ",m.length," proyecto(s)"]}),m.map(N=>e.jsxs(CD,{open:r.has(N.projectId),onOpenChange:()=>g(N.projectId),children:[e.jsx(SD,{asChild:!0,children:e.jsxs(B,{variant:"ghost",className:"w-full justify-between h-auto py-2","data-testid":`button-expand-duplicates-${N.projectId}`,children:[e.jsx("span",{className:"text-sm font-medium truncate",children:N.projectTitle}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Q,{variant:"secondary",className:"text-xs",children:[N.duplicateGroups.length," cap. afectados"]}),r.has(N.projectId)?e.jsx(kp,{className:"h-4 w-4"}):e.jsx(Qs,{className:"h-4 w-4"})]})]})}),e.jsx(kD,{className:"mt-2 space-y-2 pl-2 border-l-2 border-muted ml-2",children:N.duplicateGroups.map(b=>e.jsxs("div",{className:"space-y-1 pb-2 border-b border-muted last:border-b-0",children:[e.jsxs("p",{className:"text-sm font-medium",children:["Captulo ",b.chapterNumber,e.jsxs("span",{className:"text-muted-foreground font-normal ml-2",children:["(",b.generations.reduce((C,S)=>C+S.totalChapters,0)," versiones)"]})]}),e.jsx("div",{className:"space-y-1",children:b.generations.map((C,S)=>e.jsxs("div",{className:"flex items-center justify-between gap-2 text-xs bg-muted/50 rounded px-2 py-1",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("span",{className:"text-muted-foreground",children:["Gen ",S+1,":"]})," ",v(C.createdAt),","," ",C.totalChapters," cap.,"," ",C.wordCounts.reduce((k,P)=>k+P,0).toLocaleString()," palabras",C.hasContent&&e.jsx(Q,{variant:"outline",className:"ml-1 text-xs py-0",children:"con contenido"})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsxs(B,{size:"sm",variant:"ghost",className:"h-6 px-2 text-xs",onClick:()=>o({projectId:N.projectId,chapterNumber:b.chapterNumber,generationKey:C.generationKey,keepGeneration:!0}),disabled:h.isPending||N.projectStatus==="generating","data-testid":`button-keep-generation-${N.projectId}-${b.chapterNumber}-${S}`,children:[e.jsx(Tn,{className:"h-3 w-3 mr-1"}),"Conservar"]}),e.jsxs(B,{size:"sm",variant:"ghost",className:"h-6 px-2 text-xs text-destructive hover:text-destructive",onClick:()=>o({projectId:N.projectId,chapterNumber:b.chapterNumber,generationKey:C.generationKey,keepGeneration:!1}),disabled:h.isPending||N.projectStatus==="generating"||b.generations.length===1,"data-testid":`button-delete-generation-${N.projectId}-${b.chapterNumber}-${S}`,children:[e.jsx(Rn,{className:"h-3 w-3 mr-1"}),"Eliminar"]})]})]},C.generationKey))})]},b.chapterNumber))})]},N.projectId)),e.jsx(B,{variant:"outline",size:"sm",onClick:()=>p(),"data-testid":"button-refresh-duplicates",children:"Actualizar lista"})]}):e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Tn,{className:"h-4 w-4 text-green-500"}),"No hay captulos duplicados"]})})]}),e.jsx(Vs,{open:!!i,onOpenChange:N=>!N&&o(null),title:i?.keepGeneration?"Conservar esta generacin":"Eliminar generacin",description:i?.keepGeneration?"Se eliminarn todas las dems generaciones del captulo, conservando solo esta.":"Se eliminar esta generacin del captulo. Las otras se conservarn.",confirmText:i?.keepGeneration?"Conservar y eliminar otras":"Eliminar esta",variant:i?.keepGeneration?"default":"destructive",onConfirm:()=>{i&&h.mutate(i),o(null)}})]})}const Nn=x.forwardRef(({className:t,...n},r)=>e.jsx("textarea",{className:Ae("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...n}));Nn.displayName="Textarea";function wb(t,n,{checkForDefaultPrevented:r=!0}={}){return function(i){if(t?.(i),r===!1||!i.defaultPrevented)return n?.(i)}}var PD=eg[" useInsertionEffect ".trim().toString()]||On;function TD({prop:t,defaultProp:n,onChange:r=()=>{},caller:s}){const[i,o,c]=RD({defaultProp:n,onChange:r}),d=t!==void 0,p=d?t:i;{const h=x.useRef(t!==void 0);x.useEffect(()=>{const g=h.current;g!==d&&console.warn(`${s} is changing from ${g?"controlled":"uncontrolled"} to ${d?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),h.current=d},[d,s])}const m=x.useCallback(h=>{if(d){const g=AD(h)?h(t):h;g!==t&&c.current?.(g)}else o(h)},[d,t,o,c]);return[p,m]}function RD({defaultProp:t,onChange:n}){const[r,s]=x.useState(t),i=x.useRef(r),o=x.useRef(n);return PD(()=>{o.current=n},[n]),x.useEffect(()=>{i.current!==r&&(o.current?.(r),i.current=r)},[r,i]),[r,s,o]}function AD(t){return typeof t=="function"}function _D(t,n){return x.useReducer((r,s)=>n[r][s]??r,t)}var Ek=t=>{const{present:n,children:r}=t,s=ID(n),i=typeof r=="function"?r({present:s.isPresent}):x.Children.only(r),o=vt(s.ref,MD(i));return typeof r=="function"||s.isPresent?x.cloneElement(i,{ref:o}):null};Ek.displayName="Presence";function ID(t){const[n,r]=x.useState(),s=x.useRef(null),i=x.useRef(t),o=x.useRef("none"),c=t?"mounted":"unmounted",[d,p]=_D(c,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return x.useEffect(()=>{const m=Nu(s.current);o.current=d==="mounted"?m:"none"},[d]),On(()=>{const m=s.current,h=i.current;if(h!==t){const v=o.current,j=Nu(m);t?p("MOUNT"):j==="none"||m?.display==="none"?p("UNMOUNT"):p(h&&v!==j?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,p]),On(()=>{if(n){let m;const h=n.ownerDocument.defaultView??window,g=j=>{const b=Nu(s.current).includes(CSS.escape(j.animationName));if(j.target===n&&b&&(p("ANIMATION_END"),!i.current)){const C=n.style.animationFillMode;n.style.animationFillMode="forwards",m=h.setTimeout(()=>{n.style.animationFillMode==="forwards"&&(n.style.animationFillMode=C)})}},v=j=>{j.target===n&&(o.current=Nu(s.current))};return n.addEventListener("animationstart",v),n.addEventListener("animationcancel",g),n.addEventListener("animationend",g),()=>{h.clearTimeout(m),n.removeEventListener("animationstart",v),n.removeEventListener("animationcancel",g),n.removeEventListener("animationend",g)}}else p("ANIMATION_END")},[n,p]),{isPresent:["mounted","unmountSuspended"].includes(d),ref:x.useCallback(m=>{s.current=m?getComputedStyle(m):null,r(m)},[])}}function Nu(t){return t?.animationName||"none"}function MD(t){let n=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=n&&"isReactWarning"in n&&n.isReactWarning;return r?t.ref:(n=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=n&&"isReactWarning"in n&&n.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function OD(t){const n=DD(t),r=x.forwardRef((s,i)=>{const{children:o,...c}=s,d=x.Children.toArray(o),p=d.find(FD);if(p){const m=p.props.children,h=d.map(g=>g===p?x.Children.count(m)>1?x.Children.only(null):x.isValidElement(m)?m.props.children:null:g);return e.jsx(n,{...c,ref:i,children:x.isValidElement(m)?x.cloneElement(m,void 0,h):null})}return e.jsx(n,{...c,ref:i,children:o})});return r.displayName=`${t}.Slot`,r}function DD(t){const n=x.forwardRef((r,s)=>{const{children:i,...o}=r;if(x.isValidElement(i)){const c=zD(i),d=$D(o,i.props);return i.type!==x.Fragment&&(d.ref=s?Bc(s,c):c),x.cloneElement(i,d)}return x.Children.count(i)>1?x.Children.only(null):null});return n.displayName=`${t}.SlotClone`,n}var LD=Symbol("radix.slottable");function FD(t){return x.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===LD}function $D(t,n){const r={...n};for(const s in n){const i=t[s],o=n[s];/^on[A-Z]/.test(s)?i&&o?r[s]=(...d)=>{const p=o(...d);return i(...d),p}:i&&(r[s]=i):s==="style"?r[s]={...i,...o}:s==="className"&&(r[s]=[i,o].filter(Boolean).join(" "))}return{...t,...r}}function zD(t){let n=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=n&&"isReactWarning"in n&&n.isReactWarning;return r?t.ref:(n=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=n&&"isReactWarning"in n&&n.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var VD=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],tv=VD.reduce((t,n)=>{const r=OD(`Primitive.${n}`),s=x.forwardRef((i,o)=>{const{asChild:c,...d}=i,p=c?r:n;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(p,{...d,ref:o})});return s.displayName=`Primitive.${n}`,{...t,[n]:s}},{}),tm="Checkbox",[qD]=Zn(tm),[UD,nv]=qD(tm);function BD(t){const{__scopeCheckbox:n,checked:r,children:s,defaultChecked:i,disabled:o,form:c,name:d,onCheckedChange:p,required:m,value:h="on",internal_do_not_use_render:g}=t,[v,j]=TD({prop:r,defaultProp:i??!1,onChange:p,caller:tm}),[N,b]=x.useState(null),[C,S]=x.useState(null),k=x.useRef(!1),P=N?!!c||!!N.closest("form"):!0,R={checked:v,disabled:o,setChecked:j,control:N,setControl:b,name:d,form:c,value:h,hasConsumerStoppedPropagationRef:k,required:m,defaultChecked:si(i)?!1:i,isFormControl:P,bubbleInput:C,setBubbleInput:S};return e.jsx(UD,{scope:n,...R,children:GD(g)?g(R):s})}var Pk="CheckboxTrigger",Tk=x.forwardRef(({__scopeCheckbox:t,onKeyDown:n,onClick:r,...s},i)=>{const{control:o,value:c,disabled:d,checked:p,required:m,setControl:h,setChecked:g,hasConsumerStoppedPropagationRef:v,isFormControl:j,bubbleInput:N}=nv(Pk,t),b=vt(i,h),C=x.useRef(p);return x.useEffect(()=>{const S=o?.form;if(S){const k=()=>g(C.current);return S.addEventListener("reset",k),()=>S.removeEventListener("reset",k)}},[o,g]),e.jsx(tv.button,{type:"button",role:"checkbox","aria-checked":si(p)?"mixed":p,"aria-required":m,"data-state":Mk(p),"data-disabled":d?"":void 0,disabled:d,value:c,...s,ref:b,onKeyDown:wb(n,S=>{S.key==="Enter"&&S.preventDefault()}),onClick:wb(r,S=>{g(k=>si(k)?!0:!k),N&&j&&(v.current=S.isPropagationStopped(),v.current||S.stopPropagation())})})});Tk.displayName=Pk;var rv=x.forwardRef((t,n)=>{const{__scopeCheckbox:r,name:s,checked:i,defaultChecked:o,required:c,disabled:d,value:p,onCheckedChange:m,form:h,...g}=t;return e.jsx(BD,{__scopeCheckbox:r,checked:i,defaultChecked:o,disabled:d,required:c,onCheckedChange:m,name:s,form:h,value:p,internal_do_not_use_render:({isFormControl:v})=>e.jsxs(e.Fragment,{children:[e.jsx(Tk,{...g,ref:n,__scopeCheckbox:r}),v&&e.jsx(Ik,{__scopeCheckbox:r})]})})});rv.displayName=tm;var Rk="CheckboxIndicator",Ak=x.forwardRef((t,n)=>{const{__scopeCheckbox:r,forceMount:s,...i}=t,o=nv(Rk,r);return e.jsx(Ek,{present:s||si(o.checked)||o.checked===!0,children:e.jsx(tv.span,{"data-state":Mk(o.checked),"data-disabled":o.disabled?"":void 0,...i,ref:n,style:{pointerEvents:"none",...t.style}})})});Ak.displayName=Rk;var _k="CheckboxBubbleInput",Ik=x.forwardRef(({__scopeCheckbox:t,...n},r)=>{const{control:s,hasConsumerStoppedPropagationRef:i,checked:o,defaultChecked:c,required:d,disabled:p,name:m,value:h,form:g,bubbleInput:v,setBubbleInput:j}=nv(_k,t),N=vt(r,j),b=Vp(o),C=_p(s);x.useEffect(()=>{const k=v;if(!k)return;const P=window.HTMLInputElement.prototype,E=Object.getOwnPropertyDescriptor(P,"checked").set,A=!i.current;if(b!==o&&E){const W=new Event("click",{bubbles:A});k.indeterminate=si(o),E.call(k,si(o)?!1:o),k.dispatchEvent(W)}},[v,b,o,i]);const S=x.useRef(si(o)?!1:o);return e.jsx(tv.input,{type:"checkbox","aria-hidden":!0,defaultChecked:c??S.current,required:d,disabled:p,name:m,value:h,form:g,...n,tabIndex:-1,ref:N,style:{...n.style,...C,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Ik.displayName=_k;function GD(t){return typeof t=="function"}function si(t){return t==="indeterminate"}function Mk(t){return si(t)?"indeterminate":t?"checked":"unchecked"}const Kr=x.forwardRef(({className:t,...n},r)=>e.jsx(rv,{ref:r,className:Ae("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...n,children:e.jsx(Ak,{className:Ae("flex items-center justify-center text-current"),children:e.jsx(Tn,{className:"h-4 w-4"})})}));Kr.displayName=rv.displayName;const os={architect:"El Arquitecto",ghostwriter:"El Narrador",editor:"El Editor",copyeditor:"El Estilista","final-reviewer":"El Revisor Final","continuity-sentinel":"El Centinela","voice-auditor":"El Auditor de Voz","semantic-detector":"El Detector Semntico","global-architect":"Arquitecto Global","chapter-architect":"Diseador de Escenas","ghostwriter-v2":"Escritor de Escenas","smart-editor":"Editor Inteligente",summarizer:"Compresor","narrative-director":"Director Narrativo","universal-consistency":"Guardin de Continuidad","beta-reader":"El Crtico",inquisidor:"Inquisidor",estilista:"Estilista",ritmo:"Agente de Ritmo",ensamblador:"Ensamblador"};function HD(t){return[...t].sort((n,r)=>{const s=i=>i===0?-1e3:i===998?9998:i===999?9999:i;return s(n.chapterNumber)-s(r.chapterNumber)})}function KD(t,n){const r=new Set(n.map(o=>o.chapterNumber)),s=[...n],i=(o,c,d)=>({id:o,projectId:t.id,chapterNumber:c,title:d,content:null,originalContent:null,summary:null,wordCount:0,status:"pending",editorFeedback:null,needsRevision:!1,revisionReason:null,continuityState:null,sceneBreakdown:null,qualityScore:null,createdAt:new Date});t.hasPrologue&&!r.has(0)&&s.push(i(-1,0,"Prlogo"));for(let o=1;o<=t.chapterCount;o++)r.has(o)||s.push(i(-o-1,o,`Captulo ${o}`));return t.hasEpilogue&&!r.has(998)&&s.push(i(-998,998,"Eplogo")),t.hasAuthorNote&&!r.has(999)&&s.push(i(-999,999,"Nota del Autor")),HD(s)}function WD(t,n,r){const c=t/1e6*.36,d=n/1e6*.95,p=r/1e6*.55;return c+d+p}const QD=`Modelos DeepSeek usados:
 R1 (Arquitecto Global, Arquitecto Captulos, Director Narrativo): $0.55/$2.19/M
 V3 (Escritor, Editor, Compresor): $0.28/$0.42/M

Precios promedio ponderados: Input $0.36/M, Output $0.95/M, Thinking $0.55/M`;function YD(){const{toast:t}=nn(),[n,r]=x.useState([]),[s,i]=x.useState(null),[o,c]=x.useState([]),[d,p]=x.useState([]),[m,h]=x.useState(null),[g,v]=x.useState(!1),[j,N]=x.useState(!1),[b,C]=x.useState(!1),[S,k]=x.useState(""),[P,R]=x.useState(!1),[E,A]=x.useState(!1),[W,X]=x.useState(!1),[se,V]=x.useState(!1),[G,O]=x.useState(""),[F,U]=x.useState(null),[$,q]=x.useState(null),[le,K]=x.useState("standalone"),[J,D]=x.useState(null),[I,re]=x.useState(""),[T,Y]=x.useState(!1),[oe,Ne]=x.useState(null),[xe,Se]=x.useState(null),[Oe,Pe]=x.useState(""),[Be,ve]=x.useState(!0),[We,Ye]=x.useState(!1),[Qe,mt]=x.useState({finalReviewer:!1,continuitySentinel:!1,narrativeDirector:!1}),[ht,cn]=x.useState(null),[Jt,Vt]=x.useState(null),[tt,L]=x.useState(null),[de,ge]=x.useState("detect-fix"),{projects:ze,currentProject:M,setSelectedProjectId:ie}=fi();x.useEffect(()=>{fetch("/api/config/correction-system").then(z=>z.json()).then(z=>{(z.correctionSystem==="detect-fix"||z.correctionSystem==="legacy")&&ge(z.correctionSystem)}).catch(()=>{})},[]);const we=z=>{ge(z),localStorage.setItem("litagents-correction-system",z),fetch("/api/config/correction-system",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({correctionSystem:z})}).catch(()=>{})},qe=async()=>{v(!0);try{const z=await fetch("/api/data-export");if(!z.ok)throw new Error("Export failed");const Ve=await z.json(),Ce=new Blob([JSON.stringify(Ve,null,2)],{type:"application/json"}),lt=URL.createObjectURL(Ce),Ft=document.createElement("a");Ft.href=lt,Ft.download=`litagents-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(Ft),Ft.click(),document.body.removeChild(Ft),URL.revokeObjectURL(lt),t({title:"Exportacin completada",description:"Los datos se han descargado correctamente"})}catch{t({title:"Error",description:"No se pudieron exportar los datos",variant:"destructive"})}finally{v(!1)}},Ze=async z=>{const Ve=z.target.files?.[0];if(Ve){N(!0);try{const Ce=await Ve.text(),lt=JSON.parse(Ce),Ft=await fetch("/api/data-import",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(lt)});if(!Ft.ok)throw new Error("Import failed");const Jn=await Ft.json();ae.invalidateQueries({queryKey:["/api/projects"]}),ae.invalidateQueries({queryKey:["/api/pseudonyms"]}),ae.invalidateQueries({queryKey:["/api/style-guides"]}),ae.invalidateQueries({queryKey:["/api/series"]}),t({title:"Importacin completada",description:`Importados: ${Object.entries(Jn.results?.imported||{}).map(([fm,xm])=>`${xm} ${fm}`).join(", ")}`})}catch{t({title:"Error",description:"No se pudieron importar los datos. Verifica el formato del archivo.",variant:"destructive"})}finally{N(!1),z.target.value=""}}},{data:Rt=[]}=Ke({queryKey:["/api/agent-statuses"],refetchInterval:2e3}),en=ze.find(z=>z.status==="generating"),{data:Lt=[]}=Ke({queryKey:["/api/projects",M?.id,"chapters"],enabled:!!M?.id,refetchInterval:M?.status==="generating"?3e3:!1}),{data:An}=Ke({queryKey:["/api/projects",M?.id,"world-bible"],enabled:!!M?.id}),Hn=An?.plotOutline?.chapterOutlines?.reduce((z,Ve)=>(z[Ve.number]=Ve.summary?.substring(0,60)+(Ve.summary&&Ve.summary.length>60?"...":""),z),{})||{},tn=z=>{fetch(`/api/projects/${z}/activity-logs?limit=200`).then(Ve=>Ve.json()).then(Ve=>{const Ce={info:"info",success:"success",warning:"editing",error:"error"},lt=Ve.map(Ft=>({id:String(Ft.id),type:Ce[Ft.level]||"info",message:Ft.message,timestamp:new Date(Ft.createdAt),agent:Ft.agentRole}));r(lt)}).catch(console.error)},Sn=x.useRef(null);x.useEffect(()=>{r([]),i(null),c([]),p([]),cn(null),Vt(null),L(null),Sn.current=M?.id??null,M?.id&&tn(M.id)},[M?.id]),x.useEffect(()=>{if(M?.id){const z=M.id,Ve=setInterval(()=>{Sn.current===z&&tn(z)},3e3);return()=>clearInterval(Ve)}},[M?.id]);const hn=ye({mutationFn:async z=>(await je("PATCH",`/api/projects/${z.projectId}`,{architectInstructions:z.instructions})).json()}),Jr=ye({mutationFn:async z=>{z.instructions&&await hn.mutateAsync({projectId:z.projectId,instructions:z.instructions});const Ve=z.useV2?`/api/projects/${z.projectId}/generate-v2`:`/api/projects/${z.projectId}/generate`;return(await je("POST",Ve,{useGeminiArchitect:z.useGeminiArchitect||!1,useGeminiQA:z.useGeminiQA||{}})).json()},onSuccess:(z,Ve)=>{ae.invalidateQueries({queryKey:["/api/projects"]}),qt("info",Ve.useV2?"Generacin iniciada (LitAgents 2.0 - Escenas)":"Generacin iniciada"),C(!1),k(""),ve(!1),Ye(!1),mt({finalReviewer:!1,continuitySentinel:!1,narrativeDirector:!1})},onError:z=>{t({title:"Error",description:"No se pudo iniciar la generacin",variant:"destructive"}),qt("error",`Error: ${z.message}`)}}),Ts=ye({mutationFn:async z=>(await je("POST",`/api/projects/${z}/archive`)).json(),onSuccess:z=>{ae.invalidateQueries({queryKey:["/api/projects"]}),ie(null),t({title:"Proyecto archivado",description:`"${z.title}" ha sido archivado`})},onError:()=>{t({title:"Error",description:"No se pudo archivar el proyecto",variant:"destructive"})}}),ir=ye({mutationFn:async z=>(await je("POST",`/api/projects/${z}/unarchive`)).json(),onSuccess:z=>{ae.invalidateQueries({queryKey:["/api/projects"]}),t({title:"Proyecto restaurado",description:`"${z.title}" ha sido restaurado`})},onError:()=>{t({title:"Error",description:"No se pudo restaurar el proyecto",variant:"destructive"})}}),$r=ye({mutationFn:async z=>(await je("POST",`/api/projects/${z}/duplicate`)).json(),onSuccess:z=>{r([]),i(null),c([]),p([]),cn(null),Vt(null),ae.invalidateQueries({queryKey:["/api/projects"]}),ie(z.id),t({title:"Proyecto duplicado",description:`"${z.title}" ha sido creado`})},onError:()=>{t({title:"Error",description:"No se pudo duplicar el proyecto",variant:"destructive"})}}),{data:ba=[]}=Ke({queryKey:["/api/series"]}),Rs=ye({mutationFn:async({id:z,data:Ve})=>(await je("PATCH",`/api/projects/${z}`,Ve)).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/projects"]}),V(!1),t({title:"Datos actualizados",description:"Los datos del proyecto se han actualizado correctamente"})},onError:()=>{t({title:"Error",description:"No se pudieron actualizar los datos",variant:"destructive"})}}),te=()=>{M&&(O(M.title),K(M.workType||"standalone"),U(M.seriesId??null),q(M.seriesOrder??null),V(!0))},Ee=()=>{if(!M)return;const z={title:G};le==="standalone"?(z.workType="standalone",z.seriesId=null,z.seriesOrder=null):(z.workType=le,z.seriesId=F,z.seriesOrder=$),Rs.mutate({id:M.id,data:z})},H=ye({mutationFn:async z=>{await je("DELETE",`/api/projects/${z}`)},onSuccess:()=>{r([]),i(null),c([]),p([]),cn(null),Vt(null),ae.invalidateQueries({queryKey:["/api/projects"]}),ie(null),t({title:"Proyecto eliminado"})},onError:()=>{t({title:"Error",description:"No se pudo eliminar el proyecto",variant:"destructive"})}}),Nt=ye({mutationFn:async z=>(await je("POST",`/api/projects/${z.id}/final-review`,{useGeminiQA:z.useGeminiQA||{}})).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/projects"]}),t({title:"Revisin final iniciada",description:"El Revisor Final est analizando el manuscrito"}),qt("thinking","Iniciando revisin final del manuscrito...","final-reviewer")},onError:()=>{t({title:"Error",description:"No se pudo iniciar la revisin final",variant:"destructive"})}}),zn=ye({mutationFn:async z=>(await je("POST",`/api/projects/${z}/restart-corrections`)).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/projects"]}),t({title:"Correcciones reiniciadas",description:"Reiniciando desde ciclo 0/15"}),qt("thinking","Reiniciando correcciones desde cero...","smart-editor")},onError:()=>{t({title:"Error",description:"No se pudo reiniciar las correcciones",variant:"destructive"})}}),Xn=ye({mutationFn:async z=>(await je("POST",`/api/projects/${z.id}/detect-and-fix`,{useGeminiQA:z.useGeminiQA||{}})).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/projects"]}),t({title:"Detectar y Corregir iniciado",description:"Fase 1: 3 revisiones exhaustivas  Fase 2: Correccin verificada"}),qt("thinking","Iniciando estrategia 'Detect All, Then Fix'...","final-reviewer")},onError:()=>{t({title:"Error",description:"No se pudo iniciar la deteccin y correccin",variant:"destructive"})}}),wa=ye({mutationFn:async z=>(await je("POST",`/api/projects/${z}/cancel`)).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/projects"]}),ae.invalidateQueries({queryKey:["/api/agent-statuses"]}),t({title:"Generacin cancelada",description:"El proceso ha sido detenido"}),qt("error","Generacin cancelada por el usuario"),i(null),p([])},onError:()=>{t({title:"Error",description:"No se pudo cancelar la generacin",variant:"destructive"})}}),Xs=ye({mutationFn:async z=>(await je("POST",`/api/projects/${z}/cancel-correction`)).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/projects"]}),ae.invalidateQueries({queryKey:["/api/agent-statuses"]}),t({title:"Correccin cancelada",description:"El proceso de correccin ha sido detenido"}),qt("info","Correccin cancelada por el usuario")},onError:()=>{t({title:"Error",description:"No se pudo cancelar la correccin",variant:"destructive"})}}),id=ye({mutationFn:async z=>(await je("POST",`/api/projects/${z}/force-complete`)).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/projects"]}),ae.invalidateQueries({queryKey:["/api/agent-statuses"]}),ae.invalidateQueries({queryKey:["/api/projects",M?.id,"chapters"]}),t({title:"Proyecto completado",description:"El manuscrito ha sido marcado como finalizado"}),qt("success","Proyecto marcado como completado (forzado)"),i(null),p([]),c(["global-architect","ghostwriter-v2","inquisidor","estilista","ritmo","smart-editor","ensamblador"])},onError:()=>{t({title:"Error",description:"No se pudo completar el proyecto",variant:"destructive"})}}),vi=ye({mutationFn:async z=>(await je("POST",`/api/projects/${z}/reset-reviewer`)).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/projects"]}),ae.invalidateQueries({queryKey:["/api/agent-statuses"]}),A(!1),t({title:"Crtico reiniciado",description:"La prxima evaluacin comenzar desde cero"}),qt("info","Estado del crtico reiniciado - sin historial previo","final-reviewer")},onError:()=>{t({title:"Error",description:"No se pudo reiniciar el crtico",variant:"destructive"})}}),Na=ye({mutationFn:async z=>(await je("POST",`/api/projects/${z}/critique`)).json(),onSuccess:()=>{t({title:"Anlisis iniciado",description:"El Crtico est evaluando la novela..."}),qt("info","Beta Reader iniciado - analizando viabilidad comercial","beta-reader"),i("beta-reader")},onError:z=>{t({title:"Error",description:z.message,variant:"destructive"})}}),[Qi,Ca]=x.useState(!1),[es,od]=x.useState(null),As=ye({mutationFn:async z=>(await je("POST",`/api/projects/${z}/targeted-repair/diagnose`)).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/projects"]}),t({title:"Diagnstico iniciado",description:"Analizando la novela para detectar desviaciones..."}),qt("thinking","Diagnosticando novela completa para reparacin dirigida...","targeted-repair")},onError:z=>{t({title:"Error",description:z.message||"No se pudo iniciar el diagnstico",variant:"destructive"})}}),_s=async z=>{try{const Ce=await(await fetch(`/api/projects/${z}/targeted-repair/plan`)).json();od(Ce),Ca(!0)}catch{t({title:"Error",description:"No se pudo obtener el plan de reparacin",variant:"destructive"})}},Yi=ye({mutationFn:async z=>(await je("POST",`/api/projects/${z}/targeted-repair/execute`)).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/projects"]}),Ca(!1),t({title:"Reparacin iniciada",description:"Ejecutando correcciones dirigidas con verificacin..."}),qt("thinking","Ejecutando plan de reparacin dirigida...","targeted-repair")},onError:z=>{t({title:"Error",description:z.message||"No se pudo ejecutar la reparacin",variant:"destructive"})}}),bl=ye({mutationFn:async z=>(await je("POST",`/api/projects/${z}/targeted-repair/cancel`)).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/projects"]}),od(null),t({title:"Reparacin cancelada"})}}),Is=ye({mutationFn:async z=>(await je("POST",`/api/projects/${z}/targeted-repair/auto-cycle`,{maxCycles:10})).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/projects"]}),t({title:"Ciclo automtico iniciado",description:"Diagnosticando y corrigiendo hasta obtener 2 puntuaciones 9+ consecutivas..."}),qt("thinking","Iniciando ciclo automtico de diagnstico-correccin...","targeted-repair")},onError:z=>{t({title:"Error",description:z.message||"No se pudo iniciar el ciclo automtico",variant:"destructive"})}}),wl=ye({mutationFn:async z=>{console.log("[Resume] Sending resume request for project:",z);const Ve=await je("POST",`/api/projects/${z}/resume`);console.log("[Resume] Response status:",Ve.status);const Ce=await Ve.json();return console.log("[Resume] Response data:",Ce),Ce},onSuccess:z=>{console.log("[Resume] Success:",z),ae.invalidateQueries({queryKey:["/api/projects"]}),ae.invalidateQueries({queryKey:["/api/agent-statuses"]}),t({title:"Generacin reanudada",description:"Continuando desde donde se detuvo"}),qt("success","Reanudando generacin del manuscrito..."),c([]),p([])},onError:z=>{console.error("[Resume] Error:",z),t({title:"Error",description:"No se pudo reanudar la generacin",variant:"destructive"})}}),ld=ye({mutationFn:async z=>(await je("POST",`/api/projects/${z}/restart-from-scratch`)).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/projects"]}),ae.invalidateQueries({queryKey:["/api/agent-statuses"]}),t({title:"Reinicio completo",description:"Generando novela desde cero"}),qt("success","Reiniciando generacin desde cero..."),c([]),p([])},onError:z=>{t({title:"Error",description:z.message||"No se pudo reiniciar el proyecto",variant:"destructive"})}}),yi=ye({mutationFn:async({id:z,targetChapters:Ve})=>(await je("POST",`/api/projects/${z}/extend`,{targetChapters:Ve})).json(),onSuccess:z=>{ae.invalidateQueries({queryKey:["/api/projects"]}),ae.invalidateQueries({queryKey:["/api/agent-statuses"]}),t({title:"Extensin iniciada",description:`Generando captulos ${z.fromChapter} a ${z.toChapter}`}),qt("success",`Extendiendo novela: generando captulos ${z.fromChapter} a ${z.toChapter}...`),c([]),p([]),R(!1),Pe("")},onError:z=>{t({title:"Error",description:z.message||"No se pudo extender el proyecto",variant:"destructive"})}}),Zi=ye({mutationFn:async({projectId:z,sourceChapterNumber:Ve,targetChapterNumber:Ce})=>(await je("POST",`/api/projects/${z}/merge-chapters`,{sourceChapterNumber:Ve,targetChapterNumber:Ce})).json(),onSuccess:z=>{ae.invalidateQueries({queryKey:["/api/projects"]}),ae.invalidateQueries({queryKey:["/api/projects",M?.id,"chapters"]}),t({title:"Capitulos fusionados",description:z.message||"Fusion completada exitosamente"}),X(!1),Ne(null),Se(null)},onError:z=>{t({title:"Error",description:z.message||"No se pudo fusionar los captulos",variant:"destructive"})}}),Xi=ye({mutationFn:async({projectId:z,chapterNumber:Ve,instructions:Ce})=>Ce&&Ce.trim().length>0?(await je("POST",`/api/projects/${z}/chapters/${Ve}/rewrite`,{instructions:Ce})).json():(await je("POST",`/api/projects/${z}/regenerate-chapter/${Ve}`)).json(),onSuccess:z=>{ae.invalidateQueries({queryKey:["/api/projects"]}),ae.invalidateQueries({queryKey:["/api/projects",M?.id,"chapters"]}),t({title:"Reescritura iniciada",description:z.message||"El captulo se est reescribiendo"}),Y(!1),D(null),re("")},onError:z=>{t({title:"Error",description:z.message||"No se pudo reescribir el captulo",variant:"destructive"})}}),qt=(z,Ve,Ce)=>{const lt={id:crypto.randomUUID(),type:z,message:Ve,timestamp:new Date,agent:Ce};r(Ft=>[...Ft,lt])};x.useEffect(()=>{if(en){const z=new EventSource(`/api/projects/${en.id}/stream`);return z.onmessage=Ve=>{try{const Ce=JSON.parse(Ve.data);if(Ce.type==="agent_status"){const lt=Ce.role;ae.invalidateQueries({queryKey:["/api/agent-statuses"]}),Ce.status==="thinking"?(i(lt),qt("thinking",Ce.message||`${os[lt]} est procesando...`,lt)):Ce.status==="writing"?qt("writing",Ce.message||`${os[lt]} est escribiendo...`,lt):Ce.status==="editing"?qt("editing",Ce.message||`${os[lt]} est revisando...`,lt):Ce.status==="warning"?(p(Ft=>Ft.includes(lt)?Ft:[...Ft,lt]),qt("editing",Ce.message||`${os[lt]} detect problemas`,lt)):Ce.status==="completed"&&(c(Ft=>Ft.includes(lt)?Ft:[...Ft,lt]),p(Ft=>Ft.filter(Jn=>Jn!==lt)),qt("success",Ce.message||`${os[lt]} complet su tarea`,lt))}else if(Ce.type==="chapter_rewrite")qt("editing",`Reescribiendo captulo ${Ce.chapterNumber}: "${Ce.chapterTitle}" (${Ce.currentIndex}/${Ce.totalToRewrite}) - ${Ce.reason}`,"final-reviewer"),ae.invalidateQueries({queryKey:["/api/projects",en.id,"chapters"]});else if(Ce.type==="chapter_status_change")ae.invalidateQueries({queryKey:["/api/projects",en.id,"chapters"]});else if(Ce.type==="scene_complete")cn({chapterNumber:Ce.chapterNumber,sceneNumber:Ce.sceneNumber,totalScenes:Ce.totalScenes||4,wordCount:Ce.wordCount}),qt("writing",`Escena ${Ce.sceneNumber}/${Ce.totalScenes||"?"} del captulo ${Ce.chapterNumber} completada (${Ce.wordCount} palabras)`,"ghostwriter-v2");else if(Ce.type==="chapter_complete"){cn(null);const lt=Ce.chapterTitle==="Prlogo"?"Prlogo":Ce.chapterTitle==="Eplogo"?"Eplogo":Ce.chapterTitle==="Nota del Autor"?"Nota del Autor":`Captulo ${Ce.chapterNumber}`;qt("success",`${lt} completado (${Ce.wordCount} palabras)`),ae.invalidateQueries({queryKey:["/api/projects",en.id,"chapters"]})}else if(Ce.type==="project_complete")qt("success","Manuscrito completado!"),t({title:"Manuscrito completado!",description:"Tu novela ha sido generada exitosamente"}),ae.invalidateQueries({queryKey:["/api/projects"]}),i(null),Vt(null),cn(null);else if(Ce.type==="error")qt("error",Ce.message||"Error durante la generacin");else if(Ce.type==="chapters_being_corrected")Ce.chapterNumbers&&Ce.chapterNumbers.length>0?Vt({chapterNumbers:Ce.chapterNumbers,revisionCycle:Ce.revisionCycle||1}):Vt(null);else if(Ce.type==="detect_and_fix_progress")L({phase:Ce.phase,subPhase:Ce.subPhase,current:Ce.current,total:Ce.total,details:Ce.details});else if(Ce.type==="detect_and_fix_complete")L(null),ae.invalidateQueries({queryKey:["/api/projects"]}),t({title:"Deteccin y Correccin completada",description:`Resueltos: ${Ce.totalResolved}/${Ce.totalDetected}, Escalados: ${Ce.totalEscalated}`});else if(Ce.type==="targeted_repair_diagnosis_complete")ae.invalidateQueries({queryKey:["/api/projects"]}),t({title:"Diagnstico completado",description:`Se encontraron ${Ce.planLength} captulos con problemas`}),qt("success",`Diagnstico completado: ${Ce.planLength} captulos necesitan reparacin`,"targeted-repair");else if(Ce.type==="targeted_repair_complete")ae.invalidateQueries({queryKey:["/api/projects"]}),ae.invalidateQueries({queryKey:["/api/projects",en?.id,"chapters"]}),t({title:"Reparacin dirigida completada",description:`${Ce.totalFixed}/${Ce.totalIssues} problemas resueltos`}),qt("success",`Reparacin completada: ${Ce.totalFixed}/${Ce.totalIssues} problemas resueltos`,"targeted-repair");else if(Ce.type==="targeted_repair_chapter_progress")qt("info",`Reparando captulo ${Ce.chapterNumber}: ${Ce.message}`,"targeted-repair");else if(Ce.type==="targeted_repair_auto_cycle_complete"){ae.invalidateQueries({queryKey:["/api/projects"]}),ae.invalidateQueries({queryKey:["/api/projects",en?.id,"chapters"]});const lt=Ce.success?`Ciclo automtico COMPLETADO: 2 puntuaciones 9+ consecutivas en ${Ce.cycles} ciclos (${Ce.finalScore}/10)`:`Ciclo automtico finalizado: ${Ce.cycles} ciclos, ltima puntuacin ${Ce.finalScore}/10`;t({title:Ce.success?"Novela aprobada":"Ciclo automtico finalizado",description:lt}),qt(Ce.success?"success":"info",lt,"targeted-repair")}}catch(Ce){console.error("Error parsing SSE:",Ce)}},z.onerror=()=>{z.close()},()=>{z.close()}}},[en?.id]);const Yt=z=>{const Ve=Rt.find(Ce=>Ce.agentName.toLowerCase()===z);return{status:Ve?.status||"idle",currentTask:Ve?.currentTask,lastActivity:Ve?.lastActivity?new Date(Ve.lastActivity):void 0}},hm=Lt.filter(z=>z.status==="completed"||z.status==="approved").length,Nl=Lt.reduce((z,Ve)=>z+(Ve.wordCount||0),0),cd=()=>{M&&M.status==="idle"&&(k(M.architectInstructions||""),C(!0))},Ji=()=>{M&&Jr.mutate({projectId:M.id,instructions:S.trim()||void 0,useV2:Be,useGeminiArchitect:We,useGeminiQA:Qe})};return e.jsxs("div",{className:"space-y-6 p-6","data-testid":"dashboard-page",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Panel de Control"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Orquestacin de agentes literarios autnomos"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[en&&e.jsxs(Q,{className:"bg-green-500/20 text-green-600 dark:text-green-400 text-sm px-3 py-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 mr-2 animate-pulse"}),"Generando: ",en.title]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg border bg-card",children:[e.jsx("span",{className:"text-sm text-muted-foreground whitespace-nowrap",children:"Sistema de Correccin:"}),e.jsxs(Pt,{value:de,onValueChange:z=>we(z),children:[e.jsx(St,{className:"w-[200px] h-8","data-testid":"select-correction-system-global",children:e.jsx(Tt,{})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"detect-fix",children:"Detect & Fix (v2.9.4)"}),e.jsx(ce,{value:"legacy",children:"Revisin Clsica"})]})]})]})]})]}),M&&e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg border bg-card",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-semibold truncate",children:M.title}),M.seriesOrder&&e.jsxs(Q,{variant:"secondary",className:"text-xs",children:["Vol. ",M.seriesOrder]}),e.jsx(Q,{variant:"secondary",className:"text-xs",children:M.workType==="standalone"?"Independiente":M.workType==="series"?"Serie":M.workType==="trilogy"?"Triloga":M.workType==="bookbox"?"Bookbox":M.workType})]})}),e.jsxs(B,{variant:"outline",size:"sm",onClick:te,disabled:M.status==="generating","data-testid":"button-edit-metadata-header",children:[e.jsx(ar,{className:"h-4 w-4 mr-2"}),"Editar Datos"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"OmniWriter  Pipeline Autnomo"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[e.jsx(_i,{name:os["global-architect"],role:"global-architect",...Yt("global-architect")}),e.jsx(_i,{name:os["ghostwriter-v2"],role:"ghostwriter-v2",...Yt("ghostwriter-v2")}),e.jsx(_i,{name:os.inquisidor,role:"inquisidor",...Yt("inquisidor")}),e.jsx(_i,{name:os.estilista,role:"estilista",...Yt("estilista")}),e.jsx(_i,{name:os.ritmo,role:"ritmo",...Yt("ritmo")}),e.jsx(_i,{name:os["smart-editor"],role:"smart-editor",...Yt("smart-editor")}),e.jsx(_i,{name:os.ensamblador,role:"ensamblador",...Yt("ensamblador")})]})]}),en&&e.jsxs(me,{children:[e.jsx(Re,{className:"pb-2",children:e.jsx(Ie,{className:"text-lg",children:"Flujo de Proceso"})}),e.jsx(he,{children:e.jsx(X3,{currentStage:s,completedStages:o,warningStages:d})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(me,{children:[e.jsx(Re,{className:"pb-2",children:e.jsx(Ie,{className:"text-lg",children:"Consola de Actividad"})}),e.jsx(he,{children:e.jsx(sD,{logs:n,projectId:M?.id})})]}),M&&e.jsxs(me,{children:[e.jsxs(Re,{className:"flex flex-row items-center justify-between gap-4 pb-2",children:[e.jsx(Ie,{className:"text-lg",children:"Progreso del Manuscrito"}),e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(yt,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{children:[hm,"/",M.chapterCount+(M.hasPrologue?1:0)+(M.hasEpilogue?1:0)+(M.hasAuthorNote?1:0)," secciones"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Cn,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{children:[Nl.toLocaleString()," palabras"]})]}),ht&&M.status==="generating"&&e.jsxs(Q,{variant:"secondary",className:"animate-pulse","data-testid":"badge-scene-progress",children:["Escena ",ht.sceneNumber,"/",ht.totalScenes," - Cap. ",ht.chapterNumber]}),Lt&&Lt.filter(z=>z.chapterNumber>=0&&z.chapterNumber<998).length>=2&&e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>X(!0),"data-testid":"button-merge-chapters-global",children:[e.jsx(r1,{className:"h-4 w-4 mr-2"}),"Fusionar Captulos"]}),Jt&&Jt.chapterNumbers.length>0&&e.jsxs(Q,{variant:"outline",className:"animate-pulse border-orange-500 text-orange-600 dark:text-orange-400","data-testid":"badge-chapters-correcting",children:["Corrigiendo Cap. ",Jt.chapterNumbers.join(", ")," (Ciclo ",Jt.revisionCycle,")"]}),tt&&e.jsxs("div",{className:"flex flex-col gap-2 mt-2 p-3 rounded-lg bg-muted/50 border","data-testid":"detect-and-fix-progress",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(sc,{className:`h-4 w-4 ${tt.phase==="detection"?"text-blue-500":"text-green-500"}`}),e.jsx("span",{className:"font-medium text-sm",children:tt.phase==="detection"?"Fase 1: Deteccin":"Fase 2: Correccin"})]}),e.jsxs(Q,{variant:tt.phase==="detection"?"default":"secondary",children:[tt.current,"/",tt.total]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${tt.phase==="detection"?"bg-blue-500":"bg-green-500"}`,style:{width:`${tt.current/tt.total*100}%`}})}),e.jsx("div",{className:"text-xs text-muted-foreground",children:tt.phase==="detection"?e.jsxs(e.Fragment,{children:[tt.subPhase==="reviewing"&&`Revisin ${tt.details?.reviewNumber}/3 en progreso...`,tt.subPhase==="review_complete"&&`Revisin ${tt.details?.reviewNumber} completada: ${tt.details?.issuesFoundThisReview} nuevos issues (${tt.details?.totalUniqueIssues} nicos)`,tt.subPhase==="complete"&&`Deteccin completa: ${tt.details?.totalUniqueIssues} issues nicos encontrados`,tt.subPhase==="starting"&&"Iniciando 3 revisiones exhaustivas..."]}):e.jsxs(e.Fragment,{children:[tt.subPhase==="fixing"&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(be,{className:"h-3 w-3 animate-spin"}),"Cap ",tt.details?.issueChapter,": ",tt.details?.issueType,e.jsx(Q,{variant:"outline",className:"text-xs ml-1",children:tt.details?.issueSeverity})]}),tt.subPhase==="issue_resolved"&&`Issue resuelto - Cap ${tt.details?.issueChapter}`,tt.subPhase==="issue_escalated"&&`Issue escalado - Cap ${tt.details?.issueChapter}`,tt.subPhase==="complete"&&`Completado: ${tt.details?.resolved} resueltos, ${tt.details?.escalated} escalados`,tt.subPhase==="starting"&&`Iniciando correccin de ${tt.total} issues...`]})}),tt.phase==="correction"&&tt.details&&e.jsxs("div",{className:"flex gap-2 text-xs",children:[e.jsxs("span",{className:"text-green-600 dark:text-green-400",children:["Resueltos: ",tt.details.resolved||0]}),e.jsxs("span",{className:"text-yellow-600 dark:text-yellow-400",children:["Escalados: ",tt.details.escalated||0]})]})]}),(M.status==="completed"||M.status==="awaiting_final_review")&&e.jsxs(e.Fragment,{children:[e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>Na.mutate(M.id),disabled:Na.isPending,"data-testid":"button-critique",children:[e.jsx(mn,{className:"h-4 w-4 mr-2"}),Na.isPending?"Analizando...":"Criticar"]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>{de==="detect-fix"?Xn.mutate({id:M.id,useGeminiQA:Qe}):Nt.mutate({id:M.id,useGeminiQA:Qe})},disabled:Nt.isPending||Xn.isPending,"data-testid":"button-run-correction",children:[de==="detect-fix"?e.jsx(sc,{className:"h-4 w-4 mr-2"}):e.jsx(qu,{className:"h-4 w-4 mr-2"}),Nt.isPending||Xn.isPending?"Procesando...":de==="detect-fix"?"Detect & Fix":"Revisin Final"]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>As.mutate(M.id),disabled:As.isPending||Is.isPending||M.targetedRepairStatus==="auto_cycle","data-testid":"button-diagnose-repair",children:[e.jsx(sc,{className:"h-4 w-4 mr-2"}),As.isPending?"Diagnosticando...":"Diagnosticar"]}),e.jsxs(B,{variant:"default",size:"sm",onClick:()=>Is.mutate(M.id),disabled:Is.isPending||As.isPending||M.targetedRepairStatus==="auto_cycle","data-testid":"button-auto-cycle-repair",children:[e.jsx(Ns,{className:"h-4 w-4 mr-2"}),Is.isPending||M.targetedRepairStatus==="auto_cycle"?"Ciclo automtico...":"Auto-ciclo (2x 9+)"]}),M.targetedRepairStatus==="auto_cycle"&&e.jsxs(B,{variant:"destructive",size:"sm",onClick:()=>bl.mutate(M.id),"data-testid":"button-cancel-auto-cycle",children:[e.jsx(gu,{className:"h-4 w-4 mr-2"}),"Detener ciclo"]}),Array.isArray(M.targetedRepairPlan)&&M.targetedRepairPlan.length>0&&e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>_s(M.id),"data-testid":"button-view-repair-plan",children:[e.jsx(yt,{className:"h-4 w-4 mr-2"}),"Ver Plan (",M.targetedRepairPlan.length,")"]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>{window.open(`/api/projects/${M.id}/export-docx`,"_blank")},"data-testid":"button-export-docx",children:[e.jsx(xn,{className:"h-4 w-4 mr-2"}),"Exportar Word"]})]})]})]}),e.jsxs(he,{children:[(M.targetedRepairStatus==="auto_cycle"||M.targetedRepairStatus==="diagnosing"||M.targetedRepairStatus==="executing")&&M.targetedRepairProgress?.message&&e.jsxs("div",{className:"mb-3 p-3 rounded-md bg-muted/80 border border-border","data-testid":"repair-progress-banner",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4 animate-spin text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:M.targetedRepairProgress.message})]}),M.targetedRepairProgress?.autoCycle&&M.targetedRepairProgress?.history?.length>0&&e.jsx("div",{className:"mt-2 text-xs text-muted-foreground space-y-1",children:M.targetedRepairProgress.history.map((z,Ve)=>e.jsxs("div",{children:["Ciclo ",z.cycle,": ",z.score,"/10 - ",z.issuesFound," problemas, ",z.issuesFixed," corregidos"]},Ve))})]}),e.jsxs("div",{className:"space-y-2",children:[KD(M,Lt).map(z=>e.jsxs("div",{className:"flex items-center justify-between gap-4 p-2 rounded-md bg-muted/50","data-testid":`progress-chapter-${z.chapterNumber}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[z.status==="completed"||z.status==="approved"?e.jsx(Xt,{className:"h-4 w-4 text-green-500"}):z.status==="revision"?e.jsx(Ns,{className:"h-4 w-4 text-orange-500 animate-spin"}):ht&&ht.chapterNumber===z.chapterNumber?e.jsx(be,{className:"h-4 w-4 text-primary animate-spin"}):e.jsx(Cn,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:z.chapterNumber===0?"Prlogo":z.chapterNumber===998?"Eplogo":z.chapterNumber===999?"Nota del Autor":`Cap. ${z.chapterNumber}`})]}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("span",{className:"text-sm text-muted-foreground truncate block",children:z.title||Hn[z.chapterNumber]||""})}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[ht&&ht.chapterNumber===z.chapterNumber&&M.status==="generating"&&e.jsxs(Q,{variant:"outline",className:"text-xs animate-pulse bg-primary/10",children:["Escena ",ht.sceneNumber,"/",ht.totalScenes]}),Jt&&Jt.chapterNumbers.includes(z.chapterNumber)&&e.jsx(Q,{variant:"outline",className:"text-xs animate-pulse border-orange-500 text-orange-600 dark:text-orange-400",children:"Corrigiendo"}),z.wordCount&&z.wordCount>0&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[z.wordCount.toLocaleString()," pal."]}),e.jsx(Q,{variant:z.status==="completed"||z.status==="approved"?"default":z.status==="revision"?"destructive":"secondary",className:"text-xs",children:z.status==="completed"||z.status==="approved"?"Listo":z.status==="writing"?"Escribiendo":z.status==="editing"?"Editando":z.status==="revision"?"Reescribiendo":"Pendiente"}),(z.status==="completed"||z.status==="approved"||z.content&&z.content.length>0)&&M.status!=="generating"&&e.jsxs(ei,{children:[e.jsx(ti,{asChild:!0,children:e.jsx(B,{size:"icon",variant:"ghost","data-testid":`button-rewrite-chapter-${z.chapterNumber}`,onClick:()=>{D(z.chapterNumber),re(""),Y(!0)},disabled:Xi.isPending,children:e.jsx(Ns,{className:"h-3.5 w-3.5"})})}),e.jsx(ua,{children:"Reescribir captulo"})]})]})]},z.id)),Lt.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Los captulos aparecern aqu conforme se generen"})]}),M.finalScore&&e.jsxs("div",{className:"mt-4 p-4 rounded-md border border-border",style:{backgroundColor:M.finalScore>=9?"hsl(var(--chart-2) / 0.1)":M.finalScore>=7?"hsl(var(--chart-4) / 0.1)":"hsl(var(--destructive) / 0.1)"},children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"Puntuacin Final del Revisor"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[M.finalScore>=9?"Publicable - Calidad profesional":M.finalScore>=7?"Aceptable con reservas":"No publicable - Requiere revisin",M.revisionCycle&&M.revisionCycle>0&&e.jsxs("span",{className:"ml-2",children:["(Ciclo ",M.revisionCycle,")"]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:`text-3xl font-bold ${M.finalScore>=9?"text-green-600 dark:text-green-400":M.finalScore>=7?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"}`,"data-testid":"text-final-score",children:[M.finalScore,"/10"]})})]}),M.qaAuditReport&&M.qaAuditReport.totalFindings!==void 0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-border/50",children:[e.jsxs("p",{className:"text-sm font-medium mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"Informe Auditora QA"}),M.qaAuditReport.successCount>0&&e.jsxs(Q,{variant:"default",className:"text-[10px] px-1.5 py-0 bg-green-600",children:[M.qaAuditReport.successCount," corregidos"]}),M.qaAuditReport.failCount>0&&e.jsxs(Q,{variant:"destructive",className:"text-[10px] px-1.5 py-0",children:[M.qaAuditReport.failCount," fallidos"]})]}),M.qaAuditReport.totalFindings===0?e.jsx("p",{className:"text-xs text-green-600 dark:text-green-400",children:"No se detectaron problemas. El manuscrito est limpio."}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-xs text-muted-foreground",children:[M.qaAuditReport.totalFindings," problema(s) detectado(s) pre-revisin"]}),(()=>{const Ve=(M.qaAuditReport.findings||[]).reduce((Ce,lt)=>(Ce[lt.source]||(Ce[lt.source]=[]),Ce[lt.source].push(lt),Ce),{});return Object.entries(Ve).map(([Ce,lt])=>e.jsxs("div",{className:"text-xs p-2 rounded bg-background/50 border border-border/30",children:[e.jsxs("div",{className:"font-medium text-foreground mb-1 flex items-center gap-2",children:[e.jsx(Q,{variant:"outline",className:"text-[10px] px-1.5 py-0",children:Ce.replace(/_/g," ")}),e.jsxs("span",{className:"text-muted-foreground",children:[lt.length," problema(s)"]})]}),e.jsxs("div",{className:"space-y-1 max-h-24 overflow-y-auto",children:[lt.slice(0,3).map((Ft,Jn)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Q,{variant:Ft.severity==="critica"?"destructive":"secondary",className:"text-[9px] px-1 py-0 shrink-0",children:Ft.severity}),e.jsxs("span",{className:"text-muted-foreground",children:[Ft.chapter?`Cap ${Ft.chapter}: `:"",Ft.description?.substring(0,80),"..."]})]},Jn)),lt.length>3&&e.jsxs("p",{className:"text-muted-foreground italic",children:["+ ",lt.length-3," ms..."]})]})]},Ce))})(),M.qaAuditReport.corrections?.length>0&&e.jsxs("div",{className:"mt-2 p-2 rounded bg-green-500/10 border border-green-500/30",children:[e.jsx("p",{className:"text-xs font-medium text-green-600 dark:text-green-400 mb-1",children:"Correcciones Aplicadas"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:M.qaAuditReport.corrections.filter(z=>z.success).map((z,Ve)=>e.jsxs(Q,{variant:"outline",className:"text-[10px] px-1.5 py-0 bg-green-500/20",children:["Cap ",z.chapter,": ",z.issueCount," arreglado(s)"]},Ve))})]})]})]}),M.finalReviewResult&&M.finalReviewResult.issues?.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-border/50",children:[e.jsxs("p",{className:"text-sm font-medium mb-2",children:["Issues Documentados (",M.finalReviewResult.issues.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:M.finalReviewResult.issues.map((z,Ve)=>e.jsxs("div",{className:"text-xs p-2 rounded bg-background/50 border border-border/30","data-testid":`issue-${Ve}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx(Q,{variant:z.severidad==="critica"?"destructive":z.severidad==="mayor"?"secondary":"outline",className:"text-[10px] px-1.5 py-0",children:z.severidad}),e.jsx(Q,{variant:"outline",className:"text-[10px] px-1.5 py-0",children:z.categoria?.replace(/_/g," ")}),z.capitulos_afectados?.length>0&&e.jsxs("span",{className:"text-muted-foreground",children:["Cap. ",z.capitulos_afectados.map(Ce=>Ce===0?"Prlogo":Ce===-1?"Eplogo":Ce).join(", ")]})]}),e.jsx("p",{className:"text-foreground",children:z.descripcion}),z.instrucciones_correccion&&e.jsx("p",{className:"text-muted-foreground mt-1 italic",children:z.instrucciones_correccion})]},Ve))})]}),M.finalReviewResult&&M.finalReviewResult.justificacion_puntuacion&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-border/50",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Desglose de Puntuacin"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 text-xs",children:Object.entries(M.finalReviewResult.justificacion_puntuacion.puntuacion_desglosada||{}).map(([z,Ve])=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-muted-foreground capitalize",children:[z.replace(/_/g," "),":"]}),e.jsxs("span",{className:"font-medium",children:[Ve,"/10"]})]},z))})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-border/50",children:[e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>A(!0),className:"w-full","data-testid":"button-reset-reviewer",children:[e.jsx(Ns,{className:"w-4 h-4 mr-2"}),"Reiniciar Crtico desde cero"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2 text-center",children:"Borra el historial de evaluaciones para empezar una revisin completamente nueva"})]})]}),M.totalInputTokens||M.totalOutputTokens?e.jsx("div",{className:"mt-4 p-4 rounded-md bg-muted/30 border border-border",children:e.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm font-medium flex items-center gap-2",children:["Coste de Generacin",M.status==="generating"&&e.jsx(Q,{variant:"secondary",className:"text-xs",children:"En progreso"})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Entrada: ",(M.totalInputTokens||0).toLocaleString()," tokens"]}),e.jsxs("span",{children:["Salida: ",(M.totalOutputTokens||0).toLocaleString()," tokens"]}),(M.totalThinkingTokens||0)>0&&e.jsxs("span",{children:["Razonamiento: ",(M.totalThinkingTokens||0).toLocaleString()," tokens"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-2xl font-bold text-primary","data-testid":"text-total-cost",children:["$",WD(M.totalInputTokens||0,M.totalOutputTokens||0,M.totalThinkingTokens||0).toFixed(2)]}),e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"USD estimado"}),e.jsxs(ei,{children:[e.jsx(ti,{asChild:!0,children:e.jsx(t1,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),e.jsx(ua,{side:"left",className:"max-w-xs whitespace-pre-line text-xs",children:QD})]})]})]})]})}):null]})]})]}),e.jsxs("div",{className:"space-y-6",children:[ze.length===0&&e.jsx(me,{children:e.jsxs(he,{className:"pt-6 text-center space-y-4",children:[e.jsx("p",{className:"text-muted-foreground",children:"No hay proyectos creados"}),e.jsx(Ja,{href:"/config",children:e.jsxs(B,{"data-testid":"button-new-project",children:[e.jsx(Nr,{className:"h-4 w-4 mr-2"}),"Crear Proyecto"]})})]})}),M&&M.status==="idle"&&e.jsx(me,{children:e.jsxs(he,{className:"pt-6 space-y-3",children:[e.jsxs(B,{className:"w-full",size:"lg",onClick:cd,disabled:Jr.isPending,"data-testid":"button-continue-generation",children:[e.jsx(Yn,{className:"h-4 w-4 mr-2"}),"Iniciar Generacin"]}),e.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["Proyecto: ",M.title]})]})}),M&&e.jsxs(me,{children:[e.jsx(Re,{className:"pb-2",children:e.jsx(Ie,{className:"text-lg",children:"Acciones del Proyecto"})}),e.jsxs(he,{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(B,{variant:"outline",size:"sm",onClick:te,disabled:M.status==="generating","data-testid":"button-edit-metadata",children:[e.jsx(ar,{className:"h-4 w-4 mr-2"}),"Editar Datos"]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>$r.mutate(M.id),disabled:$r.isPending,"data-testid":"button-duplicate-project",children:[e.jsx(Uu,{className:"h-4 w-4 mr-2"}),"Duplicar"]}),M.status==="generating"&&e.jsxs(e.Fragment,{children:[e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>h("cancel"),disabled:wa.isPending,className:"text-destructive hover:text-destructive","data-testid":"button-cancel-generation",children:[e.jsx(gu,{className:"h-4 w-4 mr-2"}),"Cancelar"]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>h("forceComplete"),disabled:id.isPending,"data-testid":"button-force-complete",children:[e.jsx(fA,{className:"h-4 w-4 mr-2"}),"Forzar Completado"]})]}),["paused","cancelled","error","failed_final_review"].includes(M.status)&&e.jsxs(e.Fragment,{children:[M.pauseReason&&e.jsx("div",{className:"w-full mb-3 p-3 bg-yellow-500/10 border border-yellow-500/30 rounded-md text-sm whitespace-pre-wrap","data-testid":"pause-reason",children:M.pauseReason}),e.jsxs(B,{variant:"default",size:"sm",onClick:()=>h("resume"),disabled:wl.isPending,"data-testid":"button-resume-generation",children:[e.jsx(Yn,{className:"h-4 w-4 mr-2"}),"Continuar"]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>zn.mutate(M.id),disabled:zn.isPending,"data-testid":"button-restart-corrections",children:[e.jsx(Ns,{className:"h-4 w-4 mr-2"}),"Reiniciar Correcciones"]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>{de==="detect-fix"?Xn.mutate({id:M.id,useGeminiQA:Qe}):Nt.mutate({id:M.id,useGeminiQA:Qe})},disabled:Nt.isPending||Xn.isPending,"data-testid":"button-run-correction-paused",children:[de==="detect-fix"?e.jsx(sc,{className:"h-4 w-4 mr-2"}):e.jsx(qu,{className:"h-4 w-4 mr-2"}),Nt.isPending||Xn.isPending?"Procesando...":de==="detect-fix"?"Detect & Fix":"Revisin Final"]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>As.mutate(M.id),disabled:As.isPending||Is.isPending||M.targetedRepairStatus==="auto_cycle","data-testid":"button-diagnose-repair-paused",children:[e.jsx(sc,{className:"h-4 w-4 mr-2"}),As.isPending?"Diagnosticando...":"Diagnosticar"]}),e.jsxs(B,{variant:"default",size:"sm",onClick:()=>Is.mutate(M.id),disabled:Is.isPending||As.isPending||M.targetedRepairStatus==="auto_cycle","data-testid":"button-auto-cycle-repair-paused",children:[e.jsx(Ns,{className:"h-4 w-4 mr-2"}),Is.isPending||M.targetedRepairStatus==="auto_cycle"?"Ciclo automtico...":"Auto-ciclo (2x 9+)"]}),M.targetedRepairStatus==="auto_cycle"&&e.jsxs(B,{variant:"destructive",size:"sm",onClick:()=>bl.mutate(M.id),"data-testid":"button-cancel-auto-cycle-paused",children:[e.jsx(gu,{className:"h-4 w-4 mr-2"}),"Detener ciclo"]}),Array.isArray(M.targetedRepairPlan)&&M.targetedRepairPlan.length>0&&e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>_s(M.id),"data-testid":"button-view-repair-plan-paused",children:[e.jsx(yt,{className:"h-4 w-4 mr-2"}),"Ver Plan (",M.targetedRepairPlan.length,")"]})]}),(M.status==="final_review_in_progress"||M.status==="processing")&&e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>Xs.mutate(M.id),disabled:Xs.isPending,className:"text-destructive hover:text-destructive","data-testid":"button-cancel-correction",children:[e.jsx(gu,{className:"h-4 w-4 mr-2"}),Xs.isPending?"Cancelando...":"Cancelar Correccin"]}),["completed","paused","cancelled","error"].includes(M.status)&&e.jsx(e.Fragment,{children:e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>R(!0),disabled:yi.isPending,"data-testid":"button-extend-project",children:[e.jsx(Nr,{className:"h-4 w-4 mr-2"}),"Extender"]})}),M.status==="archived"?e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>ir.mutate(M.id),disabled:ir.isPending,"data-testid":"button-unarchive-project",children:[e.jsx(q0,{className:"h-4 w-4 mr-2"}),"Restaurar"]}):M.status!=="generating"&&e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>Ts.mutate(M.id),disabled:Ts.isPending,"data-testid":"button-archive-project",children:[e.jsx(q0,{className:"h-4 w-4 mr-2"}),"Archivar"]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>h("delete"),disabled:H.isPending||M.status==="generating",className:"text-destructive hover:text-destructive","data-testid":"button-delete-project",children:[e.jsx(Rn,{className:"h-4 w-4 mr-2"}),"Eliminar"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[M.title," - ",M.status==="completed"?"Completado":M.status==="archived"?"Archivado":M.status==="generating"?"Generando":"Pendiente"]})]})]}),e.jsxs(me,{children:[e.jsx(Re,{className:"pb-3",children:e.jsxs(Ie,{className:"text-lg flex items-center gap-2",children:[e.jsx(gA,{className:"h-5 w-5"}),"Gestin de Datos"]})}),e.jsxs(he,{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Exporta o importa todos los datos de la aplicacin (proyectos, captulos, configuraciones)."}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(B,{variant:"outline",size:"sm",onClick:qe,disabled:g,"data-testid":"button-export-data",children:[e.jsx(xn,{className:"h-4 w-4 mr-2"}),g?"Exportando...":"Exportar Datos"]}),e.jsxs("label",{children:[e.jsx(B,{variant:"outline",size:"sm",disabled:j,asChild:!0,"data-testid":"button-import-data",children:e.jsxs("span",{children:[e.jsx(ha,{className:"h-4 w-4 mr-2"}),j?"Importando...":"Importar Datos"]})}),e.jsx("input",{type:"file",accept:".json",onChange:Ze,className:"hidden","data-testid":"input-import-file"})]})]})]})]}),e.jsx(ED,{projectId:M?.id})]})]}),e.jsx(Pn,{open:se,onOpenChange:V,children:e.jsxs(yn,{children:[e.jsxs(jn,{children:[e.jsx(bn,{children:"Editar Datos del Proyecto"}),e.jsx($n,{children:"Modifica el ttulo, tipo de obra y posicin en la serie."})]}),e.jsxs("div",{className:"space-y-4 py-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{htmlFor:"edit-title",children:"Ttulo"}),e.jsx(gt,{id:"edit-title",value:G,onChange:z=>O(z.target.value),"data-testid":"input-edit-title"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{children:"Tipo de obra"}),e.jsxs(Pt,{value:le,onValueChange:z=>{K(z),z==="standalone"&&(U(null),q(null))},children:[e.jsx(St,{"data-testid":"select-edit-work-type",children:e.jsx(Tt,{})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"standalone",children:"Independiente"}),e.jsx(ce,{value:"series",children:"Serie"}),e.jsx(ce,{value:"trilogy",children:"Triloga"})]})]})]}),(le==="series"||le==="trilogy")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{children:"Serie"}),e.jsxs(Pt,{value:F?.toString()??"none",onValueChange:z=>U(z==="none"?null:parseInt(z)),children:[e.jsx(St,{"data-testid":"select-edit-series",children:e.jsx(Tt,{placeholder:"Seleccionar serie"})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"none",children:"Sin serie"}),ba.map(z=>e.jsx(ce,{value:z.id.toString(),children:z.title},z.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{htmlFor:"edit-series-order",children:"Orden en la serie"}),e.jsx(gt,{id:"edit-series-order",type:"number",min:1,value:$??"",onChange:z=>q(z.target.value?parseInt(z.target.value):null),"data-testid":"input-edit-series-order"})]})]})]}),e.jsxs(Ir,{children:[e.jsx(B,{variant:"outline",onClick:()=>V(!1),"data-testid":"button-cancel-edit",children:"Cancelar"}),e.jsx(B,{onClick:Ee,disabled:!G.trim()||Rs.isPending||(le==="series"||le==="trilogy")&&(!F||!$),"data-testid":"button-save-metadata",children:Rs.isPending?"Guardando...":"Guardar"})]})]})}),e.jsx(Vs,{open:m==="cancel",onOpenChange:z=>!z&&h(null),title:"Cancelar generacin",description:"Cancelar la generacin? El progreso actual se mantendr.",confirmText:"Cancelar generacin",variant:"destructive",onConfirm:()=>{M&&wa.mutate(M.id),h(null)}}),e.jsx(Vs,{open:m==="forceComplete",onOpenChange:z=>!z&&h(null),title:"Forzar completado",description:"Marcar como completado? Los captulos con contenido se guardarn.",confirmText:"Completar",onConfirm:()=>{M&&id.mutate(M.id),h(null)}}),e.jsx(vD,{open:m==="resume",onOpenChange:z=>!z&&h(null),title:"Reanudar o reiniciar",description:"Quieres continuar desde donde se detuvo o reiniciar desde cero? Reiniciar eliminar todos los captulos y la World Bible actual.",continueText:"Continuar",restartText:"Reiniciar desde cero",onContinue:()=>{M&&wl.mutate(M.id),h(null)},onRestart:()=>{M&&ld.mutate(M.id),h(null)}}),e.jsx(Vs,{open:m==="delete",onOpenChange:z=>!z&&h(null),title:"Eliminar proyecto",description:`Ests seguro de eliminar "${M?.title}"? Esta accin no se puede deshacer.`,confirmText:"Eliminar",variant:"destructive",onConfirm:()=>{M&&H.mutate(M.id),h(null)}}),e.jsx(Pn,{open:b,onOpenChange:C,children:e.jsxs(yn,{className:"max-w-2xl",children:[e.jsxs(jn,{children:[e.jsx(bn,{children:"Instrucciones para el Arquitecto"}),e.jsx($n,{children:"Proporciona instrucciones especficas que guiarn la planificacin de la trama y estructura de tu novela. Estas instrucciones sern utilizadas por el Arquitecto antes de generar los captulos."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{htmlFor:"architect-instructions",children:"Instrucciones (opcional)"}),e.jsx(Nn,{id:"architect-instructions",placeholder:`Escribe las instrucciones para el Arquitecto. Ejemplos:

- Quiero que cada captulo termine con un gancho fuerte
- El villano debe aparecer sutilmente en los primeros captulos
- Incluir escenas de tensin romntica entre X e Y
- El giro principal debe ocurrir en el captulo 8
- Mantener un ritmo acelerado en la segunda mitad`,value:S,onChange:z=>k(z.target.value),className:"min-h-[200px]","data-testid":"input-architect-instructions"})]}),e.jsxs("div",{className:"rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(st,{className:"text-base",children:"LitAgents 2.0"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Nuevo pipeline por escenas con edicin quirrgica"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Kr,{id:"use-v2",checked:Be,onCheckedChange:z=>ve(z===!0),"data-testid":"checkbox-use-v2"}),e.jsx("label",{htmlFor:"use-v2",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Activar"})]})]}),Be&&e.jsxs("div",{className:"text-xs text-muted-foreground bg-muted/50 p-2 rounded",children:[e.jsx("strong",{children:"Caractersticas v2:"}),e.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-0.5",children:[e.jsx("li",{children:"Escritura por escenas (3-4 por captulo)"}),e.jsx("li",{children:"Parches quirrgicos en lugar de reescrituras"}),e.jsx("li",{children:"Director Narrativo cada 5 captulos"}),e.jsx("li",{children:"Menor consumo de tokens"})]})]})]}),e.jsxs("div",{className:"border rounded-md p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Arquitecto con Gemini"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Usa Gemini en lugar de DeepSeek para planificar la novela (mayor calidad, mayor costo)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Kr,{id:"use-gemini-architect",checked:We,onCheckedChange:z=>Ye(z===!0),"data-testid":"checkbox-use-gemini-architect"}),e.jsx("label",{htmlFor:"use-gemini-architect",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Activar"})]})]}),We&&e.jsxs("div",{className:"text-xs text-muted-foreground bg-muted/50 p-2 rounded",children:[e.jsx("strong",{children:"Gemini Architect:"})," Genera planes de novela de mayor calidad y coherencia. Recomendado para novelas complejas o con muchos personajes. Requiere GEMINI_API_KEY configurada."]})]}),e.jsxs("div",{className:"border rounded-md p-3 space-y-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Agentes QA con Gemini"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Usa Gemini para agentes de calidad (mayor deteccin de errores, mayor costo)"})]}),e.jsxs("div",{className:"space-y-2 pl-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Kr,{id:"gemini-qa-final-reviewer",checked:Qe.finalReviewer,onCheckedChange:z=>mt(Ve=>({...Ve,finalReviewer:z===!0})),"data-testid":"checkbox-gemini-qa-final-reviewer"}),e.jsxs("label",{htmlFor:"gemini-qa-final-reviewer",className:"text-sm leading-none",children:["Final Reviewer ",e.jsx("span",{className:"text-xs text-muted-foreground",children:"(1 ejecucin - detecta agujeros de trama globales)"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Kr,{id:"gemini-qa-continuity-sentinel",checked:Qe.continuitySentinel,onCheckedChange:z=>mt(Ve=>({...Ve,continuitySentinel:z===!0})),"data-testid":"checkbox-gemini-qa-continuity-sentinel"}),e.jsxs("label",{htmlFor:"gemini-qa-continuity-sentinel",className:"text-sm leading-none",children:["Continuity Sentinel ",e.jsx("span",{className:"text-xs text-muted-foreground",children:"(por bloque - verifica continuidad)"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Kr,{id:"gemini-qa-narrative-director",checked:Qe.narrativeDirector,onCheckedChange:z=>mt(Ve=>({...Ve,narrativeDirector:z===!0})),"data-testid":"checkbox-gemini-qa-narrative-director"}),e.jsxs("label",{htmlFor:"gemini-qa-narrative-director",className:"text-sm leading-none",children:["Narrative Director ",e.jsx("span",{className:"text-xs text-muted-foreground",children:"(por captulo - mayor frecuencia/costo)"})]})]})]}),(Qe.finalReviewer||Qe.continuitySentinel||Qe.narrativeDirector)&&e.jsxs("div",{className:"text-xs text-muted-foreground bg-muted/50 p-2 rounded",children:[e.jsx("strong",{children:"Gemini QA:"})," Los agentes seleccionados usarn Gemini para diagnstico/deteccin. Las correcciones siempre usan DeepSeek. Requiere GEMINI_API_KEY configurada."]})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Nota:"})," Estas instrucciones son opcionales. Puedes iniciar la generacin sin ellas."]})})]}),e.jsxs(Ir,{children:[e.jsx(B,{variant:"outline",onClick:()=>C(!1),children:"Cancelar"}),e.jsx(B,{onClick:Ji,disabled:Jr.isPending,"data-testid":"button-confirm-generation",children:Jr.isPending?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}),"Iniciando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Yn,{className:"h-4 w-4 mr-2"}),"Iniciar Generacin"]})})]})]})}),e.jsx(Pn,{open:P,onOpenChange:R,children:e.jsxs(yn,{children:[e.jsxs(jn,{children:[e.jsx(bn,{children:"Extender Proyecto"}),e.jsx($n,{children:"Aade ms captulos a tu proyecto. El sistema generar la escaleta y contenido de los captulos adicionales manteniendo la continuidad con los existentes."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{htmlFor:"target-chapters",children:"Nmero total de captulos"}),e.jsx("input",{id:"target-chapters",type:"number",min:(Lt?.filter(z=>z.chapterNumber>0).length||0)+1,value:Oe,onChange:z=>Pe(z.target.value),className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring",placeholder:`Actualmente: ${Lt?.filter(z=>z.chapterNumber>0).length||0} captulos`,"data-testid":"input-target-chapters"})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsxs("p",{children:["Captulos actuales: ",e.jsx("strong",{children:Lt?.filter(z=>z.chapterNumber>0).length||0})]}),e.jsxs("p",{children:["Nuevos captulos a generar: ",e.jsx("strong",{children:Oe?Math.max(0,parseInt(Oe)-(Lt?.filter(z=>z.chapterNumber>0).length||0)):0})]})]})]}),e.jsxs(Ir,{children:[e.jsx(B,{variant:"outline",onClick:()=>R(!1),children:"Cancelar"}),e.jsx(B,{onClick:()=>{M&&Oe&&yi.mutate({id:M.id,targetChapters:parseInt(Oe)})},disabled:yi.isPending||!Oe||parseInt(Oe)<=(Lt?.filter(z=>z.chapterNumber>0).length||0),"data-testid":"button-confirm-extend",children:yi.isPending?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}),"Extendiendo..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Nr,{className:"h-4 w-4 mr-2"}),"Extender Proyecto"]})})]})]})}),e.jsx(Pn,{open:W,onOpenChange:X,children:e.jsxs(yn,{children:[e.jsxs(jn,{children:[e.jsx(bn,{children:"Fusionar Captulos"}),e.jsx($n,{children:"Fusiona dos captulos en uno. El contenido del captulo origen se aadir al final del captulo destino, y los captulos posteriores se renumerarn automticamente."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{htmlFor:"merge-target",children:"Captulo destino (se mantiene)"}),e.jsxs("select",{id:"merge-target",value:xe??"",onChange:z=>Se(z.target.value?parseInt(z.target.value):null),className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring","data-testid":"select-merge-target",children:[e.jsx("option",{value:"",children:"Seleccionar captulo destino..."}),Lt?.filter(z=>z.chapterNumber>0&&z.chapterNumber!==oe).map(z=>e.jsxs("option",{value:z.chapterNumber,children:["Captulo ",z.chapterNumber,": ",z.title?.replace(/^Captulo \d+\s*[-:]?\s*/i,"")||"Sin ttulo"]},z.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{htmlFor:"merge-source",children:"Captulo origen (se eliminar)"}),e.jsxs("select",{id:"merge-source",value:oe??"",onChange:z=>Ne(z.target.value?parseInt(z.target.value):null),className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring","data-testid":"select-merge-source",children:[e.jsx("option",{value:"",children:"Seleccionar captulo origen..."}),Lt?.filter(z=>z.chapterNumber>0&&z.chapterNumber!==xe).map(z=>e.jsxs("option",{value:z.chapterNumber,children:["Captulo ",z.chapterNumber,": ",z.title?.replace(/^Captulo \d+\s*[-:]?\s*/i,"")||"Sin ttulo"]},z.id))]})]}),oe&&xe&&e.jsxs("div",{className:"text-sm text-muted-foreground bg-muted p-3 rounded-md",children:[e.jsx("p",{children:e.jsx("strong",{children:"Vista previa:"})}),e.jsxs("p",{children:["El contenido del ",e.jsxs("strong",{children:["Captulo ",oe]})," se aadir al final del ",e.jsxs("strong",{children:["Captulo ",xe]}),"."]}),e.jsx("p",{className:"text-amber-600 dark:text-amber-400 mt-2",children:"Advertencia: Esta accin no se puede deshacer fcilmente."})]})]}),e.jsxs(Ir,{children:[e.jsx(B,{variant:"outline",onClick:()=>{X(!1),Ne(null),Se(null)},children:"Cancelar"}),e.jsx(B,{onClick:()=>{M&&oe&&xe&&Zi.mutate({projectId:M.id,sourceChapterNumber:oe,targetChapterNumber:xe})},disabled:Zi.isPending||!oe||!xe,"data-testid":"button-confirm-merge",children:Zi.isPending?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}),"Fusionando..."]}):"Fusionar Captulos"})]})]})}),e.jsx(Pn,{open:T,onOpenChange:z=>{Y(z),z||(D(null),re(""))},children:e.jsxs(yn,{children:[e.jsxs(jn,{children:[e.jsxs(bn,{children:["Reescribir ",J===0?"Prlogo":J===998?"Eplogo":J===999?"Nota del Autor":`Captulo ${J}`]}),e.jsx($n,{children:"Se regenerar el captulo completo manteniendo la coherencia con la World Bible y los captulos anteriores. Puedes dar instrucciones especficas o dejarlo en blanco para una regeneracin automtica."})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{htmlFor:"rewrite-instructions",children:"Instrucciones (opcional)"}),e.jsx(Nn,{id:"rewrite-instructions",placeholder:"Ej: Hacer el captulo ms tenso, aadir ms dilogo, corregir la escena del encuentro...",value:I,onChange:z=>re(z.target.value),className:"min-h-[100px]","data-testid":"input-rewrite-instructions"})]})}),e.jsxs(Ir,{className:"gap-2",children:[e.jsx(B,{variant:"outline",onClick:()=>{Y(!1),D(null),re("")},"data-testid":"button-cancel-rewrite",children:"Cancelar"}),e.jsx(B,{onClick:()=>{M&&J!==null&&Xi.mutate({projectId:M.id,chapterNumber:J,instructions:I.trim()||void 0})},disabled:Xi.isPending,"data-testid":"button-confirm-rewrite",children:Xi.isPending?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}),"Reescribiendo..."]}):"Reescribir Captulo"})]})]})}),e.jsx(Pn,{open:Qi,onOpenChange:Ca,children:e.jsxs(yn,{className:"max-w-2xl max-h-[80vh] flex flex-col",children:[e.jsxs(jn,{children:[e.jsx(bn,{children:"Plan de Reparacin Dirigida"}),e.jsx($n,{children:es?.diagnosis?typeof es.diagnosis=="string"?es.diagnosis:JSON.stringify(es.diagnosis,null,2).slice(0,500):"Anlisis de desviaciones del manuscrito"})]}),e.jsx("div",{className:"overflow-y-auto flex-1 pr-1",children:es?Array.isArray(es.plan)&&es.plan.length>0?e.jsx("div",{className:"space-y-3",children:es.plan.map((z,Ve)=>e.jsx(me,{children:e.jsxs(he,{className:"p-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 flex-wrap mb-2",children:[e.jsxs("span",{className:"font-medium text-sm",children:["Captulo ",z.chapterNumber??z.chapter??Ve+1]}),e.jsxs("div",{className:"flex items-center gap-2",children:[z.priority&&e.jsx(Q,{variant:z.priority==="critical"?"destructive":z.priority==="high"?"default":"secondary",children:z.priority}),z.approach&&e.jsx(Q,{variant:"outline",children:z.approach==="surgical"?"Correccin quirrgica":"Reescritura"})]})]}),Array.isArray(z.issues)&&z.issues.length>0&&e.jsx("ul",{className:"text-xs text-muted-foreground space-y-1",children:z.issues.map((Ce,lt)=>e.jsxs("li",{className:"flex items-start gap-1",children:[e.jsx("span",{className:"text-destructive mt-0.5 shrink-0",children:"-"}),e.jsx("span",{children:typeof Ce=="string"?Ce:Ce?.description||Ce?.issue||Ce?.mensaje||JSON.stringify(Ce)})]},lt))}),z.instructions&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1 italic",children:typeof z.instructions=="string"?z.instructions:JSON.stringify(z.instructions)})]})},Ve))}):e.jsx("p",{className:"text-sm text-muted-foreground py-4",children:"No se encontraron problemas que reparar."}):e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(be,{className:"h-6 w-6 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:"Cargando plan..."})]})}),e.jsxs(Ir,{className:"flex gap-2",children:[e.jsx(B,{variant:"outline",onClick:()=>Ca(!1),"data-testid":"button-close-repair-plan",children:"Cerrar"}),Array.isArray(es?.plan)&&es.plan.length>0&&M&&e.jsx(B,{onClick:()=>Yi.mutate(M.id),disabled:Yi.isPending,"data-testid":"button-execute-repair",children:Yi.isPending?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}),"Ejecutando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Yn,{className:"h-4 w-4 mr-2"}),"Ejecutar Reparacin"]})})]})]})}),e.jsx(Vs,{open:E,onOpenChange:A,title:"Reiniciar Crtico",description:"Esto borrar todo el historial de evaluaciones del crtico (puntuacin, issues resueltos, ciclos de correccin). La prxima evaluacin comenzar completamente desde cero, sin sesgos de revisiones anteriores.",confirmText:"Reiniciar Crtico",cancelText:"Cancelar",onConfirm:()=>{M&&vi.mutate(M.id)}})]})}const Nb={pending:{icon:Cn,color:"bg-muted text-muted-foreground",label:"Pendiente"},writing:{icon:be,color:"bg-chart-2/20 text-chart-2",label:"Escribiendo"},editing:{icon:be,color:"bg-chart-3/20 text-chart-3",label:"Editando"},completed:{icon:Xt,color:"bg-green-500/20 text-green-600 dark:text-green-400",label:"Completado"},approved:{icon:Xt,color:"bg-green-500/20 text-green-600 dark:text-green-400",label:"Completado"}};function ZD({chapters:t,selectedChapterId:n,onSelectChapter:r,onResetChapter:s,resettingChapterId:i}){const[o,c]=x.useState(null);if(t.length===0)return e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(yt,{className:"h-12 w-12 text-muted-foreground/30 mb-4"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"No hay captulos todava"}),e.jsx("p",{className:"text-muted-foreground/60 text-xs mt-1",children:"Inicia un proyecto para generar captulos"})]});const d=h=>(h.content||"").trim().split(/\s+/).filter(j=>j.length>0).length<50,p=()=>{o&&s&&s(o),c(null)},m=h=>h.chapterNumber===0?"el Prlogo":h.chapterNumber===-1?"el Eplogo":h.chapterNumber===-2?"la Nota del Autor":`el Captulo ${h.chapterNumber}`;return e.jsxs(e.Fragment,{children:[e.jsx(Wg,{open:!!o,onOpenChange:h=>!h&&c(null),children:e.jsxs(Qp,{children:[e.jsxs(Yp,{children:[e.jsx(Xp,{children:"Confirmar regeneracin"}),e.jsxs(Jp,{children:["Ests seguro de que quieres regenerar ",o?m(o):"este captulo","?",o?.title&&e.jsxs("span",{className:"block mt-1 font-medium text-foreground",children:['"',o.title,'"']}),e.jsx("span",{className:"block mt-2 text-destructive",children:"El contenido actual se perder y se generar uno nuevo."})]})]}),e.jsxs(Zp,{children:[e.jsx(em,{children:"Cancelar"}),e.jsx(_c,{onClick:p,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"S, regenerar"})]})]})}),e.jsx(jt,{className:"h-[400px]",children:e.jsx("div",{className:"space-y-2 pr-4",children:t.map(h=>{const g=Nb[h.status]||Nb.pending,v=g.icon,j=n===h.id,N=h.status==="writing"||h.status==="editing",b=d(h),C=i===h.id;return e.jsxs("div",{className:`
                  w-full text-left p-3 rounded-md transition-all duration-200
                  ${j?"bg-sidebar-accent":"bg-card"}
                  ${b?"border-2 border-destructive/50":""}
                `,children:[e.jsxs("button",{onClick:()=>r(h),className:"w-full text-left hover-elevate active-elevate-2 rounded","data-testid":`button-chapter-${h.id}`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[e.jsx("span",{className:"font-medium text-sm",children:h.chapterNumber===0?"Prlogo":h.chapterNumber===-1?"Eplogo":h.chapterNumber===-2?"Nota del Autor":`Captulo ${h.chapterNumber}`}),e.jsxs("div",{className:"flex items-center gap-1",children:[b&&e.jsxs(Q,{className:"bg-destructive/20 text-destructive text-xs",children:[e.jsx(on,{className:"h-3 w-3 mr-1"}),"Vaco"]}),e.jsxs(Q,{className:`${g.color} text-xs`,children:[e.jsx(v,{className:`h-3 w-3 mr-1 ${N?"animate-spin":""}`}),g.label]})]})]}),h.title&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1",children:h.title}),h.wordCount&&h.wordCount>0&&e.jsxs("p",{className:"text-xs text-muted-foreground/70 mt-1",children:[h.wordCount.toLocaleString()," palabras"]})]}),s&&(h.status==="completed"||h.status==="approved")&&e.jsx(B,{size:"sm",variant:b?"destructive":"outline",className:"w-full mt-2",onClick:S=>{S.stopPropagation(),c(h)},disabled:C,"data-testid":`button-reset-chapter-${h.id}`,children:C?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}),"Marcando pendiente..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ho,{className:"h-4 w-4 mr-2"}),b?"Regenerar (vaco)":"Marcar para regenerar"]})})]},h.id)})})})]})}function XD({chapter:t,projectId:n}){const[r,s]=x.useState(!1),[i,o]=x.useState(""),[c,d]=x.useState(!1),[p,m]=x.useState(null),[h,g]=x.useState(""),[v,j]=x.useState(!1),[N,b]=x.useState(""),[C,S]=x.useState(""),[k,P]=x.useState(!1),[R,E]=x.useState(!1),[A,W]=x.useState([]),[X,se]=x.useState(-1),V=x.useRef(null),G=x.useRef(null),O=x.useRef(null),{toast:F}=nn(),{data:U=[]}=Ke({queryKey:["/api/chapters",t?.id,"annotations"],enabled:!!t?.id}),$=ye({mutationFn:async({chapterId:ve,content:We})=>(await je("PUT",`/api/chapters/${ve}`,{content:We})).json(),onSuccess:ve=>{F({title:"Cambios guardados",description:`${ve.wordCount.toLocaleString()} palabras guardadas.`}),s(!1),ae.invalidateQueries({queryKey:["/api/projects",n,"chapters"]})},onError:ve=>{F({title:"Error",description:ve.message||"No se pudieron guardar los cambios",variant:"destructive"})}}),q=ye({mutationFn:async({chapterId:ve,startOffset:We,endOffset:Ye,content:Qe,note:mt})=>(await je("POST",`/api/chapters/${ve}/annotations`,{startOffset:We,endOffset:Ye,annotationType:"error",content:Qe,note:mt})).json(),onSuccess:()=>{F({title:"Error marcado",description:"El texto ha sido marcado para correccin."}),j(!1),m(null),g(""),ae.invalidateQueries({queryKey:["/api/chapters",t?.id,"annotations"]})},onError:ve=>{F({title:"Error",description:ve.message||"No se pudo marcar el error",variant:"destructive"})}}),le=ye({mutationFn:async ve=>(await je("PATCH",`/api/annotations/${ve}/resolve`)).json(),onSuccess:()=>{F({title:"Corregido",description:"El error ha sido marcado como resuelto."}),ae.invalidateQueries({queryKey:["/api/chapters",t?.id,"annotations"]})}}),K=ye({mutationFn:async ve=>(await je("DELETE",`/api/annotations/${ve}`)).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/chapters",t?.id,"annotations"]})}});x.useEffect(()=>{t?.content&&o(t.content)},[t?.content]);const J=()=>{if(!c||!O.current)return;const ve=window.getSelection();if(!ve||ve.isCollapsed)return;const We=ve.toString().trim();if(We.length<3)return;const Qe=(t?.content||"").indexOf(We);Qe!==-1&&(m({start:Qe,end:Qe+We.length,text:We}),j(!0))},D=()=>{t&&$.mutate({chapterId:t.id,content:i})},I=()=>{o(t?.content||""),s(!1),P(!1),E(!1),b(""),S(""),W([]),se(-1)},re=(ve,We)=>{if(!ve||ve.length<1){W([]),se(-1);return}const Ye=We.toLowerCase(),Qe=ve.toLowerCase(),mt=[];let ht=0;for(;ht<Ye.length;){const cn=Ye.indexOf(Qe,ht);if(cn===-1)break;mt.push(cn),ht=cn+1}W(mt),mt.length>0?(se(0),T(mt[0],ve.length)):se(-1)},T=(ve,We)=>{const Ye=V.current;if(!Ye)return;Ye.focus(),Ye.setSelectionRange(ve,ve+We);const Qe=32,ht=Math.floor(ve/80);Ye.scrollTop=Math.max(0,ht*Qe-Ye.clientHeight/3)},Y=()=>{if(A.length===0)return;const ve=(X+1)%A.length;se(ve),T(A[ve],N.length)},oe=()=>{if(A.length===0)return;const ve=X<=0?A.length-1:X-1;se(ve),T(A[ve],N.length)},Ne=()=>{if(A.length===0||X<0)return;const ve=A[X],We=i.substring(0,ve),Ye=i.substring(ve+N.length),Qe=We+C+Ye;o(Qe),re(N,Qe)},xe=()=>{if(!N||A.length===0)return;let ve="",We=0;for(const Qe of A)ve+=i.substring(We,Qe)+C,We=Qe+N.length;ve+=i.substring(We);const Ye=A.length;o(ve),W([]),se(-1),F({title:"Reemplazos completados",description:`${Ye} coincidencias reemplazadas.`})};x.useEffect(()=>{k&&G.current&&G.current.focus()},[k]);const Se=()=>{!t||!p||q.mutate({chapterId:t.id,startOffset:p.start,endOffset:p.end,content:p.text,note:h||void 0})},Oe=ve=>{if(!U||U.length===0||r)return e.jsx("div",{dangerouslySetInnerHTML:{__html:ve.replace(/\n\n/g,"</p><p>").replace(/\n/g,"<br />").replace(/^/,"<p>").replace(/$/,"</p>")}});const We=[...U].filter(mt=>!mt.resolved).sort((mt,ht)=>mt.startOffset-ht.startOffset);if(We.length===0)return e.jsx("div",{dangerouslySetInnerHTML:{__html:ve.replace(/\n\n/g,"</p><p>").replace(/\n/g,"<br />").replace(/^/,"<p>").replace(/$/,"</p>")}});const Ye=[];let Qe=0;for(const mt of We)mt.startOffset>Qe&&Ye.push({text:ve.slice(Qe,mt.startOffset)}),Ye.push({text:ve.slice(mt.startOffset,mt.endOffset),annotation:mt}),Qe=mt.endOffset;return Qe<ve.length&&Ye.push({text:ve.slice(Qe)}),e.jsx("div",{children:Ye.map((mt,ht)=>mt.annotation?e.jsxs("span",{className:"bg-destructive/30 border-b-2 border-destructive cursor-pointer relative group",title:mt.annotation.note||"Error marcado para correccin",children:[mt.text,e.jsxs("span",{className:"hidden group-hover:flex absolute -top-8 left-0 bg-destructive text-destructive-foreground text-xs px-2 py-1 rounded whitespace-nowrap z-10",children:[e.jsx(on,{className:"h-3 w-3 mr-1"}),mt.annotation.note||"Error marcado"]})]},ht):e.jsx("span",{children:mt.text},ht))})},Pe=U.filter(ve=>!ve.resolved);if(!t)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center py-16",children:[e.jsx(yt,{className:"h-16 w-16 text-muted-foreground/20 mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Selecciona un captulo para ver su contenido"})]});const Be=t.status==="writing"||t.status==="editing";return e.jsxs("div",{className:"h-full flex flex-col","data-testid":`viewer-chapter-${t.id}`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 pb-4 border-b mb-4 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold font-serif",children:t.chapterNumber===0?"Prlogo":t.chapterNumber===-1?"Eplogo":t.chapterNumber===-2?"Nota del Autor":`Captulo ${t.chapterNumber}`}),t.title&&e.jsx("p",{className:"text-lg text-muted-foreground font-serif mt-1",children:t.title})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[t.wordCount&&t.wordCount>0&&e.jsxs(Q,{variant:"secondary",className:"text-xs",children:[t.wordCount.toLocaleString()," palabras"]}),Pe.length>0&&e.jsxs(Q,{className:"bg-destructive/20 text-destructive text-xs",children:[e.jsx(on,{className:"h-3 w-3 mr-1"}),Pe.length," errores"]}),Be&&e.jsxs(Q,{className:"bg-chart-2/20 text-chart-2",children:[e.jsx(be,{className:"h-3 w-3 mr-1 animate-spin"}),"En progreso"]}),t.content&&!Be&&e.jsx("div",{className:"flex items-center gap-1",children:r?e.jsxs(e.Fragment,{children:[e.jsxs(B,{size:"sm",variant:k?"secondary":"outline",onClick:()=>{P(!k),k&&(E(!1),b(""),S(""),W([]),se(-1))},"data-testid":"button-toggle-search",children:[e.jsx(ma,{className:"h-4 w-4 mr-1"}),"Buscar"]}),e.jsxs(B,{size:"sm",variant:"default",onClick:D,disabled:$.isPending,"data-testid":"button-save-chapter",children:[$.isPending?e.jsx(be,{className:"h-4 w-4 mr-1 animate-spin"}):e.jsx(Pp,{className:"h-4 w-4 mr-1"}),"Guardar"]}),e.jsxs(B,{size:"sm",variant:"outline",onClick:I,"data-testid":"button-cancel-edit",children:[e.jsx(Gn,{className:"h-4 w-4 mr-1"}),"Cancelar"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(B,{size:"sm",variant:"outline",onClick:()=>s(!0),"data-testid":"button-edit-chapter",children:[e.jsx(i1,{className:"h-4 w-4 mr-1"}),"Editar"]}),e.jsxs(B,{size:"sm",variant:c?"destructive":"outline",onClick:()=>d(!c),"data-testid":"button-mark-errors",children:[e.jsx(on,{className:"h-4 w-4 mr-1"}),c?"Terminar marcado":"Marcar errores"]})]})})]})]}),Pe.length>0&&!r&&e.jsxs("div",{className:"mb-4 p-3 bg-destructive/10 rounded-md border border-destructive/20",children:[e.jsxs("h3",{className:"text-sm font-medium text-destructive mb-2 flex items-center gap-1",children:[e.jsx(on,{className:"h-4 w-4"}),"Errores marcados (",Pe.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:Pe.map(ve=>e.jsxs("div",{className:"flex items-start justify-between gap-2 p-2 bg-background rounded text-sm",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-muted-foreground line-clamp-1 italic",children:['"',ve.content,'"']}),ve.note&&e.jsxs("p",{className:"text-xs text-muted-foreground/70 mt-1",children:[e.jsx($i,{className:"h-3 w-3 inline mr-1"}),ve.note]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(B,{size:"icon",variant:"ghost",className:"h-6 w-6",onClick:()=>le.mutate(ve.id),title:"Marcar como corregido","data-testid":`button-resolve-annotation-${ve.id}`,children:e.jsx(Xt,{className:"h-4 w-4 text-green-600"})}),e.jsx(B,{size:"icon",variant:"ghost",className:"h-6 w-6",onClick:()=>K.mutate(ve.id),title:"Eliminar","data-testid":`button-delete-annotation-${ve.id}`,children:e.jsx(Rn,{className:"h-4 w-4 text-muted-foreground"})})]})]},ve.id))})]}),r&&k&&e.jsxs("div",{className:"mb-3 p-3 bg-muted/50 rounded-md border space-y-2","data-testid":"search-panel",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-1 flex-1 min-w-[200px]",children:[e.jsx(ma,{className:"h-4 w-4 text-muted-foreground shrink-0"}),e.jsx(gt,{ref:G,value:N,onChange:ve=>{b(ve.target.value),re(ve.target.value,i)},onKeyDown:ve=>{ve.key==="Enter"&&(ve.preventDefault(),ve.shiftKey?oe():Y()),ve.key==="Escape"&&(P(!1),E(!1),b(""),S(""),W([]),se(-1))},placeholder:"Buscar texto...",className:"h-8 text-sm","data-testid":"input-search-text"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[N&&e.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap","data-testid":"text-search-count",children:A.length>0?`${X+1} de ${A.length}`:"Sin resultados"}),e.jsx(B,{size:"icon",variant:"ghost",onClick:oe,disabled:A.length===0,"data-testid":"button-search-prev",children:e.jsx(kp,{className:"h-4 w-4"})}),e.jsx(B,{size:"icon",variant:"ghost",onClick:Y,disabled:A.length===0,"data-testid":"button-search-next",children:e.jsx(Qs,{className:"h-4 w-4"})}),e.jsxs(B,{size:"sm",variant:R?"secondary":"ghost",onClick:()=>E(!R),"data-testid":"button-toggle-replace",children:[e.jsx(Gu,{className:"h-4 w-4 mr-1"}),"Reemplazar"]}),e.jsx(B,{size:"icon",variant:"ghost",onClick:()=>{P(!1),E(!1),b(""),S(""),W([]),se(-1)},"data-testid":"button-close-search",children:e.jsx(Gn,{className:"h-4 w-4"})})]})]}),R&&e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-1 flex-1 min-w-[200px]",children:[e.jsx(Gu,{className:"h-4 w-4 text-muted-foreground shrink-0"}),e.jsx(gt,{value:C,onChange:ve=>S(ve.target.value),onKeyDown:ve=>{ve.key==="Enter"&&(ve.preventDefault(),Ne())},placeholder:"Reemplazar con...",className:"h-8 text-sm","data-testid":"input-replace-text"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(B,{size:"sm",variant:"outline",onClick:Ne,disabled:A.length===0,"data-testid":"button-replace-one",children:"Reemplazar"}),e.jsx(B,{size:"sm",variant:"outline",onClick:xe,disabled:A.length===0,"data-testid":"button-replace-all",children:"Reemplazar todo"})]})]})]}),e.jsx(jt,{className:"flex-1",children:t.content?r?e.jsx(Nn,{ref:V,value:i,onChange:ve=>o(ve.target.value),className:"min-h-[500px] font-serif text-base leading-8 resize-none whitespace-pre-wrap",style:{lineHeight:"2rem",paddingTop:"1rem",paddingBottom:"1rem"},placeholder:"Escribe el contenido del captulo aqu. Usa doble salto de lnea para separar prrafos.","data-testid":"textarea-edit-chapter"}):e.jsx("article",{ref:O,className:`prose prose-lg dark:prose-invert max-w-prose mx-auto leading-7 font-serif ${c?"cursor-text select-text":""}`,onMouseUp:J,children:Oe(t.content)}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx(Cn,{className:"h-12 w-12 text-muted-foreground/30 mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"El contenido se est generando..."}),e.jsx("p",{className:"text-xs text-muted-foreground/60 mt-2",children:"El captulo aparecer aqu cuando est listo"})]})}),e.jsx(Pn,{open:v,onOpenChange:j,children:e.jsxs(yn,{children:[e.jsxs(jn,{children:[e.jsx(bn,{children:"Marcar error"}),e.jsx($n,{children:"Aade una nota sobre el error seleccionado para referencia futura."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{children:[e.jsx(st,{className:"text-sm text-muted-foreground",children:"Texto seleccionado:"}),e.jsxs("p",{className:"mt-1 p-2 bg-destructive/10 rounded text-sm italic border border-destructive/20",children:['"',p?.text,'"']})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{htmlFor:"annotation-note",children:"Nota (opcional)"}),e.jsx(gt,{id:"annotation-note",placeholder:"Describe el error o la correccin necesaria...",value:h,onChange:ve=>g(ve.target.value),"data-testid":"input-annotation-note"})]})]}),e.jsxs(Ir,{children:[e.jsx(B,{variant:"outline",onClick:()=>j(!1),children:"Cancelar"}),e.jsxs(B,{variant:"destructive",onClick:Se,disabled:q.isPending,"data-testid":"button-confirm-annotation",children:[q.isPending?e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(on,{className:"h-4 w-4 mr-2"}),"Marcar error"]})]})]})}),c&&e.jsxs("div",{className:"mt-2 p-2 bg-destructive/10 rounded text-sm text-center text-destructive border border-destructive/20",children:[e.jsx(on,{className:"h-4 w-4 inline mr-2"}),"Modo marcado activo: selecciona texto para marcar errores"]})]})}function JD(t){const n=[],r=/---PROPUESTA---([\s\S]*?)---FIN_PROPUESTA---/g;let s=t,i;for(;(i=r.exec(t))!==null;){const o=i[1],c={tipo:"",descripcion:""},d=o.split(`
`);for(const p of d){const m=p.indexOf(":");if(m>0){const h=p.substring(0,m).trim().toLowerCase(),g=p.substring(m+1).trim();h==="tipo"?c.tipo=g:h==="objetivo"?c.objetivo=g:h==="capitulo"?c.capitulo=g:h==="descripcion"?c.descripcion=g:h==="contenido_propuesto"?c.contenido_propuesto=g:h==="texto_original"?c.texto_original=g:h==="texto_propuesto"&&(c.texto_propuesto=g)}}c.descripcion&&n.push(c),s=s.replace(i[0],"")}return{text:s.trim(),proposals:n}}function sv({agentType:t,projectId:n,reeditProjectId:r,chapterNumber:s,className:i,onClose:o}){const c=og(),[d,p]=x.useState(null),[m,h]=x.useState(""),[g,v]=x.useState(!1),[j,N]=x.useState(""),b=x.useRef(null),C=x.useRef(null),S=x.useRef(null),k=n?["/api/chat/sessions",{projectId:n,agentType:t}]:["/api/chat/sessions",{reeditProjectId:r,agentType:t}],{data:P=[],isLoading:R}=Ke({queryKey:k,queryFn:async()=>{const T=new URLSearchParams;n&&T.set("projectId",n.toString()),r&&T.set("reeditProjectId",r.toString()),T.set("agentType",t);const Y=await fetch(`/api/chat/sessions?${T}`);if(!Y.ok)throw new Error("Failed to fetch sessions");return Y.json()}}),E=["/api/chat/sessions",d,"messages"],{data:A=[],isLoading:W}=Ke({queryKey:E,queryFn:async()=>{if(!d)return[];const T=await fetch(`/api/chat/sessions/${d}/messages`);if(!T.ok)throw new Error("Failed to fetch messages");return T.json()},enabled:!!d}),X=ye({mutationFn:async()=>{const T={agentType:t};return n&&(T.projectId=n),r&&(T.reeditProjectId=r),s!==void 0&&(T.chapterNumber=s),T.title=`${t==="architect"?"Arquitecto":"Reeditor"} - ${new Date().toLocaleDateString()}`,(await je("POST","/api/chat/sessions",T)).json()},onSuccess:T=>{c.invalidateQueries({queryKey:k}),p(T.id)}}),se=ye({mutationFn:async T=>{await je("DELETE",`/api/chat/sessions/${T}`)},onSuccess:()=>{if(c.invalidateQueries({queryKey:k}),P.length>1){const T=P.filter(Y=>Y.id!==d);p(T[0]?.id||null)}else p(null)}}),[V,G]=x.useState(new Set),[O,F]=x.useState(null),U=ye({mutationFn:async T=>{const Y={sessionId:d,messageId:T.messageId,proposal:T.proposal,projectId:n,reeditProjectId:r};return(await je("POST","/api/chat/proposals/apply",Y)).json()},onSuccess:(T,Y)=>{const oe=`${Y.messageId}-${Y.proposalIdx}`;T.applied&&G(Ne=>new Set(Array.from(Ne).concat(oe))),c.invalidateQueries({queryKey:E})}}),$=async(T,Y,oe)=>{const Ne=`${Y}-${oe}`;F(Ne);try{await U.mutateAsync({proposal:T,messageId:Y,proposalIdx:oe})}finally{F(null)}},q=(T,Y)=>{const oe=`${T}-${Y}`;G(Ne=>new Set(Array.from(Ne).concat(oe)))};x.useEffect(()=>{p(null),h(""),v(!1),N("")},[n,r]),x.useEffect(()=>{P.length>0&&!d&&p(P[0].id)},[P,d]),x.useEffect(()=>{if(C.current){const T=C.current.querySelector("[data-radix-scroll-area-viewport]");T&&(T.scrollTop=T.scrollHeight)}},[A,j]);const le=x.useCallback(async()=>{if(!m.trim()||!d||g)return;const T=m.trim();h(""),v(!0),N("");const Y={id:-1,sessionId:d,role:"user",content:T,chapterReference:null,metadata:null,inputTokens:0,outputTokens:0,createdAt:new Date};c.setQueryData(E,(oe=[])=>[...oe,Y]);try{const oe=`/api/chat/sessions/${d}/stream?message=${encodeURIComponent(T)}`,Ne=new EventSource(oe);let xe="";Ne.addEventListener("chunk",Se=>{const Oe=JSON.parse(Se.data);xe+=Oe.text,N(xe)}),Ne.addEventListener("complete",Se=>{const Oe=JSON.parse(Se.data);Ne.close(),v(!1),N(""),c.invalidateQueries({queryKey:E}),c.invalidateQueries({queryKey:k})}),Ne.addEventListener("error",Se=>{Ne.close(),v(!1),N(""),console.error("Chat stream error:",Se)}),Ne.onerror=()=>{Ne.close(),v(!1),N("")}}catch(oe){console.error("Failed to send message:",oe),v(!1),N("")}},[m,d,g,c,E,k]),K=T=>{T.key==="Enter"&&!T.shiftKey&&(T.preventDefault(),le())},D=t==="architect"?mn:Ec,I=t==="architect"?"Arquitecto":"Reeditor",re=t==="architect"?"Asistente de estructura narrativa y desarrollo de historia":"Asistente de correccin y mejora de manuscritos";return e.jsxs(me,{className:Ae("flex flex-col h-full",i),"data-testid":"chat-panel",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 p-3 border-b",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium",children:I}),e.jsx("p",{className:"text-xs text-muted-foreground",children:re})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(B,{size:"icon",variant:"ghost",onClick:()=>X.mutate(),disabled:X.isPending,"data-testid":"button-new-chat",children:e.jsx(Nr,{className:"h-4 w-4"})}),o&&e.jsx(B,{size:"icon",variant:"ghost",onClick:o,"data-testid":"button-close-chat",children:e.jsx(Gn,{className:"h-4 w-4"})})]})]}),P.length>1&&e.jsx("div",{className:"flex gap-1 p-2 border-b overflow-x-auto",children:P.map(T=>e.jsx(Q,{variant:T.id===d?"default":"outline",className:"cursor-pointer whitespace-nowrap",onClick:()=>p(T.id),"data-testid":`badge-session-${T.id}`,children:T.title},T.id))}),e.jsx(jt,{ref:C,className:"flex-1 p-3",children:R||W?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx(be,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):P.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-32 gap-3",children:[e.jsx($i,{className:"h-10 w-10 text-muted-foreground"}),e.jsxs("p",{className:"text-sm text-muted-foreground text-center",children:["Inicia una conversacin con el ",I.toLowerCase()]}),e.jsxs(B,{onClick:()=>X.mutate(),disabled:X.isPending,"data-testid":"button-start-chat",children:[X.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Nr,{className:"h-4 w-4 mr-2"}),"Nueva conversacin"]})]}):e.jsxs("div",{className:"space-y-4",children:[A.map(T=>{const Y=T.role==="assistant"?JD(T.content):null,oe=Y?Y.text:T.content,Ne=Y?.proposals||[];return e.jsx("div",{className:Ae("flex gap-2",T.role==="user"?"justify-end":"justify-start"),"data-testid":`message-${T.id}`,children:e.jsxs("div",{className:Ae("max-w-[85%] rounded-lg px-3 py-2 text-sm",T.role==="user"?"bg-primary text-primary-foreground":"bg-muted"),children:[e.jsx("div",{className:"whitespace-pre-wrap",children:oe}),Ne.length>0&&e.jsxs("div",{className:"mt-3 space-y-2 border-t pt-3",children:[e.jsxs("div",{className:"flex items-center gap-1 text-xs font-medium text-muted-foreground mb-2",children:[e.jsx(bA,{className:"h-3 w-3"}),"Propuestas de cambio"]}),Ne.map((xe,Se)=>{const Oe=`${T.id}-${Se}`,Pe=V.has(Oe),Be=O===Oe;return e.jsxs("div",{className:Ae("bg-background rounded-md p-2 border text-xs",Pe&&"opacity-50"),"data-testid":`proposal-${T.id}-${Se}`,children:[e.jsx("div",{className:"font-medium mb-1",children:xe.descripcion}),xe.capitulo&&e.jsxs("div",{className:"text-muted-foreground mb-1",children:["Captulo: ",xe.capitulo]}),xe.objetivo&&e.jsxs("div",{className:"text-muted-foreground mb-1",children:["Objetivo: ",xe.objetivo]}),(xe.texto_propuesto||xe.contenido_propuesto)&&e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded p-1 mb-2 text-green-800 dark:text-green-200 max-h-24 overflow-y-auto",children:[e.jsx("span",{className:"font-medium",children:"Nuevo: "}),xe.texto_propuesto||xe.contenido_propuesto]}),Pe?e.jsxs("div",{className:"text-xs text-muted-foreground mt-2 flex items-center gap-1",children:[e.jsx(Tn,{className:"h-3 w-3"}),"Procesado"]}):e.jsxs("div",{className:"flex gap-1 mt-2",children:[e.jsxs(B,{size:"sm",variant:"default",className:"h-6 text-xs",onClick:()=>$(xe,T.id,Se),disabled:Be,"data-testid":`button-approve-${T.id}-${Se}`,children:[Be?e.jsx(be,{className:"h-3 w-3 mr-1 animate-spin"}):e.jsx(Tn,{className:"h-3 w-3 mr-1"}),"Aplicar"]}),e.jsxs(B,{size:"sm",variant:"ghost",className:"h-6 text-xs",onClick:()=>q(T.id,Se),disabled:Be,"data-testid":`button-reject-${T.id}-${Se}`,children:[e.jsx(Gn,{className:"h-3 w-3 mr-1"}),"Descartar"]})]})]},Se)})]})]})},T.id)}),g&&j&&e.jsx("div",{className:"flex gap-2 justify-start","data-testid":"message-streaming",children:e.jsx("div",{className:"max-w-[85%] rounded-lg px-3 py-2 text-sm bg-muted",children:e.jsx("div",{className:"whitespace-pre-wrap",children:j})})}),g&&!j&&e.jsx("div",{className:"flex gap-2 justify-start",children:e.jsx("div",{className:"rounded-lg px-3 py-2 bg-muted",children:e.jsx(be,{className:"h-4 w-4 animate-spin text-muted-foreground"})})}),e.jsx("div",{ref:b})]})}),d&&e.jsxs("div",{className:"p-3 border-t",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Nn,{ref:S,value:m,onChange:T=>h(T.target.value),onKeyDown:K,placeholder:t==="architect"?"Pregunta sobre la estructura, personajes, trama...":"Describe el problema o correccin que necesitas...",className:"resize-none min-h-[60px]",disabled:g,"data-testid":"input-chat-message"}),e.jsx(B,{onClick:le,disabled:!m.trim()||g,className:"self-end","data-testid":"button-send-message",children:g?e.jsx(be,{className:"h-4 w-4 animate-spin"}):e.jsx($A,{className:"h-4 w-4"})})]}),d&&P.length>0&&e.jsx("div",{className:"flex justify-end mt-2",children:e.jsxs(B,{variant:"ghost",size:"sm",onClick:()=>se.mutate(d),disabled:se.isPending,className:"text-destructive hover:text-destructive","data-testid":"button-delete-session",children:[e.jsx(Rn,{className:"h-3 w-3 mr-1"}),"Eliminar conversacin"]})})]})]})}var wx=["Enter"," "],e5=["ArrowDown","PageUp","Home"],Ok=["ArrowUp","PageDown","End"],t5=[...e5,...Ok],n5={ltr:[...wx,"ArrowRight"],rtl:[...wx,"ArrowLeft"]},r5={ltr:["ArrowLeft"],rtl:["ArrowRight"]},td="Menu",[Ic,s5,a5]=dl(td),[Hi,Dk]=Zn(td,[a5,xl,Hp]),nm=xl(),Lk=Hp(),[i5,Ki]=Hi(td),[o5,nd]=Hi(td),Fk=t=>{const{__scopeMenu:n,open:r=!1,children:s,dir:i,onOpenChange:o,modal:c=!0}=t,d=nm(n),[p,m]=x.useState(null),h=x.useRef(!1),g=wn(o),v=Gi(i);return x.useEffect(()=>{const j=()=>{h.current=!0,document.addEventListener("pointerdown",N,{capture:!0,once:!0}),document.addEventListener("pointermove",N,{capture:!0,once:!0})},N=()=>h.current=!1;return document.addEventListener("keydown",j,{capture:!0}),()=>{document.removeEventListener("keydown",j,{capture:!0}),document.removeEventListener("pointerdown",N,{capture:!0}),document.removeEventListener("pointermove",N,{capture:!0})}},[]),e.jsx(Ng,{...d,children:e.jsx(i5,{scope:n,open:r,onOpenChange:g,content:p,onContentChange:m,children:e.jsx(o5,{scope:n,onClose:x.useCallback(()=>g(!1),[g]),isUsingKeyboardRef:h,dir:v,modal:c,children:s})})})};Fk.displayName=td;var l5="MenuAnchor",av=x.forwardRef((t,n)=>{const{__scopeMenu:r,...s}=t,i=nm(r);return e.jsx(Cg,{...i,...s,ref:n})});av.displayName=l5;var iv="MenuPortal",[c5,$k]=Hi(iv,{forceMount:void 0}),zk=t=>{const{__scopeMenu:n,forceMount:r,children:s,container:i}=t,o=Ki(iv,n);return e.jsx(c5,{scope:n,forceMount:r,children:e.jsx(gr,{present:r||o.open,children:e.jsx(Gc,{asChild:!0,container:i,children:s})})})};zk.displayName=iv;var ds="MenuContent",[d5,ov]=Hi(ds),Vk=x.forwardRef((t,n)=>{const r=$k(ds,t.__scopeMenu),{forceMount:s=r.forceMount,...i}=t,o=Ki(ds,t.__scopeMenu),c=nd(ds,t.__scopeMenu);return e.jsx(Ic.Provider,{scope:t.__scopeMenu,children:e.jsx(gr,{present:s||o.open,children:e.jsx(Ic.Slot,{scope:t.__scopeMenu,children:c.modal?e.jsx(u5,{...i,ref:n}):e.jsx(p5,{...i,ref:n})})})})}),u5=x.forwardRef((t,n)=>{const r=Ki(ds,t.__scopeMenu),s=x.useRef(null),i=vt(n,s);return x.useEffect(()=>{const o=s.current;if(o)return Rg(o)},[]),e.jsx(lv,{...t,ref:i,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:De(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),p5=x.forwardRef((t,n)=>{const r=Ki(ds,t.__scopeMenu);return e.jsx(lv,{...t,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),m5=Li("MenuContent.ScrollLock"),lv=x.forwardRef((t,n)=>{const{__scopeMenu:r,loop:s=!1,trapFocus:i,onOpenAutoFocus:o,onCloseAutoFocus:c,disableOutsidePointerEvents:d,onEntryFocus:p,onEscapeKeyDown:m,onPointerDownOutside:h,onFocusOutside:g,onInteractOutside:v,onDismiss:j,disableOutsideScroll:N,...b}=t,C=Ki(ds,r),S=nd(ds,r),k=nm(r),P=Lk(r),R=s5(r),[E,A]=x.useState(null),W=x.useRef(null),X=vt(n,W,C.onContentChange),se=x.useRef(0),V=x.useRef(""),G=x.useRef(0),O=x.useRef(null),F=x.useRef("right"),U=x.useRef(0),$=N?$p:x.Fragment,q=N?{as:m5,allowPinchZoom:!0}:void 0,le=J=>{const D=V.current+J,I=R().filter(xe=>!xe.disabled),re=document.activeElement,T=I.find(xe=>xe.ref.current===re)?.textValue,Y=I.map(xe=>xe.textValue),oe=S5(Y,D,T),Ne=I.find(xe=>xe.textValue===oe)?.ref.current;(function xe(Se){V.current=Se,window.clearTimeout(se.current),Se!==""&&(se.current=window.setTimeout(()=>xe(""),1e3))})(D),Ne&&setTimeout(()=>Ne.focus())};x.useEffect(()=>()=>window.clearTimeout(se.current),[]),Tg();const K=x.useCallback(J=>F.current===O.current?.side&&E5(J,O.current?.area),[]);return e.jsx(d5,{scope:r,searchRef:V,onItemEnter:x.useCallback(J=>{K(J)&&J.preventDefault()},[K]),onItemLeave:x.useCallback(J=>{K(J)||(W.current?.focus(),A(null))},[K]),onTriggerLeave:x.useCallback(J=>{K(J)&&J.preventDefault()},[K]),pointerGraceTimerRef:G,onPointerGraceIntentChange:x.useCallback(J=>{O.current=J},[]),children:e.jsx($,{...q,children:e.jsx(Lp,{asChild:!0,trapped:i,onMountAutoFocus:De(o,J=>{J.preventDefault(),W.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:c,children:e.jsx(ul,{asChild:!0,disableOutsidePointerEvents:d,onEscapeKeyDown:m,onPointerDownOutside:h,onFocusOutside:g,onInteractOutside:v,onDismiss:j,children:e.jsx(CS,{asChild:!0,...P,dir:S.dir,orientation:"vertical",loop:s,currentTabStopId:E,onCurrentTabStopIdChange:A,onEntryFocus:De(p,J=>{S.isUsingKeyboardRef.current||J.preventDefault()}),preventScrollOnEntryFocus:!0,children:e.jsx(Sg,{role:"menu","aria-orientation":"vertical","data-state":r2(C.open),"data-radix-menu-content":"",dir:S.dir,...k,...b,ref:X,style:{outline:"none",...b.style},onKeyDown:De(b.onKeyDown,J=>{const I=J.target.closest("[data-radix-menu-content]")===J.currentTarget,re=J.ctrlKey||J.altKey||J.metaKey,T=J.key.length===1;I&&(J.key==="Tab"&&J.preventDefault(),!re&&T&&le(J.key));const Y=W.current;if(J.target!==Y||!t5.includes(J.key))return;J.preventDefault();const Ne=R().filter(xe=>!xe.disabled).map(xe=>xe.ref.current);Ok.includes(J.key)&&Ne.reverse(),N5(Ne)}),onBlur:De(t.onBlur,J=>{J.currentTarget.contains(J.target)||(window.clearTimeout(se.current),V.current="")}),onPointerMove:De(t.onPointerMove,Mc(J=>{const D=J.target,I=U.current!==J.clientX;if(J.currentTarget.contains(D)&&I){const re=J.clientX>U.current?"right":"left";F.current=re,U.current=J.clientX}}))})})})})})})});Vk.displayName=ds;var h5="MenuGroup",cv=x.forwardRef((t,n)=>{const{__scopeMenu:r,...s}=t;return e.jsx(et.div,{role:"group",...s,ref:n})});cv.displayName=h5;var f5="MenuLabel",qk=x.forwardRef((t,n)=>{const{__scopeMenu:r,...s}=t;return e.jsx(et.div,{...s,ref:n})});qk.displayName=f5;var ap="MenuItem",Cb="menu.itemSelect",rm=x.forwardRef((t,n)=>{const{disabled:r=!1,onSelect:s,...i}=t,o=x.useRef(null),c=nd(ap,t.__scopeMenu),d=ov(ap,t.__scopeMenu),p=vt(n,o),m=x.useRef(!1),h=()=>{const g=o.current;if(!r&&g){const v=new CustomEvent(Cb,{bubbles:!0,cancelable:!0});g.addEventListener(Cb,j=>s?.(j),{once:!0}),lg(g,v),v.defaultPrevented?m.current=!1:c.onClose()}};return e.jsx(Uk,{...i,ref:p,disabled:r,onClick:De(t.onClick,h),onPointerDown:g=>{t.onPointerDown?.(g),m.current=!0},onPointerUp:De(t.onPointerUp,g=>{m.current||g.currentTarget?.click()}),onKeyDown:De(t.onKeyDown,g=>{const v=d.searchRef.current!=="";r||v&&g.key===" "||wx.includes(g.key)&&(g.currentTarget.click(),g.preventDefault())})})});rm.displayName=ap;var Uk=x.forwardRef((t,n)=>{const{__scopeMenu:r,disabled:s=!1,textValue:i,...o}=t,c=ov(ap,r),d=Lk(r),p=x.useRef(null),m=vt(n,p),[h,g]=x.useState(!1),[v,j]=x.useState("");return x.useEffect(()=>{const N=p.current;N&&j((N.textContent??"").trim())},[o.children]),e.jsx(Ic.ItemSlot,{scope:r,disabled:s,textValue:i??v,children:e.jsx(SS,{asChild:!0,...d,focusable:!s,children:e.jsx(et.div,{role:"menuitem","data-highlighted":h?"":void 0,"aria-disabled":s||void 0,"data-disabled":s?"":void 0,...o,ref:m,onPointerMove:De(t.onPointerMove,Mc(N=>{s?c.onItemLeave(N):(c.onItemEnter(N),N.defaultPrevented||N.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:De(t.onPointerLeave,Mc(N=>c.onItemLeave(N))),onFocus:De(t.onFocus,()=>g(!0)),onBlur:De(t.onBlur,()=>g(!1))})})})}),x5="MenuCheckboxItem",Bk=x.forwardRef((t,n)=>{const{checked:r=!1,onCheckedChange:s,...i}=t;return e.jsx(Qk,{scope:t.__scopeMenu,checked:r,children:e.jsx(rm,{role:"menuitemcheckbox","aria-checked":ip(r)?"mixed":r,...i,ref:n,"data-state":uv(r),onSelect:De(i.onSelect,()=>s?.(ip(r)?!0:!r),{checkForDefaultPrevented:!1})})})});Bk.displayName=x5;var Gk="MenuRadioGroup",[g5,v5]=Hi(Gk,{value:void 0,onValueChange:()=>{}}),Hk=x.forwardRef((t,n)=>{const{value:r,onValueChange:s,...i}=t,o=wn(s);return e.jsx(g5,{scope:t.__scopeMenu,value:r,onValueChange:o,children:e.jsx(cv,{...i,ref:n})})});Hk.displayName=Gk;var Kk="MenuRadioItem",Wk=x.forwardRef((t,n)=>{const{value:r,...s}=t,i=v5(Kk,t.__scopeMenu),o=r===i.value;return e.jsx(Qk,{scope:t.__scopeMenu,checked:o,children:e.jsx(rm,{role:"menuitemradio","aria-checked":o,...s,ref:n,"data-state":uv(o),onSelect:De(s.onSelect,()=>i.onValueChange?.(r),{checkForDefaultPrevented:!1})})})});Wk.displayName=Kk;var dv="MenuItemIndicator",[Qk,y5]=Hi(dv,{checked:!1}),Yk=x.forwardRef((t,n)=>{const{__scopeMenu:r,forceMount:s,...i}=t,o=y5(dv,r);return e.jsx(gr,{present:s||ip(o.checked)||o.checked===!0,children:e.jsx(et.span,{...i,ref:n,"data-state":uv(o.checked)})})});Yk.displayName=dv;var j5="MenuSeparator",Zk=x.forwardRef((t,n)=>{const{__scopeMenu:r,...s}=t;return e.jsx(et.div,{role:"separator","aria-orientation":"horizontal",...s,ref:n})});Zk.displayName=j5;var b5="MenuArrow",Xk=x.forwardRef((t,n)=>{const{__scopeMenu:r,...s}=t,i=nm(r);return e.jsx(kg,{...i,...s,ref:n})});Xk.displayName=b5;var w5="MenuSub",[m9,Jk]=Hi(w5),xc="MenuSubTrigger",e2=x.forwardRef((t,n)=>{const r=Ki(xc,t.__scopeMenu),s=nd(xc,t.__scopeMenu),i=Jk(xc,t.__scopeMenu),o=ov(xc,t.__scopeMenu),c=x.useRef(null),{pointerGraceTimerRef:d,onPointerGraceIntentChange:p}=o,m={__scopeMenu:t.__scopeMenu},h=x.useCallback(()=>{c.current&&window.clearTimeout(c.current),c.current=null},[]);return x.useEffect(()=>h,[h]),x.useEffect(()=>{const g=d.current;return()=>{window.clearTimeout(g),p(null)}},[d,p]),e.jsx(av,{asChild:!0,...m,children:e.jsx(Uk,{id:i.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":i.contentId,"data-state":r2(r.open),...t,ref:Bc(n,i.onTriggerChange),onClick:g=>{t.onClick?.(g),!(t.disabled||g.defaultPrevented)&&(g.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:De(t.onPointerMove,Mc(g=>{o.onItemEnter(g),!g.defaultPrevented&&!t.disabled&&!r.open&&!c.current&&(o.onPointerGraceIntentChange(null),c.current=window.setTimeout(()=>{r.onOpenChange(!0),h()},100))})),onPointerLeave:De(t.onPointerLeave,Mc(g=>{h();const v=r.content?.getBoundingClientRect();if(v){const j=r.content?.dataset.side,N=j==="right",b=N?-5:5,C=v[N?"left":"right"],S=v[N?"right":"left"];o.onPointerGraceIntentChange({area:[{x:g.clientX+b,y:g.clientY},{x:C,y:v.top},{x:S,y:v.top},{x:S,y:v.bottom},{x:C,y:v.bottom}],side:j}),window.clearTimeout(d.current),d.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(g),g.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:De(t.onKeyDown,g=>{const v=o.searchRef.current!=="";t.disabled||v&&g.key===" "||n5[s.dir].includes(g.key)&&(r.onOpenChange(!0),r.content?.focus(),g.preventDefault())})})})});e2.displayName=xc;var t2="MenuSubContent",n2=x.forwardRef((t,n)=>{const r=$k(ds,t.__scopeMenu),{forceMount:s=r.forceMount,...i}=t,o=Ki(ds,t.__scopeMenu),c=nd(ds,t.__scopeMenu),d=Jk(t2,t.__scopeMenu),p=x.useRef(null),m=vt(n,p);return e.jsx(Ic.Provider,{scope:t.__scopeMenu,children:e.jsx(gr,{present:s||o.open,children:e.jsx(Ic.Slot,{scope:t.__scopeMenu,children:e.jsx(lv,{id:d.contentId,"aria-labelledby":d.triggerId,...i,ref:m,align:"start",side:c.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:h=>{c.isUsingKeyboardRef.current&&p.current?.focus(),h.preventDefault()},onCloseAutoFocus:h=>h.preventDefault(),onFocusOutside:De(t.onFocusOutside,h=>{h.target!==d.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:De(t.onEscapeKeyDown,h=>{c.onClose(),h.preventDefault()}),onKeyDown:De(t.onKeyDown,h=>{const g=h.currentTarget.contains(h.target),v=r5[c.dir].includes(h.key);g&&v&&(o.onOpenChange(!1),d.trigger?.focus(),h.preventDefault())})})})})})});n2.displayName=t2;function r2(t){return t?"open":"closed"}function ip(t){return t==="indeterminate"}function uv(t){return ip(t)?"indeterminate":t?"checked":"unchecked"}function N5(t){const n=document.activeElement;for(const r of t)if(r===n||(r.focus(),document.activeElement!==n))return}function C5(t,n){return t.map((r,s)=>t[(n+s)%t.length])}function S5(t,n,r){const i=n.length>1&&Array.from(n).every(m=>m===n[0])?n[0]:n,o=r?t.indexOf(r):-1;let c=C5(t,Math.max(o,0));i.length===1&&(c=c.filter(m=>m!==r));const p=c.find(m=>m.toLowerCase().startsWith(i.toLowerCase()));return p!==r?p:void 0}function k5(t,n){const{x:r,y:s}=t;let i=!1;for(let o=0,c=n.length-1;o<n.length;c=o++){const d=n[o].x,p=n[o].y,m=n[c].x,h=n[c].y;p>s!=h>s&&r<(m-d)*(s-p)/(h-p)+d&&(i=!i)}return i}function E5(t,n){if(!n)return!1;const r={x:t.clientX,y:t.clientY};return k5(r,n)}function Mc(t){return n=>n.pointerType==="mouse"?t(n):void 0}var P5=Fk,T5=av,R5=zk,A5=Vk,_5=cv,I5=qk,M5=rm,O5=Bk,D5=Hk,L5=Wk,F5=Yk,$5=Zk,z5=Xk,V5=e2,q5=n2,pv="DropdownMenu",[U5]=Zn(pv,[Dk]),Cr=Dk(),[B5,s2]=U5(pv),a2=t=>{const{__scopeDropdownMenu:n,children:r,dir:s,open:i,defaultOpen:o,onOpenChange:c,modal:d=!0}=t,p=Cr(n),m=x.useRef(null),[h=!1,g]=Zr({prop:i,defaultProp:o,onChange:c});return e.jsx(B5,{scope:n,triggerId:Qr(),triggerRef:m,contentId:Qr(),open:h,onOpenChange:g,onOpenToggle:x.useCallback(()=>g(v=>!v),[g]),modal:d,children:e.jsx(P5,{...p,open:h,onOpenChange:g,dir:s,modal:d,children:r})})};a2.displayName=pv;var i2="DropdownMenuTrigger",o2=x.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,disabled:s=!1,...i}=t,o=s2(i2,r),c=Cr(r);return e.jsx(T5,{asChild:!0,...c,children:e.jsx(et.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":s?"":void 0,disabled:s,...i,ref:Bc(n,o.triggerRef),onPointerDown:De(t.onPointerDown,d=>{!s&&d.button===0&&d.ctrlKey===!1&&(o.onOpenToggle(),o.open||d.preventDefault())}),onKeyDown:De(t.onKeyDown,d=>{s||(["Enter"," "].includes(d.key)&&o.onOpenToggle(),d.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(d.key)&&d.preventDefault())})})})});o2.displayName=i2;var G5="DropdownMenuPortal",l2=t=>{const{__scopeDropdownMenu:n,...r}=t,s=Cr(n);return e.jsx(R5,{...s,...r})};l2.displayName=G5;var c2="DropdownMenuContent",d2=x.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,i=s2(c2,r),o=Cr(r),c=x.useRef(!1);return e.jsx(A5,{id:i.contentId,"aria-labelledby":i.triggerId,...o,...s,ref:n,onCloseAutoFocus:De(t.onCloseAutoFocus,d=>{c.current||i.triggerRef.current?.focus(),c.current=!1,d.preventDefault()}),onInteractOutside:De(t.onInteractOutside,d=>{const p=d.detail.originalEvent,m=p.button===0&&p.ctrlKey===!0,h=p.button===2||m;(!i.modal||h)&&(c.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});d2.displayName=c2;var H5="DropdownMenuGroup",K5=x.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,i=Cr(r);return e.jsx(_5,{...i,...s,ref:n})});K5.displayName=H5;var W5="DropdownMenuLabel",u2=x.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,i=Cr(r);return e.jsx(I5,{...i,...s,ref:n})});u2.displayName=W5;var Q5="DropdownMenuItem",p2=x.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,i=Cr(r);return e.jsx(M5,{...i,...s,ref:n})});p2.displayName=Q5;var Y5="DropdownMenuCheckboxItem",m2=x.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,i=Cr(r);return e.jsx(O5,{...i,...s,ref:n})});m2.displayName=Y5;var Z5="DropdownMenuRadioGroup",X5=x.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,i=Cr(r);return e.jsx(D5,{...i,...s,ref:n})});X5.displayName=Z5;var J5="DropdownMenuRadioItem",h2=x.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,i=Cr(r);return e.jsx(L5,{...i,...s,ref:n})});h2.displayName=J5;var eL="DropdownMenuItemIndicator",f2=x.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,i=Cr(r);return e.jsx(F5,{...i,...s,ref:n})});f2.displayName=eL;var tL="DropdownMenuSeparator",x2=x.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,i=Cr(r);return e.jsx($5,{...i,...s,ref:n})});x2.displayName=tL;var nL="DropdownMenuArrow",rL=x.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,i=Cr(r);return e.jsx(z5,{...i,...s,ref:n})});rL.displayName=nL;var sL="DropdownMenuSubTrigger",g2=x.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,i=Cr(r);return e.jsx(V5,{...i,...s,ref:n})});g2.displayName=sL;var aL="DropdownMenuSubContent",v2=x.forwardRef((t,n)=>{const{__scopeDropdownMenu:r,...s}=t,i=Cr(r);return e.jsx(q5,{...i,...s,ref:n,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});v2.displayName=aL;var iL=a2,oL=o2,lL=l2,y2=d2,j2=u2,b2=p2,w2=m2,N2=h2,C2=f2,S2=x2,k2=g2,E2=v2;const mv=iL,hv=oL,cL=x.forwardRef(({className:t,inset:n,children:r,...s},i)=>e.jsxs(k2,{ref:i,className:Ae("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",t),...s,children:[r,e.jsx(Wc,{className:"ml-auto"})]}));cL.displayName=k2.displayName;const dL=x.forwardRef(({className:t,...n},r)=>e.jsx(E2,{ref:r,className:Ae("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...n}));dL.displayName=E2.displayName;const sm=x.forwardRef(({className:t,sideOffset:n=4,...r},s)=>e.jsx(lL,{children:e.jsx(y2,{ref:s,sideOffset:n,className:Ae("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...r})}));sm.displayName=y2.displayName;const Zo=x.forwardRef(({className:t,inset:n,...r},s)=>e.jsx(b2,{ref:s,className:Ae("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",t),...r}));Zo.displayName=b2.displayName;const uL=x.forwardRef(({className:t,children:n,checked:r,...s},i)=>e.jsxs(w2,{ref:i,className:Ae("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:r,...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(C2,{children:e.jsx(Tn,{className:"h-4 w-4"})})}),n]}));uL.displayName=w2.displayName;const pL=x.forwardRef(({className:t,children:n,...r},s)=>e.jsxs(N2,{ref:s,className:Ae("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(C2,{children:e.jsx(JN,{className:"h-2 w-2 fill-current"})})}),n]}));pL.displayName=N2.displayName;const P2=x.forwardRef(({className:t,inset:n,...r},s)=>e.jsx(j2,{ref:s,className:Ae("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",t),...r}));P2.displayName=j2.displayName;const T2=x.forwardRef(({className:t,...n},r)=>e.jsx(S2,{ref:r,className:Ae("-mx-1 my-1 h-px bg-muted",t),...n}));T2.displayName=S2.displayName;function Sb(t){return[...t].sort((n,r)=>{const s=n.chapterNumber===0?-1e3:n.chapterNumber===-1?1e3:n.chapterNumber===-2?1001:n.chapterNumber,i=r.chapterNumber===0?-1e3:r.chapterNumber===-1?1e3:r.chapterNumber===-2?1001:r.chapterNumber;return s-i})}function mL(){const[t,n]=x.useState(null),[r,s]=x.useState(!1),[i,o]=x.useState("architect"),[c,d]=x.useState(!1),[p,m]=x.useState(""),[h,g]=x.useState(),{currentProject:v,isLoading:j}=fi(),[,N]=ol(),{toast:b}=nn(),C={architect:"Arquitecto",reeditor:"Re-editor"},S=ye({mutationFn:async O=>(g(O.chapterId),(await je("POST",`/api/projects/${O.projectId}/chapters/${O.chapterNumber}/reset-to-pending`)).json()),onSuccess:()=>{g(void 0),b({title:"Captulo marcado como pendiente",description:"El pipeline lo detectar y continuar con la generacin."}),ae.invalidateQueries({queryKey:["/api/projects",v?.id,"chapters"]})},onError:O=>{g(void 0),b({title:"Error",description:O.message||"No se pudo marcar el captulo como pendiente",variant:"destructive"})}}),k=O=>{v&&S.mutate({projectId:v.id,chapterNumber:O.chapterNumber,chapterId:O.id})},P=ye({mutationFn:async O=>(await je("POST",`/api/projects/${O}/normalize-titles`)).json(),onSuccess:O=>{b({title:"Ttulos normalizados",description:`Se actualizaron ${O.chaptersUpdated} de ${O.totalChapters} captulos.`}),ae.invalidateQueries({queryKey:["/api/projects",v?.id,"chapters"]})},onError:O=>{b({title:"Error",description:O.message||"No se pudieron normalizar los ttulos",variant:"destructive"})}}),R=ye({mutationFn:async O=>(await je("POST",`/api/projects/${O.projectId}/clone-to-reedit`,{instructions:O.instructions})).json(),onSuccess:async O=>{b({title:"Proyecto clonado",description:`Se cre una copia para re-edicin con ${O.chaptersCloned} captulos.`}),d(!1),m(""),await je("POST",`/api/reedit-projects/${O.reeditProjectId}/start`),N(`/reedit?project=${O.reeditProjectId}`)},onError:O=>{b({title:"Error",description:O.message||"No se pudo clonar el proyecto",variant:"destructive"})}}),{data:E=[],isLoading:A}=Ke({queryKey:["/api/projects",v?.id,"chapters"],enabled:!!v?.id}),{data:W=[]}=Ke({queryKey:["/api/corrected-manuscripts"],enabled:!!v?.id}),X=W.find(O=>O.projectId===v?.id&&(O.status==="approved"||O.status==="finalized")),se=()=>{if(!v||E.length===0)return;const O=K=>{let J=K;const D=[/^#+ *Literary Style Guide[^\n]*\n[\s\S]*?(?=^#+ *(?:CHAPTER|Chapter|Prologue|Epilogue|Author['']?s? Note)\b|\n---\n|$)/gm,/^#+ *Writing Guide[^\n]*\n[\s\S]*?(?=^#+ *(?:CHAPTER|Chapter|Prologue|Epilogue|Author['']?s? Note)\b|\n---\n|$)/gm,/^#+ *The Master of[^\n]*\n[\s\S]*?(?=^#+ *(?:CHAPTER|Chapter|Prologue|Epilogue|Author['']?s? Note)\b|\n---\n|$)/gm,/^#+ *Gua de Estilo[^\n]*\n[\s\S]*?(?=^#+ *(?:CAPTULO|Captulo|Prlogo|Eplogo|Nota del Autor)\b|\n---\n|$)/gmi,/^#+ *Gua de Escritura[^\n]*\n[\s\S]*?(?=^#+ *(?:CAPTULO|Captulo|Prlogo|Eplogo|Nota del Autor)\b|\n---\n|$)/gmi,/^###+ *Checklist[^\n]*\n[\s\S]*?(?=^#{1,2} *(?:CHAPTER|Chapter|CAPTULO|Captulo|Prologue|Prlogo|Epilogue|Eplogo)\b|\n---\n|$)/gmi,/\n---\n[\s\S]*?(?:Style Guide|Gua de Estilo|Writing Guide|Gua de Escritura)[\s\S]*?\n---\n/gi];for(const re of D)J=J.replace(re,"");const I=[/^#+ *\d+\. *(?:Narrative Architecture|Character Construction|Central Themes|Language and Stylistic|Tone and Atmosphere)[^\n]*\n[\s\S]*?(?=^#+ *(?:CHAPTER|Chapter|CAPTULO|Captulo|Prologue|Prlogo)\b|$)/gmi];for(const re of I)J=J.replace(re,"");return J.trim()},F=K=>{let J=K.trim();const I=J.indexOf("---CONTINUITY_STATE---");return I!==-1&&(J=J.substring(0,I).trim()),J=O(J),J},U=Sb(E.filter(K=>K.content)).map(K=>{let J=F(K.content||"");const D=J.match(/^(#{1,2})\s*.+\n+/);D&&(J=J.substring(D[0].length).trim());let I;return K.chapterNumber===0?I=`# Prlogo${K.title?`: ${K.title}`:""}`:K.chapterNumber===-1?I=`# Eplogo${K.title?`: ${K.title}`:""}`:K.chapterNumber===-2?I="# Nota del Autor":I=`# Captulo ${K.chapterNumber}${K.title?`: ${K.title}`:""}`,`${I}

${J}`}).join(`


`),$=new Blob([U],{type:"text/markdown"}),q=URL.createObjectURL($),le=document.createElement("a");le.href=q,le.download=`${v.title.replace(/\s+/g,"_")}.md`,document.body.appendChild(le),le.click(),document.body.removeChild(le),URL.revokeObjectURL(q)},V=E.filter(O=>O.status==="completed"||O.status==="approved"),G=E.reduce((O,F)=>O+(F.wordCount||0),0);return j?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx(mn,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4 animate-pulse"}),e.jsx("p",{className:"text-muted-foreground",children:"Cargando manuscrito..."})]})}):v?e.jsxs("div",{className:"h-full flex flex-col p-6","data-testid":"manuscript-page",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-6 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:v.title}),e.jsxs("div",{className:"flex items-center gap-3 mt-2 flex-wrap",children:[e.jsx(Q,{variant:"secondary",children:v.genre}),e.jsx(Q,{variant:"outline",children:v.tone}),X&&e.jsx(Q,{variant:"default",className:"bg-green-600 text-white",children:X.source==="auto"?e.jsxs(e.Fragment,{children:[e.jsx(us,{className:"h-3 w-3 mr-1"}),"Auto-Corregido"]}):e.jsxs(e.Fragment,{children:[e.jsx(zA,{className:"h-3 w-3 mr-1"}),"Auditado y Aprobado"]})}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[V.length,"/",v.chapterCount," captulos"]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[G.toLocaleString()," palabras"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(mv,{children:[e.jsx(hv,{asChild:!0,children:e.jsxs(B,{variant:r?"secondary":"outline","data-testid":"button-toggle-chat",children:[i==="architect"?e.jsx($i,{className:"h-4 w-4 mr-2"}):e.jsx(Ec,{className:"h-4 w-4 mr-2"}),r?`Cerrar ${C[i]}`:"Agentes IA",e.jsx(Qs,{className:"h-4 w-4 ml-2"})]})}),e.jsxs(sm,{children:[e.jsxs(Zo,{onClick:()=>{o("architect"),s(!0)},"data-testid":"menu-agent-architect",children:[e.jsx($i,{className:"h-4 w-4 mr-2"}),"Arquitecto (trama y estructura)"]}),e.jsxs(Zo,{onClick:()=>{o("reeditor"),s(!0)},"data-testid":"menu-agent-reeditor",children:[e.jsx(Ec,{className:"h-4 w-4 mr-2"}),"Re-editor (correcciones y mejoras)"]})]})]}),r&&e.jsx(B,{variant:"ghost",size:"sm",onClick:()=>s(!1),"data-testid":"button-close-chat",children:"Cerrar"})]}),e.jsxs(B,{variant:"outline",onClick:()=>v&&P.mutate(v.id),disabled:P.isPending||E.length===0,"data-testid":"button-normalize-titles",children:[P.isPending?e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(o1,{className:"h-4 w-4 mr-2"}),"Normalizar Ttulos"]}),e.jsxs(B,{variant:"outline",onClick:()=>{X?window.open(`/api/corrected-manuscripts/${X.id}/download`,"_blank"):se()},disabled:V.length===0,"data-testid":"button-download-manuscript",children:[e.jsx(xn,{className:"h-4 w-4 mr-2"}),X?X.source==="auto"?"Descargar MD (Auto-Corregido)":"Descargar MD (Corregido)":"Descargar MD"]}),v.status==="completed"&&e.jsxs(B,{variant:"outline",onClick:()=>{window.open(`/api/projects/${v.id}/export-docx`,"_blank")},"data-testid":"button-export-docx-manuscript",children:[e.jsx(xn,{className:"h-4 w-4 mr-2"}),"Exportar Word"]}),V.length>0&&e.jsxs(B,{variant:"default",onClick:()=>d(!0),"data-testid":"button-auto-reedit",children:[e.jsx(da,{className:"h-4 w-4 mr-2"}),"Re-edicin Automtica"]})]})]}),e.jsx(Pn,{open:c,onOpenChange:d,children:e.jsxs(yn,{className:"max-w-2xl",children:[e.jsxs(jn,{children:[e.jsx(bn,{children:"Re-edicin Automtica"}),e.jsx($n,{children:"El sistema crear una copia del manuscrito y aplicar las instrucciones de edicin automticamente a todos los captulos. El manuscrito original no se modificar."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{htmlFor:"instructions",children:"Instrucciones de edicin"}),e.jsx(Nn,{id:"instructions",placeholder:`Escribe las instrucciones de edicin. Ejemplos:

- Recortar 20% de introspeccin en todos los captulos
- Aadir ms tensin y ganchos al final de cada captulo
- Eliminar repeticiones y mejorar el ritmo
- Mantener las escenas de clmax sin modificar`,value:p,onChange:O=>m(O.target.value),className:"min-h-[200px]","data-testid":"input-auto-edit-instructions"})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Consejo:"})," S especfico. Indica qu captulos afectar, porcentajes de recorte, elementos a preservar, y qu tipo de mejoras aplicar."]})})]}),e.jsxs(Ir,{children:[e.jsx(B,{variant:"outline",onClick:()=>d(!1),children:"Cancelar"}),e.jsx(B,{onClick:()=>{v&&p.trim()&&R.mutate({projectId:v.id,instructions:p})},disabled:!p.trim()||R.isPending,"data-testid":"button-start-auto-reedit",children:R.isPending?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}),"Clonando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(da,{className:"h-4 w-4 mr-2"}),"Iniciar Re-edicin"]})})]})]})}),e.jsxs("div",{className:`flex-1 grid grid-cols-1 gap-6 min-h-0 ${r?"lg:grid-cols-4":"lg:grid-cols-3"}`,children:[e.jsxs(me,{className:"lg:col-span-1",children:[e.jsx(Re,{className:"pb-2",children:e.jsx(Ie,{className:"text-lg",children:"Captulos"})}),e.jsx(he,{children:e.jsx(ZD,{chapters:Sb(E),selectedChapterId:t?.id,onSelectChapter:n,onResetChapter:k,resettingChapterId:h})})]}),e.jsxs(me,{className:"flex flex-col lg:col-span-2",children:[e.jsx(Re,{className:"pb-2",children:e.jsx(Ie,{className:"text-lg",children:"Vista Previa"})}),e.jsx(he,{className:"flex-1 min-h-0",children:e.jsx(XD,{chapter:t,projectId:v?.id})})]}),r&&v&&e.jsx(sv,{agentType:i,projectId:v.id,chapterNumber:t?.chapterNumber,className:"lg:col-span-1 h-[calc(100vh-220px)]",onClose:()=>s(!1)})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-6",children:[e.jsx(mn,{className:"h-16 w-16 text-muted-foreground/20 mb-4"}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Sin manuscrito"}),e.jsx("p",{className:"text-muted-foreground max-w-md",children:"Crea un nuevo proyecto desde el panel de control para comenzar a generar tu novela"})]})}function rr(t){if(t==null)return"";if(typeof t=="string")return t;if(typeof t=="number"||typeof t=="boolean")return String(t);if(typeof t=="object"){const n=t;if("descripcion"in n&&typeof n.descripcion=="string")return n.descripcion;if("description"in n&&typeof n.description=="string")return n.description;if("event"in n&&typeof n.event=="string")return n.event;if("name"in n&&typeof n.name=="string")return n.name;if("texto"in n&&typeof n.texto=="string")return n.texto;try{return JSON.stringify(t)}catch{return"[Object]"}}return String(t)}function hL({events:t}){return!t||t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(Cn,{className:"h-12 w-12 text-muted-foreground/30 mb-4"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Sin eventos en la lnea temporal"})]}):e.jsx(jt,{className:"h-[400px]",children:e.jsxs("div",{className:"relative pl-6 pr-4 space-y-4",children:[e.jsx("div",{className:"absolute left-2 top-2 bottom-2 w-0.5 bg-border"}),t.map((n,r)=>{const s=n,i=n.chapter||s.number||r+1,o=n.event||s.title||s.summary||"",c=n.characters||[],d=s.keyEvents||[],p=n.significance||(d.length>0?d[0]:null);return e.jsxs("div",{className:"relative","data-testid":`timeline-event-${r}`,children:[e.jsx("div",{className:"absolute -left-4 top-1.5 w-3 h-3 rounded-full bg-primary border-2 border-background"}),e.jsxs("div",{className:"bg-card border border-card-border rounded-md p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(Q,{variant:"secondary",className:"text-xs",children:["Cap. ",i]}),e.jsx("span",{className:"text-sm font-medium",children:rr(o)})]}),c.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:c.map((m,h)=>e.jsx(Q,{className:"text-xs bg-chart-1/10 text-chart-1",children:rr(m)},h))}),p&&e.jsx("p",{className:"text-xs text-muted-foreground mt-2 italic",children:rr(p)})]})]},r)})]})})}function fL({characters:t}){return!t||t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(pl,{className:"h-12 w-12 text-muted-foreground/30 mb-4"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Sin personajes definidos"})]}):e.jsx(jt,{className:"h-[400px]",children:e.jsx("div",{className:"grid gap-3 pr-4",children:t.map((n,r)=>{const s=n,i=n.psychologicalProfile||s.profile||"",o=s.appearance,c=n.isAlive!==!1;return e.jsxs(me,{"data-testid":`character-card-${r}`,children:[e.jsx(Re,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs(Ie,{className:"text-base font-medium flex items-center gap-2",children:[n.name,!c&&e.jsx(pg,{className:"h-4 w-4 text-destructive"})]}),e.jsx(Q,{variant:"outline",className:"text-xs",children:n.role})]})}),e.jsxs(he,{className:"space-y-2",children:[i&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground font-medium uppercase tracking-wide mb-1",children:"Perfil"}),e.jsx("p",{className:"text-sm text-foreground",children:rr(i)})]}),n.arc&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground font-medium uppercase tracking-wide mb-1",children:"Arco del Personaje"}),e.jsx("p",{className:"text-sm text-foreground",children:rr(n.arc)})]}),o&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground font-medium uppercase tracking-wide mb-1",children:"Apariencia"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[o.eyes&&e.jsxs(Q,{variant:"secondary",className:"text-xs",children:["Ojos: ",o.eyes]}),o.hair&&e.jsxs(Q,{variant:"secondary",className:"text-xs",children:["Cabello: ",o.hair]})]}),o.distinguishing_features&&o.distinguishing_features.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:o.distinguishing_features.map((d,p)=>e.jsx(Q,{variant:"outline",className:"text-xs",children:d},p))})]}),n.relationships&&n.relationships.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 pt-1",children:[e.jsx(SA,{className:"h-3.5 w-3.5 text-muted-foreground mr-1"}),n.relationships.map((d,p)=>{const m=typeof d=="string"?d:typeof d=="object"&&d!==null?d.con?`${d.con}${d.tipo?` (${d.tipo})`:""}`:JSON.stringify(d):String(d);return e.jsx(Q,{variant:"secondary",className:"text-xs",children:m},p)})]})]})]},r)})})})}function xL({rules:t}){if(!t||t.length===0)return e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(Ko,{className:"h-12 w-12 text-muted-foreground/30 mb-4"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Sin reglas del mundo definidas"})]});const n=t.reduce((r,s)=>{const i=s.category||"General";return r[i]||(r[i]=[]),r[i].push(s),r},{});return e.jsx(jt,{className:"h-[400px]",children:e.jsx("div",{className:"space-y-4 pr-4",children:Object.entries(n).map(([r,s])=>e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide mb-2",children:r}),e.jsx("div",{className:"space-y-2",children:s.map((i,o)=>e.jsxs("div",{className:"bg-card border border-card-border rounded-md p-3","data-testid":`world-rule-${o}`,children:[e.jsx("p",{className:"text-sm font-medium",children:rr(i.rule)}),i.constraints&&i.constraints.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:i.constraints.map((c,d)=>e.jsx(Q,{variant:"outline",className:"text-xs",children:rr(c)},d))})]},o))})]},r))})})}function gL({decisions:t}){return!t||t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(kc,{className:"h-12 w-12 text-muted-foreground/30 mb-4"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Sin decisiones de trama registradas"}),e.jsx("p",{className:"text-muted-foreground/60 text-xs mt-1",children:"El Revisor Final detectar decisiones crticas durante la revisin"})]}):e.jsx(jt,{className:"h-[400px]",children:e.jsx("div",{className:"space-y-3 pr-4",children:t.map((n,r)=>e.jsxs(me,{className:n.consistencia_actual==="inconsistente"?"border-destructive/50":"","data-testid":`plot-decision-${r}`,children:[e.jsx(Re,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx(Ie,{className:"text-sm font-medium",children:n.decision}),e.jsx(Q,{variant:n.consistencia_actual==="consistente"?"secondary":"destructive",className:"text-xs",children:n.consistencia_actual==="consistente"?"Consistente":"Inconsistente"})]})}),e.jsxs(he,{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(Q,{variant:"outline",className:"text-xs",children:["Establecido: Cap. ",n.capitulo_establecido??"?"]}),n.capitulos_afectados&&n.capitulos_afectados.length>0&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Afecta: ",n.capitulos_afectados.map(s=>`Cap. ${s}`).join(", ")]})]}),n.problema&&e.jsx("p",{className:"text-xs text-destructive mt-2",children:n.problema})]})]},r))})})}function vL({injuries:t}){return!t||t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(Kc,{className:"h-12 w-12 text-muted-foreground/30 mb-4"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Sin lesiones persistentes registradas"}),e.jsx("p",{className:"text-muted-foreground/60 text-xs mt-1",children:"El Revisor Final detectar lesiones que requieren seguimiento"})]}):e.jsx(jt,{className:"h-[400px]",children:e.jsx("div",{className:"space-y-3 pr-4",children:t.map((n,r)=>e.jsxs(me,{className:n.consistencia==="ignorada"?"border-destructive/50":"","data-testid":`persistent-injury-${r}`,children:[e.jsx(Re,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs(Ie,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(pg,{className:"h-4 w-4"}),n.personaje]}),e.jsxs("div",{className:"flex gap-1",children:[n.severidad&&e.jsx(Q,{variant:n.severidad==="critica"||n.severidad==="grave"?"destructive":"secondary",className:"text-xs",children:n.severidad}),n.consistencia&&e.jsx(Q,{variant:n.consistencia==="mantenida"?"secondary":"destructive",className:"text-xs",children:n.consistencia==="mantenida"?"Mantenida":"Ignorada"}),n.estado_actual&&e.jsx(Q,{variant:n.estado_actual==="activa"?"default":"secondary",className:"text-xs",children:n.estado_actual==="activa"?"Activa":"Resuelta"})]})]})}),e.jsxs(he,{className:"space-y-2",children:[e.jsx("p",{className:"text-sm",children:n.tipo_lesion}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(Q,{variant:"outline",className:"text-xs",children:["Ocurre: Cap. ",n.capitulo_ocurre??"?"]}),n.parte_afectada&&e.jsxs(Q,{variant:"outline",className:"text-xs",children:["Parte: ",n.parte_afectada]})]}),n.efecto_esperado&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:"Efecto esperado:"})," ",n.efecto_esperado]}),n.capitulos_verificados&&n.capitulos_verificados.length>0&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:"Verificado en:"})," ",n.capitulos_verificados.map(s=>`Cap. ${s}`).join(", ")]}),n.problema&&e.jsx("p",{className:"text-xs text-destructive mt-2",children:n.problema})]})]},r))})})}function yL({entities:t,rules:n}){return t.length>0||n.length>0?e.jsx(jt,{className:"h-[400px]",children:e.jsxs("div",{className:"space-y-6 pr-4",children:[t.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide mb-2",children:["Entidades Rastreadas (",t.length,")"]}),e.jsx("div",{className:"grid gap-2",children:t.map(s=>{const i=s.attributes;return e.jsxs(me,{"data-testid":`guardian-entity-${s.id}`,children:[e.jsx(Re,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs(Ie,{className:"text-sm font-medium flex items-center gap-2",children:[s.status==="dead"&&e.jsx(pg,{className:"h-4 w-4 text-destructive"}),s.name]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(Q,{variant:"outline",className:"text-xs",children:s.type}),e.jsx(Q,{variant:s.status==="active"?"secondary":"destructive",className:"text-xs",children:s.status})]})]})}),e.jsxs(he,{className:"space-y-1",children:[i.role&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:"Rol:"})," ",i.role]}),i.appearance?.eyes&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:"Ojos:"})," ",i.appearance.eyes]}),i.appearance?.hair&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:"Cabello:"})," ",i.appearance.hair]}),s.lastSeenChapter!==null&&s.lastSeenChapter>0&&e.jsxs(Q,{variant:"secondary",className:"text-xs mt-1",children:["ltimo cap: ",s.lastSeenChapter]})]})]},s.id)})})]}),n.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide mb-2",children:["Reglas de Consistencia (",n.length,")"]}),e.jsx("div",{className:"space-y-2",children:n.map(s=>e.jsxs("div",{className:"bg-card border border-card-border rounded-md p-3","data-testid":`guardian-rule-${s.id}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("p",{className:"text-sm",children:s.description}),e.jsx(Q,{variant:"outline",className:"text-xs shrink-0",children:s.category})]}),s.sourceChapter&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Establecida en Cap. ",s.sourceChapter]})]},s.id))})]})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(fr,{className:"h-12 w-12 text-muted-foreground/30 mb-4"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Sin datos del Guardin de Consistencia"}),e.jsx("p",{className:"text-muted-foreground/60 text-xs mt-1",children:"Se inicializar automticamente durante la generacin"})]})}function jL({plotOutline:t}){const n=t;if(!(t&&(t.premise||(t.chapterOutlines?.length??0)>0||n?.plotThreads?.length>0)))return e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(mn,{className:"h-12 w-12 text-muted-foreground/30 mb-4"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Sin esquema de trama definido"})]});const{threeActStructure:s,chapterOutlines:i}=t,o=n?.plotThreads||[];return e.jsx(jt,{className:"h-[400px]",children:e.jsxs("div",{className:"space-y-6 pr-4",children:[t.premise&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide mb-2",children:"Premisa"}),e.jsx("p",{className:"text-sm",children:rr(t.premise)})]}),s&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Estructura de Tres Actos"}),s.act1&&e.jsxs(me,{children:[e.jsx(Re,{className:"pb-2",children:e.jsx(Ie,{className:"text-base",children:"Acto I: Planteamiento"})}),e.jsxs(he,{className:"space-y-2 text-sm",children:[s.act1.setup&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Setup: "}),rr(s.act1.setup)]}),s.act1.incitingIncident&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Incidente Incitador: "}),rr(s.act1.incitingIncident)]})]})]}),s.act2&&e.jsxs(me,{children:[e.jsx(Re,{className:"pb-2",children:e.jsx(Ie,{className:"text-base",children:"Acto II: Confrontacin"})}),e.jsxs(he,{className:"space-y-2 text-sm",children:[s.act2.risingAction&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Accin Ascendente: "}),rr(s.act2.risingAction)]}),s.act2.midpoint&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Punto Medio: "}),rr(s.act2.midpoint)]}),s.act2.complications&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Complicaciones: "}),rr(s.act2.complications)]})]})]}),s.act3&&e.jsxs(me,{children:[e.jsx(Re,{className:"pb-2",children:e.jsx(Ie,{className:"text-base",children:"Acto III: Resolucin"})}),e.jsxs(he,{className:"space-y-2 text-sm",children:[s.act3.climax&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Clmax: "}),rr(s.act3.climax)]}),s.act3.resolution&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Resolucin: "}),rr(s.act3.resolution)]})]})]})]}),i&&i.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide mb-2",children:"Resumen por Captulo"}),e.jsx("div",{className:"space-y-2",children:i.map((c,d)=>e.jsxs("div",{className:"bg-card border border-card-border rounded-md p-3","data-testid":`chapter-outline-${c.number}`,children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsxs(Q,{variant:"secondary",className:"text-xs",children:["Cap. ",c.number]})}),e.jsx("p",{className:"text-sm mb-2",children:rr(c.summary)}),e.jsx("div",{className:"flex flex-wrap gap-1",children:c.keyEvents.map((p,m)=>e.jsx(Q,{variant:"outline",className:"text-xs",children:rr(p)},m))})]},d))})]}),o&&o.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide mb-2",children:"Hilos Narrativos"}),e.jsx("div",{className:"space-y-2",children:o.map((c,d)=>e.jsxs("div",{className:"bg-card border border-card-border rounded-md p-3","data-testid":`plot-thread-${d}`,children:[e.jsx("div",{className:"font-medium text-sm mb-1",children:c.name}),e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:c.description}),c.goal&&e.jsxs("div",{className:"text-xs text-muted-foreground/80",children:[e.jsx("span",{className:"font-medium",children:"Objetivo: "}),c.goal]})]},d))})]})]})})}function bL({worldBible:t,consistencyEntities:n=[],consistencyRules:r=[]}){if(!t)return e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(mn,{className:"h-12 w-12 text-muted-foreground/30 mb-4"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"No hay biblia del mundo disponible"}),e.jsx("p",{className:"text-muted-foreground/60 text-xs mt-1",children:"Se generar automticamente al crear un proyecto"})]});const s=t.timeline||[],i=t.characters||[],o=t.worldRules||[],c=t.plotOutline||null,d=t.plotDecisions||[],p=t.persistentInjuries||[],m=d.length>0,h=p.length>0;return e.jsxs(ci,{defaultValue:"plot",className:"w-full","data-testid":"world-bible-tabs",children:[e.jsxs(ga,{className:"w-full justify-start mb-4 flex-wrap gap-1",children:[e.jsxs(Bt,{value:"plot",className:"gap-1.5",children:[e.jsx(mn,{className:"h-4 w-4"}),"Trama"]}),e.jsxs(Bt,{value:"timeline",className:"gap-1.5",children:[e.jsx(Cn,{className:"h-4 w-4"}),"Cronologa"]}),e.jsxs(Bt,{value:"characters",className:"gap-1.5",children:[e.jsx(pl,{className:"h-4 w-4"}),"Personajes"]}),e.jsxs(Bt,{value:"rules",className:"gap-1.5",children:[e.jsx(Ko,{className:"h-4 w-4"}),"Reglas"]}),e.jsxs(Bt,{value:"decisions",className:"gap-1.5",children:[e.jsx(kc,{className:"h-4 w-4"}),"Decisiones",m&&e.jsx(Q,{variant:"secondary",className:"ml-1 text-xs",children:d.length})]}),e.jsxs(Bt,{value:"injuries",className:"gap-1.5",children:[e.jsx(Kc,{className:"h-4 w-4"}),"Lesiones",h&&e.jsx(Q,{variant:"secondary",className:"ml-1 text-xs",children:p.length})]}),e.jsxs(Bt,{value:"guardian",className:"gap-1.5",children:[e.jsx(fr,{className:"h-4 w-4"}),"Guardin",n.length>0&&e.jsx(Q,{variant:"secondary",className:"ml-1 text-xs",children:n.length})]})]}),e.jsx(Gt,{value:"plot",children:e.jsx(jL,{plotOutline:c})}),e.jsx(Gt,{value:"timeline",children:e.jsx(hL,{events:s})}),e.jsx(Gt,{value:"characters",children:e.jsx(fL,{characters:i})}),e.jsx(Gt,{value:"rules",children:e.jsx(xL,{rules:o})}),e.jsx(Gt,{value:"decisions",children:e.jsx(gL,{decisions:d})}),e.jsx(Gt,{value:"injuries",children:e.jsx(vL,{injuries:p})}),e.jsx(Gt,{value:"guardian",children:e.jsx(yL,{entities:n,rules:r})})]})}function wL(){const{currentProject:t,isLoading:n}=fi(),r=t?.status==="generating"||t?.status==="pending"||t?.status==="planning",{data:s,isLoading:i,error:o}=Ke({queryKey:["/api/projects",t?.id,"world-bible"],enabled:!!t?.id,staleTime:r?0:6e4,refetchInterval:r?5e3:!1}),{data:c}=Ke({queryKey:["/api/projects",t?.id,"consistency-violations"],enabled:!!t?.id,staleTime:3e4,refetchInterval:r?1e4:!1}),{data:d}=Ke({queryKey:["/api/projects",t?.id,"consistency-database"],enabled:!!t?.id,staleTime:3e4,refetchInterval:r?1e4:!1});return n?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ya,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4 animate-pulse"}),e.jsx("p",{className:"text-muted-foreground",children:"Cargando proyectos..."})]})}):t?o?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-6",children:[e.jsx(Ya,{className:"h-16 w-16 text-muted-foreground/20 mb-4"}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error al cargar"}),e.jsx("p",{className:"text-muted-foreground max-w-md",children:"No se pudo cargar la biblia del mundo. Intenta recargar la pgina."})]}):e.jsxs("div",{className:"p-6 space-y-6","data-testid":"world-bible-page",children:[e.jsx("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Biblia del Mundo"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Documento de referencia narrativa"})]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Q,{variant:"secondary",children:t.genre}),e.jsx(Q,{variant:"outline",children:t.tone}),e.jsxs(Q,{variant:"outline",children:[t.chapterCount," captulos"]})]}),i?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Ya,{className:"h-8 w-8 text-muted-foreground/30 animate-pulse"})}):(()=>{const p=s&&(s.timeline&&s.timeline.length>0||s.characters&&s.characters.length>0||s.plotOutline&&Object.keys(s.plotOutline).length>0);return r&&!p?e.jsx(me,{children:e.jsx(he,{className:"py-12",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[e.jsx(Ya,{className:"h-12 w-12 text-muted-foreground/30 mb-4 animate-pulse"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Generando biblia del mundo..."}),e.jsx("p",{className:"text-muted-foreground text-sm max-w-md",children:"El agente arquitecto est creando el universo narrativo. Esto puede tardar unos minutos."})]})})}):e.jsxs(e.Fragment,{children:[e.jsxs(me,{children:[e.jsx(Re,{className:"pb-2",children:e.jsxs(Ie,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ya,{className:"h-5 w-5"}),"Universo Narrativo"]})}),e.jsx(he,{children:e.jsx(bL,{worldBible:s||null,consistencyEntities:d?.entities||[],consistencyRules:d?.rules||[]})})]}),c&&c.length>0&&e.jsxs(me,{children:[e.jsx(Re,{className:"pb-2",children:e.jsxs(Ie,{className:"text-lg flex items-center gap-2",children:[e.jsx(on,{className:"h-5 w-5 text-yellow-500"}),"Registro de Consistencia",e.jsx(Q,{variant:"secondary",className:"ml-2",children:c.length})]})}),e.jsx(he,{children:e.jsx("div",{className:"space-y-3",children:c.map(m=>e.jsx("div",{className:`p-3 rounded-lg border ${m.wasAutoFixed?"bg-green-500/5 border-green-500/20":m.severity==="critical"?"bg-red-500/10 border-red-500/30":m.severity==="major"?"bg-orange-500/10 border-orange-500/30":"bg-yellow-500/10 border-yellow-500/30"}`,"data-testid":`violation-${m.id}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs(Q,{variant:m.wasAutoFixed?"default":"secondary",className:"text-xs",children:["Cap. ",m.chapterNumber]}),e.jsx(Q,{variant:"outline",className:`text-xs ${m.severity==="critical"?"border-red-500 text-red-500":m.severity==="major"?"border-orange-500 text-orange-500":"border-yellow-500 text-yellow-500"}`,children:m.severity}),e.jsx("span",{className:"text-xs text-muted-foreground",children:m.violationType.replace(/_/g," ")})]}),e.jsx("p",{className:"text-sm",children:m.description}),m.wasAutoFixed&&m.fixDescription&&e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-green-600 dark:text-green-400",children:[e.jsx(Xt,{className:"h-3 w-3"}),e.jsxs("span",{children:["Corregido: ",m.fixDescription]})]})]}),m.wasAutoFixed&&e.jsx(Xt,{className:"h-4 w-4 text-green-500 flex-shrink-0"})]})},m.id))})})]})]})})()]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-6",children:[e.jsx(Ya,{className:"h-16 w-16 text-muted-foreground/20 mb-4"}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Sin biblia del mundo"}),e.jsx("p",{className:"text-muted-foreground max-w-md",children:"Crea un nuevo proyecto desde el panel de control para generar la biblia del mundo"})]})}var ja="Accordion",NL=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[fv,CL,SL]=dl(ja),[am]=Zn(ja,[SL,Nk]),xv=Nk(),R2=ut.forwardRef((t,n)=>{const{type:r,...s}=t,i=s,o=s;return e.jsx(fv.Provider,{scope:t.__scopeAccordion,children:r==="multiple"?e.jsx(TL,{...o,ref:n}):e.jsx(PL,{...i,ref:n})})});R2.displayName=ja;var[A2,kL]=am(ja),[_2,EL]=am(ja,{collapsible:!1}),PL=ut.forwardRef((t,n)=>{const{value:r,defaultValue:s,onValueChange:i=()=>{},collapsible:o=!1,...c}=t,[d,p]=Zr({prop:r,defaultProp:s,onChange:i});return e.jsx(A2,{scope:t.__scopeAccordion,value:d?[d]:[],onItemOpen:p,onItemClose:ut.useCallback(()=>o&&p(""),[o,p]),children:e.jsx(_2,{scope:t.__scopeAccordion,collapsible:o,children:e.jsx(I2,{...c,ref:n})})})}),TL=ut.forwardRef((t,n)=>{const{value:r,defaultValue:s,onValueChange:i=()=>{},...o}=t,[c=[],d]=Zr({prop:r,defaultProp:s,onChange:i}),p=ut.useCallback(h=>d((g=[])=>[...g,h]),[d]),m=ut.useCallback(h=>d((g=[])=>g.filter(v=>v!==h)),[d]);return e.jsx(A2,{scope:t.__scopeAccordion,value:c,onItemOpen:p,onItemClose:m,children:e.jsx(_2,{scope:t.__scopeAccordion,collapsible:!0,children:e.jsx(I2,{...o,ref:n})})})}),[RL,im]=am(ja),I2=ut.forwardRef((t,n)=>{const{__scopeAccordion:r,disabled:s,dir:i,orientation:o="vertical",...c}=t,d=ut.useRef(null),p=vt(d,n),m=CL(r),g=Gi(i)==="ltr",v=De(t.onKeyDown,j=>{if(!NL.includes(j.key))return;const N=j.target,b=m().filter(X=>!X.ref.current?.disabled),C=b.findIndex(X=>X.ref.current===N),S=b.length;if(C===-1)return;j.preventDefault();let k=C;const P=0,R=S-1,E=()=>{k=C+1,k>R&&(k=P)},A=()=>{k=C-1,k<P&&(k=R)};switch(j.key){case"Home":k=P;break;case"End":k=R;break;case"ArrowRight":o==="horizontal"&&(g?E():A());break;case"ArrowDown":o==="vertical"&&E();break;case"ArrowLeft":o==="horizontal"&&(g?A():E());break;case"ArrowUp":o==="vertical"&&A();break}const W=k%S;b[W].ref.current?.focus()});return e.jsx(RL,{scope:r,disabled:s,direction:i,orientation:o,children:e.jsx(fv.Slot,{scope:r,children:e.jsx(et.div,{...c,"data-orientation":o,ref:p,onKeyDown:s?void 0:v})})})}),op="AccordionItem",[AL,gv]=am(op),M2=ut.forwardRef((t,n)=>{const{__scopeAccordion:r,value:s,...i}=t,o=im(op,r),c=kL(op,r),d=xv(r),p=Qr(),m=s&&c.value.includes(s)||!1,h=o.disabled||t.disabled;return e.jsx(AL,{scope:r,open:m,disabled:h,triggerId:p,children:e.jsx(kk,{"data-orientation":o.orientation,"data-state":z2(m),...d,...i,ref:n,disabled:h,open:m,onOpenChange:g=>{g?c.onItemOpen(s):c.onItemClose(s)}})})});M2.displayName=op;var O2="AccordionHeader",D2=ut.forwardRef((t,n)=>{const{__scopeAccordion:r,...s}=t,i=im(ja,r),o=gv(O2,r);return e.jsx(et.h3,{"data-orientation":i.orientation,"data-state":z2(o.open),"data-disabled":o.disabled?"":void 0,...s,ref:n})});D2.displayName=O2;var Nx="AccordionTrigger",L2=ut.forwardRef((t,n)=>{const{__scopeAccordion:r,...s}=t,i=im(ja,r),o=gv(Nx,r),c=EL(Nx,r),d=xv(r);return e.jsx(fv.ItemSlot,{scope:r,children:e.jsx(wD,{"aria-disabled":o.open&&!c.collapsible||void 0,"data-orientation":i.orientation,id:o.triggerId,...d,...s,ref:n})})});L2.displayName=Nx;var F2="AccordionContent",$2=ut.forwardRef((t,n)=>{const{__scopeAccordion:r,...s}=t,i=im(ja,r),o=gv(F2,r),c=xv(r);return e.jsx(ND,{role:"region","aria-labelledby":o.triggerId,"data-orientation":i.orientation,...c,...s,ref:n,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...t.style}})});$2.displayName=F2;function z2(t){return t?"open":"closed"}var _L=R2,IL=M2,ML=D2,V2=L2,q2=$2;const vv=_L,Vo=x.forwardRef(({className:t,...n},r)=>e.jsx(IL,{ref:r,className:Ae("border-b",t),...n}));Vo.displayName="AccordionItem";const qo=x.forwardRef(({className:t,children:n,...r},s)=>e.jsx(ML,{className:"flex",children:e.jsxs(V2,{ref:s,className:Ae("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",t),...r,children:[n,e.jsx(Qs,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));qo.displayName=V2.displayName;const Uo=x.forwardRef(({className:t,children:n,...r},s)=>e.jsx(q2,{ref:s,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:e.jsx("div",{className:Ae("pb-4 pt-0",t),children:n})}));Uo.displayName=q2.displayName;const OL={architect:e.jsx(Or,{className:"h-4 w-4"}),ghostwriter:e.jsx(ar,{className:"h-4 w-4"}),editor:e.jsx(fr,{className:"h-4 w-4"}),copyeditor:e.jsx(yt,{className:"h-4 w-4"})},DL={architect:"bg-chart-1/10 text-chart-1",ghostwriter:"bg-chart-2/10 text-chart-2",editor:"bg-chart-3/10 text-chart-3",copyeditor:"bg-chart-4/10 text-chart-4"},LL={architect:"El Arquitecto",ghostwriter:"El Narrador",editor:"El Editor",copyeditor:"El Estilista"};function FL({logs:t,filter:n}){const r=n?t.filter(s=>s.agentRole.toLowerCase()===n.toLowerCase()):t;return r.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(Or,{className:"h-12 w-12 text-muted-foreground/30 mb-4"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"No hay registros de pensamiento"}),e.jsx("p",{className:"text-muted-foreground/60 text-xs mt-1",children:"Las firmas de pensamiento de los agentes aparecern aqu"})]}):e.jsx(jt,{className:"h-[500px]","data-testid":"thought-log-viewer",children:e.jsx(vv,{type:"multiple",className:"space-y-2 pr-4",children:r.map(s=>{const i=s.agentRole.toLowerCase(),o=OL[i]||e.jsx(Or,{className:"h-4 w-4"}),c=DL[i]||"bg-muted text-muted-foreground",d=LL[i]||s.agentName;return e.jsxs(Vo,{value:`log-${s.id}`,className:"border border-card-border rounded-md bg-card px-4",children:[e.jsx(qo,{className:"py-3 hover:no-underline",children:e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:`p-1.5 rounded-md ${c}`,children:o}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-sm",children:d}),s.chapterId&&e.jsxs(Q,{variant:"secondary",className:"text-xs",children:["Cap. ",s.chapterId]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground mt-0.5",children:[e.jsx(Cn,{className:"h-3 w-3"}),new Date(s.createdAt).toLocaleString("es-ES")]})]})]})}),e.jsx(Uo,{className:"pb-4",children:e.jsx("div",{className:"bg-muted/50 rounded-md p-4 font-mono text-xs leading-relaxed whitespace-pre-wrap overflow-x-auto",children:s.thoughtContent})})]},s.id)})})})}const $L=[{value:"",label:"Todos",icon:NA},{value:"architect",label:"Arquitecto",icon:Or},{value:"ghostwriter",label:"Narrador",icon:ar},{value:"editor",label:"Editor",icon:fr},{value:"copyeditor",label:"Estilista",icon:yt}];function zL(){const[t,n]=x.useState(""),{currentProject:r,isLoading:s}=fi(),{data:i=[],isLoading:o}=Ke({queryKey:["/api/projects",r?.id,"thought-logs"],enabled:!!r?.id});if(s)return e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Or,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4 animate-pulse"}),e.jsx("p",{className:"text-muted-foreground",children:"Cargando proyectos..."})]})});if(!r)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-6",children:[e.jsx(Or,{className:"h-16 w-16 text-muted-foreground/20 mb-4"}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Sin logs de pensamiento"}),e.jsx("p",{className:"text-muted-foreground max-w-md",children:"Los logs de pensamiento se generarn cuando los agentes procesen tu manuscrito"})]});const c={architect:i.filter(d=>d.agentRole.toLowerCase()==="architect").length,ghostwriter:i.filter(d=>d.agentRole.toLowerCase()==="ghostwriter").length,editor:i.filter(d=>d.agentRole.toLowerCase()==="editor").length,copyeditor:i.filter(d=>d.agentRole.toLowerCase()==="copyeditor").length};return e.jsxs("div",{className:"p-6 space-y-6","data-testid":"thought-logs-page",children:[e.jsx("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Logs de Pensamiento"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Firmas de razonamiento de los agentes"})]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(Q,{variant:"secondary",children:[i.length," registros"]}),e.jsx(Q,{variant:"outline",children:r.genre})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:$L.map(d=>{const p=d.icon,m=d.value?c[d.value]:i.length,h=t===d.value;return e.jsxs(B,{variant:h?"default":"outline",size:"sm",onClick:()=>n(d.value),className:"gap-2","data-testid":`button-filter-${d.value||"all"}`,children:[e.jsx(p,{className:"h-4 w-4"}),d.label,e.jsx(Q,{variant:h?"secondary":"outline",className:"ml-1 text-xs",children:m})]},d.value)})})}),o?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Or,{className:"h-8 w-8 text-muted-foreground/30 animate-pulse"})}):e.jsxs(me,{children:[e.jsx(Re,{className:"pb-2",children:e.jsxs(Ie,{className:"text-lg flex items-center gap-2",children:[e.jsx(Or,{className:"h-5 w-5"}),"Sesiones de Razonamiento"]})}),e.jsx(he,{children:e.jsx(FL,{logs:i,filter:t})})]})]})}function VL(t,n){const r={};return(t[t.length-1]===""?[...t,""]:t).join((r.padRight?" ":"")+","+(r.padLeft===!1?"":" ")).trim()}const qL=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,UL=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,BL={};function kb(t,n){return(BL.jsx?UL:qL).test(t)}const GL=/[ \t\n\f\r]/g;function HL(t){return typeof t=="object"?t.type==="text"?Eb(t.value):!1:Eb(t)}function Eb(t){return t.replace(GL,"")===""}class rd{constructor(n,r,s){this.normal=r,this.property=n,s&&(this.space=s)}}rd.prototype.normal={};rd.prototype.property={};rd.prototype.space=void 0;function U2(t,n){const r={},s={};for(const i of t)Object.assign(r,i.property),Object.assign(s,i.normal);return new rd(r,s,n)}function Cx(t){return t.toLowerCase()}class Fr{constructor(n,r){this.attribute=r,this.property=n}}Fr.prototype.attribute="";Fr.prototype.booleanish=!1;Fr.prototype.boolean=!1;Fr.prototype.commaOrSpaceSeparated=!1;Fr.prototype.commaSeparated=!1;Fr.prototype.defined=!1;Fr.prototype.mustUseProperty=!1;Fr.prototype.number=!1;Fr.prototype.overloadedBoolean=!1;Fr.prototype.property="";Fr.prototype.spaceSeparated=!1;Fr.prototype.space=void 0;let KL=0;const It=Wi(),Ln=Wi(),Sx=Wi(),Le=Wi(),an=Wi(),Bo=Wi(),Br=Wi();function Wi(){return 2**++KL}const kx=Object.freeze(Object.defineProperty({__proto__:null,boolean:It,booleanish:Ln,commaOrSpaceSeparated:Br,commaSeparated:Bo,number:Le,overloadedBoolean:Sx,spaceSeparated:an},Symbol.toStringTag,{value:"Module"})),Tf=Object.keys(kx);class yv extends Fr{constructor(n,r,s,i){let o=-1;if(super(n,r),Pb(this,"space",i),typeof s=="number")for(;++o<Tf.length;){const c=Tf[o];Pb(this,Tf[o],(s&kx[c])===kx[c])}}}yv.prototype.defined=!0;function Pb(t,n,r){r&&(t[n]=r)}function vl(t){const n={},r={};for(const[s,i]of Object.entries(t.properties)){const o=new yv(s,t.transform(t.attributes||{},s),i,t.space);t.mustUseProperty&&t.mustUseProperty.includes(s)&&(o.mustUseProperty=!0),n[s]=o,r[Cx(s)]=s,r[Cx(o.attribute)]=s}return new rd(n,r,t.space)}const B2=vl({properties:{ariaActiveDescendant:null,ariaAtomic:Ln,ariaAutoComplete:null,ariaBusy:Ln,ariaChecked:Ln,ariaColCount:Le,ariaColIndex:Le,ariaColSpan:Le,ariaControls:an,ariaCurrent:null,ariaDescribedBy:an,ariaDetails:null,ariaDisabled:Ln,ariaDropEffect:an,ariaErrorMessage:null,ariaExpanded:Ln,ariaFlowTo:an,ariaGrabbed:Ln,ariaHasPopup:null,ariaHidden:Ln,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:an,ariaLevel:Le,ariaLive:null,ariaModal:Ln,ariaMultiLine:Ln,ariaMultiSelectable:Ln,ariaOrientation:null,ariaOwns:an,ariaPlaceholder:null,ariaPosInSet:Le,ariaPressed:Ln,ariaReadOnly:Ln,ariaRelevant:null,ariaRequired:Ln,ariaRoleDescription:an,ariaRowCount:Le,ariaRowIndex:Le,ariaRowSpan:Le,ariaSelected:Ln,ariaSetSize:Le,ariaSort:null,ariaValueMax:Le,ariaValueMin:Le,ariaValueNow:Le,ariaValueText:null,role:null},transform(t,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function G2(t,n){return n in t?t[n]:n}function H2(t,n){return G2(t,n.toLowerCase())}const WL=vl({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Bo,acceptCharset:an,accessKey:an,action:null,allow:null,allowFullScreen:It,allowPaymentRequest:It,allowUserMedia:It,alt:null,as:null,async:It,autoCapitalize:null,autoComplete:an,autoFocus:It,autoPlay:It,blocking:an,capture:null,charSet:null,checked:It,cite:null,className:an,cols:Le,colSpan:null,content:null,contentEditable:Ln,controls:It,controlsList:an,coords:Le|Bo,crossOrigin:null,data:null,dateTime:null,decoding:null,default:It,defer:It,dir:null,dirName:null,disabled:It,download:Sx,draggable:Ln,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:It,formTarget:null,headers:an,height:Le,hidden:Sx,high:Le,href:null,hrefLang:null,htmlFor:an,httpEquiv:an,id:null,imageSizes:null,imageSrcSet:null,inert:It,inputMode:null,integrity:null,is:null,isMap:It,itemId:null,itemProp:an,itemRef:an,itemScope:It,itemType:an,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:It,low:Le,manifest:null,max:null,maxLength:Le,media:null,method:null,min:null,minLength:Le,multiple:It,muted:It,name:null,nonce:null,noModule:It,noValidate:It,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:It,optimum:Le,pattern:null,ping:an,placeholder:null,playsInline:It,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:It,referrerPolicy:null,rel:an,required:It,reversed:It,rows:Le,rowSpan:Le,sandbox:an,scope:null,scoped:It,seamless:It,selected:It,shadowRootClonable:It,shadowRootDelegatesFocus:It,shadowRootMode:null,shape:null,size:Le,sizes:null,slot:null,span:Le,spellCheck:Ln,src:null,srcDoc:null,srcLang:null,srcSet:null,start:Le,step:null,style:null,tabIndex:Le,target:null,title:null,translate:null,type:null,typeMustMatch:It,useMap:null,value:Ln,width:Le,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:an,axis:null,background:null,bgColor:null,border:Le,borderColor:null,bottomMargin:Le,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:It,declare:It,event:null,face:null,frame:null,frameBorder:null,hSpace:Le,leftMargin:Le,link:null,longDesc:null,lowSrc:null,marginHeight:Le,marginWidth:Le,noResize:It,noHref:It,noShade:It,noWrap:It,object:null,profile:null,prompt:null,rev:null,rightMargin:Le,rules:null,scheme:null,scrolling:Ln,standby:null,summary:null,text:null,topMargin:Le,valueType:null,version:null,vAlign:null,vLink:null,vSpace:Le,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:It,disableRemotePlayback:It,prefix:null,property:null,results:Le,security:null,unselectable:null},space:"html",transform:H2}),QL=vl({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Br,accentHeight:Le,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:Le,amplitude:Le,arabicForm:null,ascent:Le,attributeName:null,attributeType:null,azimuth:Le,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:Le,by:null,calcMode:null,capHeight:Le,className:an,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:Le,diffuseConstant:Le,direction:null,display:null,dur:null,divisor:Le,dominantBaseline:null,download:It,dx:null,dy:null,edgeMode:null,editable:null,elevation:Le,enableBackground:null,end:null,event:null,exponent:Le,externalResourcesRequired:null,fill:null,fillOpacity:Le,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Bo,g2:Bo,glyphName:Bo,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:Le,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:Le,horizOriginX:Le,horizOriginY:Le,id:null,ideographic:Le,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:Le,k:Le,k1:Le,k2:Le,k3:Le,k4:Le,kernelMatrix:Br,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:Le,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:Le,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:Le,overlineThickness:Le,paintOrder:null,panose1:null,path:null,pathLength:Le,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:an,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:Le,pointsAtY:Le,pointsAtZ:Le,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Br,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Br,rev:Br,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Br,requiredFeatures:Br,requiredFonts:Br,requiredFormats:Br,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:Le,specularExponent:Le,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:Le,strikethroughThickness:Le,string:null,stroke:null,strokeDashArray:Br,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:Le,strokeOpacity:Le,strokeWidth:null,style:null,surfaceScale:Le,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Br,tabIndex:Le,tableValues:null,target:null,targetX:Le,targetY:Le,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Br,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:Le,underlineThickness:Le,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:Le,values:null,vAlphabetic:Le,vMathematical:Le,vectorEffect:null,vHanging:Le,vIdeographic:Le,version:null,vertAdvY:Le,vertOriginX:Le,vertOriginY:Le,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:Le,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:G2}),K2=vl({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(t,n){return"xlink:"+n.slice(5).toLowerCase()}}),W2=vl({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:H2}),Q2=vl({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(t,n){return"xml:"+n.slice(3).toLowerCase()}}),YL={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},ZL=/[A-Z]/g,Tb=/-[a-z]/g,XL=/^data[-\w.:]+$/i;function JL(t,n){const r=Cx(n);let s=n,i=Fr;if(r in t.normal)return t.property[t.normal[r]];if(r.length>4&&r.slice(0,4)==="data"&&XL.test(n)){if(n.charAt(4)==="-"){const o=n.slice(5).replace(Tb,tF);s="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=n.slice(4);if(!Tb.test(o)){let c=o.replace(ZL,eF);c.charAt(0)!=="-"&&(c="-"+c),n="data"+c}}i=yv}return new i(s,n)}function eF(t){return"-"+t.toLowerCase()}function tF(t){return t.charAt(1).toUpperCase()}const nF=U2([B2,WL,K2,W2,Q2],"html"),jv=U2([B2,QL,K2,W2,Q2],"svg");function rF(t){return t.join(" ").trim()}var ko={},Rf,Rb;function sF(){if(Rb)return Rf;Rb=1;var t=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=/\n/g,r=/^\s*/,s=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,i=/^:\s*/,o=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,c=/^[;\s]*/,d=/^\s+|\s+$/g,p=`
`,m="/",h="*",g="",v="comment",j="declaration";function N(C,S){if(typeof C!="string")throw new TypeError("First argument must be a string");if(!C)return[];S=S||{};var k=1,P=1;function R(U){var $=U.match(n);$&&(k+=$.length);var q=U.lastIndexOf(p);P=~q?U.length-q:P+U.length}function E(){var U={line:k,column:P};return function($){return $.position=new A(U),se(),$}}function A(U){this.start=U,this.end={line:k,column:P},this.source=S.source}A.prototype.content=C;function W(U){var $=new Error(S.source+":"+k+":"+P+": "+U);if($.reason=U,$.filename=S.source,$.line=k,$.column=P,$.source=C,!S.silent)throw $}function X(U){var $=U.exec(C);if($){var q=$[0];return R(q),C=C.slice(q.length),$}}function se(){X(r)}function V(U){var $;for(U=U||[];$=G();)$!==!1&&U.push($);return U}function G(){var U=E();if(!(m!=C.charAt(0)||h!=C.charAt(1))){for(var $=2;g!=C.charAt($)&&(h!=C.charAt($)||m!=C.charAt($+1));)++$;if($+=2,g===C.charAt($-1))return W("End of comment missing");var q=C.slice(2,$-2);return P+=2,R(q),C=C.slice($),P+=2,U({type:v,comment:q})}}function O(){var U=E(),$=X(s);if($){if(G(),!X(i))return W("property missing ':'");var q=X(o),le=U({type:j,property:b($[0].replace(t,g)),value:q?b(q[0].replace(t,g)):g});return X(c),le}}function F(){var U=[];V(U);for(var $;$=O();)$!==!1&&(U.push($),V(U));return U}return se(),F()}function b(C){return C?C.replace(d,g):g}return Rf=N,Rf}var Ab;function aF(){if(Ab)return ko;Ab=1;var t=ko&&ko.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ko,"__esModule",{value:!0}),ko.default=r;const n=t(sF());function r(s,i){let o=null;if(!s||typeof s!="string")return o;const c=(0,n.default)(s),d=typeof i=="function";return c.forEach(p=>{if(p.type!=="declaration")return;const{property:m,value:h}=p;d?i(m,h,p):h&&(o=o||{},o[m]=h)}),o}return ko}var oc={},_b;function iF(){if(_b)return oc;_b=1,Object.defineProperty(oc,"__esModule",{value:!0}),oc.camelCase=void 0;var t=/^--[a-zA-Z0-9_-]+$/,n=/-([a-z])/g,r=/^[^-]+$/,s=/^-(webkit|moz|ms|o|khtml)-/,i=/^-(ms)-/,o=function(m){return!m||r.test(m)||t.test(m)},c=function(m,h){return h.toUpperCase()},d=function(m,h){return"".concat(h,"-")},p=function(m,h){return h===void 0&&(h={}),o(m)?m:(m=m.toLowerCase(),h.reactCompat?m=m.replace(i,d):m=m.replace(s,d),m.replace(n,c))};return oc.camelCase=p,oc}var lc,Ib;function oF(){if(Ib)return lc;Ib=1;var t=lc&&lc.__importDefault||function(i){return i&&i.__esModule?i:{default:i}},n=t(aF()),r=iF();function s(i,o){var c={};return!i||typeof i!="string"||(0,n.default)(i,function(d,p){d&&p&&(c[(0,r.camelCase)(d,o)]=p)}),c}return s.default=s,lc=s,lc}var lF=oF();const cF=jp(lF),Y2=Z2("end"),bv=Z2("start");function Z2(t){return n;function n(r){const s=r&&r.position&&r.position[t]||{};if(typeof s.line=="number"&&s.line>0&&typeof s.column=="number"&&s.column>0)return{line:s.line,column:s.column,offset:typeof s.offset=="number"&&s.offset>-1?s.offset:void 0}}}function dF(t){const n=bv(t),r=Y2(t);if(n&&r)return{start:n,end:r}}function jc(t){return!t||typeof t!="object"?"":"position"in t||"type"in t?Mb(t.position):"start"in t||"end"in t?Mb(t):"line"in t||"column"in t?Ex(t):""}function Ex(t){return Ob(t&&t.line)+":"+Ob(t&&t.column)}function Mb(t){return Ex(t&&t.start)+"-"+Ex(t&&t.end)}function Ob(t){return t&&typeof t=="number"?t:1}class vr extends Error{constructor(n,r,s){super(),typeof r=="string"&&(s=r,r=void 0);let i="",o={},c=!1;if(r&&("line"in r&&"column"in r?o={place:r}:"start"in r&&"end"in r?o={place:r}:"type"in r?o={ancestors:[r],place:r.position}:o={...r}),typeof n=="string"?i=n:!o.cause&&n&&(c=!0,i=n.message,o.cause=n),!o.ruleId&&!o.source&&typeof s=="string"){const p=s.indexOf(":");p===-1?o.ruleId=s:(o.source=s.slice(0,p),o.ruleId=s.slice(p+1))}if(!o.place&&o.ancestors&&o.ancestors){const p=o.ancestors[o.ancestors.length-1];p&&(o.place=p.position)}const d=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=d?d.column:void 0,this.fatal=void 0,this.file="",this.message=i,this.line=d?d.line:void 0,this.name=jc(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=c&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}vr.prototype.file="";vr.prototype.name="";vr.prototype.reason="";vr.prototype.message="";vr.prototype.stack="";vr.prototype.column=void 0;vr.prototype.line=void 0;vr.prototype.ancestors=void 0;vr.prototype.cause=void 0;vr.prototype.fatal=void 0;vr.prototype.place=void 0;vr.prototype.ruleId=void 0;vr.prototype.source=void 0;const wv={}.hasOwnProperty,uF=new Map,pF=/[A-Z]/g,mF=new Set(["table","tbody","thead","tfoot","tr"]),hF=new Set(["td","th"]),X2="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function fF(t,n){if(!n||n.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const r=n.filePath||void 0;let s;if(n.development){if(typeof n.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");s=NF(r,n.jsxDEV)}else{if(typeof n.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof n.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");s=wF(r,n.jsx,n.jsxs)}const i={Fragment:n.Fragment,ancestors:[],components:n.components||{},create:s,elementAttributeNameCase:n.elementAttributeNameCase||"react",evaluater:n.createEvaluater?n.createEvaluater():void 0,filePath:r,ignoreInvalidStyle:n.ignoreInvalidStyle||!1,passKeys:n.passKeys!==!1,passNode:n.passNode||!1,schema:n.space==="svg"?jv:nF,stylePropertyNameCase:n.stylePropertyNameCase||"dom",tableCellAlignToStyle:n.tableCellAlignToStyle!==!1},o=J2(i,t,void 0);return o&&typeof o!="string"?o:i.create(t,i.Fragment,{children:o||void 0},void 0)}function J2(t,n,r){if(n.type==="element")return xF(t,n,r);if(n.type==="mdxFlowExpression"||n.type==="mdxTextExpression")return gF(t,n);if(n.type==="mdxJsxFlowElement"||n.type==="mdxJsxTextElement")return yF(t,n,r);if(n.type==="mdxjsEsm")return vF(t,n);if(n.type==="root")return jF(t,n,r);if(n.type==="text")return bF(t,n)}function xF(t,n,r){const s=t.schema;let i=s;n.tagName.toLowerCase()==="svg"&&s.space==="html"&&(i=jv,t.schema=i),t.ancestors.push(n);const o=tE(t,n.tagName,!1),c=CF(t,n);let d=Cv(t,n);return mF.has(n.tagName)&&(d=d.filter(function(p){return typeof p=="string"?!HL(p):!0})),eE(t,c,o,n),Nv(c,d),t.ancestors.pop(),t.schema=s,t.create(n,o,c,r)}function gF(t,n){if(n.data&&n.data.estree&&t.evaluater){const s=n.data.estree.body[0];return s.type,t.evaluater.evaluateExpression(s.expression)}Oc(t,n.position)}function vF(t,n){if(n.data&&n.data.estree&&t.evaluater)return t.evaluater.evaluateProgram(n.data.estree);Oc(t,n.position)}function yF(t,n,r){const s=t.schema;let i=s;n.name==="svg"&&s.space==="html"&&(i=jv,t.schema=i),t.ancestors.push(n);const o=n.name===null?t.Fragment:tE(t,n.name,!0),c=SF(t,n),d=Cv(t,n);return eE(t,c,o,n),Nv(c,d),t.ancestors.pop(),t.schema=s,t.create(n,o,c,r)}function jF(t,n,r){const s={};return Nv(s,Cv(t,n)),t.create(n,t.Fragment,s,r)}function bF(t,n){return n.value}function eE(t,n,r,s){typeof r!="string"&&r!==t.Fragment&&t.passNode&&(n.node=s)}function Nv(t,n){if(n.length>0){const r=n.length>1?n:n[0];r&&(t.children=r)}}function wF(t,n,r){return s;function s(i,o,c,d){const m=Array.isArray(c.children)?r:n;return d?m(o,c,d):m(o,c)}}function NF(t,n){return r;function r(s,i,o,c){const d=Array.isArray(o.children),p=bv(s);return n(i,o,c,d,{columnNumber:p?p.column-1:void 0,fileName:t,lineNumber:p?p.line:void 0},void 0)}}function CF(t,n){const r={};let s,i;for(i in n.properties)if(i!=="children"&&wv.call(n.properties,i)){const o=kF(t,i,n.properties[i]);if(o){const[c,d]=o;t.tableCellAlignToStyle&&c==="align"&&typeof d=="string"&&hF.has(n.tagName)?s=d:r[c]=d}}if(s){const o=r.style||(r.style={});o[t.stylePropertyNameCase==="css"?"text-align":"textAlign"]=s}return r}function SF(t,n){const r={};for(const s of n.attributes)if(s.type==="mdxJsxExpressionAttribute")if(s.data&&s.data.estree&&t.evaluater){const o=s.data.estree.body[0];o.type;const c=o.expression;c.type;const d=c.properties[0];d.type,Object.assign(r,t.evaluater.evaluateExpression(d.argument))}else Oc(t,n.position);else{const i=s.name;let o;if(s.value&&typeof s.value=="object")if(s.value.data&&s.value.data.estree&&t.evaluater){const d=s.value.data.estree.body[0];d.type,o=t.evaluater.evaluateExpression(d.expression)}else Oc(t,n.position);else o=s.value===null?!0:s.value;r[i]=o}return r}function Cv(t,n){const r=[];let s=-1;const i=t.passKeys?new Map:uF;for(;++s<n.children.length;){const o=n.children[s];let c;if(t.passKeys){const p=o.type==="element"?o.tagName:o.type==="mdxJsxFlowElement"||o.type==="mdxJsxTextElement"?o.name:void 0;if(p){const m=i.get(p)||0;c=p+"-"+m,i.set(p,m+1)}}const d=J2(t,o,c);d!==void 0&&r.push(d)}return r}function kF(t,n,r){const s=JL(t.schema,n);if(!(r==null||typeof r=="number"&&Number.isNaN(r))){if(Array.isArray(r)&&(r=s.commaSeparated?VL(r):rF(r)),s.property==="style"){let i=typeof r=="object"?r:EF(t,String(r));return t.stylePropertyNameCase==="css"&&(i=PF(i)),["style",i]}return[t.elementAttributeNameCase==="react"&&s.space?YL[s.property]||s.property:s.attribute,r]}}function EF(t,n){try{return cF(n,{reactCompat:!0})}catch(r){if(t.ignoreInvalidStyle)return{};const s=r,i=new vr("Cannot parse `style` attribute",{ancestors:t.ancestors,cause:s,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw i.file=t.filePath||void 0,i.url=X2+"#cannot-parse-style-attribute",i}}function tE(t,n,r){let s;if(!r)s={type:"Literal",value:n};else if(n.includes(".")){const i=n.split(".");let o=-1,c;for(;++o<i.length;){const d=kb(i[o])?{type:"Identifier",name:i[o]}:{type:"Literal",value:i[o]};c=c?{type:"MemberExpression",object:c,property:d,computed:!!(o&&d.type==="Literal"),optional:!1}:d}s=c}else s=kb(n)&&!/^[a-z]/.test(n)?{type:"Identifier",name:n}:{type:"Literal",value:n};if(s.type==="Literal"){const i=s.value;return wv.call(t.components,i)?t.components[i]:i}if(t.evaluater)return t.evaluater.evaluateExpression(s);Oc(t)}function Oc(t,n){const r=new vr("Cannot handle MDX estrees without `createEvaluater`",{ancestors:t.ancestors,place:n,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw r.file=t.filePath||void 0,r.url=X2+"#cannot-handle-mdx-estrees-without-createevaluater",r}function PF(t){const n={};let r;for(r in t)wv.call(t,r)&&(n[TF(r)]=t[r]);return n}function TF(t){let n=t.replace(pF,RF);return n.slice(0,3)==="ms-"&&(n="-"+n),n}function RF(t){return"-"+t.toLowerCase()}const Af={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},AF={};function _F(t,n){const r=AF,s=typeof r.includeImageAlt=="boolean"?r.includeImageAlt:!0,i=typeof r.includeHtml=="boolean"?r.includeHtml:!0;return nE(t,s,i)}function nE(t,n,r){if(IF(t)){if("value"in t)return t.type==="html"&&!r?"":t.value;if(n&&"alt"in t&&t.alt)return t.alt;if("children"in t)return Db(t.children,n,r)}return Array.isArray(t)?Db(t,n,r):""}function Db(t,n,r){const s=[];let i=-1;for(;++i<t.length;)s[i]=nE(t[i],n,r);return s.join("")}function IF(t){return!!(t&&typeof t=="object")}const Lb=document.createElement("i");function Sv(t){const n="&"+t+";";Lb.innerHTML=n;const r=Lb.textContent;return r.charCodeAt(r.length-1)===59&&t!=="semi"||r===n?!1:r}function Ws(t,n,r,s){const i=t.length;let o=0,c;if(n<0?n=-n>i?0:i+n:n=n>i?i:n,r=r>0?r:0,s.length<1e4)c=Array.from(s),c.unshift(n,r),t.splice(...c);else for(r&&t.splice(n,r);o<s.length;)c=s.slice(o,o+1e4),c.unshift(n,0),t.splice(...c),o+=1e4,n+=1e4}function cs(t,n){return t.length>0?(Ws(t,t.length,0,n),t):n}const Fb={}.hasOwnProperty;function MF(t){const n={};let r=-1;for(;++r<t.length;)OF(n,t[r]);return n}function OF(t,n){let r;for(r in n){const i=(Fb.call(t,r)?t[r]:void 0)||(t[r]={}),o=n[r];let c;if(o)for(c in o){Fb.call(i,c)||(i[c]=[]);const d=o[c];DF(i[c],Array.isArray(d)?d:d?[d]:[])}}}function DF(t,n){let r=-1;const s=[];for(;++r<n.length;)(n[r].add==="after"?t:s).push(n[r]);Ws(t,0,0,s)}function rE(t,n){const r=Number.parseInt(t,n);return r<9||r===11||r>13&&r<32||r>126&&r<160||r>55295&&r<57344||r>64975&&r<65008||(r&65535)===65535||(r&65535)===65534||r>1114111?"":String.fromCodePoint(r)}function Go(t){return t.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const zs=xi(/[A-Za-z]/),Wr=xi(/[\dA-Za-z]/),LF=xi(/[#-'*+\--9=?A-Z^-~]/);function Px(t){return t!==null&&(t<32||t===127)}const Tx=xi(/\d/),FF=xi(/[\dA-Fa-f]/),$F=xi(/[!-/:-@[-`{-~]/);function wt(t){return t!==null&&t<-2}function Lr(t){return t!==null&&(t<0||t===32)}function Wt(t){return t===-2||t===-1||t===32}const zF=xi(new RegExp("\\p{P}|\\p{S}","u")),VF=xi(/\s/);function xi(t){return n;function n(r){return r!==null&&r>-1&&t.test(String.fromCharCode(r))}}function yl(t){const n=[];let r=-1,s=0,i=0;for(;++r<t.length;){const o=t.charCodeAt(r);let c="";if(o===37&&Wr(t.charCodeAt(r+1))&&Wr(t.charCodeAt(r+2)))i=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(c=String.fromCharCode(o));else if(o>55295&&o<57344){const d=t.charCodeAt(r+1);o<56320&&d>56319&&d<57344?(c=String.fromCharCode(o,d),i=1):c=""}else c=String.fromCharCode(o);c&&(n.push(t.slice(s,r),encodeURIComponent(c)),s=r+i+1,c=""),i&&(r+=i,i=0)}return n.join("")+t.slice(s)}function ln(t,n,r,s){const i=s?s-1:Number.POSITIVE_INFINITY;let o=0;return c;function c(p){return Wt(p)?(t.enter(r),d(p)):n(p)}function d(p){return Wt(p)&&o++<i?(t.consume(p),d):(t.exit(r),n(p))}}const qF={tokenize:UF};function UF(t){const n=t.attempt(this.parser.constructs.contentInitial,s,i);let r;return n;function s(d){if(d===null){t.consume(d);return}return t.enter("lineEnding"),t.consume(d),t.exit("lineEnding"),ln(t,n,"linePrefix")}function i(d){return t.enter("paragraph"),o(d)}function o(d){const p=t.enter("chunkText",{contentType:"text",previous:r});return r&&(r.next=p),r=p,c(d)}function c(d){if(d===null){t.exit("chunkText"),t.exit("paragraph"),t.consume(d);return}return wt(d)?(t.consume(d),t.exit("chunkText"),o):(t.consume(d),c)}}const BF={tokenize:GF},$b={tokenize:HF};function GF(t){const n=this,r=[];let s=0,i,o,c;return d;function d(P){if(s<r.length){const R=r[s];return n.containerState=R[1],t.attempt(R[0].continuation,p,m)(P)}return m(P)}function p(P){if(s++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,i&&k();const R=n.events.length;let E=R,A;for(;E--;)if(n.events[E][0]==="exit"&&n.events[E][1].type==="chunkFlow"){A=n.events[E][1].end;break}S(s);let W=R;for(;W<n.events.length;)n.events[W][1].end={...A},W++;return Ws(n.events,E+1,0,n.events.slice(R)),n.events.length=W,m(P)}return d(P)}function m(P){if(s===r.length){if(!i)return v(P);if(i.currentConstruct&&i.currentConstruct.concrete)return N(P);n.interrupt=!!(i.currentConstruct&&!i._gfmTableDynamicInterruptHack)}return n.containerState={},t.check($b,h,g)(P)}function h(P){return i&&k(),S(s),v(P)}function g(P){return n.parser.lazy[n.now().line]=s!==r.length,c=n.now().offset,N(P)}function v(P){return n.containerState={},t.attempt($b,j,N)(P)}function j(P){return s++,r.push([n.currentConstruct,n.containerState]),v(P)}function N(P){if(P===null){i&&k(),S(0),t.consume(P);return}return i=i||n.parser.flow(n.now()),t.enter("chunkFlow",{_tokenizer:i,contentType:"flow",previous:o}),b(P)}function b(P){if(P===null){C(t.exit("chunkFlow"),!0),S(0),t.consume(P);return}return wt(P)?(t.consume(P),C(t.exit("chunkFlow")),s=0,n.interrupt=void 0,d):(t.consume(P),b)}function C(P,R){const E=n.sliceStream(P);if(R&&E.push(null),P.previous=o,o&&(o.next=P),o=P,i.defineSkip(P.start),i.write(E),n.parser.lazy[P.start.line]){let A=i.events.length;for(;A--;)if(i.events[A][1].start.offset<c&&(!i.events[A][1].end||i.events[A][1].end.offset>c))return;const W=n.events.length;let X=W,se,V;for(;X--;)if(n.events[X][0]==="exit"&&n.events[X][1].type==="chunkFlow"){if(se){V=n.events[X][1].end;break}se=!0}for(S(s),A=W;A<n.events.length;)n.events[A][1].end={...V},A++;Ws(n.events,X+1,0,n.events.slice(W)),n.events.length=A}}function S(P){let R=r.length;for(;R-- >P;){const E=r[R];n.containerState=E[1],E[0].exit.call(n,t)}r.length=P}function k(){i.write([null]),o=void 0,i=void 0,n.containerState._closeFlow=void 0}}function HF(t,n,r){return ln(t,t.attempt(this.parser.constructs.document,n,r),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function zb(t){if(t===null||Lr(t)||VF(t))return 1;if(zF(t))return 2}function kv(t,n,r){const s=[];let i=-1;for(;++i<t.length;){const o=t[i].resolveAll;o&&!s.includes(o)&&(n=o(n,r),s.push(o))}return n}const Rx={name:"attention",resolveAll:KF,tokenize:WF};function KF(t,n){let r=-1,s,i,o,c,d,p,m,h;for(;++r<t.length;)if(t[r][0]==="enter"&&t[r][1].type==="attentionSequence"&&t[r][1]._close){for(s=r;s--;)if(t[s][0]==="exit"&&t[s][1].type==="attentionSequence"&&t[s][1]._open&&n.sliceSerialize(t[s][1]).charCodeAt(0)===n.sliceSerialize(t[r][1]).charCodeAt(0)){if((t[s][1]._close||t[r][1]._open)&&(t[r][1].end.offset-t[r][1].start.offset)%3&&!((t[s][1].end.offset-t[s][1].start.offset+t[r][1].end.offset-t[r][1].start.offset)%3))continue;p=t[s][1].end.offset-t[s][1].start.offset>1&&t[r][1].end.offset-t[r][1].start.offset>1?2:1;const g={...t[s][1].end},v={...t[r][1].start};Vb(g,-p),Vb(v,p),c={type:p>1?"strongSequence":"emphasisSequence",start:g,end:{...t[s][1].end}},d={type:p>1?"strongSequence":"emphasisSequence",start:{...t[r][1].start},end:v},o={type:p>1?"strongText":"emphasisText",start:{...t[s][1].end},end:{...t[r][1].start}},i={type:p>1?"strong":"emphasis",start:{...c.start},end:{...d.end}},t[s][1].end={...c.start},t[r][1].start={...d.end},m=[],t[s][1].end.offset-t[s][1].start.offset&&(m=cs(m,[["enter",t[s][1],n],["exit",t[s][1],n]])),m=cs(m,[["enter",i,n],["enter",c,n],["exit",c,n],["enter",o,n]]),m=cs(m,kv(n.parser.constructs.insideSpan.null,t.slice(s+1,r),n)),m=cs(m,[["exit",o,n],["enter",d,n],["exit",d,n],["exit",i,n]]),t[r][1].end.offset-t[r][1].start.offset?(h=2,m=cs(m,[["enter",t[r][1],n],["exit",t[r][1],n]])):h=0,Ws(t,s-1,r-s+3,m),r=s+m.length-h-2;break}}for(r=-1;++r<t.length;)t[r][1].type==="attentionSequence"&&(t[r][1].type="data");return t}function WF(t,n){const r=this.parser.constructs.attentionMarkers.null,s=this.previous,i=zb(s);let o;return c;function c(p){return o=p,t.enter("attentionSequence"),d(p)}function d(p){if(p===o)return t.consume(p),d;const m=t.exit("attentionSequence"),h=zb(p),g=!h||h===2&&i||r.includes(p),v=!i||i===2&&h||r.includes(s);return m._open=!!(o===42?g:g&&(i||!v)),m._close=!!(o===42?v:v&&(h||!g)),n(p)}}function Vb(t,n){t.column+=n,t.offset+=n,t._bufferIndex+=n}const QF={name:"autolink",tokenize:YF};function YF(t,n,r){let s=0;return i;function i(j){return t.enter("autolink"),t.enter("autolinkMarker"),t.consume(j),t.exit("autolinkMarker"),t.enter("autolinkProtocol"),o}function o(j){return zs(j)?(t.consume(j),c):j===64?r(j):m(j)}function c(j){return j===43||j===45||j===46||Wr(j)?(s=1,d(j)):m(j)}function d(j){return j===58?(t.consume(j),s=0,p):(j===43||j===45||j===46||Wr(j))&&s++<32?(t.consume(j),d):(s=0,m(j))}function p(j){return j===62?(t.exit("autolinkProtocol"),t.enter("autolinkMarker"),t.consume(j),t.exit("autolinkMarker"),t.exit("autolink"),n):j===null||j===32||j===60||Px(j)?r(j):(t.consume(j),p)}function m(j){return j===64?(t.consume(j),h):LF(j)?(t.consume(j),m):r(j)}function h(j){return Wr(j)?g(j):r(j)}function g(j){return j===46?(t.consume(j),s=0,h):j===62?(t.exit("autolinkProtocol").type="autolinkEmail",t.enter("autolinkMarker"),t.consume(j),t.exit("autolinkMarker"),t.exit("autolink"),n):v(j)}function v(j){if((j===45||Wr(j))&&s++<63){const N=j===45?v:g;return t.consume(j),N}return r(j)}}const om={partial:!0,tokenize:ZF};function ZF(t,n,r){return s;function s(o){return Wt(o)?ln(t,i,"linePrefix")(o):i(o)}function i(o){return o===null||wt(o)?n(o):r(o)}}const sE={continuation:{tokenize:JF},exit:e$,name:"blockQuote",tokenize:XF};function XF(t,n,r){const s=this;return i;function i(c){if(c===62){const d=s.containerState;return d.open||(t.enter("blockQuote",{_container:!0}),d.open=!0),t.enter("blockQuotePrefix"),t.enter("blockQuoteMarker"),t.consume(c),t.exit("blockQuoteMarker"),o}return r(c)}function o(c){return Wt(c)?(t.enter("blockQuotePrefixWhitespace"),t.consume(c),t.exit("blockQuotePrefixWhitespace"),t.exit("blockQuotePrefix"),n):(t.exit("blockQuotePrefix"),n(c))}}function JF(t,n,r){const s=this;return i;function i(c){return Wt(c)?ln(t,o,"linePrefix",s.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(c):o(c)}function o(c){return t.attempt(sE,n,r)(c)}}function e$(t){t.exit("blockQuote")}const aE={name:"characterEscape",tokenize:t$};function t$(t,n,r){return s;function s(o){return t.enter("characterEscape"),t.enter("escapeMarker"),t.consume(o),t.exit("escapeMarker"),i}function i(o){return $F(o)?(t.enter("characterEscapeValue"),t.consume(o),t.exit("characterEscapeValue"),t.exit("characterEscape"),n):r(o)}}const iE={name:"characterReference",tokenize:n$};function n$(t,n,r){const s=this;let i=0,o,c;return d;function d(g){return t.enter("characterReference"),t.enter("characterReferenceMarker"),t.consume(g),t.exit("characterReferenceMarker"),p}function p(g){return g===35?(t.enter("characterReferenceMarkerNumeric"),t.consume(g),t.exit("characterReferenceMarkerNumeric"),m):(t.enter("characterReferenceValue"),o=31,c=Wr,h(g))}function m(g){return g===88||g===120?(t.enter("characterReferenceMarkerHexadecimal"),t.consume(g),t.exit("characterReferenceMarkerHexadecimal"),t.enter("characterReferenceValue"),o=6,c=FF,h):(t.enter("characterReferenceValue"),o=7,c=Tx,h(g))}function h(g){if(g===59&&i){const v=t.exit("characterReferenceValue");return c===Wr&&!Sv(s.sliceSerialize(v))?r(g):(t.enter("characterReferenceMarker"),t.consume(g),t.exit("characterReferenceMarker"),t.exit("characterReference"),n)}return c(g)&&i++<o?(t.consume(g),h):r(g)}}const qb={partial:!0,tokenize:s$},Ub={concrete:!0,name:"codeFenced",tokenize:r$};function r$(t,n,r){const s=this,i={partial:!0,tokenize:E};let o=0,c=0,d;return p;function p(A){return m(A)}function m(A){const W=s.events[s.events.length-1];return o=W&&W[1].type==="linePrefix"?W[2].sliceSerialize(W[1],!0).length:0,d=A,t.enter("codeFenced"),t.enter("codeFencedFence"),t.enter("codeFencedFenceSequence"),h(A)}function h(A){return A===d?(c++,t.consume(A),h):c<3?r(A):(t.exit("codeFencedFenceSequence"),Wt(A)?ln(t,g,"whitespace")(A):g(A))}function g(A){return A===null||wt(A)?(t.exit("codeFencedFence"),s.interrupt?n(A):t.check(qb,b,R)(A)):(t.enter("codeFencedFenceInfo"),t.enter("chunkString",{contentType:"string"}),v(A))}function v(A){return A===null||wt(A)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),g(A)):Wt(A)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),ln(t,j,"whitespace")(A)):A===96&&A===d?r(A):(t.consume(A),v)}function j(A){return A===null||wt(A)?g(A):(t.enter("codeFencedFenceMeta"),t.enter("chunkString",{contentType:"string"}),N(A))}function N(A){return A===null||wt(A)?(t.exit("chunkString"),t.exit("codeFencedFenceMeta"),g(A)):A===96&&A===d?r(A):(t.consume(A),N)}function b(A){return t.attempt(i,R,C)(A)}function C(A){return t.enter("lineEnding"),t.consume(A),t.exit("lineEnding"),S}function S(A){return o>0&&Wt(A)?ln(t,k,"linePrefix",o+1)(A):k(A)}function k(A){return A===null||wt(A)?t.check(qb,b,R)(A):(t.enter("codeFlowValue"),P(A))}function P(A){return A===null||wt(A)?(t.exit("codeFlowValue"),k(A)):(t.consume(A),P)}function R(A){return t.exit("codeFenced"),n(A)}function E(A,W,X){let se=0;return V;function V($){return A.enter("lineEnding"),A.consume($),A.exit("lineEnding"),G}function G($){return A.enter("codeFencedFence"),Wt($)?ln(A,O,"linePrefix",s.parser.constructs.disable.null.includes("codeIndented")?void 0:4)($):O($)}function O($){return $===d?(A.enter("codeFencedFenceSequence"),F($)):X($)}function F($){return $===d?(se++,A.consume($),F):se>=c?(A.exit("codeFencedFenceSequence"),Wt($)?ln(A,U,"whitespace")($):U($)):X($)}function U($){return $===null||wt($)?(A.exit("codeFencedFence"),W($)):X($)}}}function s$(t,n,r){const s=this;return i;function i(c){return c===null?r(c):(t.enter("lineEnding"),t.consume(c),t.exit("lineEnding"),o)}function o(c){return s.parser.lazy[s.now().line]?r(c):n(c)}}const _f={name:"codeIndented",tokenize:i$},a$={partial:!0,tokenize:o$};function i$(t,n,r){const s=this;return i;function i(m){return t.enter("codeIndented"),ln(t,o,"linePrefix",5)(m)}function o(m){const h=s.events[s.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?c(m):r(m)}function c(m){return m===null?p(m):wt(m)?t.attempt(a$,c,p)(m):(t.enter("codeFlowValue"),d(m))}function d(m){return m===null||wt(m)?(t.exit("codeFlowValue"),c(m)):(t.consume(m),d)}function p(m){return t.exit("codeIndented"),n(m)}}function o$(t,n,r){const s=this;return i;function i(c){return s.parser.lazy[s.now().line]?r(c):wt(c)?(t.enter("lineEnding"),t.consume(c),t.exit("lineEnding"),i):ln(t,o,"linePrefix",5)(c)}function o(c){const d=s.events[s.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(c):wt(c)?i(c):r(c)}}const l$={name:"codeText",previous:d$,resolve:c$,tokenize:u$};function c$(t){let n=t.length-4,r=3,s,i;if((t[r][1].type==="lineEnding"||t[r][1].type==="space")&&(t[n][1].type==="lineEnding"||t[n][1].type==="space")){for(s=r;++s<n;)if(t[s][1].type==="codeTextData"){t[r][1].type="codeTextPadding",t[n][1].type="codeTextPadding",r+=2,n-=2;break}}for(s=r-1,n++;++s<=n;)i===void 0?s!==n&&t[s][1].type!=="lineEnding"&&(i=s):(s===n||t[s][1].type==="lineEnding")&&(t[i][1].type="codeTextData",s!==i+2&&(t[i][1].end=t[s-1][1].end,t.splice(i+2,s-i-2),n-=s-i-2,s=i+2),i=void 0);return t}function d$(t){return t!==96||this.events[this.events.length-1][1].type==="characterEscape"}function u$(t,n,r){let s=0,i,o;return c;function c(g){return t.enter("codeText"),t.enter("codeTextSequence"),d(g)}function d(g){return g===96?(t.consume(g),s++,d):(t.exit("codeTextSequence"),p(g))}function p(g){return g===null?r(g):g===32?(t.enter("space"),t.consume(g),t.exit("space"),p):g===96?(o=t.enter("codeTextSequence"),i=0,h(g)):wt(g)?(t.enter("lineEnding"),t.consume(g),t.exit("lineEnding"),p):(t.enter("codeTextData"),m(g))}function m(g){return g===null||g===32||g===96||wt(g)?(t.exit("codeTextData"),p(g)):(t.consume(g),m)}function h(g){return g===96?(t.consume(g),i++,h):i===s?(t.exit("codeTextSequence"),t.exit("codeText"),n(g)):(o.type="codeTextData",m(g))}}class p${constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,r){const s=r??Number.POSITIVE_INFINITY;return s<this.left.length?this.left.slice(n,s):n>this.left.length?this.right.slice(this.right.length-s+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-s+this.left.length).reverse())}splice(n,r,s){const i=r||0;this.setCursor(Math.trunc(n));const o=this.right.splice(this.right.length-i,Number.POSITIVE_INFINITY);return s&&cc(this.left,s),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),cc(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),cc(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const r=this.left.splice(n,Number.POSITIVE_INFINITY);cc(this.right,r.reverse())}else{const r=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);cc(this.left,r.reverse())}}}function cc(t,n){let r=0;if(n.length<1e4)t.push(...n);else for(;r<n.length;)t.push(...n.slice(r,r+1e4)),r+=1e4}function oE(t){const n={};let r=-1,s,i,o,c,d,p,m;const h=new p$(t);for(;++r<h.length;){for(;r in n;)r=n[r];if(s=h.get(r),r&&s[1].type==="chunkFlow"&&h.get(r-1)[1].type==="listItemPrefix"&&(p=s[1]._tokenizer.events,o=0,o<p.length&&p[o][1].type==="lineEndingBlank"&&(o+=2),o<p.length&&p[o][1].type==="content"))for(;++o<p.length&&p[o][1].type!=="content";)p[o][1].type==="chunkText"&&(p[o][1]._isInFirstContentOfListItem=!0,o++);if(s[0]==="enter")s[1].contentType&&(Object.assign(n,m$(h,r)),r=n[r],m=!0);else if(s[1]._container){for(o=r,i=void 0;o--;)if(c=h.get(o),c[1].type==="lineEnding"||c[1].type==="lineEndingBlank")c[0]==="enter"&&(i&&(h.get(i)[1].type="lineEndingBlank"),c[1].type="lineEnding",i=o);else if(!(c[1].type==="linePrefix"||c[1].type==="listItemIndent"))break;i&&(s[1].end={...h.get(i)[1].start},d=h.slice(i,r),d.unshift(s),h.splice(i,r-i+1,d))}}return Ws(t,0,Number.POSITIVE_INFINITY,h.slice(0)),!m}function m$(t,n){const r=t.get(n)[1],s=t.get(n)[2];let i=n-1;const o=[];let c=r._tokenizer;c||(c=s.parser[r.contentType](r.start),r._contentTypeTextTrailing&&(c._contentTypeTextTrailing=!0));const d=c.events,p=[],m={};let h,g,v=-1,j=r,N=0,b=0;const C=[b];for(;j;){for(;t.get(++i)[1]!==j;);o.push(i),j._tokenizer||(h=s.sliceStream(j),j.next||h.push(null),g&&c.defineSkip(j.start),j._isInFirstContentOfListItem&&(c._gfmTasklistFirstContentOfListItem=!0),c.write(h),j._isInFirstContentOfListItem&&(c._gfmTasklistFirstContentOfListItem=void 0)),g=j,j=j.next}for(j=r;++v<d.length;)d[v][0]==="exit"&&d[v-1][0]==="enter"&&d[v][1].type===d[v-1][1].type&&d[v][1].start.line!==d[v][1].end.line&&(b=v+1,C.push(b),j._tokenizer=void 0,j.previous=void 0,j=j.next);for(c.events=[],j?(j._tokenizer=void 0,j.previous=void 0):C.pop(),v=C.length;v--;){const S=d.slice(C[v],C[v+1]),k=o.pop();p.push([k,k+S.length-1]),t.splice(k,2,S)}for(p.reverse(),v=-1;++v<p.length;)m[N+p[v][0]]=N+p[v][1],N+=p[v][1]-p[v][0]-1;return m}const h$={resolve:x$,tokenize:g$},f$={partial:!0,tokenize:v$};function x$(t){return oE(t),t}function g$(t,n){let r;return s;function s(d){return t.enter("content"),r=t.enter("chunkContent",{contentType:"content"}),i(d)}function i(d){return d===null?o(d):wt(d)?t.check(f$,c,o)(d):(t.consume(d),i)}function o(d){return t.exit("chunkContent"),t.exit("content"),n(d)}function c(d){return t.consume(d),t.exit("chunkContent"),r.next=t.enter("chunkContent",{contentType:"content",previous:r}),r=r.next,i}}function v$(t,n,r){const s=this;return i;function i(c){return t.exit("chunkContent"),t.enter("lineEnding"),t.consume(c),t.exit("lineEnding"),ln(t,o,"linePrefix")}function o(c){if(c===null||wt(c))return r(c);const d=s.events[s.events.length-1];return!s.parser.constructs.disable.null.includes("codeIndented")&&d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(c):t.interrupt(s.parser.constructs.flow,r,n)(c)}}function lE(t,n,r,s,i,o,c,d,p){const m=p||Number.POSITIVE_INFINITY;let h=0;return g;function g(S){return S===60?(t.enter(s),t.enter(i),t.enter(o),t.consume(S),t.exit(o),v):S===null||S===32||S===41||Px(S)?r(S):(t.enter(s),t.enter(c),t.enter(d),t.enter("chunkString",{contentType:"string"}),b(S))}function v(S){return S===62?(t.enter(o),t.consume(S),t.exit(o),t.exit(i),t.exit(s),n):(t.enter(d),t.enter("chunkString",{contentType:"string"}),j(S))}function j(S){return S===62?(t.exit("chunkString"),t.exit(d),v(S)):S===null||S===60||wt(S)?r(S):(t.consume(S),S===92?N:j)}function N(S){return S===60||S===62||S===92?(t.consume(S),j):j(S)}function b(S){return!h&&(S===null||S===41||Lr(S))?(t.exit("chunkString"),t.exit(d),t.exit(c),t.exit(s),n(S)):h<m&&S===40?(t.consume(S),h++,b):S===41?(t.consume(S),h--,b):S===null||S===32||S===40||Px(S)?r(S):(t.consume(S),S===92?C:b)}function C(S){return S===40||S===41||S===92?(t.consume(S),b):b(S)}}function cE(t,n,r,s,i,o){const c=this;let d=0,p;return m;function m(j){return t.enter(s),t.enter(i),t.consume(j),t.exit(i),t.enter(o),h}function h(j){return d>999||j===null||j===91||j===93&&!p||j===94&&!d&&"_hiddenFootnoteSupport"in c.parser.constructs?r(j):j===93?(t.exit(o),t.enter(i),t.consume(j),t.exit(i),t.exit(s),n):wt(j)?(t.enter("lineEnding"),t.consume(j),t.exit("lineEnding"),h):(t.enter("chunkString",{contentType:"string"}),g(j))}function g(j){return j===null||j===91||j===93||wt(j)||d++>999?(t.exit("chunkString"),h(j)):(t.consume(j),p||(p=!Wt(j)),j===92?v:g)}function v(j){return j===91||j===92||j===93?(t.consume(j),d++,g):g(j)}}function dE(t,n,r,s,i,o){let c;return d;function d(v){return v===34||v===39||v===40?(t.enter(s),t.enter(i),t.consume(v),t.exit(i),c=v===40?41:v,p):r(v)}function p(v){return v===c?(t.enter(i),t.consume(v),t.exit(i),t.exit(s),n):(t.enter(o),m(v))}function m(v){return v===c?(t.exit(o),p(c)):v===null?r(v):wt(v)?(t.enter("lineEnding"),t.consume(v),t.exit("lineEnding"),ln(t,m,"linePrefix")):(t.enter("chunkString",{contentType:"string"}),h(v))}function h(v){return v===c||v===null||wt(v)?(t.exit("chunkString"),m(v)):(t.consume(v),v===92?g:h)}function g(v){return v===c||v===92?(t.consume(v),h):h(v)}}function bc(t,n){let r;return s;function s(i){return wt(i)?(t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),r=!0,s):Wt(i)?ln(t,s,r?"linePrefix":"lineSuffix")(i):n(i)}}const y$={name:"definition",tokenize:b$},j$={partial:!0,tokenize:w$};function b$(t,n,r){const s=this;let i;return o;function o(j){return t.enter("definition"),c(j)}function c(j){return cE.call(s,t,d,r,"definitionLabel","definitionLabelMarker","definitionLabelString")(j)}function d(j){return i=Go(s.sliceSerialize(s.events[s.events.length-1][1]).slice(1,-1)),j===58?(t.enter("definitionMarker"),t.consume(j),t.exit("definitionMarker"),p):r(j)}function p(j){return Lr(j)?bc(t,m)(j):m(j)}function m(j){return lE(t,h,r,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(j)}function h(j){return t.attempt(j$,g,g)(j)}function g(j){return Wt(j)?ln(t,v,"whitespace")(j):v(j)}function v(j){return j===null||wt(j)?(t.exit("definition"),s.parser.defined.push(i),n(j)):r(j)}}function w$(t,n,r){return s;function s(d){return Lr(d)?bc(t,i)(d):r(d)}function i(d){return dE(t,o,r,"definitionTitle","definitionTitleMarker","definitionTitleString")(d)}function o(d){return Wt(d)?ln(t,c,"whitespace")(d):c(d)}function c(d){return d===null||wt(d)?n(d):r(d)}}const N$={name:"hardBreakEscape",tokenize:C$};function C$(t,n,r){return s;function s(o){return t.enter("hardBreakEscape"),t.consume(o),i}function i(o){return wt(o)?(t.exit("hardBreakEscape"),n(o)):r(o)}}const S$={name:"headingAtx",resolve:k$,tokenize:E$};function k$(t,n){let r=t.length-2,s=3,i,o;return t[s][1].type==="whitespace"&&(s+=2),r-2>s&&t[r][1].type==="whitespace"&&(r-=2),t[r][1].type==="atxHeadingSequence"&&(s===r-1||r-4>s&&t[r-2][1].type==="whitespace")&&(r-=s+1===r?2:4),r>s&&(i={type:"atxHeadingText",start:t[s][1].start,end:t[r][1].end},o={type:"chunkText",start:t[s][1].start,end:t[r][1].end,contentType:"text"},Ws(t,s,r-s+1,[["enter",i,n],["enter",o,n],["exit",o,n],["exit",i,n]])),t}function E$(t,n,r){let s=0;return i;function i(h){return t.enter("atxHeading"),o(h)}function o(h){return t.enter("atxHeadingSequence"),c(h)}function c(h){return h===35&&s++<6?(t.consume(h),c):h===null||Lr(h)?(t.exit("atxHeadingSequence"),d(h)):r(h)}function d(h){return h===35?(t.enter("atxHeadingSequence"),p(h)):h===null||wt(h)?(t.exit("atxHeading"),n(h)):Wt(h)?ln(t,d,"whitespace")(h):(t.enter("atxHeadingText"),m(h))}function p(h){return h===35?(t.consume(h),p):(t.exit("atxHeadingSequence"),d(h))}function m(h){return h===null||h===35||Lr(h)?(t.exit("atxHeadingText"),d(h)):(t.consume(h),m)}}const P$=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Bb=["pre","script","style","textarea"],T$={concrete:!0,name:"htmlFlow",resolveTo:_$,tokenize:I$},R$={partial:!0,tokenize:O$},A$={partial:!0,tokenize:M$};function _$(t){let n=t.length;for(;n--&&!(t[n][0]==="enter"&&t[n][1].type==="htmlFlow"););return n>1&&t[n-2][1].type==="linePrefix"&&(t[n][1].start=t[n-2][1].start,t[n+1][1].start=t[n-2][1].start,t.splice(n-2,2)),t}function I$(t,n,r){const s=this;let i,o,c,d,p;return m;function m(T){return h(T)}function h(T){return t.enter("htmlFlow"),t.enter("htmlFlowData"),t.consume(T),g}function g(T){return T===33?(t.consume(T),v):T===47?(t.consume(T),o=!0,b):T===63?(t.consume(T),i=3,s.interrupt?n:D):zs(T)?(t.consume(T),c=String.fromCharCode(T),C):r(T)}function v(T){return T===45?(t.consume(T),i=2,j):T===91?(t.consume(T),i=5,d=0,N):zs(T)?(t.consume(T),i=4,s.interrupt?n:D):r(T)}function j(T){return T===45?(t.consume(T),s.interrupt?n:D):r(T)}function N(T){const Y="CDATA[";return T===Y.charCodeAt(d++)?(t.consume(T),d===Y.length?s.interrupt?n:O:N):r(T)}function b(T){return zs(T)?(t.consume(T),c=String.fromCharCode(T),C):r(T)}function C(T){if(T===null||T===47||T===62||Lr(T)){const Y=T===47,oe=c.toLowerCase();return!Y&&!o&&Bb.includes(oe)?(i=1,s.interrupt?n(T):O(T)):P$.includes(c.toLowerCase())?(i=6,Y?(t.consume(T),S):s.interrupt?n(T):O(T)):(i=7,s.interrupt&&!s.parser.lazy[s.now().line]?r(T):o?k(T):P(T))}return T===45||Wr(T)?(t.consume(T),c+=String.fromCharCode(T),C):r(T)}function S(T){return T===62?(t.consume(T),s.interrupt?n:O):r(T)}function k(T){return Wt(T)?(t.consume(T),k):V(T)}function P(T){return T===47?(t.consume(T),V):T===58||T===95||zs(T)?(t.consume(T),R):Wt(T)?(t.consume(T),P):V(T)}function R(T){return T===45||T===46||T===58||T===95||Wr(T)?(t.consume(T),R):E(T)}function E(T){return T===61?(t.consume(T),A):Wt(T)?(t.consume(T),E):P(T)}function A(T){return T===null||T===60||T===61||T===62||T===96?r(T):T===34||T===39?(t.consume(T),p=T,W):Wt(T)?(t.consume(T),A):X(T)}function W(T){return T===p?(t.consume(T),p=null,se):T===null||wt(T)?r(T):(t.consume(T),W)}function X(T){return T===null||T===34||T===39||T===47||T===60||T===61||T===62||T===96||Lr(T)?E(T):(t.consume(T),X)}function se(T){return T===47||T===62||Wt(T)?P(T):r(T)}function V(T){return T===62?(t.consume(T),G):r(T)}function G(T){return T===null||wt(T)?O(T):Wt(T)?(t.consume(T),G):r(T)}function O(T){return T===45&&i===2?(t.consume(T),q):T===60&&i===1?(t.consume(T),le):T===62&&i===4?(t.consume(T),I):T===63&&i===3?(t.consume(T),D):T===93&&i===5?(t.consume(T),J):wt(T)&&(i===6||i===7)?(t.exit("htmlFlowData"),t.check(R$,re,F)(T)):T===null||wt(T)?(t.exit("htmlFlowData"),F(T)):(t.consume(T),O)}function F(T){return t.check(A$,U,re)(T)}function U(T){return t.enter("lineEnding"),t.consume(T),t.exit("lineEnding"),$}function $(T){return T===null||wt(T)?F(T):(t.enter("htmlFlowData"),O(T))}function q(T){return T===45?(t.consume(T),D):O(T)}function le(T){return T===47?(t.consume(T),c="",K):O(T)}function K(T){if(T===62){const Y=c.toLowerCase();return Bb.includes(Y)?(t.consume(T),I):O(T)}return zs(T)&&c.length<8?(t.consume(T),c+=String.fromCharCode(T),K):O(T)}function J(T){return T===93?(t.consume(T),D):O(T)}function D(T){return T===62?(t.consume(T),I):T===45&&i===2?(t.consume(T),D):O(T)}function I(T){return T===null||wt(T)?(t.exit("htmlFlowData"),re(T)):(t.consume(T),I)}function re(T){return t.exit("htmlFlow"),n(T)}}function M$(t,n,r){const s=this;return i;function i(c){return wt(c)?(t.enter("lineEnding"),t.consume(c),t.exit("lineEnding"),o):r(c)}function o(c){return s.parser.lazy[s.now().line]?r(c):n(c)}}function O$(t,n,r){return s;function s(i){return t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),t.attempt(om,n,r)}}const D$={name:"htmlText",tokenize:L$};function L$(t,n,r){const s=this;let i,o,c;return d;function d(D){return t.enter("htmlText"),t.enter("htmlTextData"),t.consume(D),p}function p(D){return D===33?(t.consume(D),m):D===47?(t.consume(D),E):D===63?(t.consume(D),P):zs(D)?(t.consume(D),X):r(D)}function m(D){return D===45?(t.consume(D),h):D===91?(t.consume(D),o=0,N):zs(D)?(t.consume(D),k):r(D)}function h(D){return D===45?(t.consume(D),j):r(D)}function g(D){return D===null?r(D):D===45?(t.consume(D),v):wt(D)?(c=g,le(D)):(t.consume(D),g)}function v(D){return D===45?(t.consume(D),j):g(D)}function j(D){return D===62?q(D):D===45?v(D):g(D)}function N(D){const I="CDATA[";return D===I.charCodeAt(o++)?(t.consume(D),o===I.length?b:N):r(D)}function b(D){return D===null?r(D):D===93?(t.consume(D),C):wt(D)?(c=b,le(D)):(t.consume(D),b)}function C(D){return D===93?(t.consume(D),S):b(D)}function S(D){return D===62?q(D):D===93?(t.consume(D),S):b(D)}function k(D){return D===null||D===62?q(D):wt(D)?(c=k,le(D)):(t.consume(D),k)}function P(D){return D===null?r(D):D===63?(t.consume(D),R):wt(D)?(c=P,le(D)):(t.consume(D),P)}function R(D){return D===62?q(D):P(D)}function E(D){return zs(D)?(t.consume(D),A):r(D)}function A(D){return D===45||Wr(D)?(t.consume(D),A):W(D)}function W(D){return wt(D)?(c=W,le(D)):Wt(D)?(t.consume(D),W):q(D)}function X(D){return D===45||Wr(D)?(t.consume(D),X):D===47||D===62||Lr(D)?se(D):r(D)}function se(D){return D===47?(t.consume(D),q):D===58||D===95||zs(D)?(t.consume(D),V):wt(D)?(c=se,le(D)):Wt(D)?(t.consume(D),se):q(D)}function V(D){return D===45||D===46||D===58||D===95||Wr(D)?(t.consume(D),V):G(D)}function G(D){return D===61?(t.consume(D),O):wt(D)?(c=G,le(D)):Wt(D)?(t.consume(D),G):se(D)}function O(D){return D===null||D===60||D===61||D===62||D===96?r(D):D===34||D===39?(t.consume(D),i=D,F):wt(D)?(c=O,le(D)):Wt(D)?(t.consume(D),O):(t.consume(D),U)}function F(D){return D===i?(t.consume(D),i=void 0,$):D===null?r(D):wt(D)?(c=F,le(D)):(t.consume(D),F)}function U(D){return D===null||D===34||D===39||D===60||D===61||D===96?r(D):D===47||D===62||Lr(D)?se(D):(t.consume(D),U)}function $(D){return D===47||D===62||Lr(D)?se(D):r(D)}function q(D){return D===62?(t.consume(D),t.exit("htmlTextData"),t.exit("htmlText"),n):r(D)}function le(D){return t.exit("htmlTextData"),t.enter("lineEnding"),t.consume(D),t.exit("lineEnding"),K}function K(D){return Wt(D)?ln(t,J,"linePrefix",s.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(D):J(D)}function J(D){return t.enter("htmlTextData"),c(D)}}const Ev={name:"labelEnd",resolveAll:V$,resolveTo:q$,tokenize:U$},F$={tokenize:B$},$$={tokenize:G$},z$={tokenize:H$};function V$(t){let n=-1;const r=[];for(;++n<t.length;){const s=t[n][1];if(r.push(t[n]),s.type==="labelImage"||s.type==="labelLink"||s.type==="labelEnd"){const i=s.type==="labelImage"?4:2;s.type="data",n+=i}}return t.length!==r.length&&Ws(t,0,t.length,r),t}function q$(t,n){let r=t.length,s=0,i,o,c,d;for(;r--;)if(i=t[r][1],o){if(i.type==="link"||i.type==="labelLink"&&i._inactive)break;t[r][0]==="enter"&&i.type==="labelLink"&&(i._inactive=!0)}else if(c){if(t[r][0]==="enter"&&(i.type==="labelImage"||i.type==="labelLink")&&!i._balanced&&(o=r,i.type!=="labelLink")){s=2;break}}else i.type==="labelEnd"&&(c=r);const p={type:t[o][1].type==="labelLink"?"link":"image",start:{...t[o][1].start},end:{...t[t.length-1][1].end}},m={type:"label",start:{...t[o][1].start},end:{...t[c][1].end}},h={type:"labelText",start:{...t[o+s+2][1].end},end:{...t[c-2][1].start}};return d=[["enter",p,n],["enter",m,n]],d=cs(d,t.slice(o+1,o+s+3)),d=cs(d,[["enter",h,n]]),d=cs(d,kv(n.parser.constructs.insideSpan.null,t.slice(o+s+4,c-3),n)),d=cs(d,[["exit",h,n],t[c-2],t[c-1],["exit",m,n]]),d=cs(d,t.slice(c+1)),d=cs(d,[["exit",p,n]]),Ws(t,o,t.length,d),t}function U$(t,n,r){const s=this;let i=s.events.length,o,c;for(;i--;)if((s.events[i][1].type==="labelImage"||s.events[i][1].type==="labelLink")&&!s.events[i][1]._balanced){o=s.events[i][1];break}return d;function d(v){return o?o._inactive?g(v):(c=s.parser.defined.includes(Go(s.sliceSerialize({start:o.end,end:s.now()}))),t.enter("labelEnd"),t.enter("labelMarker"),t.consume(v),t.exit("labelMarker"),t.exit("labelEnd"),p):r(v)}function p(v){return v===40?t.attempt(F$,h,c?h:g)(v):v===91?t.attempt($$,h,c?m:g)(v):c?h(v):g(v)}function m(v){return t.attempt(z$,h,g)(v)}function h(v){return n(v)}function g(v){return o._balanced=!0,r(v)}}function B$(t,n,r){return s;function s(g){return t.enter("resource"),t.enter("resourceMarker"),t.consume(g),t.exit("resourceMarker"),i}function i(g){return Lr(g)?bc(t,o)(g):o(g)}function o(g){return g===41?h(g):lE(t,c,d,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function c(g){return Lr(g)?bc(t,p)(g):h(g)}function d(g){return r(g)}function p(g){return g===34||g===39||g===40?dE(t,m,r,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):h(g)}function m(g){return Lr(g)?bc(t,h)(g):h(g)}function h(g){return g===41?(t.enter("resourceMarker"),t.consume(g),t.exit("resourceMarker"),t.exit("resource"),n):r(g)}}function G$(t,n,r){const s=this;return i;function i(d){return cE.call(s,t,o,c,"reference","referenceMarker","referenceString")(d)}function o(d){return s.parser.defined.includes(Go(s.sliceSerialize(s.events[s.events.length-1][1]).slice(1,-1)))?n(d):r(d)}function c(d){return r(d)}}function H$(t,n,r){return s;function s(o){return t.enter("reference"),t.enter("referenceMarker"),t.consume(o),t.exit("referenceMarker"),i}function i(o){return o===93?(t.enter("referenceMarker"),t.consume(o),t.exit("referenceMarker"),t.exit("reference"),n):r(o)}}const K$={name:"labelStartImage",resolveAll:Ev.resolveAll,tokenize:W$};function W$(t,n,r){const s=this;return i;function i(d){return t.enter("labelImage"),t.enter("labelImageMarker"),t.consume(d),t.exit("labelImageMarker"),o}function o(d){return d===91?(t.enter("labelMarker"),t.consume(d),t.exit("labelMarker"),t.exit("labelImage"),c):r(d)}function c(d){return d===94&&"_hiddenFootnoteSupport"in s.parser.constructs?r(d):n(d)}}const Q$={name:"labelStartLink",resolveAll:Ev.resolveAll,tokenize:Y$};function Y$(t,n,r){const s=this;return i;function i(c){return t.enter("labelLink"),t.enter("labelMarker"),t.consume(c),t.exit("labelMarker"),t.exit("labelLink"),o}function o(c){return c===94&&"_hiddenFootnoteSupport"in s.parser.constructs?r(c):n(c)}}const If={name:"lineEnding",tokenize:Z$};function Z$(t,n){return r;function r(s){return t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),ln(t,n,"linePrefix")}}const Lu={name:"thematicBreak",tokenize:X$};function X$(t,n,r){let s=0,i;return o;function o(m){return t.enter("thematicBreak"),c(m)}function c(m){return i=m,d(m)}function d(m){return m===i?(t.enter("thematicBreakSequence"),p(m)):s>=3&&(m===null||wt(m))?(t.exit("thematicBreak"),n(m)):r(m)}function p(m){return m===i?(t.consume(m),s++,p):(t.exit("thematicBreakSequence"),Wt(m)?ln(t,d,"whitespace")(m):d(m))}}const _r={continuation:{tokenize:n6},exit:s6,name:"list",tokenize:t6},J$={partial:!0,tokenize:a6},e6={partial:!0,tokenize:r6};function t6(t,n,r){const s=this,i=s.events[s.events.length-1];let o=i&&i[1].type==="linePrefix"?i[2].sliceSerialize(i[1],!0).length:0,c=0;return d;function d(j){const N=s.containerState.type||(j===42||j===43||j===45?"listUnordered":"listOrdered");if(N==="listUnordered"?!s.containerState.marker||j===s.containerState.marker:Tx(j)){if(s.containerState.type||(s.containerState.type=N,t.enter(N,{_container:!0})),N==="listUnordered")return t.enter("listItemPrefix"),j===42||j===45?t.check(Lu,r,m)(j):m(j);if(!s.interrupt||j===49)return t.enter("listItemPrefix"),t.enter("listItemValue"),p(j)}return r(j)}function p(j){return Tx(j)&&++c<10?(t.consume(j),p):(!s.interrupt||c<2)&&(s.containerState.marker?j===s.containerState.marker:j===41||j===46)?(t.exit("listItemValue"),m(j)):r(j)}function m(j){return t.enter("listItemMarker"),t.consume(j),t.exit("listItemMarker"),s.containerState.marker=s.containerState.marker||j,t.check(om,s.interrupt?r:h,t.attempt(J$,v,g))}function h(j){return s.containerState.initialBlankLine=!0,o++,v(j)}function g(j){return Wt(j)?(t.enter("listItemPrefixWhitespace"),t.consume(j),t.exit("listItemPrefixWhitespace"),v):r(j)}function v(j){return s.containerState.size=o+s.sliceSerialize(t.exit("listItemPrefix"),!0).length,n(j)}}function n6(t,n,r){const s=this;return s.containerState._closeFlow=void 0,t.check(om,i,o);function i(d){return s.containerState.furtherBlankLines=s.containerState.furtherBlankLines||s.containerState.initialBlankLine,ln(t,n,"listItemIndent",s.containerState.size+1)(d)}function o(d){return s.containerState.furtherBlankLines||!Wt(d)?(s.containerState.furtherBlankLines=void 0,s.containerState.initialBlankLine=void 0,c(d)):(s.containerState.furtherBlankLines=void 0,s.containerState.initialBlankLine=void 0,t.attempt(e6,n,c)(d))}function c(d){return s.containerState._closeFlow=!0,s.interrupt=void 0,ln(t,t.attempt(_r,n,r),"linePrefix",s.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(d)}}function r6(t,n,r){const s=this;return ln(t,i,"listItemIndent",s.containerState.size+1);function i(o){const c=s.events[s.events.length-1];return c&&c[1].type==="listItemIndent"&&c[2].sliceSerialize(c[1],!0).length===s.containerState.size?n(o):r(o)}}function s6(t){t.exit(this.containerState.type)}function a6(t,n,r){const s=this;return ln(t,i,"listItemPrefixWhitespace",s.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function i(o){const c=s.events[s.events.length-1];return!Wt(o)&&c&&c[1].type==="listItemPrefixWhitespace"?n(o):r(o)}}const Gb={name:"setextUnderline",resolveTo:i6,tokenize:o6};function i6(t,n){let r=t.length,s,i,o;for(;r--;)if(t[r][0]==="enter"){if(t[r][1].type==="content"){s=r;break}t[r][1].type==="paragraph"&&(i=r)}else t[r][1].type==="content"&&t.splice(r,1),!o&&t[r][1].type==="definition"&&(o=r);const c={type:"setextHeading",start:{...t[s][1].start},end:{...t[t.length-1][1].end}};return t[i][1].type="setextHeadingText",o?(t.splice(i,0,["enter",c,n]),t.splice(o+1,0,["exit",t[s][1],n]),t[s][1].end={...t[o][1].end}):t[s][1]=c,t.push(["exit",c,n]),t}function o6(t,n,r){const s=this;let i;return o;function o(m){let h=s.events.length,g;for(;h--;)if(s.events[h][1].type!=="lineEnding"&&s.events[h][1].type!=="linePrefix"&&s.events[h][1].type!=="content"){g=s.events[h][1].type==="paragraph";break}return!s.parser.lazy[s.now().line]&&(s.interrupt||g)?(t.enter("setextHeadingLine"),i=m,c(m)):r(m)}function c(m){return t.enter("setextHeadingLineSequence"),d(m)}function d(m){return m===i?(t.consume(m),d):(t.exit("setextHeadingLineSequence"),Wt(m)?ln(t,p,"lineSuffix")(m):p(m))}function p(m){return m===null||wt(m)?(t.exit("setextHeadingLine"),n(m)):r(m)}}const l6={tokenize:c6};function c6(t){const n=this,r=t.attempt(om,s,t.attempt(this.parser.constructs.flowInitial,i,ln(t,t.attempt(this.parser.constructs.flow,i,t.attempt(h$,i)),"linePrefix")));return r;function s(o){if(o===null){t.consume(o);return}return t.enter("lineEndingBlank"),t.consume(o),t.exit("lineEndingBlank"),n.currentConstruct=void 0,r}function i(o){if(o===null){t.consume(o);return}return t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),n.currentConstruct=void 0,r}}const d6={resolveAll:pE()},u6=uE("string"),p6=uE("text");function uE(t){return{resolveAll:pE(t==="text"?m6:void 0),tokenize:n};function n(r){const s=this,i=this.parser.constructs[t],o=r.attempt(i,c,d);return c;function c(h){return m(h)?o(h):d(h)}function d(h){if(h===null){r.consume(h);return}return r.enter("data"),r.consume(h),p}function p(h){return m(h)?(r.exit("data"),o(h)):(r.consume(h),p)}function m(h){if(h===null)return!0;const g=i[h];let v=-1;if(g)for(;++v<g.length;){const j=g[v];if(!j.previous||j.previous.call(s,s.previous))return!0}return!1}}}function pE(t){return n;function n(r,s){let i=-1,o;for(;++i<=r.length;)o===void 0?r[i]&&r[i][1].type==="data"&&(o=i,i++):(!r[i]||r[i][1].type!=="data")&&(i!==o+2&&(r[o][1].end=r[i-1][1].end,r.splice(o+2,i-o-2),i=o+2),o=void 0);return t?t(r,s):r}}function m6(t,n){let r=0;for(;++r<=t.length;)if((r===t.length||t[r][1].type==="lineEnding")&&t[r-1][1].type==="data"){const s=t[r-1][1],i=n.sliceStream(s);let o=i.length,c=-1,d=0,p;for(;o--;){const m=i[o];if(typeof m=="string"){for(c=m.length;m.charCodeAt(c-1)===32;)d++,c--;if(c)break;c=-1}else if(m===-2)p=!0,d++;else if(m!==-1){o++;break}}if(n._contentTypeTextTrailing&&r===t.length&&(d=0),d){const m={type:r===t.length||p||d<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?c:s.start._bufferIndex+c,_index:s.start._index+o,line:s.end.line,column:s.end.column-d,offset:s.end.offset-d},end:{...s.end}};s.end={...m.start},s.start.offset===s.end.offset?Object.assign(s,m):(t.splice(r,0,["enter",m,n],["exit",m,n]),r+=2)}r++}return t}const h6={42:_r,43:_r,45:_r,48:_r,49:_r,50:_r,51:_r,52:_r,53:_r,54:_r,55:_r,56:_r,57:_r,62:sE},f6={91:y$},x6={[-2]:_f,[-1]:_f,32:_f},g6={35:S$,42:Lu,45:[Gb,Lu],60:T$,61:Gb,95:Lu,96:Ub,126:Ub},v6={38:iE,92:aE},y6={[-5]:If,[-4]:If,[-3]:If,33:K$,38:iE,42:Rx,60:[QF,D$],91:Q$,92:[N$,aE],93:Ev,95:Rx,96:l$},j6={null:[Rx,d6]},b6={null:[42,95]},w6={null:[]},N6=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:b6,contentInitial:f6,disable:w6,document:h6,flow:g6,flowInitial:x6,insideSpan:j6,string:v6,text:y6},Symbol.toStringTag,{value:"Module"}));function C6(t,n,r){let s={_bufferIndex:-1,_index:0,line:r&&r.line||1,column:r&&r.column||1,offset:r&&r.offset||0};const i={},o=[];let c=[],d=[];const p={attempt:W(E),check:W(A),consume:k,enter:P,exit:R,interrupt:W(A,{interrupt:!0})},m={code:null,containerState:{},defineSkip:b,events:[],now:N,parser:t,previous:null,sliceSerialize:v,sliceStream:j,write:g};let h=n.tokenize.call(m,p);return n.resolveAll&&o.push(n),m;function g(G){return c=cs(c,G),C(),c[c.length-1]!==null?[]:(X(n,0),m.events=kv(o,m.events,m),m.events)}function v(G,O){return k6(j(G),O)}function j(G){return S6(c,G)}function N(){const{_bufferIndex:G,_index:O,line:F,column:U,offset:$}=s;return{_bufferIndex:G,_index:O,line:F,column:U,offset:$}}function b(G){i[G.line]=G.column,V()}function C(){let G;for(;s._index<c.length;){const O=c[s._index];if(typeof O=="string")for(G=s._index,s._bufferIndex<0&&(s._bufferIndex=0);s._index===G&&s._bufferIndex<O.length;)S(O.charCodeAt(s._bufferIndex));else S(O)}}function S(G){h=h(G)}function k(G){wt(G)?(s.line++,s.column=1,s.offset+=G===-3?2:1,V()):G!==-1&&(s.column++,s.offset++),s._bufferIndex<0?s._index++:(s._bufferIndex++,s._bufferIndex===c[s._index].length&&(s._bufferIndex=-1,s._index++)),m.previous=G}function P(G,O){const F=O||{};return F.type=G,F.start=N(),m.events.push(["enter",F,m]),d.push(F),F}function R(G){const O=d.pop();return O.end=N(),m.events.push(["exit",O,m]),O}function E(G,O){X(G,O.from)}function A(G,O){O.restore()}function W(G,O){return F;function F(U,$,q){let le,K,J,D;return Array.isArray(U)?re(U):"tokenize"in U?re([U]):I(U);function I(Ne){return xe;function xe(Se){const Oe=Se!==null&&Ne[Se],Pe=Se!==null&&Ne.null,Be=[...Array.isArray(Oe)?Oe:Oe?[Oe]:[],...Array.isArray(Pe)?Pe:Pe?[Pe]:[]];return re(Be)(Se)}}function re(Ne){return le=Ne,K=0,Ne.length===0?q:T(Ne[K])}function T(Ne){return xe;function xe(Se){return D=se(),J=Ne,Ne.partial||(m.currentConstruct=Ne),Ne.name&&m.parser.constructs.disable.null.includes(Ne.name)?oe():Ne.tokenize.call(O?Object.assign(Object.create(m),O):m,p,Y,oe)(Se)}}function Y(Ne){return G(J,D),$}function oe(Ne){return D.restore(),++K<le.length?T(le[K]):q}}}function X(G,O){G.resolveAll&&!o.includes(G)&&o.push(G),G.resolve&&Ws(m.events,O,m.events.length-O,G.resolve(m.events.slice(O),m)),G.resolveTo&&(m.events=G.resolveTo(m.events,m))}function se(){const G=N(),O=m.previous,F=m.currentConstruct,U=m.events.length,$=Array.from(d);return{from:U,restore:q};function q(){s=G,m.previous=O,m.currentConstruct=F,m.events.length=U,d=$,V()}}function V(){s.line in i&&s.column<2&&(s.column=i[s.line],s.offset+=i[s.line]-1)}}function S6(t,n){const r=n.start._index,s=n.start._bufferIndex,i=n.end._index,o=n.end._bufferIndex;let c;if(r===i)c=[t[r].slice(s,o)];else{if(c=t.slice(r,i),s>-1){const d=c[0];typeof d=="string"?c[0]=d.slice(s):c.shift()}o>0&&c.push(t[i].slice(0,o))}return c}function k6(t,n){let r=-1;const s=[];let i;for(;++r<t.length;){const o=t[r];let c;if(typeof o=="string")c=o;else switch(o){case-5:{c="\r";break}case-4:{c=`
`;break}case-3:{c=`\r
`;break}case-2:{c=n?" ":"	";break}case-1:{if(!n&&i)continue;c=" ";break}default:c=String.fromCharCode(o)}i=o===-2,s.push(c)}return s.join("")}function E6(t){const s={constructs:MF([N6,...(t||{}).extensions||[]]),content:i(qF),defined:[],document:i(BF),flow:i(l6),lazy:{},string:i(u6),text:i(p6)};return s;function i(o){return c;function c(d){return C6(s,o,d)}}}function P6(t){for(;!oE(t););return t}const Hb=/[\0\t\n\r]/g;function T6(){let t=1,n="",r=!0,s;return i;function i(o,c,d){const p=[];let m,h,g,v,j;for(o=n+(typeof o=="string"?o.toString():new TextDecoder(c||void 0).decode(o)),g=0,n="",r&&(o.charCodeAt(0)===65279&&g++,r=void 0);g<o.length;){if(Hb.lastIndex=g,m=Hb.exec(o),v=m&&m.index!==void 0?m.index:o.length,j=o.charCodeAt(v),!m){n=o.slice(g);break}if(j===10&&g===v&&s)p.push(-3),s=void 0;else switch(s&&(p.push(-5),s=void 0),g<v&&(p.push(o.slice(g,v)),t+=v-g),j){case 0:{p.push(65533),t++;break}case 9:{for(h=Math.ceil(t/4)*4,p.push(-2);t++<h;)p.push(-1);break}case 10:{p.push(-4),t=1;break}default:s=!0,t=1}g=v+1}return d&&(s&&p.push(-5),n&&p.push(n),p.push(null)),p}}const R6=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function A6(t){return t.replace(R6,_6)}function _6(t,n,r){if(n)return n;if(r.charCodeAt(0)===35){const i=r.charCodeAt(1),o=i===120||i===88;return rE(r.slice(o?2:1),o?16:10)}return Sv(r)||t}const mE={}.hasOwnProperty;function I6(t,n,r){return typeof n!="string"&&(r=n,n=void 0),M6(r)(P6(E6(r).document().write(T6()(t,n,!0))))}function M6(t){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(Jt),autolinkProtocol:se,autolinkEmail:se,atxHeading:o(Qe),blockQuote:o(Pe),characterEscape:se,characterReference:se,codeFenced:o(Be),codeFencedFenceInfo:c,codeFencedFenceMeta:c,codeIndented:o(Be,c),codeText:o(ve,c),codeTextData:se,data:se,codeFlowValue:se,definition:o(We),definitionDestinationString:c,definitionLabelString:c,definitionTitleString:c,emphasis:o(Ye),hardBreakEscape:o(mt),hardBreakTrailing:o(mt),htmlFlow:o(ht,c),htmlFlowData:se,htmlText:o(ht,c),htmlTextData:se,image:o(cn),label:c,link:o(Jt),listItem:o(tt),listItemValue:v,listOrdered:o(Vt,g),listUnordered:o(Vt),paragraph:o(L),reference:T,referenceString:c,resourceDestinationString:c,resourceTitleString:c,setextHeading:o(Qe),strong:o(de),thematicBreak:o(ze)},exit:{atxHeading:p(),atxHeadingSequence:E,autolink:p(),autolinkEmail:Oe,autolinkProtocol:Se,blockQuote:p(),characterEscapeValue:V,characterReferenceMarkerHexadecimal:oe,characterReferenceMarkerNumeric:oe,characterReferenceValue:Ne,characterReference:xe,codeFenced:p(C),codeFencedFence:b,codeFencedFenceInfo:j,codeFencedFenceMeta:N,codeFlowValue:V,codeIndented:p(S),codeText:p($),codeTextData:V,data:V,definition:p(),definitionDestinationString:R,definitionLabelString:k,definitionTitleString:P,emphasis:p(),hardBreakEscape:p(O),hardBreakTrailing:p(O),htmlFlow:p(F),htmlFlowData:V,htmlText:p(U),htmlTextData:V,image:p(le),label:J,labelText:K,lineEnding:G,link:p(q),listItem:p(),listOrdered:p(),listUnordered:p(),paragraph:p(),referenceString:Y,resourceDestinationString:D,resourceTitleString:I,resource:re,setextHeading:p(X),setextHeadingLineSequence:W,setextHeadingText:A,strong:p(),thematicBreak:p()}};hE(n,(t||{}).mdastExtensions||[]);const r={};return s;function s(M){let ie={type:"root",children:[]};const we={stack:[ie],tokenStack:[],config:n,enter:d,exit:m,buffer:c,resume:h,data:r},qe=[];let Ze=-1;for(;++Ze<M.length;)if(M[Ze][1].type==="listOrdered"||M[Ze][1].type==="listUnordered")if(M[Ze][0]==="enter")qe.push(Ze);else{const Rt=qe.pop();Ze=i(M,Rt,Ze)}for(Ze=-1;++Ze<M.length;){const Rt=n[M[Ze][0]];mE.call(Rt,M[Ze][1].type)&&Rt[M[Ze][1].type].call(Object.assign({sliceSerialize:M[Ze][2].sliceSerialize},we),M[Ze][1])}if(we.tokenStack.length>0){const Rt=we.tokenStack[we.tokenStack.length-1];(Rt[1]||Kb).call(we,void 0,Rt[0])}for(ie.position={start:Ha(M.length>0?M[0][1].start:{line:1,column:1,offset:0}),end:Ha(M.length>0?M[M.length-2][1].end:{line:1,column:1,offset:0})},Ze=-1;++Ze<n.transforms.length;)ie=n.transforms[Ze](ie)||ie;return ie}function i(M,ie,we){let qe=ie-1,Ze=-1,Rt=!1,en,Lt,An,Hn;for(;++qe<=we;){const tn=M[qe];switch(tn[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{tn[0]==="enter"?Ze++:Ze--,Hn=void 0;break}case"lineEndingBlank":{tn[0]==="enter"&&(en&&!Hn&&!Ze&&!An&&(An=qe),Hn=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Hn=void 0}if(!Ze&&tn[0]==="enter"&&tn[1].type==="listItemPrefix"||Ze===-1&&tn[0]==="exit"&&(tn[1].type==="listUnordered"||tn[1].type==="listOrdered")){if(en){let Sn=qe;for(Lt=void 0;Sn--;){const hn=M[Sn];if(hn[1].type==="lineEnding"||hn[1].type==="lineEndingBlank"){if(hn[0]==="exit")continue;Lt&&(M[Lt][1].type="lineEndingBlank",Rt=!0),hn[1].type="lineEnding",Lt=Sn}else if(!(hn[1].type==="linePrefix"||hn[1].type==="blockQuotePrefix"||hn[1].type==="blockQuotePrefixWhitespace"||hn[1].type==="blockQuoteMarker"||hn[1].type==="listItemIndent"))break}An&&(!Lt||An<Lt)&&(en._spread=!0),en.end=Object.assign({},Lt?M[Lt][1].start:tn[1].end),M.splice(Lt||qe,0,["exit",en,tn[2]]),qe++,we++}if(tn[1].type==="listItemPrefix"){const Sn={type:"listItem",_spread:!1,start:Object.assign({},tn[1].start),end:void 0};en=Sn,M.splice(qe,0,["enter",Sn,tn[2]]),qe++,we++,An=void 0,Hn=!0}}}return M[ie][1]._spread=Rt,we}function o(M,ie){return we;function we(qe){d.call(this,M(qe),qe),ie&&ie.call(this,qe)}}function c(){this.stack.push({type:"fragment",children:[]})}function d(M,ie,we){this.stack[this.stack.length-1].children.push(M),this.stack.push(M),this.tokenStack.push([ie,we||void 0]),M.position={start:Ha(ie.start),end:void 0}}function p(M){return ie;function ie(we){M&&M.call(this,we),m.call(this,we)}}function m(M,ie){const we=this.stack.pop(),qe=this.tokenStack.pop();if(qe)qe[0].type!==M.type&&(ie?ie.call(this,M,qe[0]):(qe[1]||Kb).call(this,M,qe[0]));else throw new Error("Cannot close `"+M.type+"` ("+jc({start:M.start,end:M.end})+"): its not open");we.position.end=Ha(M.end)}function h(){return _F(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function v(M){if(this.data.expectingFirstListItemValue){const ie=this.stack[this.stack.length-2];ie.start=Number.parseInt(this.sliceSerialize(M),10),this.data.expectingFirstListItemValue=void 0}}function j(){const M=this.resume(),ie=this.stack[this.stack.length-1];ie.lang=M}function N(){const M=this.resume(),ie=this.stack[this.stack.length-1];ie.meta=M}function b(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function C(){const M=this.resume(),ie=this.stack[this.stack.length-1];ie.value=M.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function S(){const M=this.resume(),ie=this.stack[this.stack.length-1];ie.value=M.replace(/(\r?\n|\r)$/g,"")}function k(M){const ie=this.resume(),we=this.stack[this.stack.length-1];we.label=ie,we.identifier=Go(this.sliceSerialize(M)).toLowerCase()}function P(){const M=this.resume(),ie=this.stack[this.stack.length-1];ie.title=M}function R(){const M=this.resume(),ie=this.stack[this.stack.length-1];ie.url=M}function E(M){const ie=this.stack[this.stack.length-1];if(!ie.depth){const we=this.sliceSerialize(M).length;ie.depth=we}}function A(){this.data.setextHeadingSlurpLineEnding=!0}function W(M){const ie=this.stack[this.stack.length-1];ie.depth=this.sliceSerialize(M).codePointAt(0)===61?1:2}function X(){this.data.setextHeadingSlurpLineEnding=void 0}function se(M){const we=this.stack[this.stack.length-1].children;let qe=we[we.length-1];(!qe||qe.type!=="text")&&(qe=ge(),qe.position={start:Ha(M.start),end:void 0},we.push(qe)),this.stack.push(qe)}function V(M){const ie=this.stack.pop();ie.value+=this.sliceSerialize(M),ie.position.end=Ha(M.end)}function G(M){const ie=this.stack[this.stack.length-1];if(this.data.atHardBreak){const we=ie.children[ie.children.length-1];we.position.end=Ha(M.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(ie.type)&&(se.call(this,M),V.call(this,M))}function O(){this.data.atHardBreak=!0}function F(){const M=this.resume(),ie=this.stack[this.stack.length-1];ie.value=M}function U(){const M=this.resume(),ie=this.stack[this.stack.length-1];ie.value=M}function $(){const M=this.resume(),ie=this.stack[this.stack.length-1];ie.value=M}function q(){const M=this.stack[this.stack.length-1];if(this.data.inReference){const ie=this.data.referenceType||"shortcut";M.type+="Reference",M.referenceType=ie,delete M.url,delete M.title}else delete M.identifier,delete M.label;this.data.referenceType=void 0}function le(){const M=this.stack[this.stack.length-1];if(this.data.inReference){const ie=this.data.referenceType||"shortcut";M.type+="Reference",M.referenceType=ie,delete M.url,delete M.title}else delete M.identifier,delete M.label;this.data.referenceType=void 0}function K(M){const ie=this.sliceSerialize(M),we=this.stack[this.stack.length-2];we.label=A6(ie),we.identifier=Go(ie).toLowerCase()}function J(){const M=this.stack[this.stack.length-1],ie=this.resume(),we=this.stack[this.stack.length-1];if(this.data.inReference=!0,we.type==="link"){const qe=M.children;we.children=qe}else we.alt=ie}function D(){const M=this.resume(),ie=this.stack[this.stack.length-1];ie.url=M}function I(){const M=this.resume(),ie=this.stack[this.stack.length-1];ie.title=M}function re(){this.data.inReference=void 0}function T(){this.data.referenceType="collapsed"}function Y(M){const ie=this.resume(),we=this.stack[this.stack.length-1];we.label=ie,we.identifier=Go(this.sliceSerialize(M)).toLowerCase(),this.data.referenceType="full"}function oe(M){this.data.characterReferenceType=M.type}function Ne(M){const ie=this.sliceSerialize(M),we=this.data.characterReferenceType;let qe;we?(qe=rE(ie,we==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):qe=Sv(ie);const Ze=this.stack[this.stack.length-1];Ze.value+=qe}function xe(M){const ie=this.stack.pop();ie.position.end=Ha(M.end)}function Se(M){V.call(this,M);const ie=this.stack[this.stack.length-1];ie.url=this.sliceSerialize(M)}function Oe(M){V.call(this,M);const ie=this.stack[this.stack.length-1];ie.url="mailto:"+this.sliceSerialize(M)}function Pe(){return{type:"blockquote",children:[]}}function Be(){return{type:"code",lang:null,meta:null,value:""}}function ve(){return{type:"inlineCode",value:""}}function We(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Ye(){return{type:"emphasis",children:[]}}function Qe(){return{type:"heading",depth:0,children:[]}}function mt(){return{type:"break"}}function ht(){return{type:"html",value:""}}function cn(){return{type:"image",title:null,url:"",alt:null}}function Jt(){return{type:"link",title:null,url:"",children:[]}}function Vt(M){return{type:"list",ordered:M.type==="listOrdered",start:null,spread:M._spread,children:[]}}function tt(M){return{type:"listItem",spread:M._spread,checked:null,children:[]}}function L(){return{type:"paragraph",children:[]}}function de(){return{type:"strong",children:[]}}function ge(){return{type:"text",value:""}}function ze(){return{type:"thematicBreak"}}}function Ha(t){return{line:t.line,column:t.column,offset:t.offset}}function hE(t,n){let r=-1;for(;++r<n.length;){const s=n[r];Array.isArray(s)?hE(t,s):O6(t,s)}}function O6(t,n){let r;for(r in n)if(mE.call(n,r))switch(r){case"canContainEols":{const s=n[r];s&&t[r].push(...s);break}case"transforms":{const s=n[r];s&&t[r].push(...s);break}case"enter":case"exit":{const s=n[r];s&&Object.assign(t[r],s);break}}}function Kb(t,n){throw t?new Error("Cannot close `"+t.type+"` ("+jc({start:t.start,end:t.end})+"): a different token (`"+n.type+"`, "+jc({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+jc({start:n.start,end:n.end})+") is still open")}function D6(t){const n=this;n.parser=r;function r(s){return I6(s,{...n.data("settings"),...t,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}function L6(t,n){const r={type:"element",tagName:"blockquote",properties:{},children:t.wrap(t.all(n),!0)};return t.patch(n,r),t.applyData(n,r)}function F6(t,n){const r={type:"element",tagName:"br",properties:{},children:[]};return t.patch(n,r),[t.applyData(n,r),{type:"text",value:`
`}]}function $6(t,n){const r=n.value?n.value+`
`:"",s={},i=n.lang?n.lang.split(/\s+/):[];i.length>0&&(s.className=["language-"+i[0]]);let o={type:"element",tagName:"code",properties:s,children:[{type:"text",value:r}]};return n.meta&&(o.data={meta:n.meta}),t.patch(n,o),o=t.applyData(n,o),o={type:"element",tagName:"pre",properties:{},children:[o]},t.patch(n,o),o}function z6(t,n){const r={type:"element",tagName:"del",properties:{},children:t.all(n)};return t.patch(n,r),t.applyData(n,r)}function V6(t,n){const r={type:"element",tagName:"em",properties:{},children:t.all(n)};return t.patch(n,r),t.applyData(n,r)}function q6(t,n){const r=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",s=String(n.identifier).toUpperCase(),i=yl(s.toLowerCase()),o=t.footnoteOrder.indexOf(s);let c,d=t.footnoteCounts.get(s);d===void 0?(d=0,t.footnoteOrder.push(s),c=t.footnoteOrder.length):c=o+1,d+=1,t.footnoteCounts.set(s,d);const p={type:"element",tagName:"a",properties:{href:"#"+r+"fn-"+i,id:r+"fnref-"+i+(d>1?"-"+d:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(c)}]};t.patch(n,p);const m={type:"element",tagName:"sup",properties:{},children:[p]};return t.patch(n,m),t.applyData(n,m)}function U6(t,n){const r={type:"element",tagName:"h"+n.depth,properties:{},children:t.all(n)};return t.patch(n,r),t.applyData(n,r)}function B6(t,n){if(t.options.allowDangerousHtml){const r={type:"raw",value:n.value};return t.patch(n,r),t.applyData(n,r)}}function fE(t,n){const r=n.referenceType;let s="]";if(r==="collapsed"?s+="[]":r==="full"&&(s+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+s}];const i=t.all(n),o=i[0];o&&o.type==="text"?o.value="["+o.value:i.unshift({type:"text",value:"["});const c=i[i.length-1];return c&&c.type==="text"?c.value+=s:i.push({type:"text",value:s}),i}function G6(t,n){const r=String(n.identifier).toUpperCase(),s=t.definitionById.get(r);if(!s)return fE(t,n);const i={src:yl(s.url||""),alt:n.alt};s.title!==null&&s.title!==void 0&&(i.title=s.title);const o={type:"element",tagName:"img",properties:i,children:[]};return t.patch(n,o),t.applyData(n,o)}function H6(t,n){const r={src:yl(n.url)};n.alt!==null&&n.alt!==void 0&&(r.alt=n.alt),n.title!==null&&n.title!==void 0&&(r.title=n.title);const s={type:"element",tagName:"img",properties:r,children:[]};return t.patch(n,s),t.applyData(n,s)}function K6(t,n){const r={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};t.patch(n,r);const s={type:"element",tagName:"code",properties:{},children:[r]};return t.patch(n,s),t.applyData(n,s)}function W6(t,n){const r=String(n.identifier).toUpperCase(),s=t.definitionById.get(r);if(!s)return fE(t,n);const i={href:yl(s.url||"")};s.title!==null&&s.title!==void 0&&(i.title=s.title);const o={type:"element",tagName:"a",properties:i,children:t.all(n)};return t.patch(n,o),t.applyData(n,o)}function Q6(t,n){const r={href:yl(n.url)};n.title!==null&&n.title!==void 0&&(r.title=n.title);const s={type:"element",tagName:"a",properties:r,children:t.all(n)};return t.patch(n,s),t.applyData(n,s)}function Y6(t,n,r){const s=t.all(n),i=r?Z6(r):xE(n),o={},c=[];if(typeof n.checked=="boolean"){const h=s[0];let g;h&&h.type==="element"&&h.tagName==="p"?g=h:(g={type:"element",tagName:"p",properties:{},children:[]},s.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let d=-1;for(;++d<s.length;){const h=s[d];(i||d!==0||h.type!=="element"||h.tagName!=="p")&&c.push({type:"text",value:`
`}),h.type==="element"&&h.tagName==="p"&&!i?c.push(...h.children):c.push(h)}const p=s[s.length-1];p&&(i||p.type!=="element"||p.tagName!=="p")&&c.push({type:"text",value:`
`});const m={type:"element",tagName:"li",properties:o,children:c};return t.patch(n,m),t.applyData(n,m)}function Z6(t){let n=!1;if(t.type==="list"){n=t.spread||!1;const r=t.children;let s=-1;for(;!n&&++s<r.length;)n=xE(r[s])}return n}function xE(t){const n=t.spread;return n??t.children.length>1}function X6(t,n){const r={},s=t.all(n);let i=-1;for(typeof n.start=="number"&&n.start!==1&&(r.start=n.start);++i<s.length;){const c=s[i];if(c.type==="element"&&c.tagName==="li"&&c.properties&&Array.isArray(c.properties.className)&&c.properties.className.includes("task-list-item")){r.className=["contains-task-list"];break}}const o={type:"element",tagName:n.ordered?"ol":"ul",properties:r,children:t.wrap(s,!0)};return t.patch(n,o),t.applyData(n,o)}function J6(t,n){const r={type:"element",tagName:"p",properties:{},children:t.all(n)};return t.patch(n,r),t.applyData(n,r)}function ez(t,n){const r={type:"root",children:t.wrap(t.all(n))};return t.patch(n,r),t.applyData(n,r)}function tz(t,n){const r={type:"element",tagName:"strong",properties:{},children:t.all(n)};return t.patch(n,r),t.applyData(n,r)}function nz(t,n){const r=t.all(n),s=r.shift(),i=[];if(s){const c={type:"element",tagName:"thead",properties:{},children:t.wrap([s],!0)};t.patch(n.children[0],c),i.push(c)}if(r.length>0){const c={type:"element",tagName:"tbody",properties:{},children:t.wrap(r,!0)},d=bv(n.children[1]),p=Y2(n.children[n.children.length-1]);d&&p&&(c.position={start:d,end:p}),i.push(c)}const o={type:"element",tagName:"table",properties:{},children:t.wrap(i,!0)};return t.patch(n,o),t.applyData(n,o)}function rz(t,n,r){const s=r?r.children:void 0,o=(s?s.indexOf(n):1)===0?"th":"td",c=r&&r.type==="table"?r.align:void 0,d=c?c.length:n.children.length;let p=-1;const m=[];for(;++p<d;){const g=n.children[p],v={},j=c?c[p]:void 0;j&&(v.align=j);let N={type:"element",tagName:o,properties:v,children:[]};g&&(N.children=t.all(g),t.patch(g,N),N=t.applyData(g,N)),m.push(N)}const h={type:"element",tagName:"tr",properties:{},children:t.wrap(m,!0)};return t.patch(n,h),t.applyData(n,h)}function sz(t,n){const r={type:"element",tagName:"td",properties:{},children:t.all(n)};return t.patch(n,r),t.applyData(n,r)}const Wb=9,Qb=32;function az(t){const n=String(t),r=/\r?\n|\r/g;let s=r.exec(n),i=0;const o=[];for(;s;)o.push(Yb(n.slice(i,s.index),i>0,!0),s[0]),i=s.index+s[0].length,s=r.exec(n);return o.push(Yb(n.slice(i),i>0,!1)),o.join("")}function Yb(t,n,r){let s=0,i=t.length;if(n){let o=t.codePointAt(s);for(;o===Wb||o===Qb;)s++,o=t.codePointAt(s)}if(r){let o=t.codePointAt(i-1);for(;o===Wb||o===Qb;)i--,o=t.codePointAt(i-1)}return i>s?t.slice(s,i):""}function iz(t,n){const r={type:"text",value:az(String(n.value))};return t.patch(n,r),t.applyData(n,r)}function oz(t,n){const r={type:"element",tagName:"hr",properties:{},children:[]};return t.patch(n,r),t.applyData(n,r)}const lz={blockquote:L6,break:F6,code:$6,delete:z6,emphasis:V6,footnoteReference:q6,heading:U6,html:B6,imageReference:G6,image:H6,inlineCode:K6,linkReference:W6,link:Q6,listItem:Y6,list:X6,paragraph:J6,root:ez,strong:tz,table:nz,tableCell:sz,tableRow:rz,text:iz,thematicBreak:oz,toml:Cu,yaml:Cu,definition:Cu,footnoteDefinition:Cu};function Cu(){}const gE=-1,lm=0,wc=1,lp=2,Pv=3,Tv=4,Rv=5,Av=6,vE=7,yE=8,Zb=typeof self=="object"?self:globalThis,cz=(t,n)=>{const r=(i,o)=>(t.set(o,i),i),s=i=>{if(t.has(i))return t.get(i);const[o,c]=n[i];switch(o){case lm:case gE:return r(c,i);case wc:{const d=r([],i);for(const p of c)d.push(s(p));return d}case lp:{const d=r({},i);for(const[p,m]of c)d[s(p)]=s(m);return d}case Pv:return r(new Date(c),i);case Tv:{const{source:d,flags:p}=c;return r(new RegExp(d,p),i)}case Rv:{const d=r(new Map,i);for(const[p,m]of c)d.set(s(p),s(m));return d}case Av:{const d=r(new Set,i);for(const p of c)d.add(s(p));return d}case vE:{const{name:d,message:p}=c;return r(new Zb[d](p),i)}case yE:return r(BigInt(c),i);case"BigInt":return r(Object(BigInt(c)),i);case"ArrayBuffer":return r(new Uint8Array(c).buffer,c);case"DataView":{const{buffer:d}=new Uint8Array(c);return r(new DataView(d),c)}}return r(new Zb[o](c),i)};return s},Xb=t=>cz(new Map,t)(0),Eo="",{toString:dz}={},{keys:uz}=Object,dc=t=>{const n=typeof t;if(n!=="object"||!t)return[lm,n];const r=dz.call(t).slice(8,-1);switch(r){case"Array":return[wc,Eo];case"Object":return[lp,Eo];case"Date":return[Pv,Eo];case"RegExp":return[Tv,Eo];case"Map":return[Rv,Eo];case"Set":return[Av,Eo];case"DataView":return[wc,r]}return r.includes("Array")?[wc,r]:r.includes("Error")?[vE,r]:[lp,r]},Su=([t,n])=>t===lm&&(n==="function"||n==="symbol"),pz=(t,n,r,s)=>{const i=(c,d)=>{const p=s.push(c)-1;return r.set(d,p),p},o=c=>{if(r.has(c))return r.get(c);let[d,p]=dc(c);switch(d){case lm:{let h=c;switch(p){case"bigint":d=yE,h=c.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+p);h=null;break;case"undefined":return i([gE],c)}return i([d,h],c)}case wc:{if(p){let v=c;return p==="DataView"?v=new Uint8Array(c.buffer):p==="ArrayBuffer"&&(v=new Uint8Array(c)),i([p,[...v]],c)}const h=[],g=i([d,h],c);for(const v of c)h.push(o(v));return g}case lp:{if(p)switch(p){case"BigInt":return i([p,c.toString()],c);case"Boolean":case"Number":case"String":return i([p,c.valueOf()],c)}if(n&&"toJSON"in c)return o(c.toJSON());const h=[],g=i([d,h],c);for(const v of uz(c))(t||!Su(dc(c[v])))&&h.push([o(v),o(c[v])]);return g}case Pv:return i([d,c.toISOString()],c);case Tv:{const{source:h,flags:g}=c;return i([d,{source:h,flags:g}],c)}case Rv:{const h=[],g=i([d,h],c);for(const[v,j]of c)(t||!(Su(dc(v))||Su(dc(j))))&&h.push([o(v),o(j)]);return g}case Av:{const h=[],g=i([d,h],c);for(const v of c)(t||!Su(dc(v)))&&h.push(o(v));return g}}const{message:m}=c;return i([d,{name:p,message:m}],c)};return o},Jb=(t,{json:n,lossy:r}={})=>{const s=[];return pz(!(n||r),!!n,new Map,s)(t),s},cp=typeof structuredClone=="function"?(t,n)=>n&&("json"in n||"lossy"in n)?Xb(Jb(t,n)):structuredClone(t):(t,n)=>Xb(Jb(t,n));function mz(t,n){const r=[{type:"text",value:""}];return n>1&&r.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),r}function hz(t,n){return"Back to reference "+(t+1)+(n>1?"-"+n:"")}function fz(t){const n=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",r=t.options.footnoteBackContent||mz,s=t.options.footnoteBackLabel||hz,i=t.options.footnoteLabel||"Footnotes",o=t.options.footnoteLabelTagName||"h2",c=t.options.footnoteLabelProperties||{className:["sr-only"]},d=[];let p=-1;for(;++p<t.footnoteOrder.length;){const m=t.footnoteById.get(t.footnoteOrder[p]);if(!m)continue;const h=t.all(m),g=String(m.identifier).toUpperCase(),v=yl(g.toLowerCase());let j=0;const N=[],b=t.footnoteCounts.get(g);for(;b!==void 0&&++j<=b;){N.length>0&&N.push({type:"text",value:" "});let k=typeof r=="string"?r:r(p,j);typeof k=="string"&&(k={type:"text",value:k}),N.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+v+(j>1?"-"+j:""),dataFootnoteBackref:"",ariaLabel:typeof s=="string"?s:s(p,j),className:["data-footnote-backref"]},children:Array.isArray(k)?k:[k]})}const C=h[h.length-1];if(C&&C.type==="element"&&C.tagName==="p"){const k=C.children[C.children.length-1];k&&k.type==="text"?k.value+=" ":C.children.push({type:"text",value:" "}),C.children.push(...N)}else h.push(...N);const S={type:"element",tagName:"li",properties:{id:n+"fn-"+v},children:t.wrap(h,!0)};t.patch(m,S),d.push(S)}if(d.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...cp(c),id:"footnote-label"},children:[{type:"text",value:i}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:t.wrap(d,!0)},{type:"text",value:`
`}]}}const jE=(function(t){if(t==null)return yz;if(typeof t=="function")return cm(t);if(typeof t=="object")return Array.isArray(t)?xz(t):gz(t);if(typeof t=="string")return vz(t);throw new Error("Expected function, string, or object as test")});function xz(t){const n=[];let r=-1;for(;++r<t.length;)n[r]=jE(t[r]);return cm(s);function s(...i){let o=-1;for(;++o<n.length;)if(n[o].apply(this,i))return!0;return!1}}function gz(t){const n=t;return cm(r);function r(s){const i=s;let o;for(o in t)if(i[o]!==n[o])return!1;return!0}}function vz(t){return cm(n);function n(r){return r&&r.type===t}}function cm(t){return n;function n(r,s,i){return!!(jz(r)&&t.call(this,r,typeof s=="number"?s:void 0,i||void 0))}}function yz(){return!0}function jz(t){return t!==null&&typeof t=="object"&&"type"in t}const bE=[],bz=!0,ew=!1,wz="skip";function Nz(t,n,r,s){let i;typeof n=="function"&&typeof r!="function"?(s=r,r=n):i=n;const o=jE(i),c=s?-1:1;d(t,void 0,[])();function d(p,m,h){const g=p&&typeof p=="object"?p:{};if(typeof g.type=="string"){const j=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(v,"name",{value:"node ("+(p.type+(j?"<"+j+">":""))+")"})}return v;function v(){let j=bE,N,b,C;if((!n||o(p,m,h[h.length-1]||void 0))&&(j=Cz(r(p,h)),j[0]===ew))return j;if("children"in p&&p.children){const S=p;if(S.children&&j[0]!==wz)for(b=(s?S.children.length:-1)+c,C=h.concat(S);b>-1&&b<S.children.length;){const k=S.children[b];if(N=d(k,b,C)(),N[0]===ew)return N;b=typeof N[1]=="number"?N[1]:b+c}}return j}}}function Cz(t){return Array.isArray(t)?t:typeof t=="number"?[bz,t]:t==null?bE:[t]}function wE(t,n,r,s){let i,o,c;typeof n=="function"&&typeof r!="function"?(o=void 0,c=n,i=r):(o=n,c=r,i=s),Nz(t,o,d,i);function d(p,m){const h=m[m.length-1],g=h?h.children.indexOf(p):void 0;return c(p,g,h)}}const Ax={}.hasOwnProperty,Sz={};function kz(t,n){const r=n||Sz,s=new Map,i=new Map,o=new Map,c={...lz,...r.handlers},d={all:m,applyData:Pz,definitionById:s,footnoteById:i,footnoteCounts:o,footnoteOrder:[],handlers:c,one:p,options:r,patch:Ez,wrap:Rz};return wE(t,function(h){if(h.type==="definition"||h.type==="footnoteDefinition"){const g=h.type==="definition"?s:i,v=String(h.identifier).toUpperCase();g.has(v)||g.set(v,h)}}),d;function p(h,g){const v=h.type,j=d.handlers[v];if(Ax.call(d.handlers,v)&&j)return j(d,h,g);if(d.options.passThrough&&d.options.passThrough.includes(v)){if("children"in h){const{children:b,...C}=h,S=cp(C);return S.children=d.all(h),S}return cp(h)}return(d.options.unknownHandler||Tz)(d,h,g)}function m(h){const g=[];if("children"in h){const v=h.children;let j=-1;for(;++j<v.length;){const N=d.one(v[j],h);if(N){if(j&&v[j-1].type==="break"&&(!Array.isArray(N)&&N.type==="text"&&(N.value=tw(N.value)),!Array.isArray(N)&&N.type==="element")){const b=N.children[0];b&&b.type==="text"&&(b.value=tw(b.value))}Array.isArray(N)?g.push(...N):g.push(N)}}}return g}}function Ez(t,n){t.position&&(n.position=dF(t))}function Pz(t,n){let r=n;if(t&&t.data){const s=t.data.hName,i=t.data.hChildren,o=t.data.hProperties;if(typeof s=="string")if(r.type==="element")r.tagName=s;else{const c="children"in r?r.children:[r];r={type:"element",tagName:s,properties:{},children:c}}r.type==="element"&&o&&Object.assign(r.properties,cp(o)),"children"in r&&r.children&&i!==null&&i!==void 0&&(r.children=i)}return r}function Tz(t,n){const r=n.data||{},s="value"in n&&!(Ax.call(r,"hProperties")||Ax.call(r,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:t.all(n)};return t.patch(n,s),t.applyData(n,s)}function Rz(t,n){const r=[];let s=-1;for(n&&r.push({type:"text",value:`
`});++s<t.length;)s&&r.push({type:"text",value:`
`}),r.push(t[s]);return n&&t.length>0&&r.push({type:"text",value:`
`}),r}function tw(t){let n=0,r=t.charCodeAt(n);for(;r===9||r===32;)n++,r=t.charCodeAt(n);return t.slice(n)}function nw(t,n){const r=kz(t,n),s=r.one(t,void 0),i=fz(r),o=Array.isArray(s)?{type:"root",children:s}:s||{type:"root",children:[]};return i&&o.children.push({type:"text",value:`
`},i),o}function Az(t,n){return t&&"run"in t?async function(r,s){const i=nw(r,{file:s,...n});await t.run(i,s)}:function(r,s){return nw(r,{file:s,...t||n})}}function rw(t){if(t)throw t}var Mf,sw;function _z(){if(sw)return Mf;sw=1;var t=Object.prototype.hasOwnProperty,n=Object.prototype.toString,r=Object.defineProperty,s=Object.getOwnPropertyDescriptor,i=function(m){return typeof Array.isArray=="function"?Array.isArray(m):n.call(m)==="[object Array]"},o=function(m){if(!m||n.call(m)!=="[object Object]")return!1;var h=t.call(m,"constructor"),g=m.constructor&&m.constructor.prototype&&t.call(m.constructor.prototype,"isPrototypeOf");if(m.constructor&&!h&&!g)return!1;var v;for(v in m);return typeof v>"u"||t.call(m,v)},c=function(m,h){r&&h.name==="__proto__"?r(m,h.name,{enumerable:!0,configurable:!0,value:h.newValue,writable:!0}):m[h.name]=h.newValue},d=function(m,h){if(h==="__proto__")if(t.call(m,h)){if(s)return s(m,h).value}else return;return m[h]};return Mf=function p(){var m,h,g,v,j,N,b=arguments[0],C=1,S=arguments.length,k=!1;for(typeof b=="boolean"&&(k=b,b=arguments[1]||{},C=2),(b==null||typeof b!="object"&&typeof b!="function")&&(b={});C<S;++C)if(m=arguments[C],m!=null)for(h in m)g=d(b,h),v=d(m,h),b!==v&&(k&&v&&(o(v)||(j=i(v)))?(j?(j=!1,N=g&&i(g)?g:[]):N=g&&o(g)?g:{},c(b,{name:h,newValue:p(k,N,v)})):typeof v<"u"&&c(b,{name:h,newValue:v}));return b},Mf}var Iz=_z();const Of=jp(Iz);function _x(t){if(typeof t!="object"||t===null)return!1;const n=Object.getPrototypeOf(t);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function Mz(){const t=[],n={run:r,use:s};return n;function r(...i){let o=-1;const c=i.pop();if(typeof c!="function")throw new TypeError("Expected function as last argument, not "+c);d(null,...i);function d(p,...m){const h=t[++o];let g=-1;if(p){c(p);return}for(;++g<i.length;)(m[g]===null||m[g]===void 0)&&(m[g]=i[g]);i=m,h?Oz(h,d)(...m):c(null,...m)}}function s(i){if(typeof i!="function")throw new TypeError("Expected `middelware` to be a function, not "+i);return t.push(i),n}}function Oz(t,n){let r;return s;function s(...c){const d=t.length>c.length;let p;d&&c.push(i);try{p=t.apply(this,c)}catch(m){const h=m;if(d&&r)throw h;return i(h)}d||(p&&p.then&&typeof p.then=="function"?p.then(o,i):p instanceof Error?i(p):o(p))}function i(c,...d){r||(r=!0,n(c,...d))}function o(c){i(null,c)}}const Fs={basename:Dz,dirname:Lz,extname:Fz,join:$z,sep:"/"};function Dz(t,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');sd(t);let r=0,s=-1,i=t.length,o;if(n===void 0||n.length===0||n.length>t.length){for(;i--;)if(t.codePointAt(i)===47){if(o){r=i+1;break}}else s<0&&(o=!0,s=i+1);return s<0?"":t.slice(r,s)}if(n===t)return"";let c=-1,d=n.length-1;for(;i--;)if(t.codePointAt(i)===47){if(o){r=i+1;break}}else c<0&&(o=!0,c=i+1),d>-1&&(t.codePointAt(i)===n.codePointAt(d--)?d<0&&(s=i):(d=-1,s=c));return r===s?s=c:s<0&&(s=t.length),t.slice(r,s)}function Lz(t){if(sd(t),t.length===0)return".";let n=-1,r=t.length,s;for(;--r;)if(t.codePointAt(r)===47){if(s){n=r;break}}else s||(s=!0);return n<0?t.codePointAt(0)===47?"/":".":n===1&&t.codePointAt(0)===47?"//":t.slice(0,n)}function Fz(t){sd(t);let n=t.length,r=-1,s=0,i=-1,o=0,c;for(;n--;){const d=t.codePointAt(n);if(d===47){if(c){s=n+1;break}continue}r<0&&(c=!0,r=n+1),d===46?i<0?i=n:o!==1&&(o=1):i>-1&&(o=-1)}return i<0||r<0||o===0||o===1&&i===r-1&&i===s+1?"":t.slice(i,r)}function $z(...t){let n=-1,r;for(;++n<t.length;)sd(t[n]),t[n]&&(r=r===void 0?t[n]:r+"/"+t[n]);return r===void 0?".":zz(r)}function zz(t){sd(t);const n=t.codePointAt(0)===47;let r=Vz(t,!n);return r.length===0&&!n&&(r="."),r.length>0&&t.codePointAt(t.length-1)===47&&(r+="/"),n?"/"+r:r}function Vz(t,n){let r="",s=0,i=-1,o=0,c=-1,d,p;for(;++c<=t.length;){if(c<t.length)d=t.codePointAt(c);else{if(d===47)break;d=47}if(d===47){if(!(i===c-1||o===1))if(i!==c-1&&o===2){if(r.length<2||s!==2||r.codePointAt(r.length-1)!==46||r.codePointAt(r.length-2)!==46){if(r.length>2){if(p=r.lastIndexOf("/"),p!==r.length-1){p<0?(r="",s=0):(r=r.slice(0,p),s=r.length-1-r.lastIndexOf("/")),i=c,o=0;continue}}else if(r.length>0){r="",s=0,i=c,o=0;continue}}n&&(r=r.length>0?r+"/..":"..",s=2)}else r.length>0?r+="/"+t.slice(i+1,c):r=t.slice(i+1,c),s=c-i-1;i=c,o=0}else d===46&&o>-1?o++:o=-1}return r}function sd(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}const qz={cwd:Uz};function Uz(){return"/"}function Ix(t){return!!(t!==null&&typeof t=="object"&&"href"in t&&t.href&&"protocol"in t&&t.protocol&&t.auth===void 0)}function Bz(t){if(typeof t=="string")t=new URL(t);else if(!Ix(t)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+t+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(t.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return Gz(t)}function Gz(t){if(t.hostname!==""){const s=new TypeError('File URL host must be "localhost" or empty on darwin');throw s.code="ERR_INVALID_FILE_URL_HOST",s}const n=t.pathname;let r=-1;for(;++r<n.length;)if(n.codePointAt(r)===37&&n.codePointAt(r+1)===50){const s=n.codePointAt(r+2);if(s===70||s===102){const i=new TypeError("File URL path must not include encoded / characters");throw i.code="ERR_INVALID_FILE_URL_PATH",i}}return decodeURIComponent(n)}const Df=["history","path","basename","stem","extname","dirname"];class NE{constructor(n){let r;n?Ix(n)?r={path:n}:typeof n=="string"||Hz(n)?r={value:n}:r=n:r={},this.cwd="cwd"in r?"":qz.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let s=-1;for(;++s<Df.length;){const o=Df[s];o in r&&r[o]!==void 0&&r[o]!==null&&(this[o]=o==="history"?[...r[o]]:r[o])}let i;for(i in r)Df.includes(i)||(this[i]=r[i])}get basename(){return typeof this.path=="string"?Fs.basename(this.path):void 0}set basename(n){Ff(n,"basename"),Lf(n,"basename"),this.path=Fs.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?Fs.dirname(this.path):void 0}set dirname(n){aw(this.basename,"dirname"),this.path=Fs.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?Fs.extname(this.path):void 0}set extname(n){if(Lf(n,"extname"),aw(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Fs.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){Ix(n)&&(n=Bz(n)),Ff(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?Fs.basename(this.path,this.extname):void 0}set stem(n){Ff(n,"stem"),Lf(n,"stem"),this.path=Fs.join(this.dirname||"",n+(this.extname||""))}fail(n,r,s){const i=this.message(n,r,s);throw i.fatal=!0,i}info(n,r,s){const i=this.message(n,r,s);return i.fatal=void 0,i}message(n,r,s){const i=new vr(n,r,s);return this.path&&(i.name=this.path+":"+i.name,i.file=this.path),i.fatal=!1,this.messages.push(i),i}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}}function Lf(t,n){if(t&&t.includes(Fs.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+Fs.sep+"`")}function Ff(t,n){if(!t)throw new Error("`"+n+"` cannot be empty")}function aw(t,n){if(!t)throw new Error("Setting `"+n+"` requires `path` to be set too")}function Hz(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const Kz=(function(t){const s=this.constructor.prototype,i=s[t],o=function(){return i.apply(o,arguments)};return Object.setPrototypeOf(o,s),o}),Wz={}.hasOwnProperty;class _v extends Kz{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=Mz()}copy(){const n=new _v;let r=-1;for(;++r<this.attachers.length;){const s=this.attachers[r];n.use(...s)}return n.data(Of(!0,{},this.namespace)),n}data(n,r){return typeof n=="string"?arguments.length===2?(Vf("data",this.frozen),this.namespace[n]=r,this):Wz.call(this.namespace,n)&&this.namespace[n]||void 0:n?(Vf("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[r,...s]=this.attachers[this.freezeIndex];if(s[0]===!1)continue;s[0]===!0&&(s[0]=void 0);const i=r.call(n,...s);typeof i=="function"&&this.transformers.use(i)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const r=ku(n),s=this.parser||this.Parser;return $f("parse",s),s(String(r),r)}process(n,r){const s=this;return this.freeze(),$f("process",this.parser||this.Parser),zf("process",this.compiler||this.Compiler),r?i(void 0,r):new Promise(i);function i(o,c){const d=ku(n),p=s.parse(d);s.run(p,d,function(h,g,v){if(h||!g||!v)return m(h);const j=g,N=s.stringify(j,v);Zz(N)?v.value=N:v.result=N,m(h,v)});function m(h,g){h||!g?c(h):o?o(g):r(void 0,g)}}}processSync(n){let r=!1,s;return this.freeze(),$f("processSync",this.parser||this.Parser),zf("processSync",this.compiler||this.Compiler),this.process(n,i),ow("processSync","process",r),s;function i(o,c){r=!0,rw(o),s=c}}run(n,r,s){iw(n),this.freeze();const i=this.transformers;return!s&&typeof r=="function"&&(s=r,r=void 0),s?o(void 0,s):new Promise(o);function o(c,d){const p=ku(r);i.run(n,p,m);function m(h,g,v){const j=g||n;h?d(h):c?c(j):s(void 0,j,v)}}}runSync(n,r){let s=!1,i;return this.run(n,r,o),ow("runSync","run",s),i;function o(c,d){rw(c),i=d,s=!0}}stringify(n,r){this.freeze();const s=ku(r),i=this.compiler||this.Compiler;return zf("stringify",i),iw(n),i(n,s)}use(n,...r){const s=this.attachers,i=this.namespace;if(Vf("use",this.frozen),n!=null)if(typeof n=="function")p(n,r);else if(typeof n=="object")Array.isArray(n)?d(n):c(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function o(m){if(typeof m=="function")p(m,[]);else if(typeof m=="object")if(Array.isArray(m)){const[h,...g]=m;p(h,g)}else c(m);else throw new TypeError("Expected usable value, not `"+m+"`")}function c(m){if(!("plugins"in m)&&!("settings"in m))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");d(m.plugins),m.settings&&(i.settings=Of(!0,i.settings,m.settings))}function d(m){let h=-1;if(m!=null)if(Array.isArray(m))for(;++h<m.length;){const g=m[h];o(g)}else throw new TypeError("Expected a list of plugins, not `"+m+"`")}function p(m,h){let g=-1,v=-1;for(;++g<s.length;)if(s[g][0]===m){v=g;break}if(v===-1)s.push([m,...h]);else if(h.length>0){let[j,...N]=h;const b=s[v][1];_x(b)&&_x(j)&&(j=Of(!0,b,j)),s[v]=[m,j,...N]}}}}const Qz=new _v().freeze();function $f(t,n){if(typeof n!="function")throw new TypeError("Cannot `"+t+"` without `parser`")}function zf(t,n){if(typeof n!="function")throw new TypeError("Cannot `"+t+"` without `compiler`")}function Vf(t,n){if(n)throw new Error("Cannot call `"+t+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function iw(t){if(!_x(t)||typeof t.type!="string")throw new TypeError("Expected node, got `"+t+"`")}function ow(t,n,r){if(!r)throw new Error("`"+t+"` finished async. Use `"+n+"` instead")}function ku(t){return Yz(t)?t:new NE(t)}function Yz(t){return!!(t&&typeof t=="object"&&"message"in t&&"messages"in t)}function Zz(t){return typeof t=="string"||Xz(t)}function Xz(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const Jz="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",lw=[],cw={allowDangerousHtml:!0},eV=/^(https?|ircs?|mailto|xmpp)$/i,tV=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Iv(t){const n=nV(t),r=rV(t);return sV(n.runSync(n.parse(r),r),t)}function nV(t){const n=t.rehypePlugins||lw,r=t.remarkPlugins||lw,s=t.remarkRehypeOptions?{...t.remarkRehypeOptions,...cw}:cw;return Qz().use(D6).use(r).use(Az,s).use(n)}function rV(t){const n=t.children||"",r=new NE;return typeof n=="string"&&(r.value=n),r}function sV(t,n){const r=n.allowedElements,s=n.allowElement,i=n.components,o=n.disallowedElements,c=n.skipHtml,d=n.unwrapDisallowed,p=n.urlTransform||aV;for(const h of tV)Object.hasOwn(n,h.from)&&(""+h.from+(h.to?"use `"+h.to+"` instead":"remove it")+Jz+h.id,void 0);return wE(t,m),fF(t,{Fragment:e.Fragment,components:i,ignoreInvalidStyle:!0,jsx:e.jsx,jsxs:e.jsxs,passKeys:!0,passNode:!0});function m(h,g,v){if(h.type==="raw"&&v&&typeof g=="number")return c?v.children.splice(g,1):v.children[g]={type:"text",value:h.value},g;if(h.type==="element"){let j;for(j in Af)if(Object.hasOwn(Af,j)&&Object.hasOwn(h.properties,j)){const N=h.properties[j],b=Af[j];(b===null||b.includes(h.tagName))&&(h.properties[j]=p(String(N||""),j,h))}}if(h.type==="element"){let j=r?!r.includes(h.tagName):o?o.includes(h.tagName):!1;if(!j&&s&&typeof g=="number"&&(j=!s(h,g,v)),j&&v&&typeof g=="number")return d&&h.children?v.children.splice(g,1,...h.children):v.children.splice(g,1),g}}}function aV(t){const n=t.indexOf(":"),r=t.indexOf("?"),s=t.indexOf("#"),i=t.indexOf("/");return n===-1||i!==-1&&n>i||r!==-1&&n>r||s!==-1&&n>s||eV.test(t.slice(0,n))?t:""}var ad=t=>t.type==="checkbox",Ii=t=>t instanceof Date,wr=t=>t==null;const CE=t=>typeof t=="object";var Mn=t=>!wr(t)&&!Array.isArray(t)&&CE(t)&&!Ii(t),SE=t=>Mn(t)&&t.target?ad(t.target)?t.target.checked:t.target.value:t,iV=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,kE=(t,n)=>t.has(iV(n)),oV=t=>{const n=t.constructor&&t.constructor.prototype;return Mn(n)&&n.hasOwnProperty("isPrototypeOf")},Mv=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function nr(t){let n;const r=Array.isArray(t),s=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)n=new Date(t);else if(t instanceof Set)n=new Set(t);else if(!(Mv&&(t instanceof Blob||s))&&(r||Mn(t)))if(n=r?[]:{},!r&&!oV(t))n=t;else for(const i in t)t.hasOwnProperty(i)&&(n[i]=nr(t[i]));else return t;return n}var dm=t=>Array.isArray(t)?t.filter(Boolean):[],In=t=>t===void 0,Ue=(t,n,r)=>{if(!n||!Mn(t))return r;const s=dm(n.split(/[,[\].]+?/)).reduce((i,o)=>wr(i)?i:i[o],t);return In(s)||s===t?In(t[n])?r:t[n]:s},Gr=t=>typeof t=="boolean",Ov=t=>/^\w*$/.test(t),EE=t=>dm(t.replace(/["|']|\]/g,"").split(/\.|\[/)),Qt=(t,n,r)=>{let s=-1;const i=Ov(n)?[n]:EE(n),o=i.length,c=o-1;for(;++s<o;){const d=i[s];let p=r;if(s!==c){const m=t[d];p=Mn(m)||Array.isArray(m)?m:isNaN(+i[s+1])?{}:[]}if(d==="__proto__"||d==="constructor"||d==="prototype")return;t[d]=p,t=t[d]}};const dp={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Cs={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},la={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},PE=ut.createContext(null),um=()=>ut.useContext(PE),lV=t=>{const{children:n,...r}=t;return ut.createElement(PE.Provider,{value:r},n)};var TE=(t,n,r,s=!0)=>{const i={defaultValues:n._defaultValues};for(const o in t)Object.defineProperty(i,o,{get:()=>{const c=o;return n._proxyFormState[c]!==Cs.all&&(n._proxyFormState[c]=!s||Cs.all),r&&(r[c]=!0),t[c]}});return i};function cV(t){const n=um(),{control:r=n.control,disabled:s,name:i,exact:o}=t||{},[c,d]=ut.useState(r._formState),p=ut.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),m=ut.useRef(i);return m.current=i,ut.useEffect(()=>r._subscribe({name:m.current,formState:p.current,exact:o,callback:h=>{!s&&d({...r._formState,...h})}}),[r,s,o]),ut.useEffect(()=>{p.current.isValid&&r._setValid(!0)},[r]),ut.useMemo(()=>TE(c,r,p.current,!1),[c,r])}var qs=t=>typeof t=="string",RE=(t,n,r,s,i)=>qs(t)?(s&&n.watch.add(t),Ue(r,t,i)):Array.isArray(t)?t.map(o=>(s&&n.watch.add(o),Ue(r,o))):(s&&(n.watchAll=!0),r);function dV(t){const n=um(),{control:r=n.control,name:s,defaultValue:i,disabled:o,exact:c}=t||{},d=ut.useRef(s),p=ut.useRef(i);d.current=s,ut.useEffect(()=>r._subscribe({name:d.current,formState:{values:!0},exact:c,callback:g=>!o&&h(RE(d.current,r._names,g.values||r._formValues,!1,p.current))}),[r,o,c]);const[m,h]=ut.useState(r._getWatch(s,i));return ut.useEffect(()=>r._removeUnmounted()),m}function uV(t){const n=um(),{name:r,disabled:s,control:i=n.control,shouldUnregister:o}=t,c=kE(i._names.array,r),d=dV({control:i,name:r,defaultValue:Ue(i._formValues,r,Ue(i._defaultValues,r,t.defaultValue)),exact:!0}),p=cV({control:i,name:r,exact:!0}),m=ut.useRef(t),h=ut.useRef(i.register(r,{...t.rules,value:d,...Gr(t.disabled)?{disabled:t.disabled}:{}})),g=ut.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Ue(p.errors,r)},isDirty:{enumerable:!0,get:()=>!!Ue(p.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!Ue(p.touchedFields,r)},isValidating:{enumerable:!0,get:()=>!!Ue(p.validatingFields,r)},error:{enumerable:!0,get:()=>Ue(p.errors,r)}}),[p,r]),v=ut.useCallback(C=>h.current.onChange({target:{value:SE(C),name:r},type:dp.CHANGE}),[r]),j=ut.useCallback(()=>h.current.onBlur({target:{value:Ue(i._formValues,r),name:r},type:dp.BLUR}),[r,i._formValues]),N=ut.useCallback(C=>{const S=Ue(i._fields,r);S&&C&&(S._f.ref={focus:()=>C.focus(),select:()=>C.select(),setCustomValidity:k=>C.setCustomValidity(k),reportValidity:()=>C.reportValidity()})},[i._fields,r]),b=ut.useMemo(()=>({name:r,value:d,...Gr(s)||p.disabled?{disabled:p.disabled||s}:{},onChange:v,onBlur:j,ref:N}),[r,s,p.disabled,v,j,N,d]);return ut.useEffect(()=>{const C=i._options.shouldUnregister||o;i.register(r,{...m.current.rules,...Gr(m.current.disabled)?{disabled:m.current.disabled}:{}});const S=(k,P)=>{const R=Ue(i._fields,k);R&&R._f&&(R._f.mount=P)};if(S(r,!0),C){const k=nr(Ue(i._options.defaultValues,r));Qt(i._defaultValues,r,k),In(Ue(i._formValues,r))&&Qt(i._formValues,r,k)}return!c&&i.register(r),()=>{(c?C&&!i._state.action:C)?i.unregister(r):S(r,!1)}},[r,i,c,o]),ut.useEffect(()=>{i._setDisabledField({disabled:s,name:r})},[s,r,i]),ut.useMemo(()=>({field:b,formState:p,fieldState:g}),[b,p,g])}const pV=t=>t.render(uV(t));var AE=(t,n,r,s,i)=>n?{...r[t],types:{...r[t]&&r[t].types?r[t].types:{},[s]:i||!0}}:{},Nc=t=>Array.isArray(t)?t:[t],dw=()=>{let t=[];return{get observers(){return t},next:i=>{for(const o of t)o.next&&o.next(i)},subscribe:i=>(t.push(i),{unsubscribe:()=>{t=t.filter(o=>o!==i)}}),unsubscribe:()=>{t=[]}}},Mx=t=>wr(t)||!CE(t);function Xa(t,n){if(Mx(t)||Mx(n))return t===n;if(Ii(t)&&Ii(n))return t.getTime()===n.getTime();const r=Object.keys(t),s=Object.keys(n);if(r.length!==s.length)return!1;for(const i of r){const o=t[i];if(!s.includes(i))return!1;if(i!=="ref"){const c=n[i];if(Ii(o)&&Ii(c)||Mn(o)&&Mn(c)||Array.isArray(o)&&Array.isArray(c)?!Xa(o,c):o!==c)return!1}}return!0}var br=t=>Mn(t)&&!Object.keys(t).length,Dv=t=>t.type==="file",Ss=t=>typeof t=="function",up=t=>{if(!Mv)return!1;const n=t?t.ownerDocument:0;return t instanceof(n&&n.defaultView?n.defaultView.HTMLElement:HTMLElement)},_E=t=>t.type==="select-multiple",Lv=t=>t.type==="radio",mV=t=>Lv(t)||ad(t),qf=t=>up(t)&&t.isConnected;function hV(t,n){const r=n.slice(0,-1).length;let s=0;for(;s<r;)t=In(t)?s++:t[n[s++]];return t}function fV(t){for(const n in t)if(t.hasOwnProperty(n)&&!In(t[n]))return!1;return!0}function Un(t,n){const r=Array.isArray(n)?n:Ov(n)?[n]:EE(n),s=r.length===1?t:hV(t,r),i=r.length-1,o=r[i];return s&&delete s[o],i!==0&&(Mn(s)&&br(s)||Array.isArray(s)&&fV(s))&&Un(t,r.slice(0,-1)),t}var IE=t=>{for(const n in t)if(Ss(t[n]))return!0;return!1};function pp(t,n={}){const r=Array.isArray(t);if(Mn(t)||r)for(const s in t)Array.isArray(t[s])||Mn(t[s])&&!IE(t[s])?(n[s]=Array.isArray(t[s])?[]:{},pp(t[s],n[s])):wr(t[s])||(n[s]=!0);return n}function ME(t,n,r){const s=Array.isArray(t);if(Mn(t)||s)for(const i in t)Array.isArray(t[i])||Mn(t[i])&&!IE(t[i])?In(n)||Mx(r[i])?r[i]=Array.isArray(t[i])?pp(t[i],[]):{...pp(t[i])}:ME(t[i],wr(n)?{}:n[i],r[i]):r[i]=!Xa(t[i],n[i]);return r}var uc=(t,n)=>ME(t,n,pp(n));const uw={value:!1,isValid:!1},pw={value:!0,isValid:!0};var OE=t=>{if(Array.isArray(t)){if(t.length>1){const n=t.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:n,isValid:!!n.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!In(t[0].attributes.value)?In(t[0].value)||t[0].value===""?pw:{value:t[0].value,isValid:!0}:pw:uw}return uw},DE=(t,{valueAsNumber:n,valueAsDate:r,setValueAs:s})=>In(t)?t:n?t===""?NaN:t&&+t:r&&qs(t)?new Date(t):s?s(t):t;const mw={isValid:!1,value:null};var LE=t=>Array.isArray(t)?t.reduce((n,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:n,mw):mw;function hw(t){const n=t.ref;return Dv(n)?n.files:Lv(n)?LE(t.refs).value:_E(n)?[...n.selectedOptions].map(({value:r})=>r):ad(n)?OE(t.refs).value:DE(In(n.value)?t.ref.value:n.value,t)}var xV=(t,n,r,s)=>{const i={};for(const o of t){const c=Ue(n,o);c&&Qt(i,o,c._f)}return{criteriaMode:r,names:[...t],fields:i,shouldUseNativeValidation:s}},mp=t=>t instanceof RegExp,pc=t=>In(t)?t:mp(t)?t.source:Mn(t)?mp(t.value)?t.value.source:t.value:t,fw=t=>({isOnSubmit:!t||t===Cs.onSubmit,isOnBlur:t===Cs.onBlur,isOnChange:t===Cs.onChange,isOnAll:t===Cs.all,isOnTouch:t===Cs.onTouched});const xw="AsyncFunction";var gV=t=>!!t&&!!t.validate&&!!(Ss(t.validate)&&t.validate.constructor.name===xw||Mn(t.validate)&&Object.values(t.validate).find(n=>n.constructor.name===xw)),vV=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),gw=(t,n,r)=>!r&&(n.watchAll||n.watch.has(t)||[...n.watch].some(s=>t.startsWith(s)&&/^\.\w+/.test(t.slice(s.length))));const Cc=(t,n,r,s)=>{for(const i of r||Object.keys(t)){const o=Ue(t,i);if(o){const{_f:c,...d}=o;if(c){if(c.refs&&c.refs[0]&&n(c.refs[0],i)&&!s)return!0;if(c.ref&&n(c.ref,c.name)&&!s)return!0;if(Cc(d,n))break}else if(Mn(d)&&Cc(d,n))break}}};function vw(t,n,r){const s=Ue(t,r);if(s||Ov(r))return{error:s,name:r};const i=r.split(".");for(;i.length;){const o=i.join("."),c=Ue(n,o),d=Ue(t,o);if(c&&!Array.isArray(c)&&r!==o)return{name:r};if(d&&d.type)return{name:o,error:d};i.pop()}return{name:r}}var yV=(t,n,r,s)=>{r(t);const{name:i,...o}=t;return br(o)||Object.keys(o).length>=Object.keys(n).length||Object.keys(o).find(c=>n[c]===(!s||Cs.all))},jV=(t,n,r)=>!t||!n||t===n||Nc(t).some(s=>s&&(r?s===n:s.startsWith(n)||n.startsWith(s))),bV=(t,n,r,s,i)=>i.isOnAll?!1:!r&&i.isOnTouch?!(n||t):(r?s.isOnBlur:i.isOnBlur)?!t:(r?s.isOnChange:i.isOnChange)?t:!0,wV=(t,n)=>!dm(Ue(t,n)).length&&Un(t,n),NV=(t,n,r)=>{const s=Nc(Ue(t,r));return Qt(s,"root",n[r]),Qt(t,r,s),t},Fu=t=>qs(t);function yw(t,n,r="validate"){if(Fu(t)||Array.isArray(t)&&t.every(Fu)||Gr(t)&&!t)return{type:r,message:Fu(t)?t:"",ref:n}}var Po=t=>Mn(t)&&!mp(t)?t:{value:t,message:""},jw=async(t,n,r,s,i,o)=>{const{ref:c,refs:d,required:p,maxLength:m,minLength:h,min:g,max:v,pattern:j,validate:N,name:b,valueAsNumber:C,mount:S}=t._f,k=Ue(r,b);if(!S||n.has(b))return{};const P=d?d[0]:c,R=O=>{i&&P.reportValidity&&(P.setCustomValidity(Gr(O)?"":O||""),P.reportValidity())},E={},A=Lv(c),W=ad(c),X=A||W,se=(C||Dv(c))&&In(c.value)&&In(k)||up(c)&&c.value===""||k===""||Array.isArray(k)&&!k.length,V=AE.bind(null,b,s,E),G=(O,F,U,$=la.maxLength,q=la.minLength)=>{const le=O?F:U;E[b]={type:O?$:q,message:le,ref:c,...V(O?$:q,le)}};if(o?!Array.isArray(k)||!k.length:p&&(!X&&(se||wr(k))||Gr(k)&&!k||W&&!OE(d).isValid||A&&!LE(d).isValid)){const{value:O,message:F}=Fu(p)?{value:!!p,message:p}:Po(p);if(O&&(E[b]={type:la.required,message:F,ref:P,...V(la.required,F)},!s))return R(F),E}if(!se&&(!wr(g)||!wr(v))){let O,F;const U=Po(v),$=Po(g);if(!wr(k)&&!isNaN(k)){const q=c.valueAsNumber||k&&+k;wr(U.value)||(O=q>U.value),wr($.value)||(F=q<$.value)}else{const q=c.valueAsDate||new Date(k),le=D=>new Date(new Date().toDateString()+" "+D),K=c.type=="time",J=c.type=="week";qs(U.value)&&k&&(O=K?le(k)>le(U.value):J?k>U.value:q>new Date(U.value)),qs($.value)&&k&&(F=K?le(k)<le($.value):J?k<$.value:q<new Date($.value))}if((O||F)&&(G(!!O,U.message,$.message,la.max,la.min),!s))return R(E[b].message),E}if((m||h)&&!se&&(qs(k)||o&&Array.isArray(k))){const O=Po(m),F=Po(h),U=!wr(O.value)&&k.length>+O.value,$=!wr(F.value)&&k.length<+F.value;if((U||$)&&(G(U,O.message,F.message),!s))return R(E[b].message),E}if(j&&!se&&qs(k)){const{value:O,message:F}=Po(j);if(mp(O)&&!k.match(O)&&(E[b]={type:la.pattern,message:F,ref:c,...V(la.pattern,F)},!s))return R(F),E}if(N){if(Ss(N)){const O=await N(k,r),F=yw(O,P);if(F&&(E[b]={...F,...V(la.validate,F.message)},!s))return R(F.message),E}else if(Mn(N)){let O={};for(const F in N){if(!br(O)&&!s)break;const U=yw(await N[F](k,r),P,F);U&&(O={...U,...V(F,U.message)},R(U.message),s&&(E[b]=O))}if(!br(O)&&(E[b]={ref:P,...O},!s))return E}}return R(!0),E};const CV={mode:Cs.onSubmit,reValidateMode:Cs.onChange,shouldFocusError:!0};function SV(t={}){let n={...CV,...t},r={submitCount:0,isDirty:!1,isLoading:Ss(n.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:n.errors||{},disabled:n.disabled||!1};const s={};let i=Mn(n.defaultValues)||Mn(n.values)?nr(n.values||n.defaultValues)||{}:{},o=n.shouldUnregister?{}:nr(i),c={action:!1,mount:!1,watch:!1},d={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},p,m=0;const h={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let g={...h};const v={array:dw(),state:dw()},j=fw(n.mode),N=fw(n.reValidateMode),b=n.criteriaMode===Cs.all,C=L=>de=>{clearTimeout(m),m=setTimeout(L,de)},S=async L=>{if(!n.disabled&&(h.isValid||g.isValid||L)){const de=n.resolver?br((await se()).errors):await G(s,!0);de!==r.isValid&&v.state.next({isValid:de})}},k=(L,de)=>{!n.disabled&&(h.isValidating||h.validatingFields||g.isValidating||g.validatingFields)&&((L||Array.from(d.mount)).forEach(ge=>{ge&&(de?Qt(r.validatingFields,ge,de):Un(r.validatingFields,ge))}),v.state.next({validatingFields:r.validatingFields,isValidating:!br(r.validatingFields)}))},P=(L,de=[],ge,ze,M=!0,ie=!0)=>{if(ze&&ge&&!n.disabled){if(c.action=!0,ie&&Array.isArray(Ue(s,L))){const we=ge(Ue(s,L),ze.argA,ze.argB);M&&Qt(s,L,we)}if(ie&&Array.isArray(Ue(r.errors,L))){const we=ge(Ue(r.errors,L),ze.argA,ze.argB);M&&Qt(r.errors,L,we),wV(r.errors,L)}if((h.touchedFields||g.touchedFields)&&ie&&Array.isArray(Ue(r.touchedFields,L))){const we=ge(Ue(r.touchedFields,L),ze.argA,ze.argB);M&&Qt(r.touchedFields,L,we)}(h.dirtyFields||g.dirtyFields)&&(r.dirtyFields=uc(i,o)),v.state.next({name:L,isDirty:F(L,de),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else Qt(o,L,de)},R=(L,de)=>{Qt(r.errors,L,de),v.state.next({errors:r.errors})},E=L=>{r.errors=L,v.state.next({errors:r.errors,isValid:!1})},A=(L,de,ge,ze)=>{const M=Ue(s,L);if(M){const ie=Ue(o,L,In(ge)?Ue(i,L):ge);In(ie)||ze&&ze.defaultChecked||de?Qt(o,L,de?ie:hw(M._f)):q(L,ie),c.mount&&S()}},W=(L,de,ge,ze,M)=>{let ie=!1,we=!1;const qe={name:L};if(!n.disabled){if(!ge||ze){(h.isDirty||g.isDirty)&&(we=r.isDirty,r.isDirty=qe.isDirty=F(),ie=we!==qe.isDirty);const Ze=Xa(Ue(i,L),de);we=!!Ue(r.dirtyFields,L),Ze?Un(r.dirtyFields,L):Qt(r.dirtyFields,L,!0),qe.dirtyFields=r.dirtyFields,ie=ie||(h.dirtyFields||g.dirtyFields)&&we!==!Ze}if(ge){const Ze=Ue(r.touchedFields,L);Ze||(Qt(r.touchedFields,L,ge),qe.touchedFields=r.touchedFields,ie=ie||(h.touchedFields||g.touchedFields)&&Ze!==ge)}ie&&M&&v.state.next(qe)}return ie?qe:{}},X=(L,de,ge,ze)=>{const M=Ue(r.errors,L),ie=(h.isValid||g.isValid)&&Gr(de)&&r.isValid!==de;if(n.delayError&&ge?(p=C(()=>R(L,ge)),p(n.delayError)):(clearTimeout(m),p=null,ge?Qt(r.errors,L,ge):Un(r.errors,L)),(ge?!Xa(M,ge):M)||!br(ze)||ie){const we={...ze,...ie&&Gr(de)?{isValid:de}:{},errors:r.errors,name:L};r={...r,...we},v.state.next(we)}},se=async L=>{k(L,!0);const de=await n.resolver(o,n.context,xV(L||d.mount,s,n.criteriaMode,n.shouldUseNativeValidation));return k(L),de},V=async L=>{const{errors:de}=await se(L);if(L)for(const ge of L){const ze=Ue(de,ge);ze?Qt(r.errors,ge,ze):Un(r.errors,ge)}else r.errors=de;return de},G=async(L,de,ge={valid:!0})=>{for(const ze in L){const M=L[ze];if(M){const{_f:ie,...we}=M;if(ie){const qe=d.array.has(ie.name),Ze=M._f&&gV(M._f);Ze&&h.validatingFields&&k([ze],!0);const Rt=await jw(M,d.disabled,o,b,n.shouldUseNativeValidation&&!de,qe);if(Ze&&h.validatingFields&&k([ze]),Rt[ie.name]&&(ge.valid=!1,de))break;!de&&(Ue(Rt,ie.name)?qe?NV(r.errors,Rt,ie.name):Qt(r.errors,ie.name,Rt[ie.name]):Un(r.errors,ie.name))}!br(we)&&await G(we,de,ge)}}return ge.valid},O=()=>{for(const L of d.unMount){const de=Ue(s,L);de&&(de._f.refs?de._f.refs.every(ge=>!qf(ge)):!qf(de._f.ref))&&Oe(L)}d.unMount=new Set},F=(L,de)=>!n.disabled&&(L&&de&&Qt(o,L,de),!Xa(re(),i)),U=(L,de,ge)=>RE(L,d,{...c.mount?o:In(de)?i:qs(L)?{[L]:de}:de},ge,de),$=L=>dm(Ue(c.mount?o:i,L,n.shouldUnregister?Ue(i,L,[]):[])),q=(L,de,ge={})=>{const ze=Ue(s,L);let M=de;if(ze){const ie=ze._f;ie&&(!ie.disabled&&Qt(o,L,DE(de,ie)),M=up(ie.ref)&&wr(de)?"":de,_E(ie.ref)?[...ie.ref.options].forEach(we=>we.selected=M.includes(we.value)):ie.refs?ad(ie.ref)?ie.refs.length>1?ie.refs.forEach(we=>(!we.defaultChecked||!we.disabled)&&(we.checked=Array.isArray(M)?!!M.find(qe=>qe===we.value):M===we.value)):ie.refs[0]&&(ie.refs[0].checked=!!M):ie.refs.forEach(we=>we.checked=we.value===M):Dv(ie.ref)?ie.ref.value="":(ie.ref.value=M,ie.ref.type||v.state.next({name:L,values:nr(o)})))}(ge.shouldDirty||ge.shouldTouch)&&W(L,M,ge.shouldTouch,ge.shouldDirty,!0),ge.shouldValidate&&I(L)},le=(L,de,ge)=>{for(const ze in de){const M=de[ze],ie=`${L}.${ze}`,we=Ue(s,ie);(d.array.has(L)||Mn(M)||we&&!we._f)&&!Ii(M)?le(ie,M,ge):q(ie,M,ge)}},K=(L,de,ge={})=>{const ze=Ue(s,L),M=d.array.has(L),ie=nr(de);Qt(o,L,ie),M?(v.array.next({name:L,values:nr(o)}),(h.isDirty||h.dirtyFields||g.isDirty||g.dirtyFields)&&ge.shouldDirty&&v.state.next({name:L,dirtyFields:uc(i,o),isDirty:F(L,ie)})):ze&&!ze._f&&!wr(ie)?le(L,ie,ge):q(L,ie,ge),gw(L,d)&&v.state.next({...r}),v.state.next({name:c.mount?L:void 0,values:nr(o)})},J=async L=>{c.mount=!0;const de=L.target;let ge=de.name,ze=!0;const M=Ue(s,ge),ie=we=>{ze=Number.isNaN(we)||Ii(we)&&isNaN(we.getTime())||Xa(we,Ue(o,ge,we))};if(M){let we,qe;const Ze=de.type?hw(M._f):SE(L),Rt=L.type===dp.BLUR||L.type===dp.FOCUS_OUT,en=!vV(M._f)&&!n.resolver&&!Ue(r.errors,ge)&&!M._f.deps||bV(Rt,Ue(r.touchedFields,ge),r.isSubmitted,N,j),Lt=gw(ge,d,Rt);Qt(o,ge,Ze),Rt?(M._f.onBlur&&M._f.onBlur(L),p&&p(0)):M._f.onChange&&M._f.onChange(L);const An=W(ge,Ze,Rt),Hn=!br(An)||Lt;if(!Rt&&v.state.next({name:ge,type:L.type,values:nr(o)}),en)return(h.isValid||g.isValid)&&(n.mode==="onBlur"?Rt&&S():Rt||S()),Hn&&v.state.next({name:ge,...Lt?{}:An});if(!Rt&&Lt&&v.state.next({...r}),n.resolver){const{errors:tn}=await se([ge]);if(ie(Ze),ze){const Sn=vw(r.errors,s,ge),hn=vw(tn,s,Sn.name||ge);we=hn.error,ge=hn.name,qe=br(tn)}}else k([ge],!0),we=(await jw(M,d.disabled,o,b,n.shouldUseNativeValidation))[ge],k([ge]),ie(Ze),ze&&(we?qe=!1:(h.isValid||g.isValid)&&(qe=await G(s,!0)));ze&&(M._f.deps&&I(M._f.deps),X(ge,qe,we,An))}},D=(L,de)=>{if(Ue(r.errors,de)&&L.focus)return L.focus(),1},I=async(L,de={})=>{let ge,ze;const M=Nc(L);if(n.resolver){const ie=await V(In(L)?L:M);ge=br(ie),ze=L?!M.some(we=>Ue(ie,we)):ge}else L?(ze=(await Promise.all(M.map(async ie=>{const we=Ue(s,ie);return await G(we&&we._f?{[ie]:we}:we)}))).every(Boolean),!(!ze&&!r.isValid)&&S()):ze=ge=await G(s);return v.state.next({...!qs(L)||(h.isValid||g.isValid)&&ge!==r.isValid?{}:{name:L},...n.resolver||!L?{isValid:ge}:{},errors:r.errors}),de.shouldFocus&&!ze&&Cc(s,D,L?M:d.mount),ze},re=L=>{const de={...c.mount?o:i};return In(L)?de:qs(L)?Ue(de,L):L.map(ge=>Ue(de,ge))},T=(L,de)=>({invalid:!!Ue((de||r).errors,L),isDirty:!!Ue((de||r).dirtyFields,L),error:Ue((de||r).errors,L),isValidating:!!Ue(r.validatingFields,L),isTouched:!!Ue((de||r).touchedFields,L)}),Y=L=>{L&&Nc(L).forEach(de=>Un(r.errors,de)),v.state.next({errors:L?r.errors:{}})},oe=(L,de,ge)=>{const ze=(Ue(s,L,{_f:{}})._f||{}).ref,M=Ue(r.errors,L)||{},{ref:ie,message:we,type:qe,...Ze}=M;Qt(r.errors,L,{...Ze,...de,ref:ze}),v.state.next({name:L,errors:r.errors,isValid:!1}),ge&&ge.shouldFocus&&ze&&ze.focus&&ze.focus()},Ne=(L,de)=>Ss(L)?v.state.subscribe({next:ge=>L(U(void 0,de),ge)}):U(L,de,!0),xe=L=>v.state.subscribe({next:de=>{jV(L.name,de.name,L.exact)&&yV(de,L.formState||h,Jt,L.reRenderRoot)&&L.callback({values:{...o},...r,...de})}}).unsubscribe,Se=L=>(c.mount=!0,g={...g,...L.formState},xe({...L,formState:g})),Oe=(L,de={})=>{for(const ge of L?Nc(L):d.mount)d.mount.delete(ge),d.array.delete(ge),de.keepValue||(Un(s,ge),Un(o,ge)),!de.keepError&&Un(r.errors,ge),!de.keepDirty&&Un(r.dirtyFields,ge),!de.keepTouched&&Un(r.touchedFields,ge),!de.keepIsValidating&&Un(r.validatingFields,ge),!n.shouldUnregister&&!de.keepDefaultValue&&Un(i,ge);v.state.next({values:nr(o)}),v.state.next({...r,...de.keepDirty?{isDirty:F()}:{}}),!de.keepIsValid&&S()},Pe=({disabled:L,name:de})=>{(Gr(L)&&c.mount||L||d.disabled.has(de))&&(L?d.disabled.add(de):d.disabled.delete(de))},Be=(L,de={})=>{let ge=Ue(s,L);const ze=Gr(de.disabled)||Gr(n.disabled);return Qt(s,L,{...ge||{},_f:{...ge&&ge._f?ge._f:{ref:{name:L}},name:L,mount:!0,...de}}),d.mount.add(L),ge?Pe({disabled:Gr(de.disabled)?de.disabled:n.disabled,name:L}):A(L,!0,de.value),{...ze?{disabled:de.disabled||n.disabled}:{},...n.progressive?{required:!!de.required,min:pc(de.min),max:pc(de.max),minLength:pc(de.minLength),maxLength:pc(de.maxLength),pattern:pc(de.pattern)}:{},name:L,onChange:J,onBlur:J,ref:M=>{if(M){Be(L,de),ge=Ue(s,L);const ie=In(M.value)&&M.querySelectorAll&&M.querySelectorAll("input,select,textarea")[0]||M,we=mV(ie),qe=ge._f.refs||[];if(we?qe.find(Ze=>Ze===ie):ie===ge._f.ref)return;Qt(s,L,{_f:{...ge._f,...we?{refs:[...qe.filter(qf),ie,...Array.isArray(Ue(i,L))?[{}]:[]],ref:{type:ie.type,name:L}}:{ref:ie}}}),A(L,!1,void 0,ie)}else ge=Ue(s,L,{}),ge._f&&(ge._f.mount=!1),(n.shouldUnregister||de.shouldUnregister)&&!(kE(d.array,L)&&c.action)&&d.unMount.add(L)}}},ve=()=>n.shouldFocusError&&Cc(s,D,d.mount),We=L=>{Gr(L)&&(v.state.next({disabled:L}),Cc(s,(de,ge)=>{const ze=Ue(s,ge);ze&&(de.disabled=ze._f.disabled||L,Array.isArray(ze._f.refs)&&ze._f.refs.forEach(M=>{M.disabled=ze._f.disabled||L}))},0,!1))},Ye=(L,de)=>async ge=>{let ze;ge&&(ge.preventDefault&&ge.preventDefault(),ge.persist&&ge.persist());let M=nr(o);if(v.state.next({isSubmitting:!0}),n.resolver){const{errors:ie,values:we}=await se();r.errors=ie,M=we}else await G(s);if(d.disabled.size)for(const ie of d.disabled)Qt(M,ie,void 0);if(Un(r.errors,"root"),br(r.errors)){v.state.next({errors:{}});try{await L(M,ge)}catch(ie){ze=ie}}else de&&await de({...r.errors},ge),ve(),setTimeout(ve);if(v.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:br(r.errors)&&!ze,submitCount:r.submitCount+1,errors:r.errors}),ze)throw ze},Qe=(L,de={})=>{Ue(s,L)&&(In(de.defaultValue)?K(L,nr(Ue(i,L))):(K(L,de.defaultValue),Qt(i,L,nr(de.defaultValue))),de.keepTouched||Un(r.touchedFields,L),de.keepDirty||(Un(r.dirtyFields,L),r.isDirty=de.defaultValue?F(L,nr(Ue(i,L))):F()),de.keepError||(Un(r.errors,L),h.isValid&&S()),v.state.next({...r}))},mt=(L,de={})=>{const ge=L?nr(L):i,ze=nr(ge),M=br(L),ie=M?i:ze;if(de.keepDefaultValues||(i=ge),!de.keepValues){if(de.keepDirtyValues){const we=new Set([...d.mount,...Object.keys(uc(i,o))]);for(const qe of Array.from(we))Ue(r.dirtyFields,qe)?Qt(ie,qe,Ue(o,qe)):K(qe,Ue(ie,qe))}else{if(Mv&&In(L))for(const we of d.mount){const qe=Ue(s,we);if(qe&&qe._f){const Ze=Array.isArray(qe._f.refs)?qe._f.refs[0]:qe._f.ref;if(up(Ze)){const Rt=Ze.closest("form");if(Rt){Rt.reset();break}}}}for(const we of d.mount)K(we,Ue(ie,we))}o=nr(ie),v.array.next({values:{...ie}}),v.state.next({values:{...ie}})}d={mount:de.keepDirtyValues?d.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},c.mount=!h.isValid||!!de.keepIsValid||!!de.keepDirtyValues,c.watch=!!n.shouldUnregister,v.state.next({submitCount:de.keepSubmitCount?r.submitCount:0,isDirty:M?!1:de.keepDirty?r.isDirty:!!(de.keepDefaultValues&&!Xa(L,i)),isSubmitted:de.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:M?{}:de.keepDirtyValues?de.keepDefaultValues&&o?uc(i,o):r.dirtyFields:de.keepDefaultValues&&L?uc(i,L):de.keepDirty?r.dirtyFields:{},touchedFields:de.keepTouched?r.touchedFields:{},errors:de.keepErrors?r.errors:{},isSubmitSuccessful:de.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},ht=(L,de)=>mt(Ss(L)?L(o):L,de),cn=(L,de={})=>{const ge=Ue(s,L),ze=ge&&ge._f;if(ze){const M=ze.refs?ze.refs[0]:ze.ref;M.focus&&(M.focus(),de.shouldSelect&&Ss(M.select)&&M.select())}},Jt=L=>{r={...r,...L}},tt={control:{register:Be,unregister:Oe,getFieldState:T,handleSubmit:Ye,setError:oe,_subscribe:xe,_runSchema:se,_getWatch:U,_getDirty:F,_setValid:S,_setFieldArray:P,_setDisabledField:Pe,_setErrors:E,_getFieldArray:$,_reset:mt,_resetDefaultValues:()=>Ss(n.defaultValues)&&n.defaultValues().then(L=>{ht(L,n.resetOptions),v.state.next({isLoading:!1})}),_removeUnmounted:O,_disableForm:We,_subjects:v,_proxyFormState:h,get _fields(){return s},get _formValues(){return o},get _state(){return c},set _state(L){c=L},get _defaultValues(){return i},get _names(){return d},set _names(L){d=L},get _formState(){return r},get _options(){return n},set _options(L){n={...n,...L}}},subscribe:Se,trigger:I,register:Be,handleSubmit:Ye,watch:Ne,setValue:K,getValues:re,reset:ht,resetField:Qe,clearErrors:Y,unregister:Oe,setError:oe,setFocus:cn,getFieldState:T};return{...tt,formControl:tt}}function Dc(t={}){const n=ut.useRef(void 0),r=ut.useRef(void 0),[s,i]=ut.useState({isDirty:!1,isValidating:!1,isLoading:Ss(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,defaultValues:Ss(t.defaultValues)?void 0:t.defaultValues});n.current||(n.current={...t.formControl?t.formControl:SV(t),formState:s},t.formControl&&t.defaultValues&&!Ss(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions));const o=n.current.control;return o._options=t,ut.useLayoutEffect(()=>o._subscribe({formState:o._proxyFormState,callback:()=>i({...o._formState}),reRenderRoot:!0}),[o]),ut.useEffect(()=>o._disableForm(t.disabled),[o,t.disabled]),ut.useEffect(()=>{if(o._proxyFormState.isDirty){const c=o._getDirty();c!==s.isDirty&&o._subjects.state.next({isDirty:c})}},[o,s.isDirty]),ut.useEffect(()=>{t.values&&!Xa(t.values,r.current)?(o._reset(t.values,o._options.resetOptions),r.current=t.values,i(c=>({...c}))):o._resetDefaultValues()},[t.values,o]),ut.useEffect(()=>{t.errors&&!br(t.errors)&&o._setErrors(t.errors)},[t.errors,o]),ut.useEffect(()=>{o._state.mount||(o._setValid(),o._state.mount=!0),o._state.watch&&(o._state.watch=!1,o._subjects.state.next({...o._formState})),o._removeUnmounted()}),ut.useEffect(()=>{t.shouldUnregister&&o._subjects.state.next({values:o._getWatch()})},[t.shouldUnregister,o]),n.current.formState=TE(s,o),n.current}const bw=(t,n,r)=>{if(t&&"reportValidity"in t){const s=Ue(r,n);t.setCustomValidity(s&&s.message||""),t.reportValidity()}},FE=(t,n)=>{for(const r in n.fields){const s=n.fields[r];s&&s.ref&&"reportValidity"in s.ref?bw(s.ref,r,t):s.refs&&s.refs.forEach(i=>bw(i,r,t))}},kV=(t,n)=>{n.shouldUseNativeValidation&&FE(t,n);const r={};for(const s in t){const i=Ue(n.fields,s),o=Object.assign(t[s]||{},{ref:i&&i.ref});if(EV(n.names||Object.keys(t),s)){const c=Object.assign({},Ue(r,s));Qt(c,"root",o),Qt(r,s,c)}else Qt(r,s,o)}return r},EV=(t,n)=>t.some(r=>r.startsWith(n+"."));var PV=function(t,n){for(var r={};t.length;){var s=t[0],i=s.code,o=s.message,c=s.path.join(".");if(!r[c])if("unionErrors"in s){var d=s.unionErrors[0].errors[0];r[c]={message:d.message,type:d.code}}else r[c]={message:o,type:i};if("unionErrors"in s&&s.unionErrors.forEach(function(h){return h.errors.forEach(function(g){return t.push(g)})}),n){var p=r[c].types,m=p&&p[s.code];r[c]=AE(c,n,r,i,m?[].concat(m,s.message):s.message)}t.shift()}return r},Lc=function(t,n,r){return r===void 0&&(r={}),function(s,i,o){try{return Promise.resolve((function(c,d){try{var p=Promise.resolve(t[r.mode==="sync"?"parse":"parseAsync"](s,n)).then(function(m){return o.shouldUseNativeValidation&&FE({},o),{errors:{},values:r.raw?s:m}})}catch(m){return d(m)}return p&&p.then?p.then(void 0,d):p})(0,function(c){if((function(d){return Array.isArray(d?.errors)})(c))return{values:{},errors:kV(PV(c.errors,!o.shouldUseNativeValidation&&o.criteriaMode==="all"),o)};throw c}))}catch(c){return Promise.reject(c)}}},Ht;(function(t){t.assertEqual=i=>{};function n(i){}t.assertIs=n;function r(i){throw new Error}t.assertNever=r,t.arrayToEnum=i=>{const o={};for(const c of i)o[c]=c;return o},t.getValidEnumValues=i=>{const o=t.objectKeys(i).filter(d=>typeof i[i[d]]!="number"),c={};for(const d of o)c[d]=i[d];return t.objectValues(c)},t.objectValues=i=>t.objectKeys(i).map(function(o){return i[o]}),t.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const o=[];for(const c in i)Object.prototype.hasOwnProperty.call(i,c)&&o.push(c);return o},t.find=(i,o)=>{for(const c of i)if(o(c))return c},t.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function s(i,o=" | "){return i.map(c=>typeof c=="string"?`'${c}'`:c).join(o)}t.joinValues=s,t.jsonStringifyReplacer=(i,o)=>typeof o=="bigint"?o.toString():o})(Ht||(Ht={}));var ww;(function(t){t.mergeShapes=(n,r)=>({...n,...r})})(ww||(ww={}));const rt=Ht.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Za=t=>{switch(typeof t){case"undefined":return rt.undefined;case"string":return rt.string;case"number":return Number.isNaN(t)?rt.nan:rt.number;case"boolean":return rt.boolean;case"function":return rt.function;case"bigint":return rt.bigint;case"symbol":return rt.symbol;case"object":return Array.isArray(t)?rt.array:t===null?rt.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?rt.promise:typeof Map<"u"&&t instanceof Map?rt.map:typeof Set<"u"&&t instanceof Set?rt.set:typeof Date<"u"&&t instanceof Date?rt.date:rt.object;default:return rt.unknown}},$e=Ht.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class va extends Error{get errors(){return this.issues}constructor(n){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=n}format(n){const r=n||function(o){return o.message},s={_errors:[]},i=o=>{for(const c of o.issues)if(c.code==="invalid_union")c.unionErrors.map(i);else if(c.code==="invalid_return_type")i(c.returnTypeError);else if(c.code==="invalid_arguments")i(c.argumentsError);else if(c.path.length===0)s._errors.push(r(c));else{let d=s,p=0;for(;p<c.path.length;){const m=c.path[p];p===c.path.length-1?(d[m]=d[m]||{_errors:[]},d[m]._errors.push(r(c))):d[m]=d[m]||{_errors:[]},d=d[m],p++}}};return i(this),s}static assert(n){if(!(n instanceof va))throw new Error(`Not a ZodError: ${n}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ht.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(n=r=>r.message){const r={},s=[];for(const i of this.issues)if(i.path.length>0){const o=i.path[0];r[o]=r[o]||[],r[o].push(n(i))}else s.push(n(i));return{formErrors:s,fieldErrors:r}}get formErrors(){return this.flatten()}}va.create=t=>new va(t);const Ox=(t,n)=>{let r;switch(t.code){case $e.invalid_type:t.received===rt.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case $e.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,Ht.jsonStringifyReplacer)}`;break;case $e.unrecognized_keys:r=`Unrecognized key(s) in object: ${Ht.joinValues(t.keys,", ")}`;break;case $e.invalid_union:r="Invalid input";break;case $e.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Ht.joinValues(t.options)}`;break;case $e.invalid_enum_value:r=`Invalid enum value. Expected ${Ht.joinValues(t.options)}, received '${t.received}'`;break;case $e.invalid_arguments:r="Invalid function arguments";break;case $e.invalid_return_type:r="Invalid function return type";break;case $e.invalid_date:r="Invalid date";break;case $e.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:Ht.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case $e.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case $e.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case $e.custom:r="Invalid input";break;case $e.invalid_intersection_types:r="Intersection results could not be merged";break;case $e.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case $e.not_finite:r="Number must be finite";break;default:r=n.defaultError,Ht.assertNever(t)}return{message:r}};let TV=Ox;function RV(){return TV}const AV=t=>{const{data:n,path:r,errorMaps:s,issueData:i}=t,o=[...r,...i.path||[]],c={...i,path:o};if(i.message!==void 0)return{...i,path:o,message:i.message};let d="";const p=s.filter(m=>!!m).slice().reverse();for(const m of p)d=m(c,{data:n,defaultError:d}).message;return{...i,path:o,message:d}};function He(t,n){const r=RV(),s=AV({issueData:n,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===Ox?void 0:Ox].filter(i=>!!i)});t.common.issues.push(s)}class Xr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(n,r){const s=[];for(const i of r){if(i.status==="aborted")return Ct;i.status==="dirty"&&n.dirty(),s.push(i.value)}return{status:n.value,value:s}}static async mergeObjectAsync(n,r){const s=[];for(const i of r){const o=await i.key,c=await i.value;s.push({key:o,value:c})}return Xr.mergeObjectSync(n,s)}static mergeObjectSync(n,r){const s={};for(const i of r){const{key:o,value:c}=i;if(o.status==="aborted"||c.status==="aborted")return Ct;o.status==="dirty"&&n.dirty(),c.status==="dirty"&&n.dirty(),o.value!=="__proto__"&&(typeof c.value<"u"||i.alwaysSet)&&(s[o.value]=c.value)}return{status:n.value,value:s}}}const Ct=Object.freeze({status:"aborted"}),gc=t=>({status:"dirty",value:t}),ms=t=>({status:"valid",value:t}),Nw=t=>t.status==="aborted",Cw=t=>t.status==="dirty",Xo=t=>t.status==="valid",hp=t=>typeof Promise<"u"&&t instanceof Promise;var it;(function(t){t.errToObj=n=>typeof n=="string"?{message:n}:n||{},t.toString=n=>typeof n=="string"?n:n?.message})(it||(it={}));class ui{constructor(n,r,s,i){this._cachedPath=[],this.parent=n,this.data=r,this._path=s,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Sw=(t,n)=>{if(Xo(n))return{success:!0,data:n.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new va(t.common.issues);return this._error=r,this._error}}};function Dt(t){if(!t)return{};const{errorMap:n,invalid_type_error:r,required_error:s,description:i}=t;if(n&&(r||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return n?{errorMap:n,description:i}:{errorMap:(c,d)=>{const{message:p}=t;return c.code==="invalid_enum_value"?{message:p??d.defaultError}:typeof d.data>"u"?{message:p??s??d.defaultError}:c.code!=="invalid_type"?{message:d.defaultError}:{message:p??r??d.defaultError}},description:i}}class zt{get description(){return this._def.description}_getType(n){return Za(n.data)}_getOrReturnCtx(n,r){return r||{common:n.parent.common,data:n.data,parsedType:Za(n.data),schemaErrorMap:this._def.errorMap,path:n.path,parent:n.parent}}_processInputParams(n){return{status:new Xr,ctx:{common:n.parent.common,data:n.data,parsedType:Za(n.data),schemaErrorMap:this._def.errorMap,path:n.path,parent:n.parent}}}_parseSync(n){const r=this._parse(n);if(hp(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(n){const r=this._parse(n);return Promise.resolve(r)}parse(n,r){const s=this.safeParse(n,r);if(s.success)return s.data;throw s.error}safeParse(n,r){const s={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:n,parsedType:Za(n)},i=this._parseSync({data:n,path:s.path,parent:s});return Sw(s,i)}"~validate"(n){const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:n,parsedType:Za(n)};if(!this["~standard"].async)try{const s=this._parseSync({data:n,path:[],parent:r});return Xo(s)?{value:s.value}:{issues:r.common.issues}}catch(s){s?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:n,path:[],parent:r}).then(s=>Xo(s)?{value:s.value}:{issues:r.common.issues})}async parseAsync(n,r){const s=await this.safeParseAsync(n,r);if(s.success)return s.data;throw s.error}async safeParseAsync(n,r){const s={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:n,parsedType:Za(n)},i=this._parse({data:n,path:s.path,parent:s}),o=await(hp(i)?i:Promise.resolve(i));return Sw(s,o)}refine(n,r){const s=i=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(i):r;return this._refinement((i,o)=>{const c=n(i),d=()=>o.addIssue({code:$e.custom,...s(i)});return typeof Promise<"u"&&c instanceof Promise?c.then(p=>p?!0:(d(),!1)):c?!0:(d(),!1)})}refinement(n,r){return this._refinement((s,i)=>n(s)?!0:(i.addIssue(typeof r=="function"?r(s,i):r),!1))}_refinement(n){return new tl({schema:this,typeName:Et.ZodEffects,effect:{type:"refinement",refinement:n}})}superRefine(n){return this._refinement(n)}constructor(n){this.spa=this.safeParseAsync,this._def=n,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return ai.create(this,this._def)}nullable(){return nl.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Gs.create(this)}promise(){return vp.create(this,this._def)}or(n){return xp.create([this,n],this._def)}and(n){return gp.create(this,n,this._def)}transform(n){return new tl({...Dt(this._def),schema:this,typeName:Et.ZodEffects,effect:{type:"transform",transform:n}})}default(n){const r=typeof n=="function"?n:()=>n;return new Fx({...Dt(this._def),innerType:this,defaultValue:r,typeName:Et.ZodDefault})}brand(){return new e8({typeName:Et.ZodBranded,type:this,...Dt(this._def)})}catch(n){const r=typeof n=="function"?n:()=>n;return new $x({...Dt(this._def),innerType:this,catchValue:r,typeName:Et.ZodCatch})}describe(n){const r=this.constructor;return new r({...this._def,description:n})}pipe(n){return Fv.create(this,n)}readonly(){return zx.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const _V=/^c[^\s-]{8,}$/i,IV=/^[0-9a-z]+$/,MV=/^[0-9A-HJKMNP-TV-Z]{26}$/i,OV=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,DV=/^[a-z0-9_-]{21}$/i,LV=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,FV=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,$V=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,zV="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Uf;const VV=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,qV=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,UV=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,BV=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,GV=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,HV=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,$E="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",KV=new RegExp(`^${$E}$`);function zE(t){let n="[0-5]\\d";t.precision?n=`${n}\\.\\d{${t.precision}}`:t.precision==null&&(n=`${n}(\\.\\d+)?`);const r=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${n})${r}`}function WV(t){return new RegExp(`^${zE(t)}$`)}function QV(t){let n=`${$E}T${zE(t)}`;const r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),n=`${n}(${r.join("|")})`,new RegExp(`^${n}$`)}function YV(t,n){return!!((n==="v4"||!n)&&VV.test(t)||(n==="v6"||!n)&&UV.test(t))}function ZV(t,n){if(!LV.test(t))return!1;try{const[r]=t.split(".");if(!r)return!1;const s=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),i=JSON.parse(atob(s));return!(typeof i!="object"||i===null||"typ"in i&&i?.typ!=="JWT"||!i.alg||n&&i.alg!==n)}catch{return!1}}function XV(t,n){return!!((n==="v4"||!n)&&qV.test(t)||(n==="v6"||!n)&&BV.test(t))}class ni extends zt{_parse(n){if(this._def.coerce&&(n.data=String(n.data)),this._getType(n)!==rt.string){const o=this._getOrReturnCtx(n);return He(o,{code:$e.invalid_type,expected:rt.string,received:o.parsedType}),Ct}const s=new Xr;let i;for(const o of this._def.checks)if(o.kind==="min")n.data.length<o.value&&(i=this._getOrReturnCtx(n,i),He(i,{code:$e.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),s.dirty());else if(o.kind==="max")n.data.length>o.value&&(i=this._getOrReturnCtx(n,i),He(i,{code:$e.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),s.dirty());else if(o.kind==="length"){const c=n.data.length>o.value,d=n.data.length<o.value;(c||d)&&(i=this._getOrReturnCtx(n,i),c?He(i,{code:$e.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):d&&He(i,{code:$e.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),s.dirty())}else if(o.kind==="email")$V.test(n.data)||(i=this._getOrReturnCtx(n,i),He(i,{validation:"email",code:$e.invalid_string,message:o.message}),s.dirty());else if(o.kind==="emoji")Uf||(Uf=new RegExp(zV,"u")),Uf.test(n.data)||(i=this._getOrReturnCtx(n,i),He(i,{validation:"emoji",code:$e.invalid_string,message:o.message}),s.dirty());else if(o.kind==="uuid")OV.test(n.data)||(i=this._getOrReturnCtx(n,i),He(i,{validation:"uuid",code:$e.invalid_string,message:o.message}),s.dirty());else if(o.kind==="nanoid")DV.test(n.data)||(i=this._getOrReturnCtx(n,i),He(i,{validation:"nanoid",code:$e.invalid_string,message:o.message}),s.dirty());else if(o.kind==="cuid")_V.test(n.data)||(i=this._getOrReturnCtx(n,i),He(i,{validation:"cuid",code:$e.invalid_string,message:o.message}),s.dirty());else if(o.kind==="cuid2")IV.test(n.data)||(i=this._getOrReturnCtx(n,i),He(i,{validation:"cuid2",code:$e.invalid_string,message:o.message}),s.dirty());else if(o.kind==="ulid")MV.test(n.data)||(i=this._getOrReturnCtx(n,i),He(i,{validation:"ulid",code:$e.invalid_string,message:o.message}),s.dirty());else if(o.kind==="url")try{new URL(n.data)}catch{i=this._getOrReturnCtx(n,i),He(i,{validation:"url",code:$e.invalid_string,message:o.message}),s.dirty()}else o.kind==="regex"?(o.regex.lastIndex=0,o.regex.test(n.data)||(i=this._getOrReturnCtx(n,i),He(i,{validation:"regex",code:$e.invalid_string,message:o.message}),s.dirty())):o.kind==="trim"?n.data=n.data.trim():o.kind==="includes"?n.data.includes(o.value,o.position)||(i=this._getOrReturnCtx(n,i),He(i,{code:$e.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),s.dirty()):o.kind==="toLowerCase"?n.data=n.data.toLowerCase():o.kind==="toUpperCase"?n.data=n.data.toUpperCase():o.kind==="startsWith"?n.data.startsWith(o.value)||(i=this._getOrReturnCtx(n,i),He(i,{code:$e.invalid_string,validation:{startsWith:o.value},message:o.message}),s.dirty()):o.kind==="endsWith"?n.data.endsWith(o.value)||(i=this._getOrReturnCtx(n,i),He(i,{code:$e.invalid_string,validation:{endsWith:o.value},message:o.message}),s.dirty()):o.kind==="datetime"?QV(o).test(n.data)||(i=this._getOrReturnCtx(n,i),He(i,{code:$e.invalid_string,validation:"datetime",message:o.message}),s.dirty()):o.kind==="date"?KV.test(n.data)||(i=this._getOrReturnCtx(n,i),He(i,{code:$e.invalid_string,validation:"date",message:o.message}),s.dirty()):o.kind==="time"?WV(o).test(n.data)||(i=this._getOrReturnCtx(n,i),He(i,{code:$e.invalid_string,validation:"time",message:o.message}),s.dirty()):o.kind==="duration"?FV.test(n.data)||(i=this._getOrReturnCtx(n,i),He(i,{validation:"duration",code:$e.invalid_string,message:o.message}),s.dirty()):o.kind==="ip"?YV(n.data,o.version)||(i=this._getOrReturnCtx(n,i),He(i,{validation:"ip",code:$e.invalid_string,message:o.message}),s.dirty()):o.kind==="jwt"?ZV(n.data,o.alg)||(i=this._getOrReturnCtx(n,i),He(i,{validation:"jwt",code:$e.invalid_string,message:o.message}),s.dirty()):o.kind==="cidr"?XV(n.data,o.version)||(i=this._getOrReturnCtx(n,i),He(i,{validation:"cidr",code:$e.invalid_string,message:o.message}),s.dirty()):o.kind==="base64"?GV.test(n.data)||(i=this._getOrReturnCtx(n,i),He(i,{validation:"base64",code:$e.invalid_string,message:o.message}),s.dirty()):o.kind==="base64url"?HV.test(n.data)||(i=this._getOrReturnCtx(n,i),He(i,{validation:"base64url",code:$e.invalid_string,message:o.message}),s.dirty()):Ht.assertNever(o);return{status:s.value,value:n.data}}_regex(n,r,s){return this.refinement(i=>n.test(i),{validation:r,code:$e.invalid_string,...it.errToObj(s)})}_addCheck(n){return new ni({...this._def,checks:[...this._def.checks,n]})}email(n){return this._addCheck({kind:"email",...it.errToObj(n)})}url(n){return this._addCheck({kind:"url",...it.errToObj(n)})}emoji(n){return this._addCheck({kind:"emoji",...it.errToObj(n)})}uuid(n){return this._addCheck({kind:"uuid",...it.errToObj(n)})}nanoid(n){return this._addCheck({kind:"nanoid",...it.errToObj(n)})}cuid(n){return this._addCheck({kind:"cuid",...it.errToObj(n)})}cuid2(n){return this._addCheck({kind:"cuid2",...it.errToObj(n)})}ulid(n){return this._addCheck({kind:"ulid",...it.errToObj(n)})}base64(n){return this._addCheck({kind:"base64",...it.errToObj(n)})}base64url(n){return this._addCheck({kind:"base64url",...it.errToObj(n)})}jwt(n){return this._addCheck({kind:"jwt",...it.errToObj(n)})}ip(n){return this._addCheck({kind:"ip",...it.errToObj(n)})}cidr(n){return this._addCheck({kind:"cidr",...it.errToObj(n)})}datetime(n){return typeof n=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:n}):this._addCheck({kind:"datetime",precision:typeof n?.precision>"u"?null:n?.precision,offset:n?.offset??!1,local:n?.local??!1,...it.errToObj(n?.message)})}date(n){return this._addCheck({kind:"date",message:n})}time(n){return typeof n=="string"?this._addCheck({kind:"time",precision:null,message:n}):this._addCheck({kind:"time",precision:typeof n?.precision>"u"?null:n?.precision,...it.errToObj(n?.message)})}duration(n){return this._addCheck({kind:"duration",...it.errToObj(n)})}regex(n,r){return this._addCheck({kind:"regex",regex:n,...it.errToObj(r)})}includes(n,r){return this._addCheck({kind:"includes",value:n,position:r?.position,...it.errToObj(r?.message)})}startsWith(n,r){return this._addCheck({kind:"startsWith",value:n,...it.errToObj(r)})}endsWith(n,r){return this._addCheck({kind:"endsWith",value:n,...it.errToObj(r)})}min(n,r){return this._addCheck({kind:"min",value:n,...it.errToObj(r)})}max(n,r){return this._addCheck({kind:"max",value:n,...it.errToObj(r)})}length(n,r){return this._addCheck({kind:"length",value:n,...it.errToObj(r)})}nonempty(n){return this.min(1,it.errToObj(n))}trim(){return new ni({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ni({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ni({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(n=>n.kind==="datetime")}get isDate(){return!!this._def.checks.find(n=>n.kind==="date")}get isTime(){return!!this._def.checks.find(n=>n.kind==="time")}get isDuration(){return!!this._def.checks.find(n=>n.kind==="duration")}get isEmail(){return!!this._def.checks.find(n=>n.kind==="email")}get isURL(){return!!this._def.checks.find(n=>n.kind==="url")}get isEmoji(){return!!this._def.checks.find(n=>n.kind==="emoji")}get isUUID(){return!!this._def.checks.find(n=>n.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(n=>n.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(n=>n.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(n=>n.kind==="cuid2")}get isULID(){return!!this._def.checks.find(n=>n.kind==="ulid")}get isIP(){return!!this._def.checks.find(n=>n.kind==="ip")}get isCIDR(){return!!this._def.checks.find(n=>n.kind==="cidr")}get isBase64(){return!!this._def.checks.find(n=>n.kind==="base64")}get isBase64url(){return!!this._def.checks.find(n=>n.kind==="base64url")}get minLength(){let n=null;for(const r of this._def.checks)r.kind==="min"&&(n===null||r.value>n)&&(n=r.value);return n}get maxLength(){let n=null;for(const r of this._def.checks)r.kind==="max"&&(n===null||r.value<n)&&(n=r.value);return n}}ni.create=t=>new ni({checks:[],typeName:Et.ZodString,coerce:t?.coerce??!1,...Dt(t)});function JV(t,n){const r=(t.toString().split(".")[1]||"").length,s=(n.toString().split(".")[1]||"").length,i=r>s?r:s,o=Number.parseInt(t.toFixed(i).replace(".","")),c=Number.parseInt(n.toFixed(i).replace(".",""));return o%c/10**i}class Jo extends zt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(n){if(this._def.coerce&&(n.data=Number(n.data)),this._getType(n)!==rt.number){const o=this._getOrReturnCtx(n);return He(o,{code:$e.invalid_type,expected:rt.number,received:o.parsedType}),Ct}let s;const i=new Xr;for(const o of this._def.checks)o.kind==="int"?Ht.isInteger(n.data)||(s=this._getOrReturnCtx(n,s),He(s,{code:$e.invalid_type,expected:"integer",received:"float",message:o.message}),i.dirty()):o.kind==="min"?(o.inclusive?n.data<o.value:n.data<=o.value)&&(s=this._getOrReturnCtx(n,s),He(s,{code:$e.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),i.dirty()):o.kind==="max"?(o.inclusive?n.data>o.value:n.data>=o.value)&&(s=this._getOrReturnCtx(n,s),He(s,{code:$e.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),i.dirty()):o.kind==="multipleOf"?JV(n.data,o.value)!==0&&(s=this._getOrReturnCtx(n,s),He(s,{code:$e.not_multiple_of,multipleOf:o.value,message:o.message}),i.dirty()):o.kind==="finite"?Number.isFinite(n.data)||(s=this._getOrReturnCtx(n,s),He(s,{code:$e.not_finite,message:o.message}),i.dirty()):Ht.assertNever(o);return{status:i.value,value:n.data}}gte(n,r){return this.setLimit("min",n,!0,it.toString(r))}gt(n,r){return this.setLimit("min",n,!1,it.toString(r))}lte(n,r){return this.setLimit("max",n,!0,it.toString(r))}lt(n,r){return this.setLimit("max",n,!1,it.toString(r))}setLimit(n,r,s,i){return new Jo({...this._def,checks:[...this._def.checks,{kind:n,value:r,inclusive:s,message:it.toString(i)}]})}_addCheck(n){return new Jo({...this._def,checks:[...this._def.checks,n]})}int(n){return this._addCheck({kind:"int",message:it.toString(n)})}positive(n){return this._addCheck({kind:"min",value:0,inclusive:!1,message:it.toString(n)})}negative(n){return this._addCheck({kind:"max",value:0,inclusive:!1,message:it.toString(n)})}nonpositive(n){return this._addCheck({kind:"max",value:0,inclusive:!0,message:it.toString(n)})}nonnegative(n){return this._addCheck({kind:"min",value:0,inclusive:!0,message:it.toString(n)})}multipleOf(n,r){return this._addCheck({kind:"multipleOf",value:n,message:it.toString(r)})}finite(n){return this._addCheck({kind:"finite",message:it.toString(n)})}safe(n){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:it.toString(n)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:it.toString(n)})}get minValue(){let n=null;for(const r of this._def.checks)r.kind==="min"&&(n===null||r.value>n)&&(n=r.value);return n}get maxValue(){let n=null;for(const r of this._def.checks)r.kind==="max"&&(n===null||r.value<n)&&(n=r.value);return n}get isInt(){return!!this._def.checks.find(n=>n.kind==="int"||n.kind==="multipleOf"&&Ht.isInteger(n.value))}get isFinite(){let n=null,r=null;for(const s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(r===null||s.value>r)&&(r=s.value):s.kind==="max"&&(n===null||s.value<n)&&(n=s.value)}return Number.isFinite(r)&&Number.isFinite(n)}}Jo.create=t=>new Jo({checks:[],typeName:Et.ZodNumber,coerce:t?.coerce||!1,...Dt(t)});class Fc extends zt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(n){if(this._def.coerce)try{n.data=BigInt(n.data)}catch{return this._getInvalidInput(n)}if(this._getType(n)!==rt.bigint)return this._getInvalidInput(n);let s;const i=new Xr;for(const o of this._def.checks)o.kind==="min"?(o.inclusive?n.data<o.value:n.data<=o.value)&&(s=this._getOrReturnCtx(n,s),He(s,{code:$e.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),i.dirty()):o.kind==="max"?(o.inclusive?n.data>o.value:n.data>=o.value)&&(s=this._getOrReturnCtx(n,s),He(s,{code:$e.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),i.dirty()):o.kind==="multipleOf"?n.data%o.value!==BigInt(0)&&(s=this._getOrReturnCtx(n,s),He(s,{code:$e.not_multiple_of,multipleOf:o.value,message:o.message}),i.dirty()):Ht.assertNever(o);return{status:i.value,value:n.data}}_getInvalidInput(n){const r=this._getOrReturnCtx(n);return He(r,{code:$e.invalid_type,expected:rt.bigint,received:r.parsedType}),Ct}gte(n,r){return this.setLimit("min",n,!0,it.toString(r))}gt(n,r){return this.setLimit("min",n,!1,it.toString(r))}lte(n,r){return this.setLimit("max",n,!0,it.toString(r))}lt(n,r){return this.setLimit("max",n,!1,it.toString(r))}setLimit(n,r,s,i){return new Fc({...this._def,checks:[...this._def.checks,{kind:n,value:r,inclusive:s,message:it.toString(i)}]})}_addCheck(n){return new Fc({...this._def,checks:[...this._def.checks,n]})}positive(n){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:it.toString(n)})}negative(n){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:it.toString(n)})}nonpositive(n){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:it.toString(n)})}nonnegative(n){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:it.toString(n)})}multipleOf(n,r){return this._addCheck({kind:"multipleOf",value:n,message:it.toString(r)})}get minValue(){let n=null;for(const r of this._def.checks)r.kind==="min"&&(n===null||r.value>n)&&(n=r.value);return n}get maxValue(){let n=null;for(const r of this._def.checks)r.kind==="max"&&(n===null||r.value<n)&&(n=r.value);return n}}Fc.create=t=>new Fc({checks:[],typeName:Et.ZodBigInt,coerce:t?.coerce??!1,...Dt(t)});class Dx extends zt{_parse(n){if(this._def.coerce&&(n.data=!!n.data),this._getType(n)!==rt.boolean){const s=this._getOrReturnCtx(n);return He(s,{code:$e.invalid_type,expected:rt.boolean,received:s.parsedType}),Ct}return ms(n.data)}}Dx.create=t=>new Dx({typeName:Et.ZodBoolean,coerce:t?.coerce||!1,...Dt(t)});class fp extends zt{_parse(n){if(this._def.coerce&&(n.data=new Date(n.data)),this._getType(n)!==rt.date){const o=this._getOrReturnCtx(n);return He(o,{code:$e.invalid_type,expected:rt.date,received:o.parsedType}),Ct}if(Number.isNaN(n.data.getTime())){const o=this._getOrReturnCtx(n);return He(o,{code:$e.invalid_date}),Ct}const s=new Xr;let i;for(const o of this._def.checks)o.kind==="min"?n.data.getTime()<o.value&&(i=this._getOrReturnCtx(n,i),He(i,{code:$e.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),s.dirty()):o.kind==="max"?n.data.getTime()>o.value&&(i=this._getOrReturnCtx(n,i),He(i,{code:$e.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),s.dirty()):Ht.assertNever(o);return{status:s.value,value:new Date(n.data.getTime())}}_addCheck(n){return new fp({...this._def,checks:[...this._def.checks,n]})}min(n,r){return this._addCheck({kind:"min",value:n.getTime(),message:it.toString(r)})}max(n,r){return this._addCheck({kind:"max",value:n.getTime(),message:it.toString(r)})}get minDate(){let n=null;for(const r of this._def.checks)r.kind==="min"&&(n===null||r.value>n)&&(n=r.value);return n!=null?new Date(n):null}get maxDate(){let n=null;for(const r of this._def.checks)r.kind==="max"&&(n===null||r.value<n)&&(n=r.value);return n!=null?new Date(n):null}}fp.create=t=>new fp({checks:[],coerce:t?.coerce||!1,typeName:Et.ZodDate,...Dt(t)});class kw extends zt{_parse(n){if(this._getType(n)!==rt.symbol){const s=this._getOrReturnCtx(n);return He(s,{code:$e.invalid_type,expected:rt.symbol,received:s.parsedType}),Ct}return ms(n.data)}}kw.create=t=>new kw({typeName:Et.ZodSymbol,...Dt(t)});class Ew extends zt{_parse(n){if(this._getType(n)!==rt.undefined){const s=this._getOrReturnCtx(n);return He(s,{code:$e.invalid_type,expected:rt.undefined,received:s.parsedType}),Ct}return ms(n.data)}}Ew.create=t=>new Ew({typeName:Et.ZodUndefined,...Dt(t)});class Pw extends zt{_parse(n){if(this._getType(n)!==rt.null){const s=this._getOrReturnCtx(n);return He(s,{code:$e.invalid_type,expected:rt.null,received:s.parsedType}),Ct}return ms(n.data)}}Pw.create=t=>new Pw({typeName:Et.ZodNull,...Dt(t)});class Tw extends zt{constructor(){super(...arguments),this._any=!0}_parse(n){return ms(n.data)}}Tw.create=t=>new Tw({typeName:Et.ZodAny,...Dt(t)});class Rw extends zt{constructor(){super(...arguments),this._unknown=!0}_parse(n){return ms(n.data)}}Rw.create=t=>new Rw({typeName:Et.ZodUnknown,...Dt(t)});class pi extends zt{_parse(n){const r=this._getOrReturnCtx(n);return He(r,{code:$e.invalid_type,expected:rt.never,received:r.parsedType}),Ct}}pi.create=t=>new pi({typeName:Et.ZodNever,...Dt(t)});class Aw extends zt{_parse(n){if(this._getType(n)!==rt.undefined){const s=this._getOrReturnCtx(n);return He(s,{code:$e.invalid_type,expected:rt.void,received:s.parsedType}),Ct}return ms(n.data)}}Aw.create=t=>new Aw({typeName:Et.ZodVoid,...Dt(t)});class Gs extends zt{_parse(n){const{ctx:r,status:s}=this._processInputParams(n),i=this._def;if(r.parsedType!==rt.array)return He(r,{code:$e.invalid_type,expected:rt.array,received:r.parsedType}),Ct;if(i.exactLength!==null){const c=r.data.length>i.exactLength.value,d=r.data.length<i.exactLength.value;(c||d)&&(He(r,{code:c?$e.too_big:$e.too_small,minimum:d?i.exactLength.value:void 0,maximum:c?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),s.dirty())}if(i.minLength!==null&&r.data.length<i.minLength.value&&(He(r,{code:$e.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),s.dirty()),i.maxLength!==null&&r.data.length>i.maxLength.value&&(He(r,{code:$e.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),s.dirty()),r.common.async)return Promise.all([...r.data].map((c,d)=>i.type._parseAsync(new ui(r,c,r.path,d)))).then(c=>Xr.mergeArray(s,c));const o=[...r.data].map((c,d)=>i.type._parseSync(new ui(r,c,r.path,d)));return Xr.mergeArray(s,o)}get element(){return this._def.type}min(n,r){return new Gs({...this._def,minLength:{value:n,message:it.toString(r)}})}max(n,r){return new Gs({...this._def,maxLength:{value:n,message:it.toString(r)}})}length(n,r){return new Gs({...this._def,exactLength:{value:n,message:it.toString(r)}})}nonempty(n){return this.min(1,n)}}Gs.create=(t,n)=>new Gs({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Et.ZodArray,...Dt(n)});function Ao(t){if(t instanceof Fn){const n={};for(const r in t.shape){const s=t.shape[r];n[r]=ai.create(Ao(s))}return new Fn({...t._def,shape:()=>n})}else return t instanceof Gs?new Gs({...t._def,type:Ao(t.element)}):t instanceof ai?ai.create(Ao(t.unwrap())):t instanceof nl?nl.create(Ao(t.unwrap())):t instanceof Ui?Ui.create(t.items.map(n=>Ao(n))):t}class Fn extends zt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const n=this._def.shape(),r=Ht.objectKeys(n);return this._cached={shape:n,keys:r},this._cached}_parse(n){if(this._getType(n)!==rt.object){const m=this._getOrReturnCtx(n);return He(m,{code:$e.invalid_type,expected:rt.object,received:m.parsedType}),Ct}const{status:s,ctx:i}=this._processInputParams(n),{shape:o,keys:c}=this._getCached(),d=[];if(!(this._def.catchall instanceof pi&&this._def.unknownKeys==="strip"))for(const m in i.data)c.includes(m)||d.push(m);const p=[];for(const m of c){const h=o[m],g=i.data[m];p.push({key:{status:"valid",value:m},value:h._parse(new ui(i,g,i.path,m)),alwaysSet:m in i.data})}if(this._def.catchall instanceof pi){const m=this._def.unknownKeys;if(m==="passthrough")for(const h of d)p.push({key:{status:"valid",value:h},value:{status:"valid",value:i.data[h]}});else if(m==="strict")d.length>0&&(He(i,{code:$e.unrecognized_keys,keys:d}),s.dirty());else if(m!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const m=this._def.catchall;for(const h of d){const g=i.data[h];p.push({key:{status:"valid",value:h},value:m._parse(new ui(i,g,i.path,h)),alwaysSet:h in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const m=[];for(const h of p){const g=await h.key,v=await h.value;m.push({key:g,value:v,alwaysSet:h.alwaysSet})}return m}).then(m=>Xr.mergeObjectSync(s,m)):Xr.mergeObjectSync(s,p)}get shape(){return this._def.shape()}strict(n){return it.errToObj,new Fn({...this._def,unknownKeys:"strict",...n!==void 0?{errorMap:(r,s)=>{const i=this._def.errorMap?.(r,s).message??s.defaultError;return r.code==="unrecognized_keys"?{message:it.errToObj(n).message??i}:{message:i}}}:{}})}strip(){return new Fn({...this._def,unknownKeys:"strip"})}passthrough(){return new Fn({...this._def,unknownKeys:"passthrough"})}extend(n){return new Fn({...this._def,shape:()=>({...this._def.shape(),...n})})}merge(n){return new Fn({unknownKeys:n._def.unknownKeys,catchall:n._def.catchall,shape:()=>({...this._def.shape(),...n._def.shape()}),typeName:Et.ZodObject})}setKey(n,r){return this.augment({[n]:r})}catchall(n){return new Fn({...this._def,catchall:n})}pick(n){const r={};for(const s of Ht.objectKeys(n))n[s]&&this.shape[s]&&(r[s]=this.shape[s]);return new Fn({...this._def,shape:()=>r})}omit(n){const r={};for(const s of Ht.objectKeys(this.shape))n[s]||(r[s]=this.shape[s]);return new Fn({...this._def,shape:()=>r})}deepPartial(){return Ao(this)}partial(n){const r={};for(const s of Ht.objectKeys(this.shape)){const i=this.shape[s];n&&!n[s]?r[s]=i:r[s]=i.optional()}return new Fn({...this._def,shape:()=>r})}required(n){const r={};for(const s of Ht.objectKeys(this.shape))if(n&&!n[s])r[s]=this.shape[s];else{let o=this.shape[s];for(;o instanceof ai;)o=o._def.innerType;r[s]=o}return new Fn({...this._def,shape:()=>r})}keyof(){return VE(Ht.objectKeys(this.shape))}}Fn.create=(t,n)=>new Fn({shape:()=>t,unknownKeys:"strip",catchall:pi.create(),typeName:Et.ZodObject,...Dt(n)});Fn.strictCreate=(t,n)=>new Fn({shape:()=>t,unknownKeys:"strict",catchall:pi.create(),typeName:Et.ZodObject,...Dt(n)});Fn.lazycreate=(t,n)=>new Fn({shape:t,unknownKeys:"strip",catchall:pi.create(),typeName:Et.ZodObject,...Dt(n)});class xp extends zt{_parse(n){const{ctx:r}=this._processInputParams(n),s=this._def.options;function i(o){for(const d of o)if(d.result.status==="valid")return d.result;for(const d of o)if(d.result.status==="dirty")return r.common.issues.push(...d.ctx.common.issues),d.result;const c=o.map(d=>new va(d.ctx.common.issues));return He(r,{code:$e.invalid_union,unionErrors:c}),Ct}if(r.common.async)return Promise.all(s.map(async o=>{const c={...r,common:{...r.common,issues:[]},parent:null};return{result:await o._parseAsync({data:r.data,path:r.path,parent:c}),ctx:c}})).then(i);{let o;const c=[];for(const p of s){const m={...r,common:{...r.common,issues:[]},parent:null},h=p._parseSync({data:r.data,path:r.path,parent:m});if(h.status==="valid")return h;h.status==="dirty"&&!o&&(o={result:h,ctx:m}),m.common.issues.length&&c.push(m.common.issues)}if(o)return r.common.issues.push(...o.ctx.common.issues),o.result;const d=c.map(p=>new va(p));return He(r,{code:$e.invalid_union,unionErrors:d}),Ct}}get options(){return this._def.options}}xp.create=(t,n)=>new xp({options:t,typeName:Et.ZodUnion,...Dt(n)});function Lx(t,n){const r=Za(t),s=Za(n);if(t===n)return{valid:!0,data:t};if(r===rt.object&&s===rt.object){const i=Ht.objectKeys(n),o=Ht.objectKeys(t).filter(d=>i.indexOf(d)!==-1),c={...t,...n};for(const d of o){const p=Lx(t[d],n[d]);if(!p.valid)return{valid:!1};c[d]=p.data}return{valid:!0,data:c}}else if(r===rt.array&&s===rt.array){if(t.length!==n.length)return{valid:!1};const i=[];for(let o=0;o<t.length;o++){const c=t[o],d=n[o],p=Lx(c,d);if(!p.valid)return{valid:!1};i.push(p.data)}return{valid:!0,data:i}}else return r===rt.date&&s===rt.date&&+t==+n?{valid:!0,data:t}:{valid:!1}}class gp extends zt{_parse(n){const{status:r,ctx:s}=this._processInputParams(n),i=(o,c)=>{if(Nw(o)||Nw(c))return Ct;const d=Lx(o.value,c.value);return d.valid?((Cw(o)||Cw(c))&&r.dirty(),{status:r.value,value:d.data}):(He(s,{code:$e.invalid_intersection_types}),Ct)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([o,c])=>i(o,c)):i(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}gp.create=(t,n,r)=>new gp({left:t,right:n,typeName:Et.ZodIntersection,...Dt(r)});class Ui extends zt{_parse(n){const{status:r,ctx:s}=this._processInputParams(n);if(s.parsedType!==rt.array)return He(s,{code:$e.invalid_type,expected:rt.array,received:s.parsedType}),Ct;if(s.data.length<this._def.items.length)return He(s,{code:$e.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ct;!this._def.rest&&s.data.length>this._def.items.length&&(He(s,{code:$e.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const o=[...s.data].map((c,d)=>{const p=this._def.items[d]||this._def.rest;return p?p._parse(new ui(s,c,s.path,d)):null}).filter(c=>!!c);return s.common.async?Promise.all(o).then(c=>Xr.mergeArray(r,c)):Xr.mergeArray(r,o)}get items(){return this._def.items}rest(n){return new Ui({...this._def,rest:n})}}Ui.create=(t,n)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ui({items:t,typeName:Et.ZodTuple,rest:null,...Dt(n)})};class _w extends zt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(n){const{status:r,ctx:s}=this._processInputParams(n);if(s.parsedType!==rt.map)return He(s,{code:$e.invalid_type,expected:rt.map,received:s.parsedType}),Ct;const i=this._def.keyType,o=this._def.valueType,c=[...s.data.entries()].map(([d,p],m)=>({key:i._parse(new ui(s,d,s.path,[m,"key"])),value:o._parse(new ui(s,p,s.path,[m,"value"]))}));if(s.common.async){const d=new Map;return Promise.resolve().then(async()=>{for(const p of c){const m=await p.key,h=await p.value;if(m.status==="aborted"||h.status==="aborted")return Ct;(m.status==="dirty"||h.status==="dirty")&&r.dirty(),d.set(m.value,h.value)}return{status:r.value,value:d}})}else{const d=new Map;for(const p of c){const m=p.key,h=p.value;if(m.status==="aborted"||h.status==="aborted")return Ct;(m.status==="dirty"||h.status==="dirty")&&r.dirty(),d.set(m.value,h.value)}return{status:r.value,value:d}}}}_w.create=(t,n,r)=>new _w({valueType:n,keyType:t,typeName:Et.ZodMap,...Dt(r)});class $c extends zt{_parse(n){const{status:r,ctx:s}=this._processInputParams(n);if(s.parsedType!==rt.set)return He(s,{code:$e.invalid_type,expected:rt.set,received:s.parsedType}),Ct;const i=this._def;i.minSize!==null&&s.data.size<i.minSize.value&&(He(s,{code:$e.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),r.dirty()),i.maxSize!==null&&s.data.size>i.maxSize.value&&(He(s,{code:$e.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),r.dirty());const o=this._def.valueType;function c(p){const m=new Set;for(const h of p){if(h.status==="aborted")return Ct;h.status==="dirty"&&r.dirty(),m.add(h.value)}return{status:r.value,value:m}}const d=[...s.data.values()].map((p,m)=>o._parse(new ui(s,p,s.path,m)));return s.common.async?Promise.all(d).then(p=>c(p)):c(d)}min(n,r){return new $c({...this._def,minSize:{value:n,message:it.toString(r)}})}max(n,r){return new $c({...this._def,maxSize:{value:n,message:it.toString(r)}})}size(n,r){return this.min(n,r).max(n,r)}nonempty(n){return this.min(1,n)}}$c.create=(t,n)=>new $c({valueType:t,minSize:null,maxSize:null,typeName:Et.ZodSet,...Dt(n)});class Iw extends zt{get schema(){return this._def.getter()}_parse(n){const{ctx:r}=this._processInputParams(n);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}Iw.create=(t,n)=>new Iw({getter:t,typeName:Et.ZodLazy,...Dt(n)});class Mw extends zt{_parse(n){if(n.data!==this._def.value){const r=this._getOrReturnCtx(n);return He(r,{received:r.data,code:$e.invalid_literal,expected:this._def.value}),Ct}return{status:"valid",value:n.data}}get value(){return this._def.value}}Mw.create=(t,n)=>new Mw({value:t,typeName:Et.ZodLiteral,...Dt(n)});function VE(t,n){return new el({values:t,typeName:Et.ZodEnum,...Dt(n)})}class el extends zt{_parse(n){if(typeof n.data!="string"){const r=this._getOrReturnCtx(n),s=this._def.values;return He(r,{expected:Ht.joinValues(s),received:r.parsedType,code:$e.invalid_type}),Ct}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(n.data)){const r=this._getOrReturnCtx(n),s=this._def.values;return He(r,{received:r.data,code:$e.invalid_enum_value,options:s}),Ct}return ms(n.data)}get options(){return this._def.values}get enum(){const n={};for(const r of this._def.values)n[r]=r;return n}get Values(){const n={};for(const r of this._def.values)n[r]=r;return n}get Enum(){const n={};for(const r of this._def.values)n[r]=r;return n}extract(n,r=this._def){return el.create(n,{...this._def,...r})}exclude(n,r=this._def){return el.create(this.options.filter(s=>!n.includes(s)),{...this._def,...r})}}el.create=VE;class Ow extends zt{_parse(n){const r=Ht.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(n);if(s.parsedType!==rt.string&&s.parsedType!==rt.number){const i=Ht.objectValues(r);return He(s,{expected:Ht.joinValues(i),received:s.parsedType,code:$e.invalid_type}),Ct}if(this._cache||(this._cache=new Set(Ht.getValidEnumValues(this._def.values))),!this._cache.has(n.data)){const i=Ht.objectValues(r);return He(s,{received:s.data,code:$e.invalid_enum_value,options:i}),Ct}return ms(n.data)}get enum(){return this._def.values}}Ow.create=(t,n)=>new Ow({values:t,typeName:Et.ZodNativeEnum,...Dt(n)});class vp extends zt{unwrap(){return this._def.type}_parse(n){const{ctx:r}=this._processInputParams(n);if(r.parsedType!==rt.promise&&r.common.async===!1)return He(r,{code:$e.invalid_type,expected:rt.promise,received:r.parsedType}),Ct;const s=r.parsedType===rt.promise?r.data:Promise.resolve(r.data);return ms(s.then(i=>this._def.type.parseAsync(i,{path:r.path,errorMap:r.common.contextualErrorMap})))}}vp.create=(t,n)=>new vp({type:t,typeName:Et.ZodPromise,...Dt(n)});class tl extends zt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Et.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(n){const{status:r,ctx:s}=this._processInputParams(n),i=this._def.effect||null,o={addIssue:c=>{He(s,c),c.fatal?r.abort():r.dirty()},get path(){return s.path}};if(o.addIssue=o.addIssue.bind(o),i.type==="preprocess"){const c=i.transform(s.data,o);if(s.common.async)return Promise.resolve(c).then(async d=>{if(r.value==="aborted")return Ct;const p=await this._def.schema._parseAsync({data:d,path:s.path,parent:s});return p.status==="aborted"?Ct:p.status==="dirty"||r.value==="dirty"?gc(p.value):p});{if(r.value==="aborted")return Ct;const d=this._def.schema._parseSync({data:c,path:s.path,parent:s});return d.status==="aborted"?Ct:d.status==="dirty"||r.value==="dirty"?gc(d.value):d}}if(i.type==="refinement"){const c=d=>{const p=i.refinement(d,o);if(s.common.async)return Promise.resolve(p);if(p instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return d};if(s.common.async===!1){const d=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return d.status==="aborted"?Ct:(d.status==="dirty"&&r.dirty(),c(d.value),{status:r.value,value:d.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(d=>d.status==="aborted"?Ct:(d.status==="dirty"&&r.dirty(),c(d.value).then(()=>({status:r.value,value:d.value}))))}if(i.type==="transform")if(s.common.async===!1){const c=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!Xo(c))return Ct;const d=i.transform(c.value,o);if(d instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:d}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(c=>Xo(c)?Promise.resolve(i.transform(c.value,o)).then(d=>({status:r.value,value:d})):Ct);Ht.assertNever(i)}}tl.create=(t,n,r)=>new tl({schema:t,typeName:Et.ZodEffects,effect:n,...Dt(r)});tl.createWithPreprocess=(t,n,r)=>new tl({schema:n,effect:{type:"preprocess",transform:t},typeName:Et.ZodEffects,...Dt(r)});class ai extends zt{_parse(n){return this._getType(n)===rt.undefined?ms(void 0):this._def.innerType._parse(n)}unwrap(){return this._def.innerType}}ai.create=(t,n)=>new ai({innerType:t,typeName:Et.ZodOptional,...Dt(n)});class nl extends zt{_parse(n){return this._getType(n)===rt.null?ms(null):this._def.innerType._parse(n)}unwrap(){return this._def.innerType}}nl.create=(t,n)=>new nl({innerType:t,typeName:Et.ZodNullable,...Dt(n)});class Fx extends zt{_parse(n){const{ctx:r}=this._processInputParams(n);let s=r.data;return r.parsedType===rt.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}Fx.create=(t,n)=>new Fx({innerType:t,typeName:Et.ZodDefault,defaultValue:typeof n.default=="function"?n.default:()=>n.default,...Dt(n)});class $x extends zt{_parse(n){const{ctx:r}=this._processInputParams(n),s={...r,common:{...r.common,issues:[]}},i=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return hp(i)?i.then(o=>({status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new va(s.common.issues)},input:s.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new va(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}$x.create=(t,n)=>new $x({innerType:t,typeName:Et.ZodCatch,catchValue:typeof n.catch=="function"?n.catch:()=>n.catch,...Dt(n)});class Dw extends zt{_parse(n){if(this._getType(n)!==rt.nan){const s=this._getOrReturnCtx(n);return He(s,{code:$e.invalid_type,expected:rt.nan,received:s.parsedType}),Ct}return{status:"valid",value:n.data}}}Dw.create=t=>new Dw({typeName:Et.ZodNaN,...Dt(t)});class e8 extends zt{_parse(n){const{ctx:r}=this._processInputParams(n),s=r.data;return this._def.type._parse({data:s,path:r.path,parent:r})}unwrap(){return this._def.type}}class Fv extends zt{_parse(n){const{status:r,ctx:s}=this._processInputParams(n);if(s.common.async)return(async()=>{const o=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return o.status==="aborted"?Ct:o.status==="dirty"?(r.dirty(),gc(o.value)):this._def.out._parseAsync({data:o.value,path:s.path,parent:s})})();{const i=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return i.status==="aborted"?Ct:i.status==="dirty"?(r.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:s.path,parent:s})}}static create(n,r){return new Fv({in:n,out:r,typeName:Et.ZodPipeline})}}class zx extends zt{_parse(n){const r=this._def.innerType._parse(n),s=i=>(Xo(i)&&(i.value=Object.freeze(i.value)),i);return hp(r)?r.then(i=>s(i)):s(r)}unwrap(){return this._def.innerType}}zx.create=(t,n)=>new zx({innerType:t,typeName:Et.ZodReadonly,...Dt(n)});var Et;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Et||(Et={}));const Kt=ni.create,pr=Jo.create,mr=Dx.create;pi.create;const qE=Gs.create,gi=Fn.create;xp.create;gp.create;Ui.create;const t8=el.create;vp.create;ai.create;nl.create;const zc=lV,UE=x.createContext({}),pt=({...t})=>e.jsx(UE.Provider,{value:{name:t.name},children:e.jsx(pV,{...t})}),pm=()=>{const t=x.useContext(UE),n=x.useContext(BE),{getFieldState:r,formState:s}=um(),i=r(t.name,s);if(!t)throw new Error("useFormField should be used within <FormField>");const{id:o}=n;return{id:o,name:t.name,formItemId:`${o}-form-item`,formDescriptionId:`${o}-form-item-description`,formMessageId:`${o}-form-item-message`,...i}},BE=x.createContext({}),ct=x.forwardRef(({className:t,...n},r)=>{const s=x.useId();return e.jsx(BE.Provider,{value:{id:s},children:e.jsx("div",{ref:r,className:Ae("space-y-2",t),...n})})});ct.displayName="FormItem";const ot=x.forwardRef(({className:t,...n},r)=>{const{error:s,formItemId:i}=pm();return e.jsx(st,{ref:r,className:Ae(s&&"text-destructive",t),htmlFor:i,...n})});ot.displayName="FormLabel";const dt=x.forwardRef(({...t},n)=>{const{error:r,formItemId:s,formDescriptionId:i,formMessageId:o}=pm();return e.jsx(Np,{ref:n,id:s,"aria-describedby":r?`${i} ${o}`:`${i}`,"aria-invalid":!!r,...t})});dt.displayName="FormControl";const sn=x.forwardRef(({className:t,...n},r)=>{const{formDescriptionId:s}=pm();return e.jsx("p",{ref:r,id:s,className:Ae("text-sm text-muted-foreground",t),...n})});sn.displayName="FormDescription";const Mt=x.forwardRef(({className:t,children:n,...r},s)=>{const{error:i,formMessageId:o}=pm(),c=i?String(i?.message??""):n;return c?e.jsx("p",{ref:s,id:o,className:Ae("text-sm font-medium text-destructive",t),...r,children:c}):null});Mt.displayName="FormMessage";var GE=["PageUp","PageDown"],HE=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],KE={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},jl="Slider",[Vx,n8,r8]=dl(jl),[WE]=Zn(jl,[r8]),[s8,mm]=WE(jl),QE=x.forwardRef((t,n)=>{const{name:r,min:s=0,max:i=100,step:o=1,orientation:c="horizontal",disabled:d=!1,minStepsBetweenThumbs:p=0,defaultValue:m=[s],value:h,onValueChange:g=()=>{},onValueCommit:v=()=>{},inverted:j=!1,form:N,...b}=t,C=x.useRef(new Set),S=x.useRef(0),P=c==="horizontal"?a8:i8,[R=[],E]=Zr({prop:h,defaultProp:m,onChange:G=>{[...C.current][S.current]?.focus(),g(G)}}),A=x.useRef(R);function W(G){const O=u8(R,G);V(G,O)}function X(G){V(G,S.current)}function se(){const G=A.current[S.current];R[S.current]!==G&&v(R)}function V(G,O,{commit:F}={commit:!1}){const U=f8(o),$=x8(Math.round((G-s)/o)*o+s,U),q=Ac($,[s,i]);E((le=[])=>{const K=c8(le,q,O);if(h8(K,p*o)){S.current=K.indexOf(q);const J=String(K)!==String(le);return J&&F&&v(K),J?K:le}else return le})}return e.jsx(s8,{scope:t.__scopeSlider,name:r,disabled:d,min:s,max:i,valueIndexToChangeRef:S,thumbs:C.current,values:R,orientation:c,form:N,children:e.jsx(Vx.Provider,{scope:t.__scopeSlider,children:e.jsx(Vx.Slot,{scope:t.__scopeSlider,children:e.jsx(P,{"aria-disabled":d,"data-disabled":d?"":void 0,...b,ref:n,onPointerDown:De(b.onPointerDown,()=>{d||(A.current=R)}),min:s,max:i,inverted:j,onSlideStart:d?void 0:W,onSlideMove:d?void 0:X,onSlideEnd:d?void 0:se,onHomeKeyDown:()=>!d&&V(s,0,{commit:!0}),onEndKeyDown:()=>!d&&V(i,R.length-1,{commit:!0}),onStepKeyDown:({event:G,direction:O})=>{if(!d){const $=GE.includes(G.key)||G.shiftKey&&HE.includes(G.key)?10:1,q=S.current,le=R[q],K=o*$*O;V(le+K,q,{commit:!0})}}})})})})});QE.displayName=jl;var[YE,ZE]=WE(jl,{startEdge:"left",endEdge:"right",size:"width",direction:1}),a8=x.forwardRef((t,n)=>{const{min:r,max:s,dir:i,inverted:o,onSlideStart:c,onSlideMove:d,onSlideEnd:p,onStepKeyDown:m,...h}=t,[g,v]=x.useState(null),j=vt(n,P=>v(P)),N=x.useRef(void 0),b=Gi(i),C=b==="ltr",S=C&&!o||!C&&o;function k(P){const R=N.current||g.getBoundingClientRect(),E=[0,R.width],W=$v(E,S?[r,s]:[s,r]);return N.current=R,W(P-R.left)}return e.jsx(YE,{scope:t.__scopeSlider,startEdge:S?"left":"right",endEdge:S?"right":"left",direction:S?1:-1,size:"width",children:e.jsx(XE,{dir:b,"data-orientation":"horizontal",...h,ref:j,style:{...h.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:P=>{const R=k(P.clientX);c?.(R)},onSlideMove:P=>{const R=k(P.clientX);d?.(R)},onSlideEnd:()=>{N.current=void 0,p?.()},onStepKeyDown:P=>{const E=KE[S?"from-left":"from-right"].includes(P.key);m?.({event:P,direction:E?-1:1})}})})}),i8=x.forwardRef((t,n)=>{const{min:r,max:s,inverted:i,onSlideStart:o,onSlideMove:c,onSlideEnd:d,onStepKeyDown:p,...m}=t,h=x.useRef(null),g=vt(n,h),v=x.useRef(void 0),j=!i;function N(b){const C=v.current||h.current.getBoundingClientRect(),S=[0,C.height],P=$v(S,j?[s,r]:[r,s]);return v.current=C,P(b-C.top)}return e.jsx(YE,{scope:t.__scopeSlider,startEdge:j?"bottom":"top",endEdge:j?"top":"bottom",size:"height",direction:j?1:-1,children:e.jsx(XE,{"data-orientation":"vertical",...m,ref:g,style:{...m.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:b=>{const C=N(b.clientY);o?.(C)},onSlideMove:b=>{const C=N(b.clientY);c?.(C)},onSlideEnd:()=>{v.current=void 0,d?.()},onStepKeyDown:b=>{const S=KE[j?"from-bottom":"from-top"].includes(b.key);p?.({event:b,direction:S?-1:1})}})})}),XE=x.forwardRef((t,n)=>{const{__scopeSlider:r,onSlideStart:s,onSlideMove:i,onSlideEnd:o,onHomeKeyDown:c,onEndKeyDown:d,onStepKeyDown:p,...m}=t,h=mm(jl,r);return e.jsx(et.span,{...m,ref:n,onKeyDown:De(t.onKeyDown,g=>{g.key==="Home"?(c(g),g.preventDefault()):g.key==="End"?(d(g),g.preventDefault()):GE.concat(HE).includes(g.key)&&(p(g),g.preventDefault())}),onPointerDown:De(t.onPointerDown,g=>{const v=g.target;v.setPointerCapture(g.pointerId),g.preventDefault(),h.thumbs.has(v)?v.focus():s(g)}),onPointerMove:De(t.onPointerMove,g=>{g.target.hasPointerCapture(g.pointerId)&&i(g)}),onPointerUp:De(t.onPointerUp,g=>{const v=g.target;v.hasPointerCapture(g.pointerId)&&(v.releasePointerCapture(g.pointerId),o(g))})})}),JE="SliderTrack",eP=x.forwardRef((t,n)=>{const{__scopeSlider:r,...s}=t,i=mm(JE,r);return e.jsx(et.span,{"data-disabled":i.disabled?"":void 0,"data-orientation":i.orientation,...s,ref:n})});eP.displayName=JE;var qx="SliderRange",tP=x.forwardRef((t,n)=>{const{__scopeSlider:r,...s}=t,i=mm(qx,r),o=ZE(qx,r),c=x.useRef(null),d=vt(n,c),p=i.values.length,m=i.values.map(v=>rP(v,i.min,i.max)),h=p>1?Math.min(...m):0,g=100-Math.max(...m);return e.jsx(et.span,{"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,...s,ref:d,style:{...t.style,[o.startEdge]:h+"%",[o.endEdge]:g+"%"}})});tP.displayName=qx;var Ux="SliderThumb",nP=x.forwardRef((t,n)=>{const r=n8(t.__scopeSlider),[s,i]=x.useState(null),o=vt(n,d=>i(d)),c=x.useMemo(()=>s?r().findIndex(d=>d.ref.current===s):-1,[r,s]);return e.jsx(o8,{...t,ref:o,index:c})}),o8=x.forwardRef((t,n)=>{const{__scopeSlider:r,index:s,name:i,...o}=t,c=mm(Ux,r),d=ZE(Ux,r),[p,m]=x.useState(null),h=vt(n,k=>m(k)),g=p?c.form||!!p.closest("form"):!0,v=_p(p),j=c.values[s],N=j===void 0?0:rP(j,c.min,c.max),b=d8(s,c.values.length),C=v?.[d.size],S=C?p8(C,N,d.direction):0;return x.useEffect(()=>{if(p)return c.thumbs.add(p),()=>{c.thumbs.delete(p)}},[p,c.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[d.startEdge]:`calc(${N}% + ${S}px)`},children:[e.jsx(Vx.ItemSlot,{scope:t.__scopeSlider,children:e.jsx(et.span,{role:"slider","aria-label":t["aria-label"]||b,"aria-valuemin":c.min,"aria-valuenow":j,"aria-valuemax":c.max,"aria-orientation":c.orientation,"data-orientation":c.orientation,"data-disabled":c.disabled?"":void 0,tabIndex:c.disabled?void 0:0,...o,ref:h,style:j===void 0?{display:"none"}:t.style,onFocus:De(t.onFocus,()=>{c.valueIndexToChangeRef.current=s})})}),g&&e.jsx(l8,{name:i??(c.name?c.name+(c.values.length>1?"[]":""):void 0),form:c.form,value:j},s)]})});nP.displayName=Ux;var l8=t=>{const{value:n,...r}=t,s=x.useRef(null),i=Vp(n);return x.useEffect(()=>{const o=s.current,c=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(c,"value").set;if(i!==n&&p){const m=new Event("input",{bubbles:!0});p.call(o,n),o.dispatchEvent(m)}},[i,n]),e.jsx("input",{style:{display:"none"},...r,ref:s,defaultValue:n})};function c8(t=[],n,r){const s=[...t];return s[r]=n,s.sort((i,o)=>i-o)}function rP(t,n,r){const o=100/(r-n)*(t-n);return Ac(o,[0,100])}function d8(t,n){return n>2?`Value ${t+1} of ${n}`:n===2?["Minimum","Maximum"][t]:void 0}function u8(t,n){if(t.length===1)return 0;const r=t.map(i=>Math.abs(i-n)),s=Math.min(...r);return r.indexOf(s)}function p8(t,n,r){const s=t/2,o=$v([0,50],[0,s]);return(s-o(n)*r)*r}function m8(t){return t.slice(0,-1).map((n,r)=>t[r+1]-n)}function h8(t,n){if(n>0){const r=m8(t);return Math.min(...r)>=n}return!0}function $v(t,n){return r=>{if(t[0]===t[1]||n[0]===n[1])return n[0];const s=(n[1]-n[0])/(t[1]-t[0]);return n[0]+s*(r-t[0])}}function f8(t){return(String(t).split(".")[1]||"").length}function x8(t,n){const r=Math.pow(10,n);return Math.round(t*r)/r}var sP=QE,g8=eP,v8=tP,y8=nP;const aP=x.forwardRef(({className:t,...n},r)=>e.jsxs(sP,{ref:r,className:Ae("relative flex w-full touch-none select-none items-center",t),...n,children:[e.jsx(g8,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e.jsx(v8,{className:"absolute h-full bg-primary"})}),e.jsx(y8,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));aP.displayName=sP.displayName;const j8=[{value:"thriller",label:"Thriller / Suspense",description:"Tensin, peligro y giros inesperados"},{value:"psychological-thriller",label:"Thriller Psicolgico",description:"Manipulacin mental y narradores poco fiables"},{value:"police-procedural",label:"Thriller Policial",description:"Investigaciones policiales detalladas"},{value:"domestic-thriller",label:"Thriller Domstico",description:"Secretos oscuros en la vida cotidiana"},{value:"romance",label:"Romance Contemporneo",description:"Historias de amor en el presente"},{value:"historical-romance",label:"Romance Histrico",description:"Amor en pocas pasadas (Regencia, Victorian)"},{value:"paranormal-romance",label:"Romance Paranormal",description:"Amor con seres sobrenaturales"},{value:"dark-romance",label:"Dark Romance",description:"Romance con temas oscuros y moralmente grises"},{value:"romantasy",label:"Romantasy",description:"Romance + Fantasa (trending 2024-2026)"},{value:"fantasy",label:"Fantasa pica",description:"Mundos mgicos y aventuras picas"},{value:"urban-fantasy",label:"Fantasa Urbana",description:"Magia en ciudades modernas"},{value:"grimdark",label:"Fantasa Oscura (Grimdark)",description:"Fantasa con antihroes y violencia"},{value:"sci-fi",label:"Ciencia Ficcin",description:"Tecnologa y exploracin espacial"},{value:"space-opera",label:"Space Opera",description:"Aventuras picas en el espacio"},{value:"dystopia",label:"Distopa / Post-apocalptico",description:"Futuros sombros y supervivencia"},{value:"horror",label:"Terror / Horror",description:"Miedo, horror sobrenatural"},{value:"psychological-horror",label:"Terror Psicolgico",description:"Horror mental sin elementos sobrenaturales"},{value:"mystery",label:"Misterio",description:"Investigacin y resolucin de enigmas"},{value:"cozy-mystery",label:"Cozy Mystery",description:"Misterio acogedor sin violencia explcita"},{value:"crime-noir",label:"Crime Fiction / Noir",description:"Crimen urbano y atmsfera oscura"},{value:"historical",label:"Ficcin Histrica",description:"Narrativas en contextos del pasado"},{value:"historical-thriller",label:"Thriller Histrico",description:"Suspense en contextos histricos"},{value:"literary",label:"Literaria",description:"Exploracin de la condicin humana"},{value:"young-adult",label:"Young Adult (YA)",description:"Protagonistas adolescentes (15-18 aos)"},{value:"new-adult",label:"New Adult (NA)",description:"Protagonistas jvenes adultos (18-25 aos)"},{value:"litrpg",label:"LitRPG / GameLit",description:"Aventuras con mecnicas de videojuegos"},{value:"erotic",label:"Ertico",description:"Romance con contenido adulto explcito"},{value:"adventure",label:"Aventura",description:"Viajes y descubrimientos picos"},{value:"women-fiction",label:"Women's Fiction",description:"Journeys emocionales de protagonistas femeninas"},{value:"mafia-romance",label:"Mafia Romance",description:"Romance con elementos criminales (trending)"},{value:"reverse-harem",label:"Reverse Harem / Why Choose",description:"Mltiples intereses amorosos"}],b8=[{value:"dramatic",label:"Dramtico",description:"Emociones intensas y conflictos profundos"},{value:"dark",label:"Oscuro",description:"Atmsfera sombra y temas maduros"},{value:"satirical",label:"Satrico",description:"Crtica social con humor mordaz"},{value:"lyrical",label:"Lrico",description:"Prosa potica y descriptiva"},{value:"minimalist",label:"Minimalista",description:"Estilo conciso y directo"},{value:"epic",label:"pico",description:"Grandeza y eventos monumentales"},{value:"intimate",label:"ntimo",description:"Cercana emocional con los personajes"},{value:"suspenseful",label:"Tenso",description:"Mantiene al lector en vilo"}],w8=[{value:"standalone",label:"Obra Independiente",description:"Una novela autnoma sin continuacin"},{value:"series",label:"Serie",description:"Parte de una serie de libros"},{value:"trilogy",label:"Triloga",description:"Parte de una triloga de 3 libros"},{value:"bookbox",label:"Bookbox",description:"Serie completa en un solo manuscrito (hasta 350 captulos, mltiples libros)"}],N8=gi({bookNumber:pr(),title:Kt(),startChapter:pr(),endChapter:pr(),hasPrologue:mr().default(!1),hasEpilogue:mr().default(!1)}),C8=gi({books:qE(N8)}).nullable().optional(),S8=gi({title:Kt().min(1,"El ttulo es requerido").max(100),premise:Kt().min(10,"Describe la idea de tu novela (mnimo 10 caracteres)").max(2e3).or(Kt().length(0)),genre:Kt().min(1,"Selecciona un gnero"),tone:Kt().min(1,"Selecciona un tono"),chapterCount:pr().min(1).max(350),hasPrologue:mr().default(!1),hasEpilogue:mr().default(!1),hasAuthorNote:mr().default(!1),pseudonymId:pr().nullable().optional(),styleGuideId:pr().nullable().optional(),extendedGuideId:pr().nullable().optional(),workType:Kt().default("standalone"),seriesId:pr().nullable().optional(),seriesOrder:pr().nullable().optional(),minWordCount:pr().min(0).nullable().optional(),minWordsPerChapter:pr().min(500).max(1e4).default(1500),maxWordsPerChapter:pr().min(500).max(15e3).default(3500),kindleUnlimitedOptimized:mr().default(!1),bookboxStructure:C8});function Lw({onSubmit:t,onReset:n,isLoading:r,defaultValues:s,isEditing:i}){const o=Dc({resolver:Lc(S8),defaultValues:{title:s?.title||"",premise:s?.premise||"",genre:s?.genre||"fantasy",tone:s?.tone||"dramatic",chapterCount:s?.chapterCount||10,hasPrologue:s?.hasPrologue||!1,hasEpilogue:s?.hasEpilogue||!1,hasAuthorNote:s?.hasAuthorNote||!1,pseudonymId:s?.pseudonymId||null,styleGuideId:s?.styleGuideId||null,extendedGuideId:s?.extendedGuideId||null,workType:s?.workType||"standalone",seriesId:s?.seriesId||null,seriesOrder:s?.seriesOrder||null,minWordCount:s?.minWordCount||null,minWordsPerChapter:s?.minWordsPerChapter||1500,maxWordsPerChapter:s?.maxWordsPerChapter||3500,kindleUnlimitedOptimized:s?.kindleUnlimitedOptimized||!1,bookboxStructure:s?.bookboxStructure||null}}),c=o.watch("chapterCount"),d=o.watch("minWordCount"),p=o.watch("hasPrologue"),m=o.watch("hasEpilogue"),h=o.watch("hasAuthorNote"),g=o.watch("pseudonymId"),v=o.watch("workType");o.watch("seriesId");const j=o.watch("bookboxStructure"),N=v==="bookbox",[b,C]=x.useState(j?.books||[{bookNumber:1,title:"Libro 1",startChapter:1,endChapter:50,hasPrologue:!0,hasEpilogue:!1}]),S=()=>{const G=b[b.length-1],O={bookNumber:b.length+1,title:`Libro ${b.length+1}`,startChapter:G?G.endChapter+1:1,endChapter:G?G.endChapter+50:50,hasPrologue:!1,hasEpilogue:!1},F=[...b,O];C(F),o.setValue("bookboxStructure",{books:F});const U=O.endChapter;U>c&&o.setValue("chapterCount",U)},k=G=>{if(b.length<=1)return;const O=b.filter((F,U)=>U!==G).map((F,U)=>({...F,bookNumber:U+1}));C(O),o.setValue("bookboxStructure",{books:O})},P=(G,O,F)=>{const U=[...b];U[G][O]=F,C(U),o.setValue("bookboxStructure",{books:U});const $=Math.max(...U.map(q=>q.endChapter));$>c&&o.setValue("chapterCount",$)},R=c+(p?1:0)+(m?1:0)+(h?1:0),{data:E=[]}=Ke({queryKey:["/api/pseudonyms"]}),{data:A=[]}=Ke({queryKey:["/api/pseudonyms",g,"style-guides"],enabled:!!g&&g>0}),{data:W=[]}=Ke({queryKey:["/api/series"]}),{data:X=[]}=Ke({queryKey:["/api/extended-guides"]}),se=o.watch("extendedGuideId"),V=v==="series"||v==="trilogy";return e.jsx(zc,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(t),className:"space-y-6","data-testid":"config-form",children:[e.jsx(pt,{control:o.control,name:"title",render:({field:G})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Ttulo del Proyecto"}),e.jsx(dt,{children:e.jsx(gt,{placeholder:"La ltima esperanza...",...G,"data-testid":"input-project-title"})}),e.jsx(sn,{children:"El ttulo de tu novela o manuscrito"}),e.jsx(Mt,{})]})}),e.jsx(pt,{control:o.control,name:"premise",render:({field:G})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Idea / Premisa de la Novela"}),e.jsx(dt,{children:e.jsx(Nn,{placeholder:"Describe la idea central de tu novela: De qu trata? Quin es el protagonista? Cul es el conflicto principal? En qu poca y lugar transcurre?",className:"min-h-[120px]",...G,"data-testid":"input-project-premise"})}),e.jsx(sn,{children:se?"La gua extendida seleccionada proporcionar la premisa completa. Puedes dejar este campo vaco.":"Esta premisa guiar a los agentes para disear la trama, personajes y mundo de tu novela"}),e.jsx(Mt,{})]})}),e.jsx(pt,{control:o.control,name:"extendedGuideId",render:({field:G})=>e.jsxs(ct,{children:[e.jsxs(ot,{className:"flex items-center gap-2",children:[e.jsx(yt,{className:"h-4 w-4"}),"Gua Extendida (Opcional)"]}),e.jsxs(Pt,{onValueChange:O=>G.onChange(O==="none"?null:parseInt(O)),value:G.value?.toString()||"none",children:[e.jsx(dt,{children:e.jsx(St,{"data-testid":"select-extended-guide",children:e.jsx(Tt,{placeholder:"Sin gua extendida"})})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"none",children:"Sin gua extendida"}),X.map(O=>e.jsx(ce,{value:O.id.toString(),children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:O.title}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[O.wordCount?.toLocaleString()," palabras"]})]})},O.id))]})]}),e.jsx(sn,{children:"Sube una gua de escritura extendida en Word que sustituya o complemente la premisa"}),e.jsx(Mt,{})]})}),e.jsx(pt,{control:o.control,name:"genre",render:({field:G})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Gnero"}),e.jsxs(Pt,{onValueChange:G.onChange,defaultValue:G.value,children:[e.jsx(dt,{children:e.jsx(St,{"data-testid":"select-genre",children:e.jsx(Tt,{placeholder:"Selecciona un gnero"})})}),e.jsx(kt,{children:j8.map(O=>e.jsx(ce,{value:O.value,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:O.label}),e.jsx("span",{className:"text-xs text-muted-foreground",children:O.description})]})},O.value))})]}),e.jsx(Mt,{})]})}),e.jsx(pt,{control:o.control,name:"tone",render:({field:G})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Tono Narrativo"}),e.jsxs(Pt,{onValueChange:G.onChange,defaultValue:G.value,children:[e.jsx(dt,{children:e.jsx(St,{"data-testid":"select-tone",children:e.jsx(Tt,{placeholder:"Selecciona un tono"})})}),e.jsx(kt,{children:b8.map(O=>e.jsx(ce,{value:O.value,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:O.label}),e.jsx("span",{className:"text-xs text-muted-foreground",children:O.description})]})},O.value))})]}),e.jsx(Mt,{})]})}),e.jsxs("div",{className:"space-y-4 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 pt-4",children:[e.jsx(pa,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(ot,{className:"text-base mb-0",children:"Tipo de Obra"})]}),e.jsx(pt,{control:o.control,name:"workType",render:({field:G})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Clasificacin"}),e.jsxs(Pt,{onValueChange:O=>{G.onChange(O),O==="standalone"&&(o.setValue("seriesId",null),o.setValue("seriesOrder",null))},value:G.value||"standalone",children:[e.jsx(dt,{children:e.jsx(St,{"data-testid":"select-work-type",children:e.jsx(Tt,{placeholder:"Selecciona tipo de obra"})})}),e.jsx(kt,{children:w8.map(O=>e.jsx(ce,{value:O.value,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:O.label}),e.jsx("span",{className:"text-xs text-muted-foreground",children:O.description})]})},O.value))})]}),e.jsx(sn,{children:"Define si esta novela es parte de una serie o triloga"}),e.jsx(Mt,{})]})}),V&&e.jsxs(e.Fragment,{children:[e.jsx(pt,{control:o.control,name:"seriesId",render:({field:G})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Serie / Saga"}),e.jsxs(Pt,{onValueChange:O=>G.onChange(O==="none"?null:parseInt(O)),value:G.value?.toString()||"none",children:[e.jsx(dt,{children:e.jsx(St,{"data-testid":"select-series",children:e.jsx(Tt,{placeholder:"Selecciona o crea una serie"})})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"none",children:"Ninguna (crear nueva despus)"}),W.map(O=>e.jsx(ce,{value:O.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Vu,{className:"h-3 w-3"}),e.jsx("span",{children:O.title})]})},O.id))]})]}),e.jsx(sn,{children:"Agrupa novelas en una serie para mantener continuidad narrativa"}),e.jsx(Mt,{})]})}),e.jsx(pt,{control:o.control,name:"seriesOrder",render:({field:G})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Orden en la Serie"}),e.jsx(dt,{children:e.jsx(gt,{type:"number",min:1,placeholder:"1, 2, 3...",value:G.value||"",onChange:O=>G.onChange(O.target.value?parseInt(O.target.value):null),"data-testid":"input-series-order"})}),e.jsx(sn,{children:"Posicin de esta novela dentro de la serie (1 = primera, 2 = segunda, etc.)"}),e.jsx(Mt,{})]})})]}),N&&e.jsxs("div",{className:"space-y-4 p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ot,{className:"text-sm font-medium",children:"Estructura de Libros"}),e.jsxs(B,{type:"button",variant:"outline",size:"sm",onClick:S,"data-testid":"button-add-bookbox-book",children:[e.jsx(Nr,{className:"h-3 w-3 mr-1"}),"Aadir Libro"]})]}),e.jsx(sn,{className:"text-xs",children:"Define los libros internos del bookbox. Cada libro puede tener su propio prlogo y eplogo."}),e.jsx("div",{className:"space-y-3",children:b.map((G,O)=>e.jsxs("div",{className:"p-3 bg-background rounded border space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx(gt,{value:G.title,onChange:F=>P(O,"title",F.target.value),placeholder:`Libro ${O+1}`,className:"flex-1","data-testid":`input-bookbox-title-${O}`}),b.length>1&&e.jsx(B,{type:"button",variant:"ghost",size:"icon",onClick:()=>k(O),"data-testid":`button-remove-bookbox-${O}`,children:e.jsx(Rn,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(ot,{className:"text-xs",children:"Captulo Inicial"}),e.jsx(gt,{type:"number",min:1,value:G.startChapter,onChange:F=>P(O,"startChapter",parseInt(F.target.value)||1),"data-testid":`input-bookbox-start-${O}`})]}),e.jsxs("div",{children:[e.jsx(ot,{className:"text-xs",children:"Captulo Final"}),e.jsx(gt,{type:"number",min:G.startChapter,value:G.endChapter,onChange:F=>P(O,"endChapter",parseInt(F.target.value)||G.startChapter),"data-testid":`input-bookbox-end-${O}`})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Kr,{checked:G.hasPrologue,onCheckedChange:F=>P(O,"hasPrologue",!!F),id:`bookbox-prologue-${O}`,"data-testid":`checkbox-bookbox-prologue-${O}`}),e.jsx("label",{htmlFor:`bookbox-prologue-${O}`,className:"text-xs",children:"Prlogo"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Kr,{checked:G.hasEpilogue,onCheckedChange:F=>P(O,"hasEpilogue",!!F),id:`bookbox-epilogue-${O}`,"data-testid":`checkbox-bookbox-epilogue-${O}`}),e.jsx("label",{htmlFor:`bookbox-epilogue-${O}`,className:"text-xs",children:"Eplogo"})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[G.endChapter-G.startChapter+1," captulos",G.hasPrologue&&" + prlogo",G.hasEpilogue&&" + eplogo"]})]},O))}),e.jsxs("div",{className:"text-xs text-muted-foreground pt-2 border-t",children:["Total: ",b.reduce((G,O)=>G+(O.endChapter-O.startChapter+1)+(O.hasPrologue?1:0)+(O.hasEpilogue?1:0),0)," secciones en ",b.length," libro",b.length>1?"s":""]})]})]}),e.jsxs("div",{className:"space-y-4 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 pt-4",children:[e.jsx(ri,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(ot,{className:"text-base mb-0",children:"Identidad del Autor"})]}),e.jsx(pt,{control:o.control,name:"pseudonymId",render:({field:G})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Pseudnimo (Opcional)"}),e.jsxs(Pt,{onValueChange:O=>{G.onChange(O==="none"?null:parseInt(O)),o.setValue("styleGuideId",null)},value:G.value?.toString()||"none",children:[e.jsx(dt,{children:e.jsx(St,{"data-testid":"select-pseudonym",children:e.jsx(Tt,{placeholder:"Selecciona un pseudnimo"})})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"none",children:"Sin pseudnimo"}),E.map(O=>e.jsx(ce,{value:O.id.toString(),children:O.name},O.id))]})]}),e.jsx(sn,{children:"Asocia una identidad de autor al proyecto"}),e.jsx(Mt,{})]})}),g&&A.length>0&&e.jsx(pt,{control:o.control,name:"styleGuideId",render:({field:G})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Gua de Estilo"}),e.jsxs(Pt,{onValueChange:O=>G.onChange(O==="none"?null:parseInt(O)),value:G.value?.toString()||"none",children:[e.jsx(dt,{children:e.jsx(St,{"data-testid":"select-style-guide",children:e.jsx(Tt,{placeholder:"Selecciona una gua de estilo"})})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"none",children:"Sin gua especfica"}),A.map(O=>e.jsx(ce,{value:O.id.toString(),children:O.title},O.id))]})]}),e.jsx(sn,{children:"La gua de estilo define la voz y estilo narrativo"}),e.jsx(Mt,{})]})})]}),e.jsx(pt,{control:o.control,name:"chapterCount",render:({field:G})=>e.jsxs(ct,{children:[e.jsxs(ot,{children:["Nmero de Captulos: ",c]}),e.jsx(dt,{children:e.jsx(aP,{min:1,max:N?350:100,step:1,value:[G.value],onValueChange:O=>G.onChange(O[0]),className:"py-4","data-testid":"slider-chapter-count"})}),e.jsxs(sn,{children:["Entre 1 y ",N?350:100," captulos (aproximadamente ",(c*2500).toLocaleString()," - ",(c*3500).toLocaleString()," palabras)"]}),e.jsx(Mt,{})]})}),e.jsx(pt,{control:o.control,name:"minWordCount",render:({field:G})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Palabras Mnimas (objetivo)"}),e.jsx(dt,{children:e.jsx(gt,{type:"number",placeholder:"Ej: 80000",value:G.value??"",onChange:O=>{const F=O.target.value;G.onChange(F?parseInt(F):null)},"data-testid":"input-min-word-count"})}),e.jsx(sn,{children:d&&c>0?`Aproximadamente ${Math.round(d/c).toLocaleString()} palabras por captulo`:"Opcional: Define el mnimo de palabras para la novela completa"}),e.jsx(Mt,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(pt,{control:o.control,name:"minWordsPerChapter",render:({field:G})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Mnimo palabras/captulo"}),e.jsx(dt,{children:e.jsx(gt,{type:"number",min:500,max:1e4,value:G.value,onChange:O=>G.onChange(parseInt(O.target.value)||1500),"data-testid":"input-min-words-per-chapter"})}),e.jsx(sn,{className:"text-xs",children:"Extensin mnima por captulo"}),e.jsx(Mt,{})]})}),e.jsx(pt,{control:o.control,name:"maxWordsPerChapter",render:({field:G})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Mximo palabras/captulo"}),e.jsx(dt,{children:e.jsx(gt,{type:"number",min:500,max:15e3,value:G.value,onChange:O=>G.onChange(parseInt(O.target.value)||3500),"data-testid":"input-max-words-per-chapter"})}),e.jsx(sn,{className:"text-xs",children:"Extensin mxima por captulo"}),e.jsx(Mt,{})]})})]}),e.jsx(pt,{control:o.control,name:"kindleUnlimitedOptimized",render:({field:G})=>e.jsxs(ct,{className:"flex items-center gap-3 space-y-0 rounded-md border border-orange-200 dark:border-orange-800 bg-orange-50 dark:bg-orange-950/30 p-3",children:[e.jsx(dt,{children:e.jsx(Kr,{checked:G.value,onCheckedChange:G.onChange,"data-testid":"checkbox-kindle-unlimited"})}),e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx(us,{className:"h-4 w-4 text-orange-500"}),e.jsxs("div",{children:[e.jsx(ot,{className:"font-medium cursor-pointer",children:"Optimizar para Kindle Unlimited"}),e.jsx(sn,{className:"text-xs",children:"Captulos cortos con cliffhangers, ritmo rpido y tcnicas page-turner para maximizar pginas ledas"})]})]})]})}),e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsx(ot,{className:"text-base",children:"Secciones Adicionales"}),e.jsx(pt,{control:o.control,name:"hasPrologue",render:({field:G})=>e.jsxs(ct,{className:"flex items-center gap-3 space-y-0 rounded-md border p-3",children:[e.jsx(dt,{children:e.jsx(Kr,{checked:G.value,onCheckedChange:G.onChange,"data-testid":"checkbox-prologue"})}),e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx(mn,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx(ot,{className:"font-medium cursor-pointer",children:"Prlogo"}),e.jsx(sn,{className:"text-xs",children:"Introduccin previa al primer captulo"})]})]})]})}),e.jsx(pt,{control:o.control,name:"hasEpilogue",render:({field:G})=>e.jsxs(ct,{className:"flex items-center gap-3 space-y-0 rounded-md border p-3",children:[e.jsx(dt,{children:e.jsx(Kr,{checked:G.value,onCheckedChange:G.onChange,"data-testid":"checkbox-epilogue"})}),e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx(FA,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx(ot,{className:"font-medium cursor-pointer",children:"Eplogo"}),e.jsx(sn,{className:"text-xs",children:"Cierre posterior al ltimo captulo"})]})]})]})}),e.jsx(pt,{control:o.control,name:"hasAuthorNote",render:({field:G})=>e.jsxs(ct,{className:"flex items-center gap-3 space-y-0 rounded-md border p-3",children:[e.jsx(dt,{children:e.jsx(Kr,{checked:G.value,onCheckedChange:G.onChange,"data-testid":"checkbox-author-note"})}),e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx(yt,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx(ot,{className:"font-medium cursor-pointer",children:"Nota del Autor"}),e.jsx(sn,{className:"text-xs",children:"Reflexiones del autor sobre la obra"})]})]})]})})]}),e.jsxs("div",{className:"bg-muted/50 rounded-md p-3 text-sm",children:[e.jsx("span",{className:"font-medium",children:"Total de secciones:"})," ",e.jsxs("span",{className:"text-muted-foreground",children:[R," (",p?"Prlogo + ":"",c," captulos",m?" + Eplogo":"",h?" + Nota del Autor":"",")"]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsxs(B,{type:"submit",className:"flex-1",disabled:r,"data-testid":"button-start-project",children:[e.jsx(Yn,{className:"h-4 w-4 mr-2"}),r?i?"Guardando...":"Creando...":i?"Guardar Cambios":"Crear Proyecto"]}),n&&e.jsx(B,{type:"button",variant:"outline",onClick:n,disabled:r,"data-testid":"button-reset-config",children:e.jsx(Ho,{className:"h-4 w-4"})})]})]})})}const k8=`# GUA DE ESCRITURA PARA LIBRO INDIVIDUAL
# Esta gua ayuda al Arquitecto a planificar tu novela de forma estructurada

================================================================================
## 1. BRIEF EDITORIAL Y LECTOR OBJETIVO
================================================================================

### Pblico objetivo:
- Edad: [18-25 / 25-40 / 40-60 / Universal]
- Gnero lector predominante: [Mayoritariamente femenino / Mayoritariamente masculino / Mixto]
- Nivel de lectura: [Casual / vido / Literario]
- Lecturas similares que disfrutan: [Ttulos de referencia]

### Promesa al lector:
[Qu experiencia emocional prometes? Ej: "Una montaa rusa de suspense que no podrs soltar hasta el final"]

### Comparables de mercado (Comp titles):
- [Ttulo 1] porque [razn]
- [Ttulo 2] porque [razn]

================================================================================
## 2. MANDATOS DE GNERO Y TONO
================================================================================

### Gnero principal: [Thriller / Romance / Fantasa / Ciencia Ficcin / etc.]
### Subgneros: [Psychological thriller / Romantic suspense / etc.]

### Tropos OBLIGATORIOS del gnero:
- [Tropo 1 - Ej: "El detective con pasado oscuro"]
- [Tropo 2 - Ej: "Plot twist en el tercer acto"]
- [Tropo 3]

### Tropos a EVITAR:
- [Tropo clich 1 que no quieres]
- [Tropo clich 2 que no quieres]

### Tono narrativo:
- Atmsfera general: [Oscura / Luminosa / Ambigua / Opresiva / Esperanzadora]
- Nivel de humor: [Ninguno / Sutil / Moderado / Predominante]
- Nivel de romance: [Ninguno / Subtrama / Central]

================================================================================
## 3. ARQUITECTURA DE ACTOS
================================================================================

### ACTO I (Planteamiento) - Captulos 1-X
- Objetivo: [Qu debe lograr este acto]
- Umbral de tensin inicial: [1-10, siendo 10 mxima tensin]
- Evento incitador en captulo: [nmero]
- Primer punto de giro en captulo: [nmero]

### ACTO II (Confrontacin) - Captulos X-Y
- Objetivo: [Qu debe lograr este acto]
- Punto medio (midpoint) en captulo: [nmero]
- Escalada de tensin: [Descripcin de cmo aumenta]
- Momento de "todo est perdido" en captulo: [nmero]

### ACTO III (Resolucin) - Captulos Y-Z
- Objetivo: [Qu debe lograr este acto]
- Clmax en captulo: [nmero]
- Umbral de tensin mxima: [1-10]
- Tipo de resolucin: [Cerrada / Abierta / Agridulce]

### Giros obligatorios:
1. [Giro 1 - Aproximadamente captulo X]
2. [Giro 2 - Aproximadamente captulo Y]
3. [Giro 3 - Aproximadamente captulo Z]

================================================================================
## 4. ARCOS DE PERSONAJES Y STAKES
================================================================================

### Protagonista:
- Defecto fatal inicial: [Ej: "Incapacidad de confiar"]
- Necesidad interna (lo que realmente necesita): [Ej: "Aprender a ser vulnerable"]
- Deseo externo (lo que cree querer): [Ej: "Atrapar al asesino"]
- Transformacin esperada: [De X a Y]

### Antagonista:
- Motivacin comprensible: [Por qu hace lo que hace]
- Fortalezas que lo hacen temible: [Lista]
- Debilidad que permite derrotarlo: [Descripcin]

### Stakes (lo que est en juego):
- Nivel personal: [Qu pierde el protagonista si falla]
- Nivel social: [Consecuencias para otros]
- Nivel universal: [Tema mayor en juego]

================================================================================
## 5. REGLAS DE WORLDBUILDING
================================================================================

### Lmites de verosimilitud:
- [Regla 1 - Ej: "No hay magia, todo debe tener explicacin racional"]
- [Regla 2 - Ej: "La tecnologa es actual, no futurista"]

### Elementos del mundo que DEBEN aparecer:
- [Elemento 1]
- [Elemento 2]

### Anacronismos o elementos a EVITAR:
- [Elemento 1 que rompera la inmersin]
- [Elemento 2]

================================================================================
## 6. ELEMENTOS IMPRESCINDIBLES Y PROHIBIDOS
================================================================================

### DEBE incluir:
- [Escena o elemento 1]
- [Escena o elemento 2]
- [Escena o elemento 3]

### NO DEBE incluir:
- [Elemento prohibido 1]
- [Elemento prohibido 2]

### Sensibilidades a respetar:
- [Tema delicado 1 y cmo manejarlo]
- [Tema delicado 2 y cmo manejarlo]

================================================================================
## 7. MTRICAS DE CALIDAD DESEADAS
================================================================================

### Ritmo:
- Frecuencia de cliffhangers: [Cada captulo / Cada 2-3 captulos / Solo en puntos clave]
- Longitud de escenas de accin vs. reflexin: [Ratio aproximado]

### Engagement:
- El lector debe [emocin] en el Acto I
- El lector debe [emocin] en el Acto II
- El lector debe [emocin] en el Acto III

### Benchmark de xito:
- [Criterio 1 - Ej: "Que el lector no pueda predecir el asesino"]
- [Criterio 2 - Ej: "Que el romance se sienta ganado, no forzado"]

================================================================================
## 8. NOTAS ADICIONALES PARA EL ARQUITECTO
================================================================================

[Cualquier instruccin adicional especfica para la planificacin de esta novela]
`,E8=`# GUA DE ESCRITURA PARA SERIE / SAGA
# Esta gua ayuda al Arquitecto a mantener coherencia a travs de mltiples volmenes

================================================================================
## 1. VISIN GENERAL DE LA SAGA
================================================================================

### Concepto central de la serie:
[Una frase que capture la esencia de toda la saga]

### Promesa de largo plazo al lector:
[Qu experiencia completa prometes al lector que complete la serie?]

### Nmero total de volmenes planificados: [X]

### Estructura de la serie:
- [ ] Episdica (cada libro es autoconclusivo)
- [ ] Serializada (historia continua)
- [ ] Hbrida (arcos por libro + meta-arco)

================================================================================
## 2. TABLA DE VOLMENES
================================================================================

### Volumen 1: [Ttulo]
- Objetivo narrativo: [Qu establece este libro]
- Arco principal: [Descripcin breve]
- Estado al final: [Cmo termina]

### Volumen 2: [Ttulo]
- Objetivo narrativo: [Qu avanza este libro]
- Arco principal: [Descripcin breve]
- Estado al final: [Cmo termina]

### Volumen 3: [Ttulo]
- Objetivo narrativo: [Qu resuelve este libro]
- Arco principal: [Descripcin breve]
- Estado al final: [Cmo termina]

[Aadir ms volmenes segn sea necesario]

================================================================================
## 3. ARCOS MACRO DE PERSONAJES
================================================================================

### Protagonista principal:
- Estado inicial (Vol 1): [Descripcin]
- Transformacin Vol 12: [De X a Y]
- Transformacin Vol 23: [De Y a Z]
- Estado final de la serie: [Descripcin]

### Personajes secundarios recurrentes:
1. [Nombre]: 
   - Rol en la serie: [Descripcin]
   - Evolucin a travs de volmenes: [Descripcin]

2. [Nombre]:
   - Rol en la serie: [Descripcin]
   - Evolucin a travs de volmenes: [Descripcin]

### Antagonistas:
- Antagonista del Vol 1: [Nombre y destino]
- Antagonista del Vol 2: [Nombre y destino]
- Antagonista principal de la saga: [Nombre]
  - Primera aparicin: [Volumen y forma]
  - Revelacin completa: [Volumen]
  - Confrontacin final: [Volumen]

================================================================================
## 4. CONTINUIDAD CRTICA
================================================================================

### Eventos fundacionales (canon inamovible):
1. [Evento] - Ocurre en Vol [X], Cap [Y]
2. [Evento] - Ocurre en Vol [X], Cap [Y]
3. [Evento] - Ocurre en Vol [X], Cap [Y]

### Lnea temporal de la saga:
- Vol 1: [Periodo temporal - Ej: "Verano 2024"]
- Vol 2: [Periodo temporal - Ej: "6 meses despus"]
- Vol 3: [Periodo temporal - Ej: "1 ao despus"]

### Elementos fsicos persistentes:
- [Personaje] tiene [caracterstica fsica permanente] desde Vol [X]
- [Personaje] perdi [elemento] en Vol [X]
- [Ubicacin] fue destruida/modificada en Vol [X]

### Relaciones que evolucionan:
- [Personaje A] y [Personaje B]: 
  - Vol 1: [Estado de la relacin]
  - Vol 2: [Evolucin]
  - Vol 3: [Estado final]

================================================================================
## 5. POLTICAS DE FORESHADOWING Y CALLBACKS
================================================================================

### Seeds plantadas por volumen:
Vol 1:
- [Seed 1]: Pista sobre [X], payoff en Vol [Y]
- [Seed 2]: Pista sobre [X], payoff en Vol [Y]

Vol 2:
- [Seed 1]: Pista sobre [X], payoff en Vol [Y]
- [Seed 2]: Pista sobre [X], payoff en Vol [Y]

### Callbacks obligatorios:
- Vol 2 DEBE referenciar: [Evento de Vol 1]
- Vol 3 DEBE referenciar: [Evento de Vol 1 o 2]

### Elementos recurrentes (motifs):
- [Smbolo/frase/objeto] que aparece en cada volumen
- Significado que evoluciona: [Descripcin]

================================================================================
## 6. SUBTRAMAS SERIALIZADAS
================================================================================

### Subtrama 1: [Nombre]
- Introducida en: Vol [X]
- Desarrollada en: Vol [X, Y]
- Resuelta en: Vol [Z]
- Importancia para trama principal: [Alta/Media/Baja]

### Subtrama 2: [Nombre]
- Introducida en: Vol [X]
- Desarrollada en: Vol [X, Y]
- Resuelta en: Vol [Z]
- Importancia para trama principal: [Alta/Media/Baja]

================================================================================
## 7. GESTIN DE CLIFFHANGERS Y RECAPS
================================================================================

### Poltica de cliffhangers entre volmenes:
- [ ] Cliffhanger fuerte (el lector DEBE leer el siguiente)
- [ ] Resolucin parcial (satisfactorio pero con preguntas abiertas)
- [ ] Autoconclusivo (cada libro cierra completamente)

### Recaps obligatorios:
- Cada volumen DEBE recordar: [Elementos esenciales]
- Tcnica de recap preferida: [Flashback / Dilogo / Narracin / Prlogo]
- Extensin mxima del recap: [X prrafos/pginas]

================================================================================
## 8. CONSISTENCIA LINGSTICA Y CULTURAL
================================================================================

### Vocabulario especfico de la serie:
- [Trmino 1]: [Definicin] - Introducido en Vol [X]
- [Trmino 2]: [Definicin] - Introducido en Vol [X]

### Expresiones caractersticas de personajes:
- [Personaje]: [Muletilla o forma de hablar]
- [Personaje]: [Muletilla o forma de hablar]

### Reglas culturales del mundo:
- [Regla 1 que aplica a toda la serie]
- [Regla 2 que aplica a toda la serie]

================================================================================
## 9. ESTADO DEL CANON
================================================================================

### Elementos estructurales (NO modificables):
- [Elemento 1 - Ej: "El protagonista es hurfano"]
- [Elemento 2 - Ej: "La magia requiere sacrificio"]

### Elementos cosmticos (modificables si es necesario):
- [Elemento 1 - Ej: "Color de ojos de personaje secundario"]
- [Elemento 2 - Ej: "Nombre del pueblo natal"]

### Contradicciones conocidas a resolver:
- [Contradiccin 1 entre Vol X y Vol Y]
- [Solucin propuesta]

================================================================================
## 10. NOTAS ADICIONALES PARA EL ARQUITECTO
================================================================================

[Cualquier instruccin adicional especfica para la planificacin de esta serie]
`;function iP(t,n){const r=new Blob([t],{type:"text/plain;charset=utf-8"}),s=URL.createObjectURL(r),i=document.createElement("a");i.href=s,i.download=n,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(s)}function P8(){const{toast:t}=nn(),[n,r]=x.useState(null),[s,i]=x.useState(null),[o,c]=x.useState(null),[d,p]=x.useState(""),m=x.useRef(null),[h,g]=x.useState(null),[v,j]=x.useState(null),[N,b]=x.useState(""),{data:C=[],isLoading:S}=Ke({queryKey:["/api/projects"]}),{data:k=[],isLoading:P}=Ke({queryKey:["/api/extended-guides"]}),R=x.useMemo(()=>{if(!d.trim())return C;const q=d.toLowerCase();return C.filter(le=>le.title.toLowerCase().includes(q)||le.genre.toLowerCase().includes(q)||le.tone.toLowerCase().includes(q))},[C,d]),E=ye({mutationFn:async q=>(await je("POST","/api/projects",q)).json(),onSuccess:q=>{ae.invalidateQueries({queryKey:["/api/projects"]}),t({title:"Proyecto creado",description:`"${q.title}" ha sido configurado. Puedes iniciar la generacin desde el panel principal.`})},onError:()=>{t({title:"Error",description:"No se pudo crear el proyecto",variant:"destructive"})}}),A=ye({mutationFn:async q=>{await je("DELETE",`/api/projects/${q}`)},onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/projects"]}),t({title:"Proyecto eliminado",description:"El proyecto ha sido eliminado correctamente"})},onError:()=>{t({title:"Error",description:"No se pudo eliminar el proyecto",variant:"destructive"})}}),W=ye({mutationFn:async({id:q,...le})=>(await je("PATCH",`/api/projects/${q}`,le)).json(),onSuccess:q=>{ae.invalidateQueries({queryKey:["/api/projects"]}),ae.invalidateQueries({queryKey:["/api/series"]}),r(null),t({title:"Proyecto actualizado",description:`"${q.title}" ha sido actualizado correctamente`})},onError:q=>{let le="No se pudo actualizar el proyecto";try{const K=q.message||"",J=K.includes("{")?K.substring(K.indexOf("{")):"";if(J){const D=JSON.parse(J);D.error&&(le=D.error)}else K.includes(":")&&(le=K.substring(K.indexOf(":")+1).trim())}catch{}t({title:"Error",description:le,variant:"destructive"})}}),X=ye({mutationFn:async q=>{await je("DELETE",`/api/extended-guides/${q}`)},onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/extended-guides"]}),t({title:"Gua eliminada",description:"La gua de escritura ha sido eliminada correctamente"})},onError:()=>{t({title:"Error",description:"No se pudo eliminar la gua",variant:"destructive"})}}),se=ye({mutationFn:async({guideId:q,content:le})=>{await je("PATCH",`/api/extended-guides/${q}`,{content:le})},onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/extended-guides"]}),j(null),b(""),t({title:"Gua actualizada"})},onError:()=>{t({title:"Error",description:"No se pudo actualizar la gua",variant:"destructive"})}}),V=ye({mutationFn:async q=>{const le=new FormData;le.append("file",q);const K=await fetch("/api/extended-guides/upload",{method:"POST",body:le,credentials:"include"});if(!K.ok)throw new Error("Upload failed");return K.json()},onSuccess:q=>{ae.invalidateQueries({queryKey:["/api/extended-guides"]}),t({title:"Gua subida",description:`"${q.title}" se ha aadido correctamente (${(q.wordCount||0).toLocaleString()} palabras)`}),m.current&&(m.current.value="")},onError:()=>{t({title:"Error",description:"No se pudo subir el archivo",variant:"destructive"}),m.current&&(m.current.value="")}}),G=q=>{const le=q.target.files?.[0];if(le){if(!le.name.endsWith(".docx")){t({title:"Formato no soportado",description:"Por favor sube un archivo .docx (Word)",variant:"destructive"}),m.current&&(m.current.value="");return}V.mutate(le)}},O=q=>{E.mutate(q)},F=q=>{i(q)},U={idle:"En espera",generating:"Generando",completed:"Completado"},$={idle:"bg-muted text-muted-foreground",generating:"bg-chart-2/20 text-chart-2",completed:"bg-green-500/20 text-green-600 dark:text-green-400"};return e.jsxs("div",{className:"p-6 space-y-6","data-testid":"config-page",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Configuracin"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Gestiona tus proyectos y configuraciones de generacin"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(me,{children:[e.jsxs(Re,{children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(a1,{className:"h-5 w-5"}),"Nuevo Proyecto"]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>iP(k8,"guia-escritura-libro.txt"),"data-testid":"button-download-book-guide",children:[e.jsx(xn,{className:"h-4 w-4 mr-1"}),"Gua de Escritura"]})]}),e.jsx(At,{children:"Configura los parmetros para un nuevo manuscrito"})]}),e.jsx(he,{children:e.jsx(Lw,{onSubmit:O,isLoading:E.isPending})})]}),e.jsxs(me,{className:"flex flex-col",children:[e.jsxs(Re,{children:[e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(mn,{className:"h-5 w-5"}),"Proyectos Existentes"]}),e.jsxs(At,{children:[C.length," proyecto",C.length!==1?"s":""," creado",C.length!==1?"s":""]}),C.length>0&&e.jsxs("div",{className:"relative mt-2",children:[e.jsx(ma,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(gt,{placeholder:"Buscar proyectos...",value:d,onChange:q=>p(q.target.value),className:"pl-9","data-testid":"input-project-search"})]})]}),e.jsx(he,{className:"flex-1 min-h-0",children:S?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(Cn,{className:"h-8 w-8 text-muted-foreground/30 animate-pulse"})}):C.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(mn,{className:"h-12 w-12 text-muted-foreground/30 mb-4"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"No hay proyectos todava"}),e.jsx("p",{className:"text-muted-foreground/60 text-xs mt-1",children:"Crea tu primer proyecto usando el formulario"})]}):R.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(ma,{className:"h-12 w-12 text-muted-foreground/30 mb-4"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"No se encontraron proyectos"})]}):e.jsx(jt,{className:"h-[400px] pr-4",children:e.jsx("div",{className:"space-y-3",children:R.map(q=>e.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 rounded-md bg-muted/50","data-testid":`project-item-${q.id}`,children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-1",children:[e.jsx("h3",{className:"font-medium text-sm truncate",children:q.title}),e.jsx(Q,{className:`text-xs ${$[q.status]||$.idle}`,children:U[q.status]||q.status})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(Q,{variant:"outline",className:"text-xs",children:q.genre}),e.jsx(Q,{variant:"outline",className:"text-xs",children:q.tone}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[q.chapterCount," captulos"]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[q.status==="idle"&&e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>r(q),"data-testid":`button-edit-${q.id}`,children:e.jsx(ar,{className:"h-4 w-4"})}),e.jsx(Ja,{href:"/manuscript",children:e.jsx(B,{variant:"ghost",size:"sm","data-testid":`button-view-${q.id}`,children:"Ver"})}),e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>F(q.id),disabled:A.isPending,"data-testid":`button-delete-${q.id}`,children:e.jsx(Rn,{className:"h-4 w-4 text-destructive"})})]})]},q.id))})})})]})]}),e.jsxs(me,{children:[e.jsxs(Re,{className:"flex flex-row items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(yt,{className:"h-5 w-5"}),"Guas de Escritura Extendidas"]}),e.jsx(At,{children:"Sube documentos Word con instrucciones detalladas para la generacin de novelas"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"file",ref:m,onChange:G,accept:".docx",className:"hidden","data-testid":"input-guide-upload"}),e.jsxs(B,{variant:"outline",onClick:()=>m.current?.click(),disabled:V.isPending,"data-testid":"button-upload-guide",children:[e.jsx(ha,{className:"h-4 w-4 mr-2"}),V.isPending?"Subiendo...":"Subir Gua"]})]})]}),e.jsx(he,{children:P?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(Cn,{className:"h-8 w-8 text-muted-foreground/30 animate-pulse"})}):k.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(yt,{className:"h-12 w-12 text-muted-foreground/30 mb-4"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"No hay guas de escritura todava"}),e.jsx("p",{className:"text-muted-foreground/60 text-xs mt-1",children:"Sube un documento Word (.docx) con instrucciones detalladas"})]}):e.jsx(jt,{className:"h-[300px] pr-4",children:e.jsx("div",{className:"space-y-3",children:k.map(q=>e.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 rounded-md bg-muted/50","data-testid":`guide-item-${q.id}`,children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-1",children:[e.jsx("h3",{className:"font-medium text-sm truncate",children:q.title}),e.jsxs(Q,{variant:"outline",className:"text-xs",children:[(q.wordCount||0).toLocaleString()," palabras"]})]}),q.description&&e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:q.description}),e.jsx("p",{className:"text-xs text-muted-foreground/60 mt-1",children:q.originalFileName})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>g(q),"data-testid":`button-view-guide-${q.id}`,children:e.jsx(fr,{className:"h-4 w-4"})}),e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>{j(q),b(q.content)},"data-testid":`button-edit-guide-${q.id}`,children:e.jsx(ar,{className:"h-4 w-4"})}),e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>c(q.id),disabled:X.isPending,"data-testid":`button-delete-guide-${q.id}`,children:e.jsx(Rn,{className:"h-4 w-4 text-destructive"})})]})]},q.id))})})})]}),e.jsxs(me,{children:[e.jsx(Re,{children:e.jsx(Ie,{children:"Acerca del Sistema"})}),e.jsxs(he,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-md bg-muted/50",children:[e.jsx("p",{className:"text-xs text-muted-foreground font-medium uppercase tracking-wide mb-1",children:"Modelo de IA"}),e.jsx("p",{className:"font-medium",children:"Gemini 3 Pro Preview"})]}),e.jsxs("div",{className:"p-4 rounded-md bg-muted/50",children:[e.jsx("p",{className:"text-xs text-muted-foreground font-medium uppercase tracking-wide mb-1",children:"Nivel de Razonamiento"}),e.jsx("p",{className:"font-medium",children:"High (Deep Thinking)"})]}),e.jsxs("div",{className:"p-4 rounded-md bg-muted/50",children:[e.jsx("p",{className:"text-xs text-muted-foreground font-medium uppercase tracking-wide mb-1",children:"Temperatura"}),e.jsx("p",{className:"font-medium",children:"1.0"})]}),e.jsxs("div",{className:"p-4 rounded-md bg-muted/50",children:[e.jsx("p",{className:"text-xs text-muted-foreground font-medium uppercase tracking-wide mb-1",children:"Top P"}),e.jsx("p",{className:"font-medium",children:"0.95"})]})]}),e.jsx(Mo,{}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Este sistema utiliza cuatro agentes literarios autnomos (Arquitecto, Narrador, Editor, Estilista) que colaboran para crear manuscritos completos. Cada agente utiliza el motor de razonamiento avanzado de Gemini 3 Pro para planificar y ejecutar sus tareas con mxima coherencia narrativa."})]})]}),e.jsx(Pn,{open:!!n,onOpenChange:q=>!q&&r(null),children:e.jsxs(yn,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(jn,{children:e.jsx(bn,{children:"Editar proyecto"})}),n&&e.jsx(Lw,{onSubmit:q=>{W.mutate({id:n.id,...q})},onReset:()=>r(null),isLoading:W.isPending,defaultValues:{title:n.title,premise:n.premise||"",genre:n.genre,tone:n.tone,chapterCount:n.chapterCount,hasPrologue:n.hasPrologue,hasEpilogue:n.hasEpilogue,hasAuthorNote:n.hasAuthorNote,pseudonymId:n.pseudonymId,styleGuideId:n.styleGuideId,extendedGuideId:n.extendedGuideId,workType:n.workType||"standalone",seriesId:n.seriesId,seriesOrder:n.seriesOrder,minWordCount:n.minWordCount,minWordsPerChapter:n.minWordsPerChapter??1500,maxWordsPerChapter:n.maxWordsPerChapter??3500,kindleUnlimitedOptimized:n.kindleUnlimitedOptimized,bookboxStructure:n.bookboxStructure},isEditing:!0},n.id)]})}),e.jsx(Vs,{open:s!==null,onOpenChange:q=>!q&&i(null),title:"Eliminar proyecto",description:"Ests seguro de que quieres eliminar este proyecto? Esta accin no se puede deshacer.",confirmText:"Eliminar",variant:"destructive",onConfirm:()=>{s&&A.mutate(s),i(null)}}),e.jsx(Vs,{open:o!==null,onOpenChange:q=>!q&&c(null),title:"Eliminar gua",description:"Ests seguro de que quieres eliminar esta gua de escritura? Los proyectos que la usen perdern la referencia.",confirmText:"Eliminar",variant:"destructive",onConfirm:()=>{o&&X.mutate(o),c(null)}}),e.jsx(Pn,{open:!!h,onOpenChange:q=>!q&&g(null),children:e.jsxs(yn,{className:"max-w-4xl max-h-[85vh]",children:[e.jsxs(jn,{children:[e.jsxs(bn,{className:"flex items-center gap-2",children:[e.jsx(yt,{className:"h-5 w-5"}),h?.title]}),e.jsx($n,{children:"Gua de escritura para la novela"})]}),e.jsx(jt,{className:"max-h-[65vh] pr-4",children:e.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none",children:e.jsx(Iv,{children:h?.content||""})})})]})}),e.jsx(Pn,{open:!!v,onOpenChange:q=>{q||(j(null),b(""))},children:e.jsxs(yn,{className:"max-w-4xl max-h-[85vh]",children:[e.jsxs(jn,{children:[e.jsxs(bn,{className:"flex items-center gap-2",children:[e.jsx(ar,{className:"h-5 w-5"}),"Editar: ",v?.title]}),e.jsx($n,{children:"Modifica el contenido de la gua de escritura"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Nn,{value:N,onChange:q=>b(q.target.value),className:"min-h-[50vh] font-mono text-sm",placeholder:"Contenido de la gua en formato Markdown...","data-testid":"textarea-edit-book-guide"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(B,{variant:"outline",onClick:()=>{j(null),b("")},"data-testid":"button-cancel-edit-book-guide",children:"Cancelar"}),e.jsxs(B,{onClick:()=>{v&&se.mutate({guideId:v.id,content:N})},disabled:se.isPending,"data-testid":"button-save-book-guide",children:[se.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Tn,{className:"h-4 w-4 mr-2"}),"Guardar Cambios"]})]})]})]})})]})}function T8(){const{toast:t}=nn(),[n,r]=x.useState(null),[s,i]=x.useState(!1),[o,c]=x.useState(!1),[d,p]=x.useState(""),[m,h]=x.useState(""),[g,v]=x.useState(""),[j,N]=x.useState(""),[b,C]=x.useState(!1),[S,k]=x.useState(null),[P,R]=x.useState(null),E=x.useRef(null),{data:A=[],isLoading:W}=Ke({queryKey:["/api/pseudonyms"]}),{data:X=[]}=Ke({queryKey:["/api/pseudonyms",n,"style-guides"],enabled:n!==null}),se=ye({mutationFn:async K=>(await je("POST","/api/pseudonyms",K)).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/pseudonyms"]}),i(!1),p(""),h(""),t({title:"Pseudnimo creado",description:"El nuevo pseudnimo ha sido aadido"})},onError:()=>{t({title:"Error",description:"No se pudo crear el pseudnimo",variant:"destructive"})}}),V=ye({mutationFn:async K=>{await je("DELETE",`/api/pseudonyms/${K}`)},onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/pseudonyms"]}),n&&r(null),t({title:"Pseudnimo eliminado"})},onError:()=>{t({title:"Error",description:"No se pudo eliminar el pseudnimo",variant:"destructive"})}}),G=ye({mutationFn:async K=>(await je("POST",`/api/pseudonyms/${n}/style-guides`,K)).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/pseudonyms",n,"style-guides"]}),c(!1),v(""),N(""),t({title:"Gua de estilo creada"})},onError:()=>{t({title:"Error",description:"No se pudo crear la gua de estilo",variant:"destructive"})}}),O=ye({mutationFn:async K=>{await je("DELETE",`/api/style-guides/${K}`)},onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/pseudonyms",n,"style-guides"]}),t({title:"Gua eliminada"})},onError:()=>{t({title:"Error",description:"No se pudo eliminar la gua",variant:"destructive"})}}),F=()=>{d.trim()&&se.mutate({name:d,bio:m||void 0})},U=()=>{!g.trim()||!j.trim()||G.mutate({title:g,content:j})},$=async K=>{const J=K.target.files?.[0];if(J){C(!0);try{const D=new FormData;D.append("file",J);const I=await fetch("/api/upload/word",{method:"POST",body:D});if(!I.ok){const T=await I.json();throw new Error(T.error||"Error al procesar el archivo")}const re=await I.json();if(N(re.content),!g.trim()){const T=J.name.replace(/\.(docx?|doc)$/i,"");v(T)}t({title:"Archivo procesado",description:`Contenido extrado de "${J.name}"`})}catch(D){t({title:"Error",description:D.message||"No se pudo procesar el archivo Word",variant:"destructive"})}finally{C(!1),K.target.value=""}}},q=A.find(K=>K.id===n),le=()=>{const K=`# PLANTILLA DE GUA DE ESTILO
# Completa las secciones segn tu preferencia de escritura

## 1. VOZ NARRATIVA
- Persona: [Primera persona / Tercera persona limitada / Tercera persona omnisciente]
- Tono predominante: [ntimo / Distante / Irnico / Dramtico / etc.]
- Nivel de formalidad: [Coloquial / Neutro / Formal / Literario]

## 2. ESTILO DE PROSA
- Longitud de oraciones: [Cortas y directas / Variadas / Largas y elaboradas]
- Uso de metforas: [Mnimo / Moderado / Abundante]
- Descripciones: [Esenciales / Detalladas / Sensoriales]
- Dilogos: [Realistas / Estilizados / Dialectales]

## 3. RITMO Y ESTRUCTURA
- Velocidad de escenas de accin: [Frentica / Moderada / Pausada]
- Captulos: [Cortos 2000-3000 palabras / Medios 4000-5000 / Largos 6000+]
- Cliffhangers: [Al final de cada captulo / Ocasionales / Mnimos]

## 4. CONTENIDO SENSIBLE
- Violencia: [Explcita / Sugerida / Mnima]
- Romance/Escenas ntimas: [Explcitas / Fade to black / Sin escenas]
- Lenguaje fuerte: [Permitido / Moderado / Evitar]

## 5. VOCABULARIO
- Palabras a EVITAR: [Lista de palabras que no quieres usar]
- Palabras PREFERIDAS: [Trminos o expresiones caractersticas de tu estilo]
- Muletillas a evitar: [Frases repetitivas que no deseas]

## 6. REFERENCIAS DE ESTILO
- Autores de referencia: [Nombres de autores cuyo estilo admiras]
- Libros de referencia: [Ttulos especficos que ejemplifican el tono deseado]

## 7. NOTAS ADICIONALES
[Cualquier otra instruccin especfica para los agentes de escritura]
`,J=new Blob([K],{type:"text/plain;charset=utf-8"}),D=URL.createObjectURL(J),I=document.createElement("a");I.href=D,I.download="plantilla-guia-estilo.txt",document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(D),t({title:"Plantilla descargada",description:"Edita el archivo y sbelo para crear tu gua de estilo"})};return e.jsxs("div",{className:"p-6 space-y-6","data-testid":"pseudonyms-page",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Pseudnimos"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Gestiona tus identidades de autor y guas de estilo asociadas"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(me,{className:"lg:col-span-1",children:[e.jsxs(Re,{className:"flex flex-row items-center justify-between gap-2",children:[e.jsxs("div",{children:[e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(ri,{className:"h-5 w-5"}),"Autores"]}),e.jsxs(At,{children:[A.length," pseudnimo",A.length!==1?"s":""]})]}),e.jsx(B,{size:"icon",variant:"ghost",onClick:()=>i(!0),"data-testid":"button-add-pseudonym",children:e.jsx(Nr,{className:"h-4 w-4"})})]}),e.jsxs(he,{className:"space-y-2",children:[s&&e.jsxs("div",{className:"space-y-2 p-3 rounded-md bg-muted/50 mb-3",children:[e.jsx(gt,{placeholder:"Nombre del pseudnimo",value:d,onChange:K=>p(K.target.value),"data-testid":"input-pseudonym-name"}),e.jsx(Nn,{placeholder:"Biografa (opcional)",value:m,onChange:K=>h(K.target.value),className:"min-h-[60px]","data-testid":"input-pseudonym-bio"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(B,{size:"sm",onClick:F,disabled:se.isPending,"data-testid":"button-save-pseudonym",children:[e.jsx(Tn,{className:"h-3 w-3 mr-1"}),"Guardar"]}),e.jsx(B,{size:"sm",variant:"ghost",onClick:()=>{i(!1),p(""),h("")},"data-testid":"button-cancel-pseudonym",children:e.jsx(Gn,{className:"h-3 w-3"})})]})]}),W?e.jsx("div",{className:"py-8 text-center text-muted-foreground",children:"Cargando..."}):A.length===0?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(ri,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-2"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"No hay pseudnimos"})]}):A.map(K=>e.jsxs("div",{className:`flex items-center justify-between gap-2 p-3 rounded-md cursor-pointer transition-colors ${n===K.id?"bg-primary/10 border border-primary/20":"bg-muted/50 hover-elevate"}`,onClick:()=>r(K.id),"data-testid":`pseudonym-item-${K.id}`,children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:K.name}),K.bio&&e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:K.bio})]}),e.jsx(B,{size:"icon",variant:"ghost",onClick:J=>{J.stopPropagation(),k(K.id)},"data-testid":`button-delete-pseudonym-${K.id}`,children:e.jsx(Rn,{className:"h-4 w-4 text-destructive"})})]},K.id))]})]}),e.jsxs(me,{className:"lg:col-span-2",children:[e.jsxs(Re,{className:"flex flex-row items-center justify-between gap-2",children:[e.jsxs("div",{children:[e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(yt,{className:"h-5 w-5"}),"Guas de Estilo"]}),e.jsx(At,{children:q?`Guas para "${q.name}"`:"Selecciona un pseudnimo para ver sus guas"})]}),n&&e.jsxs(B,{size:"sm",onClick:()=>c(!0),"data-testid":"button-add-style-guide",children:[e.jsx(Nr,{className:"h-4 w-4 mr-1"}),"Nueva Gua"]})]}),e.jsx(he,{children:n?e.jsxs("div",{className:"space-y-4",children:[o&&e.jsxs("div",{className:"space-y-3 p-4 rounded-md bg-muted/50",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{children:"Ttulo de la gua"}),e.jsx(gt,{placeholder:"Ej: Voz narrativa thriller",value:g,onChange:K=>v(K.target.value),"data-testid":"input-guide-title"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx(st,{children:"Contenido de la gua"}),e.jsx("input",{ref:E,type:"file",accept:".docx,.doc",onChange:$,className:"hidden",disabled:b,"data-testid":"input-upload-word"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(B,{type:"button",size:"sm",variant:"outline",onClick:le,"data-testid":"button-download-template",children:[e.jsx(xn,{className:"h-3 w-3 mr-1"}),"Descargar Plantilla"]}),e.jsxs(B,{type:"button",size:"sm",variant:"outline",disabled:b,onClick:()=>E.current?.click(),"data-testid":"button-upload-word",children:[b?e.jsx(be,{className:"h-3 w-3 mr-1 animate-spin"}):e.jsx(ha,{className:"h-3 w-3 mr-1"}),"Subir Word"]})]})]}),e.jsx(Nn,{placeholder:"Describe el estilo de escritura, vocabulario preferido, estructura de oraciones, nivel de descripcin, manejo de dilogos, ritmo narrativo, etc.",value:j,onChange:K=>N(K.target.value),className:"min-h-[200px] font-mono text-sm","data-testid":"input-guide-content"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Puedes escribir directamente o subir un archivo Word (.docx, .doc)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(B,{onClick:U,disabled:G.isPending,"data-testid":"button-save-guide",children:[e.jsx(Tn,{className:"h-4 w-4 mr-1"}),"Guardar Gua"]}),e.jsx(B,{variant:"ghost",onClick:()=>{c(!1),v(""),N("")},"data-testid":"button-cancel-guide",children:"Cancelar"})]})]}),X.length===0&&!o?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(yt,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-2"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Este pseudnimo no tiene guas de estilo"}),e.jsx("p",{className:"text-muted-foreground/60 text-xs mt-1",children:"Crea una gua para definir la voz de este autor"}),e.jsxs("div",{className:"flex justify-center gap-2 mt-4",children:[e.jsxs(B,{variant:"outline",size:"sm",onClick:le,"data-testid":"button-download-template-empty",children:[e.jsx(xn,{className:"h-4 w-4 mr-1"}),"Descargar Plantilla"]}),e.jsxs(B,{size:"sm",onClick:()=>c(!0),"data-testid":"button-create-guide-empty",children:[e.jsx(Nr,{className:"h-4 w-4 mr-1"}),"Crear Gua"]})]})]}):X.map(K=>e.jsxs("div",{className:"p-4 rounded-md bg-muted/50 space-y-3","data-testid":`style-guide-item-${K.id}`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium",children:K.title}),K.isActive&&e.jsx(Q,{variant:"outline",className:"text-xs",children:"Activa"})]}),e.jsx(B,{size:"icon",variant:"ghost",onClick:()=>R(K.id),"data-testid":`button-delete-guide-${K.id}`,children:e.jsx(Rn,{className:"h-4 w-4 text-destructive"})})]}),e.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-wrap font-mono",children:K.content.length>500?K.content.substring(0,500)+"...":K.content})]},K.id))]}):e.jsxs("div",{className:"py-12 text-center",children:[e.jsx(yt,{className:"h-16 w-16 text-muted-foreground/20 mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Selecciona un pseudnimo de la lista para gestionar sus guas de estilo"})]})})]})]}),e.jsx(Vs,{open:S!==null,onOpenChange:K=>!K&&k(null),title:"Eliminar pseudnimo",description:"Eliminar este pseudnimo y todas sus guas de estilo? Esta accin no se puede deshacer.",confirmText:"Eliminar",variant:"destructive",onConfirm:()=>{S&&(V.mutate(S),n===S&&r(null)),k(null)}}),e.jsx(Vs,{open:P!==null,onOpenChange:K=>!K&&R(null),title:"Eliminar gua de estilo",description:"Eliminar esta gua de estilo? Esta accin no se puede deshacer.",confirmText:"Eliminar",variant:"destructive",onConfirm:()=>{P&&O.mutate(P),R(null)}})]})}const oP=[{code:"en",name:"English"},{code:"fr",name:"Franais"},{code:"de",name:"Deutsch"},{code:"it",name:"Italiano"},{code:"pt",name:"Portugus"},{code:"ca",name:"Catal"},{code:"es",name:"Espaol"}];function lP(t){if(!t)return"Sin detectar";const n=oP.find(r=>r.code===t.toLowerCase());return n?n.name:t.toUpperCase()}const R8=.8,A8=6.5,_8=3;function cP(t,n,r){const s=t/1e6*R8,i=n/1e6*A8,o=r/1e6*_8;return s+i+o}function Bx(t,n){return t===0?n||"Prlogo":t===-1?n||"Eplogo":t===-2?n||"Nota del Autor":n||`Captulo ${t}`}function dP(t){return t===0?"P":t===-1?"E":t===-2?"N":String(t)}function uP(t){return[...t].sort((n,r)=>{const s=n.chapterNumber===0?-1e3:n.chapterNumber===-1?1e3:n.chapterNumber===-2?1001:n.chapterNumber,i=r.chapterNumber===0?-1e3:r.chapterNumber===-1?1e3:r.chapterNumber===-2?1001:r.chapterNumber;return s-i})}function I8(t){let n=t;const r=[/^#+ *Literary Style Guide[^\n]*\n[\s\S]*?(?=^#+ *(?:CHAPTER|Chapter|Prologue|Epilogue|Author['']?s? Note)\b|\n---\n|$)/gm,/^#+ *Writing Guide[^\n]*\n[\s\S]*?(?=^#+ *(?:CHAPTER|Chapter|Prologue|Epilogue|Author['']?s? Note)\b|\n---\n|$)/gm,/^#+ *The Master of[^\n]*\n[\s\S]*?(?=^#+ *(?:CHAPTER|Chapter|Prologue|Epilogue|Author['']?s? Note)\b|\n---\n|$)/gm,/^#+ *Gua de Estilo[^\n]*\n[\s\S]*?(?=^#+ *(?:CAPTULO|Captulo|Prlogo|Eplogo|Nota del Autor)\b|\n---\n|$)/gmi,/^#+ *Gua de Escritura[^\n]*\n[\s\S]*?(?=^#+ *(?:CAPTULO|Captulo|Prlogo|Eplogo|Nota del Autor)\b|\n---\n|$)/gmi,/^###+ *Checklist[^\n]*\n[\s\S]*?(?=^#{1,2} *(?:CHAPTER|Chapter|CAPTULO|Captulo|Prologue|Prlogo|Epilogue|Eplogo)\b|\n---\n|$)/gmi,/\n---\n[\s\S]*?(?:Style Guide|Gua de Estilo|Writing Guide|Gua de Escritura)[\s\S]*?\n---\n/gi];for(const i of r)n=n.replace(i,"");const s=[/^#+ *\d+\. *(?:Narrative Architecture|Character Construction|Central Themes|Language and Stylistic|Tone and Atmosphere)[^\n]*\n[\s\S]*?(?=^#+ *(?:CHAPTER|Chapter|CAPTULO|Captulo|Prologue|Prlogo)\b|$)/gmi];for(const i of s)n=n.replace(i,"");return n.trim()}function M8(t){let n=t.trim();return n=I8(n),n=n.replace(/^#+ *(CHAPTER|CAPTULO|CAP\.?|Captulo|Chapter|Chapitre|Kapitel|Capitolo|Captol|Prlogo|Prologue|Prolog|Prologo|Prleg|Eplogo|Epilogue|pilogue|Epilog|Epilogo|Epleg|Nota del Autor|Nota de l'Autor|Author'?s? Note|Note de l'auteur|Nachwort|Nota dell'autore)[^\n]*\n+/gi,""),n.trim()}const Fw={en:{chapter:"Chapter",prologue:"Prologue",epilogue:"Epilogue",authorNote:"Author's Note"},es:{chapter:"Captulo",prologue:"Prlogo",epilogue:"Eplogo",authorNote:"Nota del Autor"},fr:{chapter:"Chapitre",prologue:"Prologue",epilogue:"pilogue",authorNote:"Note de l'auteur"},de:{chapter:"Kapitel",prologue:"Prolog",epilogue:"Epilog",authorNote:"Nachwort"},it:{chapter:"Capitolo",prologue:"Prologo",epilogue:"Epilogo",authorNote:"Nota dell'autore"},pt:{chapter:"Captulo",prologue:"Prlogo",epilogue:"Eplogo",authorNote:"Nota do Autor"},ca:{chapter:"Captol",prologue:"Prleg",epilogue:"Epleg",authorNote:"Nota de l'Autor"}};function O8(t){const n=t?.toLowerCase()||"es";return Fw[n]||Fw.es}function D8(t,n){const r=uP(n),s=[],i=O8(t.detectedLanguage);s.push(`# ${t.title}`),s.push("");for(const o of r){const c=o.editedContent||o.originalContent;if(!c)continue;let d;o.chapterNumber===0?d=o.title||i.prologue:o.chapterNumber===-1?d=o.title||i.epilogue:o.chapterNumber===-2?d=o.title||i.authorNote:o.title?d=`${i.chapter} ${o.chapterNumber}: ${o.title}`:d=`${i.chapter} ${o.chapterNumber}`,s.push(`## ${d}`),s.push(""),s.push(M8(c)),s.push("")}return s.join(`
`)}function L8(t,n){const r=new Blob([n],{type:"text/markdown;charset=utf-8"}),s=URL.createObjectURL(r),i=document.createElement("a");i.href=s,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(s)}function F8(t){const n=[/(?:^|\n)(Captulo|Chapter|Chapitre|Kapitel|Capitolo|Captol)[ \t]+(\d+)(?:[:\.\-][ \t]*)?([^\n]*)/gi,/(?:^|\n)(Cap\.?)[ \t]+(\d+)(?:[:\.\-][ \t]*)?([^\n]*)/gi],r=[/(?:^|\n)(Prlogo|Prologue|Prolog|Prologo|Prleg|Prefacio|Preface|Prface|Vorwort|Prefazione|Prefaci|Avant-propos)[:\.\s]*([^\n]*)/gi],s=[/(?:^|\n)(Eplogo|Epilogue|pilogue|Epilog|Epilogo|Epleg)[:\.\s]*([^\n]*)/gi],i=[/(?:^|\n)(Nota del Autor|Nota de l'Autor|Author'?s? Note|Note de l'auteur|Nachwort|Nota dell'autore|Nota final|Notas? finales?|Posfacio|Postfacio|Afterword|Postface|Palabras del Autor|Agradecimientos|Acknowledgments?|Remerciements|Ringraziamenti|Danksagung)[:\.\s]*([^\n]*)/gi],o=[];for(const c of r){let d;for(;(d=c.exec(t))!==null;){const p=d[2]?.trim()||d[1];o.push({chapterNumber:0,title:p||"Prlogo",content:"",startIndex:d.index})}}for(const c of n){let d;for(;(d=c.exec(t))!==null;){const p=parseInt(d[2],10),m=d[3]?.trim()||null;o.push({chapterNumber:p,title:m,content:"",startIndex:d.index})}}for(const c of s){let d;for(;(d=c.exec(t))!==null;){const p=d[2]?.trim()||d[1];o.push({chapterNumber:-1,title:p||"Eplogo",content:"",startIndex:d.index})}}for(const c of i){let d;for(;(d=c.exec(t))!==null;){const p=d[2]?.trim()||d[1];o.push({chapterNumber:-2,title:p||"Nota del Autor",content:"",startIndex:d.index})}}if(o.length===0)return[{chapterNumber:1,title:null,content:t.trim()}];o.sort((c,d)=>c.startIndex-d.startIndex);for(let c=0;c<o.length;c++){const d=o[c].startIndex,p=c<o.length-1?o[c+1].startIndex:t.length,m=t.slice(d,p).trim(),h=m.indexOf(`
`);o[c].content=h>0?m.slice(h+1).trim():m}return o.map(({chapterNumber:c,title:d,content:p})=>({chapterNumber:c,title:d,content:p}))}function $8({manuscript:t,onSelect:n,onDelete:r}){const s=t.totalChapters?(t.processedChapters||0)/t.totalChapters*100:0,i=cP(t.totalInputTokens||0,t.totalOutputTokens||0,t.totalThinkingTokens||0),o={pending:"bg-muted text-muted-foreground",processing:"bg-blue-500/10 text-blue-600 dark:text-blue-400",completed:"bg-green-500/10 text-green-600 dark:text-green-400",error:"bg-destructive/10 text-destructive"},d={pending:Cn,processing:be,completed:Xt,error:Dr}[t.status]||Cn;return e.jsxs(me,{className:"hover-elevate cursor-pointer",onClick:n,"data-testid":`card-manuscript-${t.id}`,children:[e.jsx(Re,{className:"pb-2",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(Ie,{className:"text-base truncate",children:t.title}),e.jsx(At,{className:"text-xs truncate",children:t.originalFileName})]}),e.jsxs(Q,{className:o[t.status],children:[e.jsx(d,{className:`h-3 w-3 mr-1 ${t.status==="processing"?"animate-spin":""}`}),t.status]})]})}),e.jsxs(he,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Mi,{className:"h-3 w-3"}),e.jsx("span",{children:lP(t.detectedLanguage)})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(yt,{className:"h-3 w-3"}),e.jsxs("span",{children:[t.processedChapters||0,"/",t.totalChapters||0," caps."]})]})]}),t.status!=="pending"&&e.jsx(di,{value:s,className:"h-1"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(Fi,{className:"h-3 w-3 text-muted-foreground"}),e.jsxs("span",{className:"font-mono",children:["$",i.toFixed(4)]})]}),e.jsx(B,{size:"icon",variant:"ghost",onClick:p=>{p.stopPropagation(),r()},"data-testid":`button-delete-manuscript-${t.id}`,children:e.jsx(Rn,{className:"h-4 w-4"})})]})]})]})}function z8({manuscriptId:t,onBack:n}){const{toast:r}=nn(),[s,i]=x.useState(null),{data:o,isLoading:c,refetch:d}=Ke({queryKey:["/api/imported-manuscripts",t],refetchInterval:N=>N.state.data?.status==="processing"?3e3:!1}),{data:p=[],isLoading:m,refetch:h}=Ke({queryKey:["/api/imported-manuscripts",t,"chapters"],refetchInterval:N=>o?.status==="processing"?3e3:!1}),g=ye({mutationFn:async N=>(await je("POST",`/api/imported-chapters/${N}/edit`)).json(),onSuccess:async()=>{await d();const{data:N}=await h();if(s&&N){const b=N.find(C=>C.id===s.id);b&&i(b)}r({title:"Captulo editado",description:"El captulo se ha editado correctamente"})},onError:N=>{r({title:"Error",description:N.message,variant:"destructive"})}}),v=ye({mutationFn:async()=>(await je("POST",`/api/imported-manuscripts/${t}/edit-all`)).json(),onSuccess:()=>{r({title:"Edicin iniciada",description:"Los captulos se estn editando. La pgina se actualizar automticamente."}),d(),h()},onError:N=>{r({title:"Error",description:N.message,variant:"destructive"})}}),j=o?cP(o.totalInputTokens||0,o.totalOutputTokens||0,o.totalThinkingTokens||0):0;return c||m?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(be,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):o?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold",children:o.title}),e.jsx("p",{className:"text-muted-foreground",children:o.originalFileName})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(B,{onClick:()=>v.mutate(),disabled:v.isPending||o.status==="processing"||p.every(N=>N.status==="completed"),"data-testid":"button-edit-all-chapters",children:[v.isPending&&e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}),"Editar Todos"]}),e.jsxs(B,{variant:"secondary",onClick:()=>{const N=D8(o,p),b=`${o.title.replace(/[^a-zA-Z0-9\s]/g,"").replace(/\s+/g,"_")}.md`;L8(b,N)},disabled:p.length===0,"data-testid":"button-export-manuscript",children:[e.jsx(xn,{className:"h-4 w-4 mr-2"}),"Exportar MD"]}),e.jsx(B,{variant:"outline",onClick:n,children:"Volver"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(me,{children:e.jsxs(he,{className:"pt-4",children:[e.jsx("div",{className:"text-2xl font-bold",children:o.totalChapters||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Captulos Totales"})]})}),e.jsx(me,{children:e.jsxs(he,{className:"pt-4",children:[e.jsx("div",{className:"text-2xl font-bold",children:o.processedChapters||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Captulos Editados"})]})}),e.jsx(me,{children:e.jsxs(he,{className:"pt-4",children:[e.jsx("div",{className:"text-2xl font-bold",children:lP(o.detectedLanguage)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Idioma Detectado"})]})}),e.jsx(me,{children:e.jsxs(he,{className:"pt-4",children:[e.jsxs("div",{className:"text-2xl font-bold font-mono",children:["$",j.toFixed(4)]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Coste Total USD"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(me,{className:"lg:col-span-1",children:[e.jsx(Re,{children:e.jsx(Ie,{className:"text-base",children:"Captulos"})}),e.jsx(he,{className:"p-0",children:e.jsx(jt,{className:"h-[400px]",children:e.jsx("div",{className:"p-4 space-y-2",children:uP(p).map(N=>e.jsxs(B,{variant:s?.id===N.id?"secondary":"ghost",className:"w-full justify-start gap-2",onClick:()=>i(N),"data-testid":`button-chapter-${N.id}`,children:[e.jsx(Q,{variant:"outline",className:`font-mono text-xs shrink-0 no-default-hover-elevate no-default-active-elevate ${N.status==="completed"?"bg-green-500/10 text-green-600 border-green-500/30":N.status==="processing"?"bg-blue-500/10 text-blue-600 border-blue-500/30":"bg-muted text-muted-foreground"}`,children:dP(N.chapterNumber)}),e.jsx("span",{className:"truncate flex-1 text-left text-sm",children:Bx(N.chapterNumber,N.title)}),N.status==="completed"&&e.jsx(Xt,{className:"h-4 w-4 text-green-500 shrink-0"}),N.status==="processing"&&e.jsx(be,{className:"h-4 w-4 animate-spin text-blue-500 shrink-0"}),N.status==="pending"&&e.jsx(Cn,{className:"h-4 w-4 text-muted-foreground shrink-0"}),N.status==="error"&&e.jsx(Dr,{className:"h-4 w-4 text-destructive shrink-0"})]},N.id))})})})]}),e.jsxs(me,{className:"lg:col-span-2",children:[e.jsxs(Re,{className:"flex flex-row items-center justify-between gap-2",children:[e.jsx(Ie,{className:"text-base",children:s?Bx(s.chapterNumber,s.title):"Selecciona un captulo"}),s&&s.status!=="completed"&&e.jsxs(B,{size:"sm",onClick:()=>g.mutate(s.id),disabled:g.isPending||s.status==="processing","data-testid":`button-edit-chapter-${s.id}`,children:[g.isPending?e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(ar,{className:"h-4 w-4 mr-2"}),"Editar"]})]}),e.jsx(he,{children:s?e.jsxs(ci,{defaultValue:"original",children:[e.jsxs(ga,{className:"mb-4",children:[e.jsx(Bt,{value:"original",children:"Original"}),e.jsx(Bt,{value:"edited",disabled:!s.editedContent,children:"Editado"}),e.jsx(Bt,{value:"changes",disabled:!s.changesLog,children:"Cambios"})]}),e.jsx(Gt,{value:"original",children:e.jsx(jt,{className:"h-[300px] border rounded-md p-4",children:e.jsx("pre",{className:"whitespace-pre-wrap font-serif text-sm",children:s.originalContent})})}),e.jsx(Gt,{value:"edited",children:e.jsx(jt,{className:"h-[300px] border rounded-md p-4",children:e.jsx("pre",{className:"whitespace-pre-wrap font-serif text-sm",children:s.editedContent||"No hay contenido editado an"})})}),e.jsx(Gt,{value:"changes",children:e.jsx(jt,{className:"h-[300px] border rounded-md p-4",children:e.jsx("pre",{className:"whitespace-pre-wrap font-mono text-xs",children:s.changesLog||"Sin registro de cambios"})})})]}):e.jsx("div",{className:"h-[300px] flex items-center justify-center text-muted-foreground",children:e.jsx("p",{children:"Selecciona un captulo para ver su contenido"})})})]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-muted-foreground",children:"Manuscrito no encontrado"}),e.jsx(B,{onClick:n,className:"mt-4",children:"Volver"})]})}function V8(){const{toast:t}=nn(),[n,r]=x.useState(null),[s,i]=x.useState({file:null,title:"",targetLanguage:"es",parsedChapters:[],isUploading:!1,isParsing:!1}),{data:o=[],isLoading:c}=Ke({queryKey:["/api/imported-manuscripts"],refetchInterval:g=>g.state.data?.some(j=>j.status==="processing")?3e3:!1}),d=ye({mutationFn:async g=>(await je("POST","/api/imported-manuscripts",g)).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/imported-manuscripts"]}),i({file:null,title:"",targetLanguage:"es",parsedChapters:[],isUploading:!1,isParsing:!1}),t({title:"Manuscrito importado",description:"El manuscrito se ha importado correctamente"})},onError:g=>{t({title:"Error al importar",description:g.message,variant:"destructive"})}}),p=ye({mutationFn:async g=>{await je("DELETE",`/api/imported-manuscripts/${g}`)},onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/imported-manuscripts"]}),t({title:"Manuscrito eliminado",description:"El manuscrito se ha eliminado correctamente"})},onError:g=>{t({title:"Error al eliminar",description:g.message,variant:"destructive"})}}),m=x.useCallback(async g=>{const v=g.target.files?.[0];if(v){i(j=>({...j,file:v,isParsing:!0,title:v.name.replace(/\.[^/.]+$/,"")}));try{const j=new FormData;j.append("file",v);const N=await fetch("/api/upload/word",{method:"POST",body:j});if(!N.ok){const S=await N.json();throw new Error(S.error||"Error al procesar el archivo")}const b=await N.json(),C=F8(b.content);i(S=>({...S,parsedChapters:C,isParsing:!1})),t({title:"Archivo procesado",description:`Se detectaron ${C.length} captulo(s)`})}catch(j){i(N=>({...N,isParsing:!1,file:null})),t({title:"Error al procesar",description:j instanceof Error?j.message:"Error desconocido",variant:"destructive"})}}},[t]),h=x.useCallback(()=>{!s.file||s.parsedChapters.length===0||d.mutate({title:s.title||s.file.name,originalFileName:s.file.name,targetLanguage:s.targetLanguage,detectedLanguage:s.targetLanguage,chapters:s.parsedChapters})},[s,d]);return n?e.jsx("div",{className:"container mx-auto p-6",children:e.jsx(z8,{manuscriptId:n,onBack:()=>r(null)})}):e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Importar Manuscrito"}),e.jsx("p",{className:"text-muted-foreground",children:"Sube un manuscrito en Word para edicin profesional por captulos"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(me,{children:[e.jsxs(Re,{children:[e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(ha,{className:"h-5 w-5"}),"Subir Manuscrito"]}),e.jsx(At,{children:"Soporta archivos .docx en ingls, francs, alemn, italiano, portugus y cataln"})]}),e.jsxs(he,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{htmlFor:"file",children:"Archivo Word"}),e.jsx(gt,{id:"file",type:"file",accept:".docx,.doc",onChange:m,disabled:s.isParsing,"data-testid":"input-file-upload"})]}),s.file&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{htmlFor:"title",children:"Ttulo"}),e.jsx(gt,{id:"title",value:s.title,onChange:g=>i(v=>({...v,title:g.target.value})),placeholder:"Ttulo del manuscrito","data-testid":"input-manuscript-title"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{htmlFor:"language",children:"Idioma de edicin"}),e.jsxs(Pt,{value:s.targetLanguage,onValueChange:g=>i(v=>({...v,targetLanguage:g})),children:[e.jsx(St,{"data-testid":"select-target-language",children:e.jsx(Tt,{})}),e.jsx(kt,{children:oP.map(g=>e.jsx(ce,{value:g.code,children:g.name},g.code))})]})]}),s.isParsing&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(be,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Analizando documento..."})]}),s.parsedChapters.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(st,{children:["Captulos detectados: ",s.parsedChapters.length]}),e.jsx(jt,{className:"h-32 border rounded-md p-2",children:e.jsx("ul",{className:"space-y-1 text-sm",children:s.parsedChapters.map((g,v)=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"outline",children:dP(g.chapterNumber)}),e.jsx("span",{className:"truncate",children:Bx(g.chapterNumber,g.title)}),e.jsxs("span",{className:"text-muted-foreground ml-auto text-xs",children:[g.content.split(/\s+/).length," palabras"]})]},v))})})]}),e.jsxs(B,{onClick:h,disabled:s.parsedChapters.length===0||d.isPending,className:"w-full","data-testid":"button-import-manuscript",children:[d.isPending&&e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}),"Importar Manuscrito"]})]})]})]}),e.jsxs(me,{children:[e.jsxs(Re,{children:[e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(yt,{className:"h-5 w-5"}),"Manuscritos Importados"]}),e.jsxs(At,{children:[o.length," manuscrito(s) en el sistema"]})]}),e.jsx(he,{children:c?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx(be,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):o.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(yt,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No hay manuscritos importados"})]}):e.jsx(jt,{className:"h-[400px]",children:e.jsx("div",{className:"space-y-3 pr-4",children:o.map(g=>e.jsx($8,{manuscript:g,onSelect:()=>r(g.id),onDelete:()=>p.mutate(g.id)},g.id))})})})]})]})]})}const Gx=[{code:"es",name:"Espaol"},{code:"en-US",name:"English (US)"},{code:"en-GB",name:"English (UK)"},{code:"fr",name:"Franais"},{code:"de",name:"Deutsch"},{code:"it",name:"Italiano"},{code:"pt",name:"Portugus"},{code:"ca",name:"Catal"}],Hx=.8,Kx=6.5;function $w(t,n){const r=t/1e6*Hx,s=n/1e6*Kx;return r+s}function Bf(t,n){const r=new Blob([n],{type:"text/markdown;charset=utf-8"}),s=URL.createObjectURL(r),i=document.createElement("a");i.href=s,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(s)}function Eu(t){return t.toLocaleString("es-ES")}function Ka(t){return Gx.find(n=>n.code===t)?.name||t.toUpperCase()}const Vc="litagents_active_translation";function Ar(t){t?localStorage.setItem(Vc,JSON.stringify(t)):localStorage.removeItem(Vc)}function Wx(){try{const t=localStorage.getItem(Vc);if(t){const n=JSON.parse(t),r=new Date(n.startedAt);if((Date.now()-r.getTime())/1e3/60<30)return n;localStorage.removeItem(Vc)}}catch{}return null}function Gf(){try{localStorage.removeItem(Vc)}catch{}}function zw(t){if(t.status!=="translating")return!1;const n=180*1e3;if(!t.heartbeatAt){const o=Wx();return!o||o.projectId!==t.projectId}const r=new Date(t.heartbeatAt).getTime();return Date.now()-r>n}function q8(){const{toast:t}=nn(),[n,r]=x.useState(null),[s,i]=x.useState("es"),[o,c]=x.useState("en-US"),[d,p]=x.useState(null),[m,h]=x.useState(""),[g,v]=x.useState(""),[j,N]=x.useState(!0),[b,C]=x.useState(null),S=Wx(),[k,P]=x.useState({isTranslating:S!==null,currentChapter:S?.currentChapter||0,totalChapters:S?.totalChapters||0,chapterTitle:S?`Reconectando a "${S.projectTitle}"...`:"",inputTokens:S?.inputTokens||0,outputTokens:S?.outputTokens||0,status:S?"reconnecting":void 0}),{data:R=[],isLoading:E}=Ke({queryKey:["/api/projects/completed"]}),{data:A=[],isLoading:W}=Ke({queryKey:["/api/translations"],refetchInterval:I=>I.state.data?.some(T=>T.status==="translating")?2e3:1e4}),X=x.useCallback((I,re,T,Y,oe="original")=>{d&&(d.close(),p(null));const Ne=Y||R.find(Oe=>Oe.id===I)?.title||"Proyecto";P({isTranslating:!0,currentChapter:0,totalChapters:0,chapterTitle:"Iniciando...",inputTokens:0,outputTokens:0,status:"active"}),Ar({projectId:I,projectTitle:Ne,sourceLanguage:re,targetLanguage:T,startedAt:new Date().toISOString(),currentChapter:0,totalChapters:0,chapterTitle:"Iniciando...",inputTokens:0,outputTokens:0});const xe=oe==="reedit"?`/api/reedit-projects/${I}/translate-stream`:oe==="imported"?`/api/projects/${I}/translate-stream`:`/api/projects/${I}/translate-stream`,Se=new EventSource(`${xe}?sourceLanguage=${re}&targetLanguage=${T}`);p(Se),Se.addEventListener("start",Oe=>{const Pe=JSON.parse(Oe.data);ae.invalidateQueries({queryKey:["/api/translations"]}),P(Be=>{const ve={...Be,totalChapters:Pe.totalChapters,chapterTitle:`Preparando ${Pe.totalChapters} captulos...`};return Ar({projectId:I,projectTitle:Ne,sourceLanguage:re,targetLanguage:T,startedAt:new Date().toISOString(),currentChapter:ve.currentChapter,totalChapters:ve.totalChapters,chapterTitle:ve.chapterTitle,inputTokens:ve.inputTokens,outputTokens:ve.outputTokens}),ve})}),Se.addEventListener("progress",Oe=>{const Pe=JSON.parse(Oe.data);ae.invalidateQueries({queryKey:["/api/translations"]}),P(Be=>{const ve={...Be,currentChapter:Pe.current,totalChapters:Pe.total,chapterTitle:Pe.chapterTitle,inputTokens:Pe.inputTokens||Be.inputTokens,outputTokens:Pe.outputTokens||Be.outputTokens};return Ar({projectId:I,projectTitle:Ne,sourceLanguage:re,targetLanguage:T,startedAt:new Date().toISOString(),currentChapter:ve.currentChapter,totalChapters:ve.totalChapters,chapterTitle:ve.chapterTitle,inputTokens:ve.inputTokens,outputTokens:ve.outputTokens}),ve})}),Se.addEventListener("chapterError",Oe=>{const Pe=JSON.parse(Oe.data);t({title:`Error en captulo ${Pe.chapterNumber}`,description:`${Pe.chapterTitle}: ${Pe.error}. Continuando con el resto...`,variant:"destructive"}),P(Be=>({...Be,chapterTitle:`Error en ${Pe.chapterTitle}, continuando...`}))}),Se.addEventListener("saving",()=>{P(Oe=>({...Oe,chapterTitle:"Guardando traduccin..."}))}),Se.addEventListener("native_review",Oe=>{const Pe=JSON.parse(Oe.data);C(Pe),P(Be=>({...Be,chapterTitle:`Revisin nativa: ${Pe.correctionsApplied} correcciones aplicadas`}))}),Se.addEventListener("complete",Oe=>{const Pe=JSON.parse(Oe.data);Se.close(),p(null),Ar(null),Pe.nativeBetaReaderResult&&C(Pe.nativeBetaReaderResult),P({isTranslating:!1,currentChapter:0,totalChapters:0,chapterTitle:"",inputTokens:0,outputTokens:0}),ae.resetQueries({queryKey:["/api/translations"]}),ae.refetchQueries({queryKey:["/api/translations"],exact:!0});const ve=(Pe.title||Pe.projectTitle||"traduccion").replace(/[^a-zA-Z0-9\u00C0-\u024F\s]/g,"").replace(/\s+/g,"_");Bf(`${ve}_${T.toUpperCase()}.md`,Pe.markdown),t({title:Pe.warning?"Traduccin completada con advertencia":"Traduccin completada",description:Pe.warning||`${Pe.chaptersTranslated} captulos traducidos y guardados`})}),Se.addEventListener("error",Oe=>{let Pe="";try{Pe=JSON.parse(Oe.data).error||""}catch{}Se.close(),p(null),Ar(null),P({isTranslating:!1,currentChapter:0,totalChapters:0,chapterTitle:"",inputTokens:0,outputTokens:0}),Pe&&t({title:"Error",description:Pe,variant:"destructive"})}),Se.onerror=()=>{Se.readyState!==EventSource.CLOSED&&(Se.close(),p(null),P(Oe=>({...Oe,status:"background",chapterTitle:"Procesando en segundo plano..."})),t({title:"Conexin interrumpida",description:"La traduccin contina en segundo plano. Revisa el repositorio en unos minutos.",variant:"default"}),setTimeout(()=>{Ar(null),P({isTranslating:!1,currentChapter:0,totalChapters:0,chapterTitle:"",inputTokens:0,outputTokens:0,status:void 0}),ae.invalidateQueries({queryKey:["/api/translations"]})},3e3))}},[t,R,d]),se=x.useCallback((I,re,T,Y,oe="original")=>{d&&(d.close(),p(null));const Ne=Y||R.find(Se=>Se.id===I)?.title||"Proyecto";P({isTranslating:!0,currentChapter:0,totalChapters:0,chapterTitle:"Analizando estilo y tipografa...",inputTokens:0,outputTokens:0,status:"active"}),Ar({projectId:I,projectTitle:Ne,sourceLanguage:re,targetLanguage:T,startedAt:new Date().toISOString(),currentChapter:0,totalChapters:0,chapterTitle:"Analizando estilo y tipografa...",inputTokens:0,outputTokens:0}),fetch("/api/translations/v2/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(oe==="reedit"?{reeditProjectId:I,targetLanguage:T}:oe==="imported"?{importedManuscriptId:I,targetLanguage:T}:{projectId:I,targetLanguage:T})}).then(Se=>{if(!Se.ok)throw new Error(`HTTP ${Se.status}: ${Se.statusText}`);const Oe=Se.body?.getReader();if(!Oe)throw new Error("No readable stream available");const Pe=new TextDecoder,Be=(We,Ye)=>{if(We==="started")ae.invalidateQueries({queryKey:["/api/translations"]});else if(We==="status")P(Qe=>({...Qe,chapterTitle:Ye.message||Ye.status||"Procesando..."}));else if(We==="strategy"){const Qe=Ye.typographical_rules;t({title:"Estrategia definida",description:`Reglas tipogrficas: ${Qe?.substring(0,50)||"Configurado"}...`})}else We==="progress"?(P(Qe=>({...Qe,currentChapter:Ye.current,totalChapters:Ye.total,chapterTitle:`Transcreando fragmento ${Ye.current}/${Ye.total}...`})),ae.invalidateQueries({queryKey:["/api/translations"]})):We==="complete"?(Ar(null),P({isTranslating:!1,currentChapter:0,totalChapters:0,chapterTitle:"",inputTokens:0,outputTokens:0}),ae.invalidateQueries({queryKey:["/api/translations"]}),t({title:"Transcreacin completada",description:`${Ye.projectTitle} transcreado a ${Ka(T)}. Puntuacin: Maquetacin ${Ye.layoutScore}/10, Naturalidad ${Ye.naturalnessScore}/10`})):We==="error"&&(Ar(null),P({isTranslating:!1,currentChapter:0,totalChapters:0,chapterTitle:"",inputTokens:0,outputTokens:0}),t({title:"Error en transcreacin",description:Ye.error,variant:"destructive"}))};(async()=>{let We="",Ye="",Qe="";for(;;){const{done:mt,value:ht}=await Oe.read();if(mt)break;We+=Pe.decode(ht,{stream:!0});const cn=We.split(`
`);We=cn.pop()||"";for(const Jt of cn)if(Jt.startsWith("event: "))Ye=Jt.slice(7).trim();else if(Jt.startsWith("data: "))Qe=Jt.slice(6);else if(Jt===""&&Ye&&Qe){try{const Vt=JSON.parse(Qe);Be(Ye,Vt)}catch{console.warn("Failed to parse SSE data:",Qe)}Ye="",Qe=""}}if(Ye&&Qe)try{const mt=JSON.parse(Qe);Be(Ye,mt)}catch{}})().catch(We=>{console.error("Stream error:",We),Ar(null),P({isTranslating:!1,currentChapter:0,totalChapters:0,chapterTitle:"",inputTokens:0,outputTokens:0}),t({title:"Conexin perdida",description:"La transcreacin puede continuar en segundo plano. Revisa el repositorio.",variant:"default"})})}).catch(Se=>{console.error("Fetch error:",Se),Ar(null),P({isTranslating:!1,currentChapter:0,totalChapters:0,chapterTitle:"",inputTokens:0,outputTokens:0}),t({title:"Error",description:Se.message||"No se pudo iniciar la transcreacin",variant:"destructive"})})},[t,R,d]);x.useEffect(()=>{if(d)return;const I=Wx();if(!I)return;const re=new Date(I.startedAt);(Date.now()-re.getTime())/1e3<120?A.some(oe=>oe.projectId===I.projectId&&oe.targetLanguage===I.targetLanguage)&&(Ar(null),P({isTranslating:!1,currentChapter:0,totalChapters:0,chapterTitle:"",inputTokens:0,outputTokens:0})):Ar(null)},[A]);const V=x.useCallback(()=>{d&&(d.close(),p(null)),Ar(null),P({isTranslating:!1,currentChapter:0,totalChapters:0,chapterTitle:"",inputTokens:0,outputTokens:0}),t({title:"Traduccin cancelada",description:"Puedes reiniciarla cuando quieras"})},[d,t]),G=ye({mutationFn:async({projectId:I,source:re,version:T})=>{const Y=re==="reedit"?`/api/reedit-projects/${I}/export-markdown`:re==="imported"?`/api/imported-manuscripts/${I}/export-markdown`:`/api/projects/${I}/export-markdown`,oe=T?`${Y}?version=${T}`:Y,Ne=await fetch(oe);if(!Ne.ok){const xe=await Ne.json().catch(()=>({}));throw new Error(xe.error||"Failed to export project")}return Ne.json()},onSuccess:I=>{const re=I.title.replace(/[^a-zA-Z0-9\u00C0-\u024F\s]/g,"").replace(/\s+/g,"_"),T=I.version==="original"?"_ORIGINAL":"";Bf(`${re}${T}.md`,I.markdown),t({title:"Exportado",description:`${I.versionLabel||"Manuscrito"}: ${I.chapterCount} captulos (${Eu(I.totalWords)} palabras)`})},onError:I=>{t({title:"Error",description:I.message,variant:"destructive"})}}),O=ye({mutationFn:async I=>{const re=await fetch(`/api/translations/${I}/download`);if(!re.ok)throw new Error("Failed to download translation");return re.json()},onSuccess:I=>{const re=I.projectTitle.replace(/[^a-zA-Z0-9\u00C0-\u024F\s]/g,"").replace(/\s+/g,"_");Bf(`${re}_${I.targetLanguage.toUpperCase()}.md`,I.markdown),t({title:"Descargado",description:`${I.projectTitle} en ${Ka(I.targetLanguage)}`})},onError:I=>{t({title:"Error",description:I.message,variant:"destructive"})}}),F=ye({mutationFn:async I=>{await je("DELETE",`/api/translations/${I}`)},onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/translations"]}),t({title:"Eliminado",description:"Traduccin eliminada del repositorio"})},onError:I=>{t({title:"Error",description:I.message,variant:"destructive"})}}),U=x.useCallback((I,re)=>{d&&(d.close(),p(null)),P({isTranslating:!0,currentChapter:0,totalChapters:0,chapterTitle:"Reanudando traduccin...",inputTokens:0,outputTokens:0});const T=new EventSource(`/api/translations/${I}/resume`);p(T),T.addEventListener("start",Y=>{const oe=JSON.parse(Y.data);ae.invalidateQueries({queryKey:["/api/translations"]}),P(Ne=>({...Ne,totalChapters:oe.totalChapters,chapterTitle:oe.resumed?`Reanudando: ${oe.alreadyTranslated}/${oe.totalChapters} ya traducidos, quedan ${oe.remaining}...`:`Preparando ${oe.totalChapters} captulos...`})),t({title:"Reanudando traduccin",description:`${oe.alreadyTranslated} captulos ya traducidos, continuando con ${oe.remaining} restantes`})}),T.addEventListener("progress",Y=>{const oe=JSON.parse(Y.data);ae.invalidateQueries({queryKey:["/api/translations"]}),P(Ne=>({...Ne,currentChapter:oe.current,totalChapters:oe.total,chapterTitle:oe.status==="translating"?`Traduciendo: ${oe.chapterTitle}...`:`Completado: ${oe.chapterTitle}`,inputTokens:oe.inputTokens||Ne.inputTokens,outputTokens:oe.outputTokens||Ne.outputTokens}))}),T.addEventListener("chapterError",Y=>{const oe=JSON.parse(Y.data);t({title:`Error en captulo ${oe.chapterNumber}`,description:`${oe.chapterTitle}: ${oe.error}. Continuando con el resto...`,variant:"destructive"}),P(Ne=>({...Ne,chapterTitle:`Error en ${oe.chapterTitle}, continuando...`}))}),T.addEventListener("complete",Y=>{const oe=JSON.parse(Y.data);T.close(),p(null),Gf(),P({isTranslating:!1,currentChapter:0,totalChapters:0,chapterTitle:"",inputTokens:0,outputTokens:0}),ae.invalidateQueries({queryKey:["/api/translations"]}),t({title:"Traduccin completada",description:oe.resumed?`${re}: ${oe.newChaptersTranslated} nuevos captulos traducidos (total: ${oe.chaptersTranslated})`:`${re}: ${oe.chaptersTranslated} captulos traducidos`})}),T.addEventListener("error",Y=>{let oe="";try{oe=JSON.parse(Y.data).error||""}catch{}T.close(),p(null),Gf(),P({isTranslating:!1,currentChapter:0,totalChapters:0,chapterTitle:"",inputTokens:0,outputTokens:0}),oe&&t({title:"Error al reanudar",description:oe,variant:"destructive"})}),T.onerror=()=>{T.readyState!==EventSource.CLOSED&&(T.close(),p(null),Gf(),P({isTranslating:!1,currentChapter:0,totalChapters:0,chapterTitle:"",inputTokens:0,outputTokens:0}))}},[t,d]),$=R.find(I=>I.id===n),q=n?A.find(I=>I.projectId===n&&I.targetLanguage===o):null,le=!!q,K=q?.status==="translating",J=R.filter(I=>I.title.toLowerCase().includes(m.toLowerCase())||(I.genre?.toLowerCase().includes(m.toLowerCase())??!1)),D=A.filter(I=>I.projectTitle.toLowerCase().includes(g.toLowerCase())||Ka(I.targetLanguage).toLowerCase().includes(g.toLowerCase()));return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Exportar y Traducir"}),e.jsx("p",{className:"text-muted-foreground",children:"Exporta proyectos completados en Markdown o tradcelos a otros idiomas"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(me,{children:[e.jsxs(Re,{children:[e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(mn,{className:"h-5 w-5"}),"Proyectos Completados"]}),e.jsxs(At,{children:[R.length," proyecto(s) disponible(s) para exportar"]})]}),e.jsxs(he,{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ma,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(gt,{placeholder:"Buscar proyectos...",value:m,onChange:I=>h(I.target.value),className:"pl-9","data-testid":"input-search-projects"})]}),E?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx(be,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):J.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(mn,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No hay proyectos completados"}),e.jsx("p",{className:"text-sm",children:"Los proyectos aparecern aqu cuando finalicen con xito"})]}):e.jsx(jt,{className:"h-[300px]",children:e.jsx("div",{className:"space-y-3 pr-4",children:J.map(I=>e.jsxs(me,{className:`hover-elevate cursor-pointer transition-all ${n===I.id?"ring-2 ring-primary":""}`,onClick:()=>{r(I.id),I.source==="imported"&&I.detectedLanguage&&i(I.detectedLanguage)},"data-testid":`card-project-${I.source}-${I.id}`,children:[e.jsx(Re,{className:"pb-2",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(Ie,{className:"text-base truncate",children:I.title}),e.jsx(At,{className:"text-xs",children:I.genre||(I.source==="reedit"?"Manuscrito re-editado":I.source==="imported"?"Libro importado":"Sin gnero")})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[I.source==="reedit"&&e.jsx(Q,{variant:"outline",className:"text-xs",children:"Re-editado"}),I.source==="imported"&&e.jsx(Q,{variant:"outline",className:"text-xs",children:"Importado"}),e.jsxs(Q,{variant:"secondary",className:"bg-green-500/10 text-green-600 dark:text-green-400",children:[e.jsx(Xt,{className:"h-3 w-3 mr-1"}),"Completado"]})]})]})}),e.jsx(he,{children:e.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm text-muted-foreground flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(yt,{className:"h-3 w-3"}),e.jsxs("span",{children:[I.chapterCount," cap."]})]}),e.jsxs("span",{children:[Eu(I.totalWords)," palabras"]}),I.finalScore&&e.jsxs(Q,{variant:"outline",children:[I.finalScore,"/10"]})]})})]},`${I.source}-${I.id}`))})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(me,{children:[e.jsxs(Re,{children:[e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(xn,{className:"h-5 w-5"}),"Exportar Markdown"]}),e.jsx(At,{children:"Descarga el manuscrito en formato Markdown. Puedes comparar original vs corregido."})]}),e.jsx(he,{children:$?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-3 bg-muted rounded-md",children:[e.jsx("p",{className:"font-medium",children:$.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[$.chapterCount," captulos - ",Eu($.totalWords)," palabras"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(B,{onClick:()=>G.mutate({projectId:$.id,source:$.source,version:"corrected"}),disabled:G.isPending,"data-testid":"button-export-markdown",children:[G.isPending?e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(xn,{className:"h-4 w-4 mr-2"}),"Corregido"]}),e.jsxs(B,{variant:"outline",onClick:()=>G.mutate({projectId:$.id,source:$.source,version:"original"}),disabled:G.isPending,"data-testid":"button-export-original",children:[G.isPending?e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(yt,{className:"h-4 w-4 mr-2"}),"Original"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:'El manuscrito "Original" es el snapshot guardado antes de Detect & Fix'})]}):e.jsxs("div",{className:"text-center py-6 text-muted-foreground",children:[e.jsx(yt,{className:"h-10 w-10 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Selecciona un proyecto para exportar"})]})})]}),e.jsxs(me,{children:[e.jsxs(Re,{children:[e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(Mi,{className:"h-5 w-5"}),"Nueva Traduccin"]}),e.jsx(At,{children:"Traduce y guarda en el repositorio"})]}),e.jsx(he,{children:$?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{children:"Idioma origen"}),e.jsxs(Pt,{value:s,onValueChange:i,children:[e.jsx(St,{"data-testid":"select-source-language",children:e.jsx(Tt,{})}),e.jsx(kt,{children:Gx.map(I=>e.jsx(ce,{value:I.code,children:I.name},I.code))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{children:"Idioma destino"}),e.jsxs(Pt,{value:o,onValueChange:c,children:[e.jsx(St,{"data-testid":"select-target-language",children:e.jsx(Tt,{})}),e.jsx(kt,{children:Gx.filter(I=>I.code!==s).map(I=>e.jsx(ce,{value:I.code,children:I.name},I.code))})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-primary/5 border border-primary/20 rounded-md",children:[e.jsx(Kr,{id:"use-v2",checked:j,onCheckedChange:I=>N(I===!0),"data-testid":"checkbox-littranslators2"}),e.jsxs(st,{htmlFor:"use-v2",className:"flex items-center gap-2 cursor-pointer text-sm",children:[e.jsx(xr,{className:"h-4 w-4 text-primary"}),e.jsx("span",{children:"LitTranslators 2.0"}),e.jsx(Q,{variant:"secondary",className:"text-xs",children:"Transcreacin"})]})]}),!k.isTranslating&&e.jsxs("div",{className:"p-3 bg-amber-500/10 border border-amber-500/20 rounded-md text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-600 dark:text-amber-400",children:[e.jsx(Fi,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Coste estimado"})]}),e.jsxs("p",{className:"text-muted-foreground mt-1",children:["~$",($.totalWords*1.5/1e6*(Hx+Kx*1.2)).toFixed(2)," - $",($.totalWords*2/1e6*(Hx+Kx*1.5)).toFixed(2)]})]}),k.isTranslating&&e.jsxs("div",{className:`space-y-3 p-3 rounded-md ${k.status==="background"?"bg-orange-100 dark:bg-orange-950 border border-orange-300 dark:border-orange-800":"bg-muted"}`,children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-medium flex items-center gap-2",children:k.status==="background"?e.jsxs(e.Fragment,{children:[e.jsx(Ns,{className:"h-4 w-4 animate-spin text-orange-600"}),e.jsx("span",{className:"text-orange-700 dark:text-orange-400",children:"En segundo plano"})]}):k.status==="reconnecting"?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"h-4 w-4 animate-spin text-blue-600"}),e.jsx("span",{className:"text-blue-700 dark:text-blue-400",children:"Reconectando..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"h-4 w-4 animate-spin"}),"Traduciendo..."]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-muted-foreground",children:[k.currentChapter,"/",k.totalChapters]}),k.status!=="background"&&e.jsx(B,{size:"icon",variant:"ghost",onClick:V,"data-testid":"button-cancel-translation",children:e.jsx(Gn,{className:"h-4 w-4"})})]})]}),e.jsx(di,{value:k.totalChapters>0?k.currentChapter/k.totalChapters*100:0,className:"h-2"}),e.jsx("p",{className:`text-xs truncate ${k.status==="background"?"text-orange-600 dark:text-orange-400":"text-muted-foreground"}`,children:k.chapterTitle}),k.inputTokens>0&&k.status!=="background"&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(Fi,{className:"h-3 w-3"}),e.jsxs("span",{children:["Coste actual: $",$w(k.inputTokens,k.outputTokens).toFixed(3)]})]})]}),b&&e.jsxs("div",{className:"p-3 bg-emerald-500/10 border border-emerald-500/20 rounded-md text-sm space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-emerald-600 dark:text-emerald-400",children:[e.jsx(xr,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Revisin Nativa Completada"})]}),e.jsx(Q,{variant:b.verdict==="APPROVED"?"default":"secondary",children:b.verdict==="APPROVED"?"Aprobado":b.verdict==="NEEDS_REVISION"?"Revisado":"Corregido"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Calidad general:"}),e.jsxs("span",{className:"font-medium",children:[b.overallScore,"/10"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Fluidez:"}),e.jsxs("span",{className:"font-medium",children:[b.fluencyScore,"/10"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Adecuacin gnero:"}),e.jsxs("span",{className:"font-medium",children:[b.genreAdherenceScore,"/10"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Adaptacin cultural:"}),e.jsxs("span",{className:"font-medium",children:[b.culturalAdaptationScore,"/10"]})]})]}),e.jsxs("div",{className:"flex justify-between text-xs pt-1 border-t border-emerald-500/20",children:[e.jsx("span",{className:"text-muted-foreground",children:"Problemas detectados:"}),e.jsx("span",{className:"font-medium",children:b.issuesCount})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Correcciones aplicadas:"}),e.jsx("span",{className:"font-medium text-emerald-600 dark:text-emerald-400",children:b.correctionsApplied})]}),b.genreFeedback&&e.jsx("div",{className:"text-xs text-muted-foreground pt-1 border-t border-emerald-500/20 italic",children:b.genreFeedback}),e.jsxs(B,{variant:"ghost",size:"sm",className:"w-full text-xs h-7",onClick:()=>C(null),"data-testid":"button-dismiss-native-review",children:[e.jsx(Gn,{className:"h-3 w-3 mr-1"}),"Cerrar resumen"]})]}),le?e.jsx("div",{className:"p-3 bg-muted rounded-md text-sm text-center",children:K?e.jsxs("p",{className:"text-muted-foreground",children:[e.jsx(be,{className:"h-4 w-4 inline mr-2 animate-spin"}),"Traduccin a ",Ka(o)," en progreso..."]}):e.jsxs("p",{className:"text-muted-foreground",children:["Ya existe una traduccin a ",Ka(o),". Elimnala del repositorio si deseas volver a traducir, o selecciona otro idioma."]})}):e.jsx(B,{onClick:()=>{j||$.source==="imported"?se($.id,s,o,$.title,$.source):X($.id,s,o,$.title,$.source)},disabled:k.isTranslating||s===o,className:"w-full","data-testid":"button-translate-project",children:k.isTranslating?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}),"Traduciendo ",k.currentChapter,"/",k.totalChapters,"..."]}):e.jsxs(e.Fragment,{children:[j?e.jsx(xr,{className:"h-4 w-4 mr-2"}):e.jsx(Mi,{className:"h-4 w-4 mr-2"}),j?"Transcrear":"Traducir"," a ",Ka(o)]})})]}):e.jsxs("div",{className:"text-center py-6 text-muted-foreground",children:[e.jsx(Mi,{className:"h-10 w-10 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Selecciona un proyecto para traducir"})]})})]})]})]}),e.jsxs(me,{children:[e.jsxs(Re,{children:[e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(pa,{className:"h-5 w-5"}),"Repositorio de Traducciones"]}),e.jsx(At,{children:"Traducciones guardadas listas para descargar"})]}),e.jsxs(he,{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ma,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(gt,{placeholder:"Buscar traducciones...",value:g,onChange:I=>v(I.target.value),className:"pl-9","data-testid":"input-search-translations"})]}),W?e.jsx("div",{className:"flex items-center justify-center h-24",children:e.jsx(be,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):D.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(pa,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No hay traducciones guardadas"}),e.jsx("p",{className:"text-sm",children:"Las traducciones aparecern aqu cuando las generes"})]}):e.jsx(jt,{className:"max-h-[400px] pr-1",children:e.jsx("div",{className:"space-y-3",children:D.map(I=>e.jsxs("div",{className:"flex items-center justify-between gap-4 p-4 bg-muted/50 rounded-md border border-border","data-testid":`translation-${I.id}`,children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("p",{className:"font-medium truncate",children:I.projectTitle}),I.status==="translating"&&zw(I)?e.jsxs(Q,{variant:"outline",className:"bg-amber-500/10 text-amber-600 border-amber-200",children:[e.jsx(on,{className:"h-3 w-3 mr-1"}),"Congelado"]}):I.status==="translating"?e.jsxs(Q,{variant:"outline",className:"animate-pulse bg-blue-500/10 text-blue-600 border-blue-200",children:[e.jsx(be,{className:"h-3 w-3 mr-1 animate-spin"}),"Procesando..."]}):I.status==="completed"?e.jsxs(Q,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-200",children:[e.jsx(Xt,{className:"h-3 w-3 mr-1"}),"Listo"]}):I.status==="error"?e.jsx(Q,{variant:"destructive",children:"Error"}):I.status==="pending"?e.jsx(Q,{variant:"outline",className:"bg-muted text-muted-foreground",children:"Pendiente"}):null]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-muted-foreground flex-wrap",children:[e.jsxs(Q,{variant:"outline",children:[Ka(I.sourceLanguage),"  ",Ka(I.targetLanguage)]}),e.jsxs("span",{children:[I.chaptersTranslated," cap."]}),I.totalWords>0&&e.jsxs("span",{children:[Eu(I.totalWords)," palabras"]}),I.inputTokens>0&&e.jsxs("span",{className:"text-xs",children:["$",$w(I.inputTokens,I.outputTokens).toFixed(4)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[I.status==="completed"?e.jsxs(B,{size:"sm",onClick:()=>O.mutate(I.id),disabled:O.isPending,"data-testid":`button-download-translation-${I.id}`,children:[O.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin"}):e.jsx(xn,{className:"h-4 w-4 mr-2"}),"Descargar"]}):I.status==="translating"&&zw(I)?e.jsxs(B,{size:"sm",variant:"outline",onClick:()=>U(I.id,I.projectTitle),disabled:k.isTranslating,className:"border-amber-500/50 text-amber-600 hover:bg-amber-500/10","data-testid":`button-retry-frozen-${I.id}`,children:[k.isTranslating?e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Ns,{className:"h-4 w-4 mr-2"}),"Reintentar"]}):I.status==="translating"?e.jsxs(B,{size:"sm",variant:"outline",onClick:()=>U(I.id,I.projectTitle),disabled:k.isTranslating,className:"border-blue-500/50 text-blue-600 hover:bg-blue-500/10","data-testid":`button-resume-translation-${I.id}`,children:[k.isTranslating?e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Yn,{className:"h-4 w-4 mr-2"}),"Reanudar"]}):e.jsxs(B,{size:"sm",variant:"outline",onClick:()=>O.mutate(I.id),disabled:O.isPending,className:"border-destructive/50 text-destructive hover:bg-destructive/10",children:[O.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin"}):e.jsx(xn,{className:"h-4 w-4 mr-2"}),"Intentar Descarga"]}),e.jsx(B,{size:"sm",variant:"ghost",onClick:()=>F.mutate(I.id),disabled:F.isPending,className:"text-destructive hover:text-destructive hover:bg-destructive/10","data-testid":`button-delete-translation-${I.id}`,children:e.jsx(Rn,{className:"h-4 w-4"})})]})]},I.id))})})]})]})]})}function U8({seriesId:t,seriesTitle:n,totalVolumes:r}){const{toast:s}=nn(),[i,o]=x.useState(!1),[c,d]=x.useState(!1),[p,m]=x.useState({description:"",volumeNumber:1,milestoneType:"plot_point",isRequired:!0}),[h,g]=x.useState({threadName:"",description:"",introducedVolume:1,importance:"major"}),[v,j]=x.useState(""),[N,b]=x.useState(null),{data:C=[]}=Ke({queryKey:[`/api/series/${t}/projects`]}),{data:S=[],isLoading:k}=Ke({queryKey:[`/api/series/${t}/milestones`]}),{data:P=[],isLoading:R}=Ke({queryKey:[`/api/series/${t}/threads`]}),{data:E=[]}=Ke({queryKey:[`/api/series/${t}/verifications`]}),A=ye({mutationFn:async Y=>je("POST",`/api/series/${t}/milestones`,Y),onSuccess:()=>{ae.invalidateQueries({queryKey:[`/api/series/${t}/milestones`]}),o(!1),m({description:"",volumeNumber:1,milestoneType:"plot_point",isRequired:!0}),s({title:"Hito aadido"})}}),W=ye({mutationFn:async({id:Y,data:oe})=>je("PATCH",`/api/milestones/${Y}`,oe),onSuccess:()=>{ae.invalidateQueries({queryKey:[`/api/series/${t}/milestones`]})}}),X=ye({mutationFn:async Y=>je("DELETE",`/api/milestones/${Y}`),onSuccess:()=>{ae.invalidateQueries({queryKey:[`/api/series/${t}/milestones`]}),s({title:"Hito eliminado"})}}),se=ye({mutationFn:async Y=>je("POST",`/api/series/${t}/threads`,Y),onSuccess:()=>{ae.invalidateQueries({queryKey:[`/api/series/${t}/threads`]}),d(!1),g({threadName:"",description:"",introducedVolume:1,importance:"major"}),s({title:"Hilo argumental aadido"})}}),V=ye({mutationFn:async({id:Y,data:oe})=>je("PATCH",`/api/threads/${Y}`,oe),onSuccess:()=>{ae.invalidateQueries({queryKey:[`/api/series/${t}/threads`]})}}),G=ye({mutationFn:async Y=>je("DELETE",`/api/threads/${Y}`),onSuccess:()=>{ae.invalidateQueries({queryKey:[`/api/series/${t}/threads`]}),s({title:"Hilo eliminado"})}}),O=ye({mutationFn:async Y=>(await je("POST",`/api/series/${t}/verify-project`,{projectId:Y})).json(),onSuccess:Y=>{ae.invalidateQueries({queryKey:[`/api/series/${t}/verifications`]}),ae.invalidateQueries({queryKey:[`/api/series/${t}/milestones`]}),ae.invalidateQueries({queryKey:[`/api/series/${t}/threads`]}),b(Y.result),s({title:Y.result?.passed?"Verificacion exitosa":"Verificacion con observaciones",description:`Puntuacion: ${Y.result?.overallScore||0}/100`})},onError:()=>{s({title:"Error",description:"No se pudo ejecutar la verificacion",variant:"destructive"})}}),F=ye({mutationFn:async Y=>(await je("POST",`/api/series/${t}/apply-corrections`,{projectId:parseInt(v),corrections:Y})).json(),onSuccess:Y=>{ae.invalidateQueries({queryKey:[`/api/series/${t}/verifications`]}),ae.invalidateQueries({queryKey:[`/api/series/${t}/milestones`]}),ae.invalidateQueries({queryKey:["/api/chapters",parseInt(v)]}),b(null);const oe=Y.needsReview>0;s({title:oe?"Correcciones con observaciones":"Correcciones verificadas",description:Y.message||`${Y.totalCorrected} capitulos corregidos`})},onError:()=>{s({title:"Error",description:"No se pudieron aplicar las correcciones",variant:"destructive"})}}),U=ye({mutationFn:async({chapterNumbers:Y,instructions:oe})=>(await je("POST",`/api/series/${t}/structural-rewrite`,{projectId:parseInt(v),chapterNumbers:Y,structuralInstructions:oe})).json(),onSuccess:Y=>{ae.invalidateQueries({queryKey:[`/api/series/${t}/verifications`]}),ae.invalidateQueries({queryKey:["/api/chapters",parseInt(v)]}),s({title:"Reescritura completada",description:Y.message||`${Y.totalRewritten} capitulos reescritos`})},onError:()=>{s({title:"Error",description:"No se pudo completar la reescritura estructural",variant:"destructive"})}}),$=()=>{if(!v){s({title:"Error",description:"Selecciona un proyecto primero",variant:"destructive"});return}O.mutate(parseInt(v))},q=()=>{if(!N?.milestoneVerifications)return;const Y=N.milestoneVerifications.filter(oe=>!oe.isFulfilled).map((oe,Ne)=>({chapterNumber:oe.suggestedChapter||oe.fulfilledInChapter||Ne+1,instruction:`HITO NO CUMPLIDO: ${oe.description}. ${oe.verificationNotes||"Incorporar este elemento del arco argumental en el capitulo."}`,milestoneId:oe.milestoneId}));if(Y.length===0){s({title:"Info",description:"Todos los hitos estan cumplidos, no hay correcciones necesarias"});return}F.mutate(Y)},le=Y=>{switch(Y){case"plot_point":return"Punto de Trama";case"character_development":return"Desarrollo de Personaje";case"revelation":return"Revelacin";case"conflict":return"Conflicto";case"resolution":return"Resolucin";default:return Y}},K=Y=>Y?e.jsx(Us,{className:"h-4 w-4 text-green-500"}):e.jsx(JN,{className:"h-4 w-4 text-muted-foreground"}),J=Y=>{switch(Y){case"active":return{label:"Activo",variant:"default"};case"developing":return{label:"En Desarrollo",variant:"secondary"};case"resolved":return{label:"Resuelto",variant:"outline"};case"abandoned":return{label:"Abandonado",variant:"destructive"};default:return{label:Y,variant:"outline"}}};if(k||R)return e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(be,{className:"h-6 w-6 animate-spin text-muted-foreground"})});const D=S.filter(Y=>Y.isFulfilled).length,I=P.filter(Y=>Y.status==="resolved").length,re=E[0],T=N?.milestoneVerifications?.filter(Y=>!Y.isFulfilled)||[];return e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsxs("div",{className:"p-4 rounded-lg border bg-muted/30 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex-1 min-w-48",children:[e.jsx(st,{className:"text-sm text-muted-foreground mb-1 block",children:"Proyecto a verificar"}),e.jsxs(Pt,{value:v,onValueChange:j,children:[e.jsx(St,{"data-testid":"select-project-verify",children:e.jsx(Tt,{placeholder:"Seleccionar volumen..."})}),e.jsx(kt,{children:C.map(Y=>e.jsxs(ce,{value:Y.id.toString(),children:["Vol. ",Y.seriesOrder,": ",Y.title]},Y.id))})]})]}),e.jsxs("div",{className:"flex gap-2 pt-5",children:[e.jsxs(B,{onClick:$,disabled:!v||O.isPending,"data-testid":"button-run-verification",children:[O.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Yn,{className:"h-4 w-4 mr-2"}),"Ejecutar Verificacion"]}),T.length>0&&e.jsxs(B,{variant:"secondary",onClick:q,disabled:F.isPending,"data-testid":"button-apply-corrections",children:[F.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(BA,{className:"h-4 w-4 mr-2"}),"Aplicar Correcciones (",T.length,")"]})]})]}),N&&e.jsxs("div",{className:"p-3 rounded-lg border bg-card",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[N.passed?e.jsx(Us,{className:"h-5 w-5 text-green-500"}):e.jsx(on,{className:"h-5 w-5 text-yellow-500"}),e.jsxs("span",{className:"font-medium",children:["Resultado: ",N.passed?"Aprobado":"Requiere atencion"]}),e.jsxs(Q,{variant:"outline",children:[N.overallScore,"/100"]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Hitos: ",N.milestonesFulfilled,"/",N.milestonesChecked," | Hilos resueltos: ",N.threadsResolved]}),N.recommendations&&e.jsx("p",{className:"text-sm mt-2 text-muted-foreground",children:N.recommendations}),N.classifiedFindings?.length>0?e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Hallazgos Clasificados:"}),N.classifiedFindings.map((Y,oe)=>e.jsxs("div",{className:"flex items-start gap-2 p-2 rounded bg-muted/50 text-xs",children:[e.jsx(Q,{variant:Y.type==="structural"?"destructive":"secondary",className:"shrink-0",children:Y.type==="structural"?e.jsxs(e.Fragment,{children:[e.jsx(PA,{className:"h-3 w-3 mr-1"}),"Estructural"]}):e.jsxs(e.Fragment,{children:[e.jsx(ar,{className:"h-3 w-3 mr-1"}),"Cosmetico"]})}),e.jsx("span",{className:"flex-1 text-muted-foreground",children:Y.text}),Y.type==="structural"?e.jsx(B,{size:"sm",variant:"outline",className:"shrink-0 h-6 text-xs",disabled:U.isPending||!v,onClick:()=>{U.mutate({chapterNumbers:Y.affectedChapters?.length>0?Y.affectedChapters:[1],instructions:Y.text})},"data-testid":`button-structural-${oe}`,children:U.isPending?e.jsx(be,{className:"h-3 w-3 animate-spin"}):"Reescribir"}):e.jsx(B,{size:"sm",variant:"ghost",className:"shrink-0 h-6 text-xs",disabled:F.isPending||!v,onClick:()=>{F.mutate([{chapterNumber:Y.affectedChapters?.[0]||1,instruction:Y.text,milestoneId:null}])},"data-testid":`button-cosmetic-${oe}`,children:F.isPending?e.jsx(be,{className:"h-3 w-3 animate-spin"}):"Corregir"})]},oe))]}):N.findings?.length>0&&e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Hallazgos:"}),N.findings.slice(0,10).map((Y,oe)=>e.jsxs("div",{className:"flex items-start gap-2 p-2 rounded bg-muted/50 text-xs",children:[e.jsxs(Q,{variant:"secondary",className:"shrink-0",children:[e.jsx(on,{className:"h-3 w-3 mr-1"}),"Hallazgo"]}),e.jsx("span",{className:"flex-1 text-muted-foreground",children:Y}),e.jsx(B,{size:"sm",variant:"ghost",className:"shrink-0 h-6 text-xs",disabled:F.isPending||!v,onClick:()=>{F.mutate([{chapterNumber:1,instruction:Y,milestoneId:null}])},"data-testid":`button-finding-${oe}`,children:F.isPending?e.jsx(be,{className:"h-3 w-3 animate-spin"}):"Corregir"})]},oe))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 rounded-lg bg-muted/50",children:[e.jsx(Qu,{className:"h-5 w-5 mx-auto mb-2 text-primary"}),e.jsxs("div",{className:"text-xl font-bold",children:[D,"/",S.length]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Hitos Completados"})]}),e.jsxs("div",{className:"text-center p-4 rounded-lg bg-muted/50",children:[e.jsx(kc,{className:"h-5 w-5 mx-auto mb-2 text-primary"}),e.jsxs("div",{className:"text-xl font-bold",children:[I,"/",P.length]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Hilos Resueltos"})]}),e.jsxs("div",{className:"text-center p-4 rounded-lg bg-muted/50",children:[e.jsx(Ko,{className:"h-5 w-5 mx-auto mb-2 text-primary"}),e.jsx("div",{className:"text-xl font-bold",children:re?re.status==="passed"?e.jsx("span",{className:"text-green-600",children:"Verificado"}):e.jsx("span",{className:"text-yellow-600",children:"Pendiente"}):e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Estado del Arco"})]})]}),e.jsxs(vv,{type:"multiple",defaultValue:["milestones"],className:"w-full",children:[e.jsxs(Vo,{value:"milestones",children:[e.jsx(qo,{className:"hover:no-underline",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qu,{className:"h-4 w-4"}),e.jsxs("span",{children:["Hitos del Arco (",S.length,")"]})]})}),e.jsx(Uo,{children:e.jsxs("div",{className:"space-y-3 pt-2",children:[S.map(Y=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg border bg-card",children:[e.jsx(B,{size:"icon",variant:"ghost",className:"shrink-0 mt-1",onClick:()=>W.mutate({id:Y.id,data:{isFulfilled:!Y.isFulfilled}}),"data-testid":`toggle-milestone-${Y.id}`,children:K(Y.isFulfilled)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium",children:Y.description}),e.jsxs(Q,{variant:"outline",children:["Vol. ",Y.volumeNumber]}),e.jsx(Q,{variant:"secondary",children:le(Y.milestoneType)}),Y.isRequired&&e.jsx(Q,{variant:"destructive",children:"Requerido"})]}),Y.verificationNotes&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:Y.verificationNotes})]}),e.jsx(B,{size:"icon",variant:"ghost",onClick:()=>X.mutate(Y.id),"data-testid":`delete-milestone-${Y.id}`,children:e.jsx(Rn,{className:"h-4 w-4"})})]},Y.id)),i?e.jsxs("div",{className:"p-4 rounded-lg border space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(st,{children:"Descripcion"}),e.jsx(gt,{value:p.description,onChange:Y=>m(oe=>({...oe,description:Y.target.value})),placeholder:"Descripcion del hito...","data-testid":"input-milestone-description"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(st,{children:"Volumen"}),e.jsxs(Pt,{value:p.volumeNumber.toString(),onValueChange:Y=>m(oe=>({...oe,volumeNumber:parseInt(Y)})),children:[e.jsx(St,{"data-testid":"select-milestone-volume",children:e.jsx(Tt,{})}),e.jsx(kt,{children:Array.from({length:r},(Y,oe)=>oe+1).map(Y=>e.jsxs(ce,{value:Y.toString(),children:["Volumen ",Y]},Y))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(st,{children:"Tipo"}),e.jsxs(Pt,{value:p.milestoneType,onValueChange:Y=>m(oe=>({...oe,milestoneType:Y})),children:[e.jsx(St,{"data-testid":"select-milestone-type",children:e.jsx(Tt,{})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"plot_point",children:"Punto de Trama"}),e.jsx(ce,{value:"character_development",children:"Desarrollo de Personaje"}),e.jsx(ce,{value:"revelation",children:"Revelacin"}),e.jsx(ce,{value:"conflict",children:"Conflicto"}),e.jsx(ce,{value:"resolution",children:"Resolucin"})]})]})]}),e.jsx("div",{className:"space-y-1 flex items-end",children:e.jsxs("label",{className:"flex items-center gap-2 pb-2",children:[e.jsx("input",{type:"checkbox",checked:p.isRequired,onChange:Y=>m(oe=>({...oe,isRequired:Y.target.checked})),className:"rounded"}),e.jsx("span",{className:"text-sm",children:"Requerido"})]})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(B,{size:"sm",onClick:()=>A.mutate(p),disabled:!p.description||A.isPending,"data-testid":"button-save-milestone",children:[e.jsx(Tn,{className:"h-4 w-4 mr-1"}),"Guardar"]}),e.jsxs(B,{size:"sm",variant:"outline",onClick:()=>o(!1),children:[e.jsx(Gn,{className:"h-4 w-4 mr-1"}),"Cancelar"]})]})]}):e.jsxs(B,{variant:"outline",size:"sm",className:"w-full",onClick:()=>o(!0),"data-testid":"button-add-milestone",children:[e.jsx(Nr,{className:"h-4 w-4 mr-2"}),"Aadir Hito"]})]})})]}),e.jsxs(Vo,{value:"threads",children:[e.jsx(qo,{className:"hover:no-underline",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(kc,{className:"h-4 w-4"}),e.jsxs("span",{children:["Hilos Argumentales (",P.length,")"]})]})}),e.jsx(Uo,{children:e.jsxs("div",{className:"space-y-3 pt-2",children:[P.map(Y=>{const oe=J(Y.status||"active");return e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg border bg-card",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium",children:Y.threadName}),e.jsxs(Q,{variant:"outline",children:["Intro: Vol. ",Y.introducedVolume]}),Y.resolvedVolume&&e.jsxs(Q,{variant:"secondary",children:["Res: Vol. ",Y.resolvedVolume]}),e.jsx(Q,{variant:oe.variant,children:oe.label}),Y.importance==="major"&&e.jsx(Q,{children:"Principal"})]}),Y.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:Y.description})]}),e.jsxs(Pt,{value:Y.status||"active",onValueChange:Ne=>V.mutate({id:Y.id,data:{status:Ne}}),children:[e.jsx(St,{className:"w-32","data-testid":`select-thread-status-${Y.id}`,children:e.jsx(Tt,{})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"active",children:"Activo"}),e.jsx(ce,{value:"developing",children:"Desarrollando"}),e.jsx(ce,{value:"resolved",children:"Resuelto"}),e.jsx(ce,{value:"abandoned",children:"Abandonado"})]})]}),e.jsx(B,{size:"icon",variant:"ghost",onClick:()=>G.mutate(Y.id),"data-testid":`delete-thread-${Y.id}`,children:e.jsx(Rn,{className:"h-4 w-4"})})]},Y.id)}),c?e.jsxs("div",{className:"p-4 rounded-lg border space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(st,{children:"Nombre del Hilo"}),e.jsx(gt,{value:h.threadName,onChange:Y=>g(oe=>({...oe,threadName:Y.target.value})),placeholder:"Nombre del hilo...","data-testid":"input-thread-name"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(st,{children:"Volumen de Introduccion"}),e.jsxs(Pt,{value:h.introducedVolume.toString(),onValueChange:Y=>g(oe=>({...oe,introducedVolume:parseInt(Y)})),children:[e.jsx(St,{"data-testid":"select-thread-volume",children:e.jsx(Tt,{})}),e.jsx(kt,{children:Array.from({length:r},(Y,oe)=>oe+1).map(Y=>e.jsxs(ce,{value:Y.toString(),children:["Volumen ",Y]},Y))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(st,{children:"Importancia"}),e.jsxs(Pt,{value:h.importance,onValueChange:Y=>g(oe=>({...oe,importance:Y})),children:[e.jsx(St,{"data-testid":"select-thread-importance",children:e.jsx(Tt,{})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"major",children:"Principal"}),e.jsx(ce,{value:"minor",children:"Secundario"}),e.jsx(ce,{value:"subplot",children:"Subtrama"})]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(st,{children:"Descripcin"}),e.jsx(gt,{value:h.description,onChange:Y=>g(oe=>({...oe,description:Y.target.value})),placeholder:"Breve descripcin...","data-testid":"input-thread-description"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(B,{size:"sm",onClick:()=>se.mutate(h),disabled:!h.threadName||se.isPending,"data-testid":"button-save-thread",children:[e.jsx(Tn,{className:"h-4 w-4 mr-1"}),"Guardar"]}),e.jsxs(B,{size:"sm",variant:"outline",onClick:()=>d(!1),children:[e.jsx(Gn,{className:"h-4 w-4 mr-1"}),"Cancelar"]})]})]}):e.jsxs(B,{variant:"outline",size:"sm",className:"w-full",onClick:()=>d(!0),"data-testid":"button-add-thread",children:[e.jsx(Nr,{className:"h-4 w-4 mr-2"}),"Aadir Hilo Argumental"]})]})})]}),E.length>0&&e.jsxs(Vo,{value:"verifications",children:[e.jsx(qo,{className:"hover:no-underline",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ko,{className:"h-4 w-4"}),e.jsxs("span",{children:["Historial de Verificaciones (",E.length,")"]})]})}),e.jsx(Uo,{children:e.jsx("div",{className:"space-y-3 pt-2",children:E.map(Y=>e.jsxs("div",{className:"p-3 rounded-lg border bg-card",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[Y.status==="passed"?e.jsx(Us,{className:"h-4 w-4 text-green-500"}):e.jsx(on,{className:"h-4 w-4 text-yellow-500"}),e.jsx("span",{className:"font-medium",children:Y.status==="passed"?"Verificacin Exitosa":"Verificacin con Observaciones"}),e.jsxs(Q,{variant:"outline",children:["Vol. ",Y.volumeNumber]}),e.jsx("span",{className:"text-sm text-muted-foreground ml-auto",children:new Date(Y.verificationDate).toLocaleDateString()})]}),Y.overallScore!==null&&e.jsxs("div",{className:"text-sm text-muted-foreground mb-1",children:["Puntuacin: ",Y.overallScore,"% | Hitos: ",Y.milestonesFulfilled,"/",Y.milestonesChecked," | Hilos resueltos: ",Y.threadsResolved]}),Y.recommendations&&e.jsx("p",{className:"text-sm text-muted-foreground",children:Y.recommendations})]},Y.id))})})]})]})]})}function B8({seriesId:t}){const[n,r]=x.useState(!1),{data:s,isLoading:i}=Ke({queryKey:["/api/series",t,"world-bible"],queryFn:async()=>{const c=await fetch(`/api/series/${t}/world-bible`);if(!c.ok){if(c.status===404)return null;throw new Error("Failed to fetch series world bible")}return c.json()},enabled:n}),o=s&&((s.characters?.length||0)>0||(s.locations?.length||0)>0||(s.lessons?.length||0)>0||(s.worldRules?.length||0)>0||(s.timelineEvents?.length||0)>0||(s.objects?.length||0)>0||(s.secrets?.length||0)>0);return e.jsxs("div",{className:"space-y-3",children:[e.jsxs(B,{variant:"ghost",size:"sm",className:"w-full justify-between",onClick:()=>r(!n),"data-testid":`button-toggle-world-bible-${t}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ya,{className:"h-4 w-4"}),e.jsx("span",{children:"Biblia del Mundo de la Serie"})]}),e.jsx(Qs,{className:`h-4 w-4 transition-transform ${n?"rotate-180":""}`})]}),n&&e.jsx("div",{className:"pl-6 space-y-4",children:i?e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm py-4",children:[e.jsx(be,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Cargando biblia del mundo..."})]}):o?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s?.characters&&s.characters.length>0&&e.jsxs(me,{className:"bg-muted/30",children:[e.jsx(Re,{className:"pb-2",children:e.jsxs(Ie,{className:"text-sm flex items-center gap-2",children:[e.jsx(pl,{className:"h-4 w-4"}),"Personajes (",s.characters.length,")"]})}),e.jsx(he,{className:"text-sm space-y-2",children:s.characters.map((c,d)=>e.jsxs("div",{className:"p-2 bg-background rounded border",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium",children:c.name}),c.role&&e.jsx(Q,{variant:"outline",className:"text-xs",children:c.role})]}),c.current_status&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Estado: ",c.current_status]}),c.arc_summary&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:c.arc_summary})]},d))})]}),s?.locations&&s.locations.length>0&&e.jsxs(me,{className:"bg-muted/30",children:[e.jsx(Re,{className:"pb-2",children:e.jsxs(Ie,{className:"text-sm flex items-center gap-2",children:[e.jsx(AA,{className:"h-4 w-4"}),"Locaciones (",s.locations.length,")"]})}),e.jsx(he,{className:"text-sm space-y-2",children:s.locations.map((c,d)=>e.jsxs("div",{className:"p-2 bg-background rounded border",children:[e.jsx("span",{className:"font-medium",children:c.name}),c.significance&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:c.significance}),c.current_state&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["[",c.current_state,"]"]})]},d))})]}),s?.worldRules&&s.worldRules.length>0&&e.jsxs(me,{className:"bg-muted/30",children:[e.jsx(Re,{className:"pb-2",children:e.jsxs(Ie,{className:"text-sm flex items-center gap-2",children:[e.jsx(Vu,{className:"h-4 w-4"}),"Reglas del Mundo (",s.worldRules.length,")"]})}),e.jsx(he,{className:"text-sm space-y-2",children:s.worldRules.map((c,d)=>e.jsxs("div",{className:"p-2 bg-background rounded border",children:[e.jsx("span",{className:"font-medium",children:c.rule_name||c.name}),c.description&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:c.description})]},d))})]}),s?.timelineEvents&&s.timelineEvents.length>0&&e.jsxs(me,{className:"bg-muted/30",children:[e.jsx(Re,{className:"pb-2",children:e.jsxs(Ie,{className:"text-sm flex items-center gap-2",children:[e.jsx(Cn,{className:"h-4 w-4"}),"Linea Temporal (",s.timelineEvents.length,")"]})}),e.jsx(he,{className:"text-sm space-y-2",children:s.timelineEvents.sort((c,d)=>(c.volume||0)-(d.volume||0)).map((c,d)=>e.jsxs("div",{className:"p-2 bg-background rounded border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Q,{variant:"outline",className:"text-xs",children:["Vol. ",c.volume]}),e.jsx("span",{className:"text-xs",children:c.event})]}),c.consequences&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[" ",c.consequences]})]},d))})]}),s?.objects&&s.objects.length>0&&e.jsxs(me,{className:"bg-muted/30",children:[e.jsx(Re,{className:"pb-2",children:e.jsxs(Ie,{className:"text-sm flex items-center gap-2",children:[e.jsx(MA,{className:"h-4 w-4"}),"Objetos Significativos (",s.objects.length,")"]})}),e.jsx(he,{className:"text-sm space-y-2",children:s.objects.map((c,d)=>e.jsxs("div",{className:"p-2 bg-background rounded border",children:[e.jsx("span",{className:"font-medium",children:c.name}),c.description&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:c.description}),c.current_owner&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Poseedor: ",c.current_owner]})]},d))})]}),s?.secrets&&s.secrets.length>0&&e.jsxs(me,{className:"bg-muted/30",children:[e.jsx(Re,{className:"pb-2",children:e.jsxs(Ie,{className:"text-sm flex items-center gap-2",children:[e.jsx(kA,{className:"h-4 w-4"}),"Secretos (",s.secrets.length,")"]})}),e.jsx(he,{className:"text-sm space-y-2",children:s.secrets.map((c,d)=>e.jsxs("div",{className:"p-2 bg-background rounded border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[c.resolved?e.jsx(fr,{className:"h-3 w-3 text-green-500"}):e.jsx(vA,{className:"h-3 w-3 text-amber-500"}),e.jsx("span",{className:"text-xs",children:c.secret})]}),c.known_by&&c.known_by.length>0&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Conocido por: ",c.known_by.join(", ")]}),c.resolved&&c.resolution&&e.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:["Resolucion: ",c.resolution]})]},d))})]}),s?.lessons&&s.lessons.length>0&&e.jsxs(me,{className:"bg-muted/30 md:col-span-2",children:[e.jsx(Re,{className:"pb-2",children:e.jsxs(Ie,{className:"text-sm flex items-center gap-2",children:[e.jsx(xr,{className:"h-4 w-4"}),"Lecciones y Temas (",s.lessons.length,")"]})}),e.jsx(he,{className:"text-sm",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:s.lessons.map((c,d)=>e.jsxs(Q,{variant:"secondary",className:"text-xs",children:[c.theme||c.title,c.volume_learned&&` (Vol. ${c.volume_learned})`]},d))})})]})]}):e.jsxs("div",{className:"text-sm text-muted-foreground/60 py-4 text-center bg-muted/30 rounded-md",children:["No hay informacion acumulada todavia.",e.jsx("br",{}),"Se extraera automaticamente al completar volumenes."]})})]})}function G8(){const{toast:t}=nn(),[n,r]=x.useState(!1),[s,i]=x.useState(""),[o,c]=x.useState("trilogy"),[d,p]=x.useState(3),[m,h]=x.useState(null),[g,v]=x.useState(null),[j,N]=x.useState(""),[b,C]=x.useState(""),[S,k]=x.useState("trilogy"),[P,R]=x.useState(3),[E,A]=x.useState(null),W=x.useRef(null),X=x.useRef(null),[se,V]=x.useState(null),[G,O]=x.useState(""),[F,U]=x.useState(""),[$,q]=x.useState("manuscript"),[le,K]=x.useState(1),[J,D]=x.useState(null),I=x.useRef(null),re=x.useRef(null),[T,Y]=x.useState(null),[oe,Ne]=x.useState(null),[xe,Se]=x.useState(null),[Oe,Pe]=x.useState(""),{data:Be=[],isLoading:ve}=Ke({queryKey:["/api/series/registry"]}),{data:We=[]}=Ke({queryKey:["/api/pseudonyms"]}),{data:Ye=[]}=Ke({queryKey:["/api/imported-manuscripts"]}),{data:Qe=[]}=Ke({queryKey:["/api/projects"]}),mt=ye({mutationFn:async te=>{const Ee=await je("POST","/api/series",te);if(!Ee.ok){const H=await Ee.json().catch(()=>({}));throw new Error(H.details||H.error||"Error desconocido")}return Ee.json()},onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/series/registry"]}),ae.invalidateQueries({queryKey:["/api/series"]}),r(!1),i(""),c("trilogy"),p(3),t({title:"Serie creada",description:"La nueva serie ha sido aadida"})},onError:te=>{console.error("[Series] Create error:",te),t({title:"Error",description:te?.message||"No se pudo crear la serie",variant:"destructive"})}}),ht=ye({mutationFn:async({id:te,data:Ee})=>(await je("PATCH",`/api/series/${te}`,Ee)).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/series/registry"]}),ae.invalidateQueries({queryKey:["/api/series"]}),v(null),t({title:"Serie actualizada"})},onError:()=>{t({title:"Error",description:"No se pudo actualizar la serie",variant:"destructive"})}}),cn=ye({mutationFn:async te=>{await je("DELETE",`/api/series/${te}`)},onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/series/registry"]}),ae.invalidateQueries({queryKey:["/api/series"]}),t({title:"Serie eliminada"})},onError:()=>{t({title:"Error",description:"No se pudo eliminar la serie",variant:"destructive"})}}),Jt=ye({mutationFn:async({seriesId:te,file:Ee})=>{const H=new FormData;H.append("file",Ee);const Nt=await fetch(`/api/series/${te}/guide`,{method:"POST",body:H,credentials:"include"});if(!Nt.ok)throw new Error("Upload failed");return Nt.json()},onSuccess:te=>{ae.invalidateQueries({queryKey:["/api/series/registry"]}),ae.invalidateQueries({queryKey:["/api/series"]}),t({title:"Guia de serie cargada",description:`Se han cargado ${te.wordCount?.toLocaleString()||0} palabras de la guia`}),A(null),W.current=null,X.current&&(X.current.value="")},onError:()=>{t({title:"Error",description:"No se pudo subir la guia de serie",variant:"destructive"}),W.current=null,X.current&&(X.current.value="")}}),Vt=ye({mutationFn:async te=>{await je("DELETE",`/api/series/${te}/guide`)},onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/series/registry"]}),ae.invalidateQueries({queryKey:["/api/series"]}),t({title:"Guia eliminada"})},onError:()=>{t({title:"Error",description:"No se pudo eliminar la guia",variant:"destructive"})}}),tt=ye({mutationFn:async({seriesId:te,content:Ee})=>{await je("PATCH",`/api/series/${te}/guide`,{content:Ee})},onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/series/registry"]}),ae.invalidateQueries({queryKey:["/api/series"]}),Se(null),Pe(""),t({title:"Gua actualizada"})},onError:()=>{t({title:"Error",description:"No se pudo actualizar la gua",variant:"destructive"})}}),[L,de]=x.useState(null),ge=ye({mutationFn:async te=>(de(te),(await je("POST",`/api/series/${te}/guide/extract`)).json()),onSuccess:(te,Ee)=>{de(null),ae.invalidateQueries({queryKey:["/api/series/registry"]}),ae.invalidateQueries({queryKey:[`/api/series/${Ee}/milestones`]}),ae.invalidateQueries({queryKey:[`/api/series/${Ee}/threads`]}),t({title:"Extraccion completada",description:`${te.milestonesCreated} hitos y ${te.threadsCreated} hilos extraidos`})},onError:async te=>{de(null);let Ee="Error desconocido";try{if(te?.response){const H=await te.response.json();Ee=H.details||H.error||"Error desconocido"}else te?.message&&(Ee=te.message)}catch{}t({title:"Error",description:Ee,variant:"destructive"})}}),ze=ye({mutationFn:async({seriesId:te,manuscriptId:Ee,seriesOrder:H})=>(await je("POST",`/api/series/${te}/link-manuscript`,{manuscriptId:Ee,seriesOrder:H})).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/series/registry"]}),ae.invalidateQueries({queryKey:["/api/imported-manuscripts"]}),V(null),O(""),K(1),t({title:"Volumen vinculado",description:"El manuscrito ha sido aadido a la serie"})},onError:async te=>{let Ee="No se pudo vincular el manuscrito";try{te?.response&&(Ee=(await te.response.json()).error||Ee)}catch{}t({title:"Error",description:Ee,variant:"destructive"})}}),M=ye({mutationFn:async({seriesId:te,projectId:Ee,seriesOrder:H})=>(await je("POST",`/api/series/${te}/link-project`,{projectId:Ee,seriesOrder:H})).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/series/registry"]}),ae.invalidateQueries({queryKey:["/api/projects"]}),V(null),U(""),K(1),t({title:"Proyecto vinculado",description:"El proyecto ha sido aadido a la serie"})},onError:async te=>{let Ee="No se pudo vincular el proyecto";try{te?.response&&(Ee=(await te.response.json()).error||Ee)}catch{}t({title:"Error",description:Ee,variant:"destructive"})}}),ie=ye({mutationFn:async({seriesId:te,file:Ee})=>{const H=new FormData;H.append("file",Ee);const Nt=await fetch(`/api/series/${te}/upload-volume`,{method:"POST",body:H,credentials:"include"});if(!Nt.ok){const zn=await Nt.json().catch(()=>({}));throw new Error(zn.error||"Upload failed")}return Nt.json()},onSuccess:te=>{ae.invalidateQueries({queryKey:["/api/series/registry"]}),ae.invalidateQueries({queryKey:["/api/imported-manuscripts"]}),t({title:"Volumen subido",description:`"${te.manuscript?.title||"Volumen"}" aadido como Vol. ${te.manuscript?.seriesOrder||"?"}`}),D(null),I.current=null,re.current&&(re.current.value="")},onError:te=>{t({title:"Error",description:te?.message||"No se pudo subir el volumen",variant:"destructive"}),I.current=null,re.current&&(re.current.value="")}}),[we,qe]=x.useState(null),Ze=ye({mutationFn:async te=>(qe(te),(await je("POST",`/api/imported-manuscripts/${te}/analyze-continuity`,{})).json()),onSuccess:te=>{qe(null),ae.invalidateQueries({queryKey:["/api/series/registry"]}),ae.invalidateQueries({queryKey:["/api/imported-manuscripts"]}),t({title:"Anlisis completado",description:`Se han extrado ${te.snapshot?.characterStates?.length||0} personajes y ${te.snapshot?.unresolvedThreads?.length||0} hilos narrativos`})},onError:async te=>{qe(null);let Ee="No se pudo analizar el manuscrito";try{const H=String(te?.message||te||"");if(H.includes(":")){const Nt=H.substring(H.indexOf(":")+1).trim();try{Ee=JSON.parse(Nt).error||Ee}catch{Nt.length>10&&(Ee=Nt.substring(0,200))}}}catch{}Ee.includes("cancelled")||t({title:"Error",description:Ee,variant:"destructive"})}}),Rt=ye({mutationFn:async te=>(await je("POST",`/api/imported-manuscripts/${te}/cancel-analysis`,{})).json(),onSuccess:()=>{qe(null),ae.invalidateQueries({queryKey:["/api/series/registry"]}),ae.invalidateQueries({queryKey:["/api/imported-manuscripts"]}),t({title:"Anlisis cancelado"})},onError:()=>{t({title:"Error",description:"No se pudo cancelar el anlisis",variant:"destructive"})}}),en=()=>{if(se)if($==="manuscript"){if(!G)return;ze.mutate({seriesId:se,manuscriptId:parseInt(G),seriesOrder:le})}else{if(!F)return;M.mutate({seriesId:se,projectId:parseInt(F),seriesOrder:le})}},Lt=async te=>{V(te),O(""),U(""),q("manuscript");try{const Ee=await fetch(`/api/series/${te}/volumes`,{credentials:"include"});if(Ee.ok){const H=await Ee.json();K(H.nextOrder||1)}else K(1)}catch{K(1)}},An=Ye.filter(te=>!te.seriesId),Hn=Qe.filter(te=>!te.seriesId),tn=()=>{s.trim()&&mt.mutate({title:s,workType:o,totalPlannedBooks:d})},Sn=(te,Ee)=>{ht.mutate({id:te,data:{pseudonymId:Ee==="none"?null:parseInt(Ee)}})},hn=te=>{v(te.id),N(te.title),C(te.description||""),k(te.workType),R(te.totalPlannedBooks||3)},Jr=()=>{v(null),N(""),C(""),k("trilogy"),R(3)},Ts=()=>{!g||!j.trim()||ht.mutate({id:g,data:{title:j,description:b||null,workType:S,totalPlannedBooks:P}})},ir=te=>{const Ee=te.target.files?.[0],H=W.current;if(!(!Ee||!H)){if(!Ee.name.endsWith(".docx")){t({title:"Formato no soportado",description:"Por favor sube un archivo .docx (Word)",variant:"destructive"}),X.current&&(X.current.value="");return}Jt.mutate({seriesId:H,file:Ee})}},$r=te=>{const Ee=te.target.files?.[0],H=I.current;if(!(!Ee||!H)){if(!Ee.name.endsWith(".docx")){t({title:"Formato no soportado",description:"Por favor sube un archivo .docx (Word)",variant:"destructive"}),re.current&&(re.current.value="");return}ie.mutate({seriesId:H,file:Ee})}},ba={idle:"Pendiente",generating:"En curso",completed:"Completado"},Rs={idle:"bg-muted text-muted-foreground",generating:"bg-chart-2/20 text-chart-2",completed:"bg-green-500/20 text-green-600 dark:text-green-400"};return ve?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(be,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"p-6 space-y-6","data-testid":"series-page",children:[e.jsx("input",{type:"file",ref:X,onChange:ir,accept:".docx",className:"hidden","data-testid":"input-series-guide-upload"}),e.jsx("input",{type:"file",ref:re,onChange:$r,accept:".docx",className:"hidden","data-testid":"input-volume-upload"}),e.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Registro de Series"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Gestiona tus series y trilogias con sus volumenes asignados"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(B,{variant:"outline",onClick:()=>iP(E8,"guia-escritura-serie.txt"),"data-testid":"button-download-series-guide",children:[e.jsx(xn,{className:"h-4 w-4 mr-2"}),"Gua de Escritura"]}),e.jsxs(B,{onClick:()=>r(!0),"data-testid":"button-create-series",children:[e.jsx(Nr,{className:"h-4 w-4 mr-2"}),"Nueva Serie"]})]})]}),n&&e.jsxs(me,{children:[e.jsx(Re,{children:e.jsx(Ie,{children:"Crear Nueva Serie"})}),e.jsxs(he,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{children:"Titulo de la Serie"}),e.jsx(gt,{value:s,onChange:te=>i(te.target.value),placeholder:"Nombre de la saga...","data-testid":"input-series-title"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{children:"Tipo"}),e.jsxs(Pt,{value:o,onValueChange:te=>c(te),children:[e.jsx(St,{"data-testid":"select-work-type",children:e.jsx(Tt,{})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"trilogy",children:"Trilogia"}),e.jsx(ce,{value:"series",children:"Serie"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{children:"Libros Planificados"}),e.jsx(gt,{type:"number",min:2,max:20,value:d,onChange:te=>p(parseInt(te.target.value)||3),"data-testid":"input-total-books"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(B,{onClick:tn,disabled:mt.isPending,children:[mt.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Tn,{className:"h-4 w-4 mr-2"}),"Crear"]}),e.jsx(B,{variant:"outline",onClick:()=>r(!1),children:"Cancelar"})]})]})]}),Be.length===0&&!n?e.jsx(me,{children:e.jsxs(he,{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(pa,{className:"h-16 w-16 text-muted-foreground/30 mb-4"}),e.jsx("p",{className:"text-muted-foreground text-lg mb-2",children:"No hay series registradas"}),e.jsx("p",{className:"text-muted-foreground/60 text-sm",children:"Crea una serie o trilogia para organizar tus volumenes"})]})}):e.jsx(vv,{type:"multiple",className:"space-y-2",children:Be.map(te=>e.jsxs(Vo,{value:te.id.toString(),className:"border rounded-lg bg-card","data-testid":`accordion-series-${te.id}`,children:[e.jsx(qo,{className:"px-4 py-3 hover:no-underline",children:e.jsxs("div",{className:"flex items-center gap-3 flex-wrap flex-1 text-left",children:[e.jsx("span",{className:"font-semibold text-lg",children:te.title}),e.jsx(Q,{variant:"outline",children:te.workType==="trilogy"?"Trilogia":"Serie"}),e.jsxs(Q,{variant:"secondary",children:[te.completedVolumes,"/",te.totalPlannedBooks," vol."]}),te.seriesGuide&&e.jsxs(Q,{variant:"outline",className:"text-green-600 dark:text-green-400",children:[e.jsx(yt,{className:"h-3 w-3 mr-1"}),"Guia"]}),te.pseudonym&&e.jsxs(Q,{variant:"outline",children:[e.jsx(ri,{className:"h-3 w-3 mr-1"}),te.pseudonym.name]})]})}),e.jsxs(Uo,{className:"px-4 pb-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 flex-wrap mb-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:g===te.id?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{children:"Titulo"}),e.jsx(gt,{value:j,onChange:Ee=>N(Ee.target.value),"data-testid":`input-edit-title-${te.id}`})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{children:"Tipo"}),e.jsxs(Pt,{value:S,onValueChange:Ee=>k(Ee),children:[e.jsx(St,{"data-testid":`select-edit-type-${te.id}`,children:e.jsx(Tt,{})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"trilogy",children:"Trilogia"}),e.jsx(ce,{value:"series",children:"Serie"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{children:"Descripcion"}),e.jsx(Nn,{value:b,onChange:Ee=>C(Ee.target.value),placeholder:"Descripcion de la serie...",rows:3,"data-testid":`input-edit-description-${te.id}`})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{children:"Libros Planificados"}),e.jsx(gt,{type:"number",min:2,max:20,value:P,onChange:Ee=>R(parseInt(Ee.target.value)||3),"data-testid":`input-edit-books-${te.id}`})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(B,{onClick:Ts,disabled:ht.isPending,size:"sm",children:[ht.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Tn,{className:"h-4 w-4 mr-2"}),"Guardar"]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:Jr,children:[e.jsx(Gn,{className:"h-4 w-4 mr-2"}),"Cancelar"]})]})]}):e.jsx("p",{className:"text-sm text-muted-foreground",children:te.description||"Sin descripcion"})}),g!==te.id&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>hn(te),"data-testid":`button-edit-series-${te.id}`,children:e.jsx(ar,{className:"h-4 w-4"})}),e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>h(te.id),"data-testid":`button-delete-series-${te.id}`,children:e.jsx(Rn,{className:"h-4 w-4 text-destructive"})})]})]}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ri,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Seudonimo:"})]}),e.jsxs(Pt,{value:te.pseudonymId?.toString()||"none",onValueChange:Ee=>Sn(te.id,Ee),children:[e.jsx(St,{className:"w-48","data-testid":`select-pseudonym-${te.id}`,children:e.jsx(Tt,{placeholder:"Sin asignar"})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"none",children:"Sin asignar"}),We.map(Ee=>e.jsx(ce,{value:Ee.id.toString(),children:Ee.name},Ee.id))]})]}),te.pseudonym&&e.jsxs(Q,{variant:"secondary",children:[e.jsx(ri,{className:"h-3 w-3 mr-1"}),te.pseudonym.name]})]}),e.jsx(Mo,{}),e.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(yt,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Guia de Serie:"}),te.seriesGuideFileName&&e.jsx("span",{className:"text-xs text-muted-foreground/60",children:te.seriesGuideFileName})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>{W.current=te.id,A(te.id),X.current?.click()},disabled:Jt.isPending,"data-testid":`button-upload-guide-${te.id}`,children:[Jt.isPending&&E===te.id?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(ha,{className:"h-4 w-4 mr-2"}),te.seriesGuide?"Reemplazar":"Subir"," Guia"]}),te.seriesGuide&&e.jsxs(e.Fragment,{children:[e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>Ne(te),"data-testid":`button-view-guide-${te.id}`,children:[e.jsx(fr,{className:"h-4 w-4 mr-2"}),"Ver"]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>{Se(te),Pe(te.seriesGuide||"")},"data-testid":`button-edit-guide-${te.id}`,children:[e.jsx(ar,{className:"h-4 w-4 mr-2"}),"Editar"]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>ge.mutate(te.id),disabled:ge.isPending&&L===te.id,"data-testid":`button-extract-milestones-${te.id}`,children:[ge.isPending&&L===te.id?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(xr,{className:"h-4 w-4 mr-2"}),"Extraer Hitos"]}),e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>Vt.mutate(te.id),disabled:Vt.isPending,"data-testid":`button-delete-guide-${te.id}`,children:e.jsx(Rn,{className:"h-4 w-4 text-destructive"})})]})]})]}),e.jsx(Mo,{}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(mn,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Volumenes"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>{I.current=te.id,D(te.id),re.current?.click()},disabled:ie.isPending,"data-testid":`button-upload-volume-${te.id}`,children:[ie.isPending&&J===te.id?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(ha,{className:"h-4 w-4 mr-2"}),"Subir Volumen"]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>Lt(te.id),disabled:An.length===0,"data-testid":`button-link-manuscript-${te.id}`,children:[e.jsx(B0,{className:"h-4 w-4 mr-2"}),"Vincular Existente"]})]})]}),!te.volumes||te.volumes.length===0?e.jsxs("div",{className:"text-sm text-muted-foreground/60 py-4 text-center bg-muted/30 rounded-md",children:["No hay volumenes en esta serie todavia.",e.jsx("br",{}),"Vincula un manuscrito importado o crea un nuevo proyecto."]}):e.jsx("div",{className:"space-y-2",children:te.volumes.map(Ee=>e.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 rounded-md bg-muted/50","data-testid":`volume-item-${Ee.type}-${Ee.id}`,children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsxs(Q,{variant:"outline",className:"shrink-0",children:["Vol. ",Ee.seriesOrder||"?"]}),e.jsx("span",{className:"font-medium truncate",children:Ee.title}),Ee.type==="imported"&&e.jsxs(Q,{variant:"secondary",className:"shrink-0",children:[e.jsx(yt,{className:"h-3 w-3 mr-1"}),"Importado"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[Ee.type==="project"?e.jsx(Q,{className:Rs[Ee.status]||"",children:ba[Ee.status]||Ee.status}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{variant:"outline",className:"text-green-600 dark:text-green-400",children:"Completado"}),Ee.hasContinuitySnapshot?e.jsxs(Q,{variant:"secondary",className:"text-blue-600 dark:text-blue-400 cursor-pointer hover-elevate",onClick:()=>Y(Ee),"data-testid":`badge-view-snapshot-${Ee.id}`,children:[e.jsx(Tn,{className:"h-3 w-3 mr-1"}),"Ver Hilos"]}):Ee.continuityAnalysisStatus==="analyzing"||we===Ee.id?e.jsxs(B,{variant:"ghost",size:"sm",onClick:()=>Rt.mutate(Ee.id),disabled:Rt.isPending,"data-testid":`button-cancel-analysis-${Ee.id}`,children:[e.jsx(be,{className:"h-3 w-3 mr-1 animate-spin"}),"Cancelar"]}):e.jsxs(B,{variant:"ghost",size:"sm",onClick:()=>Ze.mutate(Ee.id),disabled:Ze.isPending,"data-testid":`button-analyze-continuity-${Ee.id}`,children:[e.jsx(xr,{className:"h-3 w-3 mr-1"}),"Extraer Hilos"]})]}),Ee.wordCount>0&&e.jsxs(Q,{variant:"secondary",children:[Ee.wordCount.toLocaleString()," palabras"]})]})]},`${Ee.type}-${Ee.id}`))})]}),e.jsx(Mo,{}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Qu,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Verificacin de Arco Argumental"})]}),e.jsx(U8,{seriesId:te.id,seriesTitle:te.title,totalVolumes:te.totalPlannedBooks||0})]}),e.jsx(Mo,{}),e.jsx("div",{children:e.jsx(B8,{seriesId:te.id})})]})]})]},te.id))}),e.jsx(Vs,{open:m!==null,onOpenChange:te=>!te&&h(null),title:"Eliminar Serie",description:"Esta accion eliminara la serie pero mantendra los proyectos asociados como obras independientes.",confirmText:"Eliminar",onConfirm:()=>{m&&(cn.mutate(m),h(null))}}),e.jsx(Pn,{open:se!==null,onOpenChange:te=>!te&&V(null),children:e.jsxs(yn,{className:"sm:max-w-md",children:[e.jsx(jn,{children:e.jsx(bn,{children:"Vincular Volumen Existente"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{children:"Tipo de Volumen"}),e.jsxs(Pt,{value:$,onValueChange:te=>{q(te),O(""),U("")},children:[e.jsx(St,{"data-testid":"select-link-type",children:e.jsx(Tt,{})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"manuscript",children:"Manuscrito Importado"}),e.jsx(ce,{value:"project",children:"Proyecto Generado"})]})]})]}),$==="manuscript"?e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{children:"Manuscrito Importado"}),e.jsxs(Pt,{value:G,onValueChange:O,children:[e.jsx(St,{"data-testid":"select-link-manuscript",children:e.jsx(Tt,{placeholder:"Seleccionar manuscrito..."})}),e.jsx(kt,{children:An.map(te=>e.jsxs(ce,{value:te.id.toString(),children:[te.title," (",te.totalChapters," caps.)"]},te.id))})]}),An.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:'No hay manuscritos disponibles. Importa un manuscrito primero desde la seccion "Edicion".'})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{children:"Proyecto Generado"}),e.jsxs(Pt,{value:F,onValueChange:U,children:[e.jsx(St,{"data-testid":"select-link-project",children:e.jsx(Tt,{placeholder:"Seleccionar proyecto..."})}),e.jsx(kt,{children:Hn.map(te=>e.jsxs(ce,{value:te.id.toString(),children:[te.title," (",te.status,")"]},te.id))})]}),Hn.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"No hay proyectos disponibles para vincular."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{children:"Numero de Volumen"}),e.jsx(gt,{type:"number",min:1,max:20,value:le,onChange:te=>K(parseInt(te.target.value)||1),"data-testid":"input-link-series-order"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Este numero indica la posicion del libro en la serie."})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(B,{onClick:en,disabled:($==="manuscript"?!G:!F)||ze.isPending||M.isPending,"data-testid":"button-confirm-link",children:[ze.isPending||M.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(B0,{className:"h-4 w-4 mr-2"}),"Vincular"]}),e.jsx(B,{variant:"outline",onClick:()=>V(null),children:"Cancelar"})]})]})]})}),e.jsx(Pn,{open:T!==null,onOpenChange:te=>!te&&Y(null),children:e.jsxs(yn,{className:"sm:max-w-3xl max-h-[85vh] flex flex-col",children:[e.jsxs(jn,{children:[e.jsxs(bn,{className:"flex items-center gap-2",children:[e.jsx(kc,{className:"h-5 w-5"}),"Hilos Narrativos: ",T?.title]}),e.jsxs($n,{children:["Informacion de continuidad extraida del Vol. ",T?.seriesOrder]})]}),e.jsx(jt,{className:"flex-1 pr-4",children:T?.continuitySnapshot?e.jsxs("div",{className:"space-y-6",children:[T.continuitySnapshot.synopsis&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx(mn,{className:"h-4 w-4"}),"Sinopsis"]}),e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:T.continuitySnapshot.synopsis})]}),T.continuitySnapshot.unresolvedThreads&&T.continuitySnapshot.unresolvedThreads.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx(on,{className:"h-4 w-4 text-amber-500"}),"Hilos No Resueltos (",T.continuitySnapshot.unresolvedThreads.length,")"]}),e.jsx("div",{className:"space-y-2",children:T.continuitySnapshot.unresolvedThreads.map((te,Ee)=>e.jsxs("div",{className:"p-3 rounded-md bg-muted/50 border-l-2 border-amber-500",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("p",{className:"text-sm",children:te.description}),e.jsx(Q,{variant:te.severity==="critical"?"destructive":te.severity==="major"?"secondary":"outline",className:"shrink-0",children:te.severity==="critical"?"Critico":te.severity==="major"?"Mayor":"Menor"})]}),te.involvedCharacters&&te.involvedCharacters.length>0&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Personajes: ",te.involvedCharacters.join(", ")]})]},Ee))})]}),T.continuitySnapshot.keyEvents&&T.continuitySnapshot.keyEvents.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx(_A,{className:"h-4 w-4 text-blue-500"}),"Eventos Clave (",T.continuitySnapshot.keyEvents.length,")"]}),e.jsx("div",{className:"space-y-2",children:T.continuitySnapshot.keyEvents.map((te,Ee)=>e.jsxs("div",{className:"p-3 rounded-md bg-muted/50 border-l-2 border-blue-500",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("p",{className:"text-sm",children:te.description}),e.jsxs(Q,{variant:"outline",className:"shrink-0",children:["Cap. ",te.chapter]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Impacto: ",te.impact]})]},Ee))})]}),T.continuitySnapshot.seriesHooks&&T.continuitySnapshot.seriesHooks.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx(dA,{className:"h-4 w-4 text-purple-500"}),"Ganchos de Serie (",T.continuitySnapshot.seriesHooks.length,")"]}),e.jsx("div",{className:"space-y-2",children:T.continuitySnapshot.seriesHooks.map((te,Ee)=>e.jsxs("div",{className:"p-3 rounded-md bg-muted/50 border-l-2 border-purple-500",children:[e.jsx("p",{className:"text-sm",children:te.description}),te.potentialResolution&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Posible resolucion: ",te.potentialResolution]})]},Ee))})]}),T.continuitySnapshot.characterStates&&T.continuitySnapshot.characterStates.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx(pl,{className:"h-4 w-4 text-green-500"}),"Estado de Personajes (",T.continuitySnapshot.characterStates.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:T.continuitySnapshot.characterStates.map((te,Ee)=>e.jsxs("div",{className:"p-3 rounded-md bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium text-sm",children:te.name}),e.jsx(Q,{variant:"outline",className:"text-xs",children:te.role})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:te.status}),te.lastKnownLocation&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Ubicacion: ",te.lastKnownLocation]})]},Ee))})]}),T.continuitySnapshot.worldStateChanges&&T.continuitySnapshot.worldStateChanges.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Cambios en el Mundo"}),e.jsx("div",{className:"space-y-1",children:T.continuitySnapshot.worldStateChanges.map((te,Ee)=>e.jsxs("div",{className:"text-sm text-muted-foreground flex items-start gap-2",children:[e.jsx("span",{className:"text-xs mt-1",children:"-"}),e.jsx("span",{children:te.description})]},Ee))})]})]}):e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No hay informacion de continuidad disponible"})})]})}),e.jsx(Pn,{open:!!oe,onOpenChange:te=>!te&&Ne(null),children:e.jsxs(yn,{className:"max-w-4xl max-h-[85vh]",children:[e.jsxs(jn,{children:[e.jsxs(bn,{className:"flex items-center gap-2",children:[e.jsx(yt,{className:"h-5 w-5"}),"Gua de Serie: ",oe?.title]}),e.jsx($n,{children:"Contenido de la gua de serie"})]}),e.jsx(jt,{className:"max-h-[65vh] pr-4",children:e.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none",children:e.jsx(Iv,{children:oe?.seriesGuide||""})})})]})}),e.jsx(Pn,{open:!!xe,onOpenChange:te=>{te||(Se(null),Pe(""))},children:e.jsxs(yn,{className:"max-w-4xl max-h-[85vh]",children:[e.jsxs(jn,{children:[e.jsxs(bn,{className:"flex items-center gap-2",children:[e.jsx(ar,{className:"h-5 w-5"}),"Editar Gua: ",xe?.title]}),e.jsx($n,{children:"Modifica el contenido de la gua de serie"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Nn,{value:Oe,onChange:te=>Pe(te.target.value),className:"min-h-[50vh] font-mono text-sm",placeholder:"Contenido de la gua en formato Markdown...","data-testid":"textarea-edit-series-guide"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(B,{variant:"outline",onClick:()=>{Se(null),Pe("")},"data-testid":"button-cancel-edit-guide",children:"Cancelar"}),e.jsxs(B,{onClick:()=>{xe&&tt.mutate({seriesId:xe.id,content:Oe})},disabled:tt.isPending,"data-testid":"button-save-series-guide",children:[tt.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Tn,{className:"h-4 w-4 mr-2"}),"Guardar Cambios"]})]})]})]})})]})}function H8(){const{toast:t}=nn(),[n,r]=x.useState(""),{data:s,isLoading:i}=Ke({queryKey:["/api/queue/state"],refetchInterval:3e3}),{data:o=[],isLoading:c}=Ke({queryKey:["/api/queue"],refetchInterval:3e3}),{data:d=[]}=Ke({queryKey:["/api/projects"]}),p=d.filter(V=>V.status!=="completed"&&!o.some(G=>G.projectId===V.id)),m=ye({mutationFn:()=>je("POST","/api/queue/start"),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/queue/state"]}),t({title:"Cola iniciada",description:"El procesamiento autnomo ha comenzado"})},onError:()=>t({variant:"destructive",title:"Error",description:"No se pudo iniciar la cola"})}),h=ye({mutationFn:()=>je("POST","/api/queue/stop"),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/queue/state"]}),t({title:"Cola detenida"})}}),g=ye({mutationFn:()=>je("POST","/api/queue/pause"),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/queue/state"]}),t({title:"Cola pausada"})}}),v=ye({mutationFn:()=>je("POST","/api/queue/resume"),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/queue/state"]}),t({title:"Cola reanudada"})}}),j=ye({mutationFn:()=>je("POST","/api/queue/skip-current"),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/queue"]}),ae.invalidateQueries({queryKey:["/api/queue/state"]}),t({title:"Proyecto saltado"})}}),N=ye({mutationFn:V=>je("POST","/api/queue",V),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/queue"]}),r(""),t({title:"Proyecto aadido a la cola"})},onError:()=>t({variant:"destructive",title:"Error",description:"No se pudo aadir a la cola"})}),b=ye({mutationFn:V=>je("DELETE",`/api/queue/${V}`),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/queue"]}),t({title:"Proyecto eliminado de la cola"})}}),C=ye({mutationFn:({id:V,newPosition:G})=>je("PATCH",`/api/queue/${V}/reorder`,{newPosition:G}),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/queue"]})}}),S=ye({mutationFn:V=>je("POST",`/api/queue/${V}/urgent`),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/queue"]}),t({title:"Proyecto marcado como urgente"})}}),k=ye({mutationFn:V=>je("PATCH","/api/queue/state",V),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/queue/state"]})}}),P=V=>{switch(V){case"waiting":return e.jsxs(Q,{variant:"outline",children:[e.jsx(Cn,{className:"h-3 w-3 mr-1"}),"En espera"]});case"processing":return e.jsxs(Q,{variant:"default",children:[e.jsx(be,{className:"h-3 w-3 mr-1 animate-spin"}),"Procesando"]});case"completed":return e.jsxs(Q,{variant:"secondary",children:[e.jsx(Us,{className:"h-3 w-3 mr-1"}),"Completado"]});case"failed":return e.jsxs(Q,{variant:"destructive",children:[e.jsx(Hs,{className:"h-3 w-3 mr-1"}),"Fallido"]});case"skipped":return e.jsxs(Q,{variant:"outline",children:[e.jsx(G0,{className:"h-3 w-3 mr-1"}),"Saltado"]});default:return e.jsx(Q,{variant:"outline",children:V})}},R=V=>{switch(V){case"urgent":return e.jsxs(Q,{variant:"destructive",children:[e.jsx(us,{className:"h-3 w-3 mr-1"}),"Urgente"]});case"high":return e.jsxs(Q,{children:[e.jsx(on,{className:"h-3 w-3 mr-1"}),"Alta"]});default:return null}},E=()=>{n&&N.mutate({projectId:parseInt(n),priority:"normal"})},A=V=>{V.position>1&&C.mutate({id:V.id,newPosition:V.position-1})},W=V=>{const G=Math.max(...o.map(O=>O.position));V.position<G&&C.mutate({id:V.id,newPosition:V.position+1})};if(i||c)return e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(be,{className:"h-8 w-8 animate-spin text-muted-foreground"})});const X=o.filter(V=>V.status==="waiting"||V.status==="processing"),se=o.filter(V=>V.status==="completed"||V.status==="failed"||V.status==="skipped");return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(n1,{className:"h-6 w-6"}),"Cola de Proyectos"]}),e.jsx("p",{className:"text-muted-foreground",children:"Gestin autnoma de generacin de novelas"})]}),e.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:s?.status==="stopped"?e.jsxs(B,{onClick:()=>m.mutate(),disabled:m.isPending||X.length===0,"data-testid":"button-start-queue",children:[e.jsx(Yn,{className:"h-4 w-4 mr-2"}),"Iniciar Cola"]}):s?.status==="paused"?e.jsxs(e.Fragment,{children:[e.jsxs(B,{onClick:()=>v.mutate(),disabled:v.isPending,"data-testid":"button-resume-queue",children:[e.jsx(Yn,{className:"h-4 w-4 mr-2"}),"Reanudar"]}),e.jsxs(B,{variant:"outline",onClick:()=>h.mutate(),disabled:h.isPending,"data-testid":"button-stop-queue",children:[e.jsx(Ku,{className:"h-4 w-4 mr-2"}),"Detener"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(B,{variant:"outline",onClick:()=>g.mutate(),disabled:g.isPending,"data-testid":"button-pause-queue",children:[e.jsx(ox,{className:"h-4 w-4 mr-2"}),"Pausar"]}),e.jsxs(B,{variant:"outline",onClick:()=>h.mutate(),disabled:h.isPending,"data-testid":"button-stop-queue",children:[e.jsx(Ku,{className:"h-4 w-4 mr-2"}),"Detener"]}),s?.currentProjectId&&e.jsxs(B,{variant:"outline",onClick:()=>j.mutate(),disabled:j.isPending,"data-testid":"button-skip-current",children:[e.jsx(G0,{className:"h-4 w-4 mr-2"}),"Saltar Actual"]})]})})]}),e.jsxs(me,{children:[e.jsx(Re,{children:e.jsx(Ie,{className:"text-lg",children:"Estado de la Cola"})}),e.jsxs(he,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 rounded-lg bg-muted/50",children:[e.jsx("div",{className:"text-2xl font-bold",children:X.length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"En espera"})]}),e.jsxs("div",{className:"text-center p-4 rounded-lg bg-muted/50",children:[e.jsx("div",{className:"text-2xl font-bold",children:o.filter(V=>V.status==="processing").length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Procesando"})]}),e.jsxs("div",{className:"text-center p-4 rounded-lg bg-muted/50",children:[e.jsx("div",{className:"text-2xl font-bold",children:o.filter(V=>V.status==="completed").length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Completados"})]}),e.jsxs("div",{className:"text-center p-4 rounded-lg bg-muted/50",children:[e.jsx("div",{className:"text-2xl font-bold capitalize",children:s?.status==="running"?e.jsx("span",{className:"text-green-600 dark:text-green-400",children:"Activa"}):s?.status==="paused"?e.jsx("span",{className:"text-yellow-600 dark:text-yellow-400",children:"Pausada"}):e.jsx("span",{className:"text-muted-foreground",children:"Detenida"})}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Estado"})]})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-4 flex-wrap",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s?.autoAdvance??!0,onChange:V=>k.mutate({autoAdvance:V.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm",children:"Avanzar automticamente"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s?.skipOnError??!0,onChange:V=>k.mutate({skipOnError:V.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm",children:"Saltar en caso de error"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s?.pauseAfterEach??!1,onChange:V=>k.mutate({pauseAfterEach:V.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm",children:"Pausar despus de cada proyecto"})]})]})]})]}),e.jsxs(me,{children:[e.jsxs(Re,{children:[e.jsx(Ie,{className:"text-lg",children:"Aadir Proyecto"}),e.jsx(At,{children:"Selecciona un proyecto para aadir a la cola de generacin"})]}),e.jsx(he,{children:e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs(Pt,{value:n,onValueChange:r,children:[e.jsx(St,{className:"w-[300px]","data-testid":"select-project",children:e.jsx(Tt,{placeholder:"Seleccionar proyecto..."})}),e.jsxs(kt,{children:[p.map(V=>e.jsx(ce,{value:V.id.toString(),children:V.title},V.id)),p.length===0&&e.jsx(ce,{value:"none",disabled:!0,children:"No hay proyectos disponibles"})]})]}),e.jsxs(B,{onClick:E,disabled:!n||N.isPending,"data-testid":"button-add-to-queue",children:[e.jsx(Nr,{className:"h-4 w-4 mr-2"}),"Aadir a Cola"]})]})})]}),e.jsxs(me,{children:[e.jsxs(Re,{children:[e.jsx(Ie,{className:"text-lg",children:"Proyectos en Cola"}),e.jsxs(At,{children:[X.length," proyectos pendientes"]})]}),e.jsx(he,{children:X.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No hay proyectos en cola"}):e.jsx("div",{className:"space-y-2",children:X.sort((V,G)=>V.position-G.position).map((V,G)=>e.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-lg border bg-card hover-elevate","data-testid":`queue-item-${V.id}`,children:[e.jsx("div",{className:"text-lg font-bold text-muted-foreground w-8",children:G+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium truncate",children:V.project?.title||`Proyecto #${V.projectId}`}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[V.project?.genre," - ",V.project?.chapterCount," captulos"]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[R(V.priority),P(V.status)]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(ei,{children:[e.jsx(ti,{asChild:!0,children:e.jsx(B,{size:"icon",variant:"ghost",onClick:()=>A(V),disabled:G===0||V.status==="processing","data-testid":`button-move-up-${V.id}`,children:e.jsx(pA,{className:"h-4 w-4"})})}),e.jsx(ua,{children:"Subir"})]}),e.jsxs(ei,{children:[e.jsx(ti,{asChild:!0,children:e.jsx(B,{size:"icon",variant:"ghost",onClick:()=>W(V),disabled:G===X.length-1||V.status==="processing","data-testid":`button-move-down-${V.id}`,children:e.jsx(uA,{className:"h-4 w-4"})})}),e.jsx(ua,{children:"Bajar"})]}),e.jsxs(ei,{children:[e.jsx(ti,{asChild:!0,children:e.jsx(B,{size:"icon",variant:"ghost",onClick:()=>S.mutate(V.id),disabled:V.priority==="urgent"||V.status==="processing","data-testid":`button-urgent-${V.id}`,children:e.jsx(us,{className:"h-4 w-4"})})}),e.jsx(ua,{children:"Marcar urgente"})]}),e.jsxs(ei,{children:[e.jsx(ti,{asChild:!0,children:e.jsx(B,{size:"icon",variant:"ghost",onClick:()=>b.mutate(V.id),disabled:V.status==="processing","data-testid":`button-remove-${V.id}`,children:e.jsx(Rn,{className:"h-4 w-4"})})}),e.jsx(ua,{children:"Eliminar de cola"})]})]})]},V.id))})})]}),se.length>0&&e.jsxs(me,{children:[e.jsxs(Re,{children:[e.jsx(Ie,{className:"text-lg",children:"Historial"}),e.jsx(At,{children:"Proyectos procesados recientemente"})]}),e.jsx(he,{children:e.jsx("div",{className:"space-y-2",children:se.slice(0,10).map(V=>e.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-lg border bg-muted/30","data-testid":`history-item-${V.id}`,children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium truncate",children:V.project?.title||`Proyecto #${V.projectId}`}),V.errorMessage&&e.jsx("div",{className:"text-sm text-destructive truncate",children:V.errorMessage})]}),P(V.status),V.completedAt&&e.jsx("div",{className:"text-sm text-muted-foreground",children:new Date(V.completedAt).toLocaleString()})]},V.id))})})]})]})}var zv="Switch",[K8]=Zn(zv),[W8,Q8]=K8(zv),pP=x.forwardRef((t,n)=>{const{__scopeSwitch:r,name:s,checked:i,defaultChecked:o,required:c,disabled:d,value:p="on",onCheckedChange:m,form:h,...g}=t,[v,j]=x.useState(null),N=vt(n,P=>j(P)),b=x.useRef(!1),C=v?h||!!v.closest("form"):!0,[S=!1,k]=Zr({prop:i,defaultProp:o,onChange:m});return e.jsxs(W8,{scope:r,checked:S,disabled:d,children:[e.jsx(et.button,{type:"button",role:"switch","aria-checked":S,"aria-required":c,"data-state":fP(S),"data-disabled":d?"":void 0,disabled:d,value:p,...g,ref:N,onClick:De(t.onClick,P=>{k(R=>!R),C&&(b.current=P.isPropagationStopped(),b.current||P.stopPropagation())})}),C&&e.jsx(Y8,{control:v,bubbles:!b.current,name:s,value:p,checked:S,required:c,disabled:d,form:h,style:{transform:"translateX(-100%)"}})]})});pP.displayName=zv;var mP="SwitchThumb",hP=x.forwardRef((t,n)=>{const{__scopeSwitch:r,...s}=t,i=Q8(mP,r);return e.jsx(et.span,{"data-state":fP(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:n})});hP.displayName=mP;var Y8=t=>{const{control:n,checked:r,bubbles:s=!0,...i}=t,o=x.useRef(null),c=Vp(r),d=_p(n);return x.useEffect(()=>{const p=o.current,m=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(m,"checked").set;if(c!==r&&g){const v=new Event("click",{bubbles:s});g.call(p,r),p.dispatchEvent(v)}},[c,r,s]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...i,tabIndex:-1,ref:o,style:{...t.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function fP(t){return t?"checked":"unchecked"}var xP=pP,Z8=hP;const hr=x.forwardRef(({className:t,...n},r)=>e.jsx(xP,{className:Ae("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...n,ref:r,children:e.jsx(Z8,{className:Ae("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));hr.displayName=xP.displayName;const gP=[{code:"es",name:"Espaol"},{code:"en",name:"English"},{code:"fr",name:"Franais"},{code:"de",name:"Deutsch"},{code:"it",name:"Italiano"},{code:"pt",name:"Portugus"},{code:"ca",name:"Catal"}];function Vw(t){if(!t)return"No detectado";const n=gP.find(r=>r.code===t.toLowerCase());return n?n.name:t.toUpperCase()}function yp(t,n){return t===0?n||"Prlogo":t===-1?n||"Eplogo":t===-2?n||"Nota del Autor":n||`Captulo ${t}`}function rl(t){return t===0?"Prlogo":t===-1?"Eplogo":t===-2?"N.A.":`Cap. ${t}`}const X8=.15,J8=.6,eq=3.5;function tq(t,n,r){const s=t/1e6*X8,i=n/1e6*J8,o=r/1e6*eq;return s+i+o}function Hf(t){const n={pending:"Pendiente",processing:"Procesando",paused:"Pausado",completed:"Completado",error:"Error",awaiting_instructions:"Esperando Instrucciones",awaiting_issue_approval:"Revisin de Problemas"},r={pending:{variant:"outline",icon:Cn},processing:{variant:"secondary",icon:be},paused:{variant:"outline",icon:ox},completed:{variant:"default",icon:Xt},error:{variant:"destructive",icon:Dr},awaiting_instructions:{variant:"outline",icon:ox},awaiting_issue_approval:{variant:"outline",icon:Dr}},s=r[t]||r.pending,i=s.icon;return e.jsxs(Q,{variant:s.variant,className:`flex items-center gap-1 ${t==="awaiting_instructions"?"border-amber-500 text-amber-600 dark:text-amber-400":""} ${t==="awaiting_issue_approval"?"border-orange-500 text-orange-600 dark:text-orange-400":""}`,children:[e.jsx(i,{className:`h-3 w-3 ${t==="processing"?"animate-spin":""}`}),n[t]||t]})}function qw(t){return{uploaded:"Subido",analyzing:"Analizando Estructura",editing:"Revisin Editorial",world_bible:"Extrayendo Biblia del Mundo",architect:"Anlisis Arquitectnico",copyediting:"Correccin de Estilo",qa:"Auditora QA",reviewing:"Revisin Final",completed:"Completado"}[t]||t}function qc({score:t}){if(t==null)return null;const n=t>=8?"text-green-600 dark:text-green-400":t>=6?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400";return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Wu,{className:`h-5 w-5 ${n}`}),e.jsxs("span",{className:`text-2xl font-bold ${n}`,children:[t,"/10"]})]})}function Kf(t){return t>=1e6?`${(t/1e6).toFixed(2)}M`:t>=1e3?`${(t/1e3).toFixed(1)}K`:t.toString()}function nq({projectId:t,isProcessing:n}){const{data:r}=Ke({queryKey:["/api/reedit-projects",t],refetchInterval:n?5e3:!1});if(!r)return null;const s=r.totalInputTokens||0,i=r.totalOutputTokens||0,o=r.totalThinkingTokens||0,c=tq(s,i,o);return!(s>0||i>0)&&!n?null:e.jsx(me,{className:"border-2 border-primary/20 bg-gradient-to-r from-primary/5 to-transparent","data-testid":"widget-realtime-cost",children:e.jsxs(he,{className:"pt-4 pb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Fi,{className:"h-5 w-5 text-primary"}),e.jsx("span",{className:"font-semibold",children:"Costos en Tiempo Real"}),n&&e.jsxs(Q,{variant:"secondary",className:"ml-auto animate-pulse",children:[e.jsx(us,{className:"h-3 w-3 mr-1"}),"Actualizando"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-2 bg-muted/50 rounded-md",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1 text-muted-foreground mb-1",children:[e.jsx(Pc,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs",children:"Entrada"})]}),e.jsx("p",{className:"font-mono font-semibold",children:Kf(s)})]}),e.jsxs("div",{className:"text-center p-2 bg-muted/50 rounded-md",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1 text-muted-foreground mb-1",children:[e.jsx(xA,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs",children:"Salida"})]}),e.jsx("p",{className:"font-mono font-semibold",children:Kf(i)})]}),e.jsxs("div",{className:"text-center p-2 bg-muted/50 rounded-md",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1 text-muted-foreground mb-1",children:[e.jsx(us,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs",children:"Thinking"})]}),e.jsx("p",{className:"font-mono font-semibold",children:Kf(o)})]}),e.jsxs("div",{className:"text-center p-2 bg-primary/10 rounded-md",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1 text-primary mb-1",children:[e.jsx(Fi,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs font-medium",children:"Costo Total"})]}),e.jsxs("p",{className:"font-mono font-bold text-lg text-primary",children:["$",c.toFixed(2)]})]})]})]})})}function rq({analysis:t}){if(!t)return null;const n=t.hasIssues,r=t.duplicateChapters||[],s=t.outOfOrderChapters||[],i=t.missingChapters||[],o=t.recommendations||[],c=t.totalChapters,d=t.regularChapters;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n?e.jsx(Q,{variant:"destructive",children:"Con Problemas"}):e.jsx(Q,{className:"bg-green-600",children:"Sin Problemas"}),c!==void 0&&e.jsxs(Q,{variant:"secondary",children:[c," captulos totales"]}),d!==void 0&&e.jsxs(Q,{variant:"outline",children:[d," captulos regulares"]})]}),(t.hasPrologue!==void 0||t.hasEpilogue!==void 0)&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.hasPrologue&&e.jsx(Q,{variant:"outline",children:"Tiene Prlogo"}),t.hasEpilogue&&e.jsx(Q,{variant:"outline",children:"Tiene Eplogo"}),t.hasAuthorNote&&e.jsx(Q,{variant:"outline",children:"Tiene Nota del Autor"})]}),i.length>0&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-red-600 dark:text-red-400 mb-1",children:["Captulos Faltantes (",i.length,")"]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[i.slice(0,20).map((p,m)=>e.jsx(Q,{variant:"destructive",className:"text-xs",children:p},m)),i.length>20&&e.jsxs(Q,{variant:"secondary",className:"text-xs",children:["...y ",i.length-20," ms"]})]})]}),r.length>0&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-orange-600 dark:text-orange-400 mb-1",children:["Captulos Duplicados (",r.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.map((p,m)=>{const h=p.chapterNumber??p.chapter??p;return e.jsx(Q,{variant:"secondary",children:rl(typeof h=="number"?h:parseInt(h)||0)},m)})})]}),s.length>0&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-yellow-600 dark:text-yellow-400 mb-1",children:["Captulos Fuera de Orden (",s.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map((p,m)=>{const h=p.chapterNumber??p.chapter??p;return e.jsx(Q,{variant:"secondary",children:rl(typeof h=="number"?h:parseInt(h)||0)},m)})})]}),!n&&i.length===0&&r.length===0&&s.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"La estructura del manuscrito es correcta. No se detectaron problemas."}),o.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Recomendaciones"}),e.jsx("ul",{className:"text-sm space-y-1 list-disc list-inside",children:o.map((p,m)=>e.jsx("li",{className:"text-muted-foreground",children:p},m))})]})]})}function sq({result:t}){if(!t)return null;const n=o=>{switch(o?.toLowerCase()){case"critica":case"critical":return"text-red-600 dark:text-red-400";case"mayor":case"major":return"text-orange-600 dark:text-orange-400";case"menor":case"minor":return"text-yellow-600 dark:text-yellow-400";default:return"text-muted-foreground"}},r=o=>{const c=o?.toUpperCase()||"";return c.includes("APROBADO")&&!c.includes("RESERVA")?e.jsx(Q,{className:"bg-green-600",children:"Aprobado"}):c.includes("RESERVA")?e.jsx(Q,{className:"bg-yellow-600",children:"Aprobado con Reservas"}):c.includes("REVISION")||c.includes("REQUIERE")?e.jsx(Q,{variant:"destructive",children:"Requiere Revisin"}):e.jsx(Q,{variant:"outline",children:o})},s=o=>{const c=o?.toLowerCase()||"";return c==="high"||c==="alto"?e.jsx(Q,{className:"bg-green-600",children:"Potencial Alto"}):c==="medium"||c==="medio"?e.jsx(Q,{className:"bg-yellow-600",children:"Potencial Medio"}):e.jsx(Q,{variant:"outline",children:o})},i=t.strengths||t.weaknesses||t.bestsellerScore;return e.jsxs("div",{className:"space-y-6",children:[t.veredicto&&e.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Veredicto"}),r(t.veredicto)]}),t.puntuacion_global&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Puntuacin Global"}),e.jsx(qc,{score:t.puntuacion_global})]})]}),i&&!t.veredicto&&e.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[t.bestsellerScore&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Puntuacin Bestseller"}),e.jsx(qc,{score:t.bestsellerScore})]}),t.marketPotential&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Potencial de Mercado"}),s(t.marketPotential)]})]}),t.resumen_general&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Resumen General"}),e.jsx("p",{className:"text-sm leading-relaxed bg-muted p-3 rounded-md",children:t.resumen_general})]}),t.strengths&&t.strengths.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2 text-green-600 dark:text-green-400",children:"Fortalezas"}),e.jsx("ul",{className:"text-sm list-disc list-inside space-y-1",children:t.strengths.map((o,c)=>e.jsx("li",{children:o},c))})]}),t.weaknesses&&t.weaknesses.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2 text-orange-600 dark:text-orange-400",children:"reas de Mejora"}),e.jsx("ul",{className:"text-sm list-disc list-inside space-y-1",children:t.weaknesses.map((o,c)=>e.jsx("li",{children:o},c))})]}),t.recommendations&&Array.isArray(t.recommendations)&&t.recommendations.length>0&&!t.justificacion_puntuacion&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Recomendaciones"}),e.jsx("ul",{className:"text-sm list-disc list-inside space-y-1",children:t.recommendations.map((o,c)=>e.jsx("li",{children:o},c))})]}),t.issues&&t.issues.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-2",children:["Problemas Detectados (",t.issues.length,")"]}),e.jsx("div",{className:"space-y-3",children:t.issues.map((o,c)=>e.jsxs("div",{className:"border rounded-md p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Q,{variant:"outline",children:o.categoria||"General"}),e.jsx("span",{className:`text-sm font-medium ${n(o.severidad)}`,children:o.severidad||"Sin severidad"})]}),e.jsx("p",{className:"text-sm",children:o.descripcion}),o.capitulos_afectados&&o.capitulos_afectados.length>0&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Captulos afectados: ",o.capitulos_afectados.join(", ")]}),o.instrucciones_correccion&&e.jsxs("p",{className:"text-sm mt-2 italic text-muted-foreground",children:["Correccin: ",o.instrucciones_correccion]})]},c))})]}),t.analisis_bestseller&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Anlisis de Potencial Bestseller"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(t.analisis_bestseller).map(([o,c])=>e.jsxs("div",{className:"bg-muted p-2 rounded-md",children:[e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:o.replace(/_/g," ")}),e.jsx("p",{className:"text-sm",children:String(c)})]},o))})]}),t.justificacion_puntuacion&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Justificacin de la Puntuacin"}),t.justificacion_puntuacion.puntuacion_desglosada&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Puntuacin Desglosada"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(t.justificacion_puntuacion.puntuacion_desglosada).map(([o,c])=>e.jsxs(Q,{variant:"secondary",children:[o,": ",String(c),"/10"]},o))})]}),t.justificacion_puntuacion.fortalezas_principales&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Fortalezas Principales"}),e.jsx("ul",{className:"text-sm list-disc list-inside space-y-1",children:t.justificacion_puntuacion.fortalezas_principales.map((o,c)=>e.jsx("li",{children:o},c))})]}),t.justificacion_puntuacion.debilidades_principales&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Debilidades Principales"}),e.jsx("ul",{className:"text-sm list-disc list-inside space-y-1",children:t.justificacion_puntuacion.debilidades_principales.map((o,c)=>e.jsx("li",{children:o},c))})]}),t.justificacion_puntuacion.comparacion_mercado&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Comparacin con el Mercado"}),e.jsx("p",{className:"text-sm",children:t.justificacion_puntuacion.comparacion_mercado})]})]}),t.capitulos_para_reescribir&&t.capitulos_para_reescribir.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2 text-orange-600 dark:text-orange-400",children:"Captulos que Requieren Reescritura"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.capitulos_para_reescribir.map(o=>e.jsxs(Q,{variant:"destructive",children:["Captulo ",o]},o))})]})]})}function aq({worldBible:t}){if(!t)return null;const n=t.characters||[],r=t.locations||[],s=t.timeline||[],i=t.loreRules||[];return e.jsxs("div",{className:"space-y-6","data-testid":"display-world-bible",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[t.confidence!==void 0&&t.confidence!==null&&e.jsxs(Q,{variant:"secondary",children:["Confianza: ",t.confidence,"/10"]}),t.historicalPeriod&&e.jsxs(Q,{className:"bg-amber-600",children:["poca: ",t.historicalPeriod]})]}),n.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-2",children:["Personajes (",n.length,")"]}),e.jsx("div",{className:"space-y-2",children:n.slice(0,10).map((o,c)=>e.jsxs("div",{className:"p-3 border rounded-md",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium",children:o.nombre||o.name}),e.jsxs(Q,{variant:"outline",className:"text-xs",children:["Cap. ",o.primeraAparicion||o.firstAppearance||"?"]}),(o.alias||o.aliases)?.length>0&&e.jsx(Q,{variant:"secondary",className:"text-xs",children:(o.alias||o.aliases)[0]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:o.descripcion||o.description}),(o.relaciones||o.relationships)?.length>0&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Relaciones: ",(o.relaciones||o.relationships).slice(0,3).join(", ")]})]},c))})]}),r.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-2",children:["Ubicaciones (",r.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.map((o,c)=>e.jsxs(Q,{variant:"outline",className:"text-sm py-1",children:[o.nombre||o.name," (Cap. ",o.primeraMencion||o.firstMention||"?",")"]},c))})]}),s.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-2",children:["Lnea Temporal (",s.length," eventos)"]}),e.jsx("div",{className:"space-y-1",children:s.slice(0,8).map((o,c)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsxs(Q,{variant:"outline",className:"text-xs",children:["Cap. ",o.capitulo||o.chapter]}),e.jsx("span",{children:o.evento||o.event}),o.marcadorTemporal&&e.jsxs("span",{className:"text-muted-foreground text-xs",children:["(",o.marcadorTemporal,")"]})]},c))})]}),i.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-2",children:["Reglas del Mundo (",i.length,")"]}),e.jsx("ul",{className:"text-sm space-y-1 list-disc list-inside",children:i.slice(0,6).map((o,c)=>e.jsxs("li",{children:[o.regla||o.rule," ",e.jsxs("span",{className:"text-muted-foreground text-xs",children:["(",o.categoria||o.category||"general",")"]})]},c))})]})]})}function iq({report:t}){return t?e.jsxs("div",{className:"space-y-4",children:[t.critique&&e.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Crtica General"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.critique})]}),t.plot_holes&&t.plot_holes.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[e.jsx(on,{className:"h-4 w-4 text-red-500"}),"Huecos en la Trama (",t.plot_holes.length,")"]}),e.jsx("div",{className:"space-y-2",children:t.plot_holes.map((n,r)=>e.jsx(me,{className:"border-red-500/30",children:e.jsx(he,{className:"py-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs(Q,{variant:"outline",className:"shrink-0",children:["Cap. ",n.chapter||n.between_chapters]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:n.issue||n.description}),n.suggestion&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Sugerencia: ",n.suggestion]})]})]})})},r))})]}),t.redundancies&&t.redundancies.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[e.jsx(Hs,{className:"h-4 w-4 text-orange-500"}),"Redundancias (",t.redundancies.length,")"]}),e.jsx("div",{className:"space-y-2",children:t.redundancies.map((n,r)=>e.jsx(me,{className:"border-orange-500/30",children:e.jsx(he,{className:"py-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs(Q,{variant:"outline",className:"shrink-0",children:["Caps. ",n.chapters?.join(", ")||n.chapter]}),e.jsx("p",{className:"text-sm",children:n.issue||n.description})]})})},r))})]}),t.pacing_issues&&t.pacing_issues.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[e.jsx(Cn,{className:"h-4 w-4 text-yellow-500"}),"Problemas de Ritmo (",t.pacing_issues.length,")"]}),e.jsx("div",{className:"space-y-2",children:t.pacing_issues.map((n,r)=>e.jsx(me,{className:"border-yellow-500/30",children:e.jsx(he,{className:"py-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Q,{variant:"outline",className:"shrink-0",children:n.section||`Cap. ${n.chapter}`}),e.jsx("p",{className:"text-sm",children:n.issue||n.description})]})})},r))})]}),t.anachronisms_warning&&t.anachronisms_warning.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[e.jsx(Dr,{className:"h-4 w-4 text-purple-500"}),"Anacronismos Detectados (",t.anachronisms_warning.length,")"]}),e.jsx("div",{className:"space-y-2",children:t.anachronisms_warning.map((n,r)=>e.jsx(me,{className:"border-purple-500/30",children:e.jsx(he,{className:"py-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs(Q,{variant:"outline",className:"shrink-0",children:["Cap. ",n.chapter]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:n.element||n.issue}),n.reason&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:n.reason})]})]})})},r))})]}),(!t.plot_holes||t.plot_holes.length===0)&&(!t.redundancies||t.redundancies.length===0)&&(!t.pacing_issues||t.pacing_issues.length===0)&&(!t.anachronisms_warning||t.anachronisms_warning.length===0)&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Xt,{className:"h-12 w-12 mx-auto mb-4 text-green-500"}),e.jsx("p",{className:"font-medium",children:"No se detectaron problemas estructurales"}),e.jsx("p",{className:"text-sm",children:"El manuscrito tiene una estructura slida."})]})]}):null}function oq({project:t,chapters:n}){const r=n.filter(j=>j.status==="completed"||j.editedContent),s=n.filter(j=>j.status==="pending"),i=n.filter(j=>j.status==="analyzing"||j.status==="editing"),o=n.reduce((j,N)=>{const b=N.originalContent||"";return j+b.split(/\s+/).filter(C=>C.length>0).length},0),c=n.reduce((j,N)=>{const b=N.editedContent||N.originalContent||"";return j+b.split(/\s+/).filter(C=>C.length>0).length},0),d=c-o,p=o>0?(d/o*100).toFixed(1):"0",m=j=>{if(!j)return null;if(typeof j=="object")return j;try{return JSON.parse(j)}catch{return null}},h=[];n.forEach(j=>{const N=[],b=m(j.narrativeIssues);b&&(Array.isArray(b.plotHoles)&&N.push(...b.plotHoles.map(S=>({type:"trama",text:String(S)}))),Array.isArray(b.continuityErrors)&&N.push(...b.continuityErrors.map(S=>({type:"continuidad",text:String(S)}))),Array.isArray(b.pacing)&&N.push(...b.pacing.map(S=>({type:"ritmo",text:String(S)}))));const C=m(j.editorFeedback);C&&Array.isArray(C.issues)&&N.push(...C.issues.map(S=>({type:"editor",text:String(S)}))),N.length>0&&h.push({chapter:j.chapterNumber,title:j.title,issues:N})});const g=n.filter(j=>j.editedContent&&j.editedContent!==j.originalContent),v=j=>{const N={trama:"bg-red-600",continuidad:"bg-orange-600",ritmo:"bg-blue-600",editor:"bg-purple-600"},b={trama:"Trama",continuidad:"Continuidad",ritmo:"Ritmo",editor:"Editorial"};return e.jsx(Q,{className:N[j]||"bg-gray-600",children:b[j]||j})};return e.jsxs("div",{className:"space-y-6","data-testid":"display-progress-report",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsx(me,{children:e.jsxs(he,{className:"pt-4 pb-3 text-center",children:[e.jsx(Pc,{className:"h-5 w-5 mx-auto mb-1 text-blue-500"}),e.jsxs("p",{className:"text-2xl font-bold",children:[r.length,"/",n.length]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Captulos Procesados"})]})}),e.jsx(me,{children:e.jsxs(he,{className:"pt-4 pb-3 text-center",children:[e.jsx(yt,{className:"h-5 w-5 mx-auto mb-1 text-green-500"}),e.jsx("p",{className:"text-2xl font-bold",children:o.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Palabras Originales"})]})}),e.jsx(me,{children:e.jsxs(he,{className:"pt-4 pb-3 text-center",children:[e.jsx(us,{className:"h-5 w-5 mx-auto mb-1 text-yellow-500"}),e.jsx("p",{className:"text-2xl font-bold",children:c.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Palabras Editadas"})]})}),e.jsx(me,{children:e.jsxs(he,{className:"pt-4 pb-3 text-center",children:[e.jsx(Pc,{className:`h-5 w-5 mx-auto mb-1 ${d>=0?"text-green-500":"text-red-500"}`}),e.jsxs("p",{className:"text-2xl font-bold",children:[d>=0?"+":"",p,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Cambio de Longitud"})]})})]}),i.length>0&&e.jsxs(me,{className:"border-blue-500/50",children:[e.jsx(Re,{className:"py-3",children:e.jsxs(Ie,{className:"text-sm flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4 animate-spin"}),"En Proceso (",i.length,")"]})}),e.jsx(he,{className:"py-2",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:i.map(j=>e.jsx(Q,{variant:"outline",className:"animate-pulse",children:rl(j.chapterNumber)},j.id))})})]}),e.jsxs(me,{children:[e.jsx(Re,{className:"py-3",children:e.jsxs(Ie,{className:"text-sm flex items-center gap-2",children:[e.jsx(on,{className:"h-4 w-4 text-orange-500"}),"Problemas Detectados (",h.reduce((j,N)=>j+N.issues.length,0),")"]})}),e.jsx(he,{className:"py-2",children:h.length===0?e.jsx("p",{className:"text-muted-foreground text-sm text-center py-2",children:r.length===0?"Los problemas aparecern aqu durante el anlisis":"No se han detectado problemas significativos"}):e.jsx(jt,{className:"h-[200px]",children:e.jsxs("div",{className:"space-y-3",children:[h.slice(0,10).map((j,N)=>e.jsxs("div",{className:"border-l-2 border-muted pl-3",children:[e.jsx("p",{className:"text-xs font-medium mb-1",children:yp(j.chapter,j.title)}),e.jsxs("div",{className:"space-y-1",children:[j.issues.slice(0,3).map((b,C)=>e.jsxs("div",{className:"flex items-start gap-2 text-xs",children:[v(b.type),e.jsx("span",{className:"text-muted-foreground",children:b.text})]},C)),j.issues.length>3&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["+",j.issues.length-3," ms..."]})]})]},N)),h.length>10&&e.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["+",h.length-10," captulos ms con problemas"]})]})})})]}),e.jsxs(me,{children:[e.jsx(Re,{className:"py-3",children:e.jsxs(Ie,{className:"text-sm flex items-center gap-2",children:[e.jsx(Xt,{className:"h-4 w-4 text-green-500"}),"Captulos Editados (",g.length,")"]})}),e.jsx(he,{className:"py-2",children:g.length===0?e.jsx("p",{className:"text-muted-foreground text-sm text-center py-2",children:"Los cambios aparecern aqu cuando se procesen los captulos"}):e.jsx(jt,{className:"h-[200px]",children:e.jsxs("div",{className:"space-y-2",children:[g.slice(0,15).map(j=>{const N=(j.originalContent||"").split(/\s+/).filter(S=>S.length>0).length,b=(j.editedContent||"").split(/\s+/).filter(S=>S.length>0).length,C=b-N;return e.jsxs("div",{className:"flex items-center justify-between text-sm py-1 border-b last:border-0",children:[e.jsx("span",{className:"font-medium",children:yp(j.chapterNumber,j.title)}),e.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[e.jsxs("span",{className:"text-muted-foreground",children:[N,"  ",b]}),e.jsxs(Q,{variant:C>=0?"default":"secondary",className:"text-xs",children:[C>=0?"+":"",C]}),j.editorScore&&e.jsxs(Q,{variant:"outline",className:"text-xs",children:[" ",j.editorScore]})]})]},j.id)}),g.length>15&&e.jsxs("p",{className:"text-xs text-muted-foreground text-center py-2",children:["+",g.length-15," captulos ms editados"]})]})})})]}),s.length>0&&e.jsxs(me,{className:"border-muted",children:[e.jsx(Re,{className:"py-3",children:e.jsxs(Ie,{className:"text-sm flex items-center gap-2",children:[e.jsx(Cn,{className:"h-4 w-4 text-muted-foreground"}),"Pendientes (",s.length,")"]})}),e.jsx(he,{className:"py-2",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.slice(0,20).map(j=>e.jsx(Q,{variant:"outline",className:"text-xs opacity-60",children:rl(j.chapterNumber)},j.id)),s.length>20&&e.jsxs(Q,{variant:"outline",className:"text-xs opacity-60",children:["+",s.length-20]})]})})]})]})}function lq({projectId:t}){const{data:n,isLoading:r,error:s}=Ke({queryKey:["/api/reedit-projects",t,"quality-report"],queryFn:async()=>{const d=await fetch(`/api/reedit-projects/${t}/quality-report`);if(!d.ok)throw new Error("Failed to fetch quality report");return d.json()},enabled:!!t});if(r)return e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(be,{className:"h-8 w-8 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-2 text-muted-foreground",children:"Generando informe de calidad..."})]});if(s||!n)return e.jsxs("div",{className:"text-center text-muted-foreground py-12",children:[e.jsx(Dr,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No hay informe de calidad disponible."}),e.jsx("p",{className:"text-sm",children:"Complete al menos un ciclo de revisin para generar el informe."})]});const i=d=>({enganche:"Enganche",personajes:"Personajes",trama:"Trama",atmosfera:"Atmsfera",ritmo:"Ritmo",continuidad_fisica:"Continuidad Fsica",timeline:"Lnea Temporal",ubicacion:"Ubicacin",repeticion_lexica:"Repeticin Lxica",arco_incompleto:"Arco Incompleto",tension_insuficiente:"Tensin Insuficiente",giro_predecible:"Giro Predecible",hook_debil:"Hook Dbil",credibilidad_narrativa:"Credibilidad Narrativa",otro:"Otro"})[d]||d,o=d=>d==="critica"?e.jsx(Q,{variant:"destructive",children:"Crtico"}):d==="mayor"?e.jsx(Q,{className:"bg-orange-500 hover:bg-orange-600",children:"Mayor"}):e.jsx(Q,{variant:"secondary",children:"Menor"}),c=(d,p,m)=>{if(d.length===0)return null;const h=g=>g==="critica"?"border-l-red-500":g==="mayor"?"border-l-orange-500":"border-l-yellow-500";return e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"font-medium flex items-center gap-2 mb-3",children:[m,p," (",d.length,")"]}),e.jsx("div",{className:"space-y-3",children:d.map(g=>e.jsx(me,{className:`border-l-4 ${h(g.severidad)}`,children:e.jsxs(he,{className:"py-3 px-4",children:[e.jsx("div",{className:"flex items-start justify-between gap-2 mb-2",children:e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[g.titulosCapitulos.map((v,j)=>e.jsx(Q,{variant:"outline",children:v},j)),e.jsx(Q,{variant:"outline",className:"text-xs",children:i(g.categoria)}),o(g.severidad)]})}),g.capitulosAfectados.length>0&&e.jsxs("div",{className:"text-xs text-muted-foreground mb-2",children:[e.jsx("strong",{children:"Ubicacin:"})," ",g.capitulosAfectados.length===1?`Captulo ${g.capitulosAfectados[0]}`:`Captulos ${g.capitulosAfectados.join(", ")}`]}),g.extractoTexto&&e.jsxs("div",{className:"text-xs bg-muted/50 border-l-2 border-primary/30 pl-2 py-1 mb-2 italic",children:['"',g.extractoTexto,'"']}),e.jsx("p",{className:"text-sm mb-2",children:g.descripcion}),g.instruccionCorreccion&&e.jsxs("div",{className:"text-xs text-muted-foreground bg-muted p-2 rounded mb-2",children:[e.jsx("strong",{children:"Correccin sugerida:"})," ",g.instruccionCorreccion.substring(0,300),g.instruccionCorreccion.length>300&&"..."]}),g.elementosAPreservar&&e.jsxs("div",{className:"text-xs text-green-700 dark:text-green-400 bg-green-50 dark:bg-green-900/20 p-2 rounded",children:[e.jsx("strong",{children:"No modificar:"})," ",g.elementosAPreservar.substring(0,150),g.elementosAPreservar.length>150&&"..."]})]})},g.id))})]})};return e.jsx(jt,{className:"h-[600px] mt-4 pr-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(me,{className:n.esPublicable?"border-green-500":"border-orange-500",children:[e.jsxs(Re,{children:[e.jsxs(Ie,{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Wu,{className:"h-5 w-5 text-yellow-500"}),"Informe de Calidad"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-3xl font-bold",children:[n.puntuacionGlobal,"/10"]}),n.esPublicable?e.jsx(Q,{className:"bg-green-500 hover:bg-green-600",children:"Publicable"}):e.jsx(Q,{variant:"destructive",children:"No Publicable"})]})]}),e.jsx(At,{children:n.razonPublicabilidad})]}),e.jsxs(he,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center p-2 bg-muted rounded",children:[e.jsx("div",{className:"text-2xl font-bold",children:n.puntuacionesDesglosadas.enganche}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Enganche"})]}),e.jsxs("div",{className:"text-center p-2 bg-muted rounded",children:[e.jsx("div",{className:"text-2xl font-bold",children:n.puntuacionesDesglosadas.personajes}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Personajes"})]}),e.jsxs("div",{className:"text-center p-2 bg-muted rounded",children:[e.jsx("div",{className:"text-2xl font-bold",children:n.puntuacionesDesglosadas.trama}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Trama"})]}),e.jsxs("div",{className:"text-center p-2 bg-muted rounded",children:[e.jsx("div",{className:"text-2xl font-bold",children:n.puntuacionesDesglosadas.atmosfera}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Atmsfera"})]}),e.jsxs("div",{className:"text-center p-2 bg-muted rounded",children:[e.jsx("div",{className:"text-2xl font-bold",children:n.puntuacionesDesglosadas.ritmo}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Ritmo"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:n.totalCapitulos}),e.jsx("div",{className:"text-muted-foreground",children:"Captulos"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:n.totalPalabras.toLocaleString()}),e.jsx("div",{className:"text-muted-foreground",children:"Palabras"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:n.ciclosCompletados}),e.jsx("div",{className:"text-muted-foreground",children:"Ciclos"})]})]})]})]}),n.totalIssues>0?e.jsxs(me,{children:[e.jsxs(Re,{children:[e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(on,{className:"h-5 w-5 text-orange-500"}),"Problemas Detectados (",n.totalIssues,")"]}),e.jsxs(At,{children:["Captulos afectados: ",n.capitulosConProblemas.length>0?n.capitulosConProblemas.join(", "):"Ninguno"]})]}),e.jsxs(he,{children:[c(n.issuesCriticos,"Errores Crticos",e.jsx(Hs,{className:"h-4 w-4 text-red-500"})),c(n.issuesMayores,"Errores Mayores",e.jsx(on,{className:"h-4 w-4 text-orange-500"})),c(n.issuesMenores,"Errores Menores",e.jsx(Dr,{className:"h-4 w-4 text-yellow-500"}))]})]}):e.jsx(me,{className:"border-green-500",children:e.jsxs(he,{className:"py-8 text-center",children:[e.jsx(Xt,{className:"h-12 w-12 mx-auto mb-4 text-green-500"}),e.jsx("h3",{className:"text-lg font-medium text-green-700",children:"Sin Problemas Detectados"}),e.jsx("p",{className:"text-muted-foreground",children:"El manuscrito est listo para publicacin."})]})}),n.recomendacionesFinales.length>0&&e.jsxs(me,{children:[e.jsx(Re,{children:e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(Pc,{className:"h-5 w-5 text-blue-500"}),"Recomendaciones"]})}),e.jsx(he,{children:e.jsx("ul",{className:"space-y-2",children:n.recomendacionesFinales.map((d,p)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Wc,{className:"h-4 w-4 mt-0.5 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:d})]},p))})})]}),e.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["Informe generado: ",new Date(n.fechaGeneracion).toLocaleString()]})]})})}function cq({reports:t}){if(!t||t.length===0)return e.jsx("p",{className:"text-muted-foreground text-center py-4",children:"No hay informes de auditora disponibles"});const n=i=>({architect:"Anlisis Arquitectnico",continuity:"Centinela de Continuidad",voice_rhythm:"Auditor de Voz y Ritmo",semantic_repetition:"Detector de Repeticin Semntica",anachronism:"Detector de Anacronismos",final_review:"Revisin Final",structural_fix:"Correccin Estructural"})[i]||i,r=i=>({architect:"bg-purple-600",continuity:"bg-blue-600",voice_rhythm:"bg-teal-600",semantic_repetition:"bg-orange-600",anachronism:"bg-amber-600",final_review:"bg-green-600",structural_fix:"bg-indigo-600"})[i]||"bg-gray-600",s=t.filter(i=>i&&typeof i=="object");return s.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-4",children:"No hay informes de auditora vlidos"}):e.jsx("div",{className:"space-y-4","data-testid":"display-audit-reports",children:s.map((i,o)=>{const c=(()=>{try{if(!i.findings)return null;const p=typeof i.findings=="string"?JSON.parse(i.findings):i.findings;return p?.resumenEjecutivo||p?.resumen||null}catch{return null}})(),d=(()=>{try{if(!i.recommendations)return[];const p=typeof i.recommendations=="string"?JSON.parse(i.recommendations):i.recommendations;return Array.isArray(p)?p.slice(0,3):[]}catch{return[]}})();return e.jsxs(me,{"data-testid":`card-audit-report-${i.id||o}`,children:[e.jsx(Re,{className:"py-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-2 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:r(i.auditType||"unknown"),children:n(i.auditType||"unknown")}),i.chapterRange&&i.chapterRange!=="all"&&e.jsxs(Q,{variant:"outline",children:["Caps. ",i.chapterRange]})]}),i.score!==void 0&&i.score!==null&&e.jsx(qc,{score:i.score})]})}),e.jsxs(he,{className:"py-2",children:[c&&e.jsx("p",{className:"text-sm mb-2",children:c}),d.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Recomendaciones:"}),e.jsx("ul",{className:"text-sm list-disc list-inside space-y-1",children:d.map((p,m)=>e.jsx("li",{className:"text-muted-foreground",children:typeof p=="string"?p:p?.descripcion||p?.description||JSON.stringify(p)},m))})]})]})]},i.id||o)})})}function dq(){const{toast:t}=nn(),[n,r]=x.useState(null),[s,i]=x.useState(""),[o,c]=x.useState("es"),[d,p]=x.useState(null),[m,h]=x.useState(!1),[g,v]=x.useState(!1),[j,N]=x.useState(!1),[b,C]=x.useState(2e3),[S,k]=x.useState(""),[P,R]=x.useState(!1),[E,A]=x.useState(!1),[W,X]=x.useState(!1),[se,V]=x.useState(2e3),[G,O]=x.useState(""),[F,U]=x.useState(!1),[$,q]=x.useState(!1),[le,K]=x.useState(""),[J,D]=x.useState(null),[I,re]=x.useState(!1),[T,Y]=x.useState(null),[oe,Ne]=x.useState(!1),[xe,Se]=x.useState(""),[Oe,Pe]=x.useState(""),[Be,ve]=x.useState(""),[We,Ye]=x.useState(""),{data:Qe=[],isLoading:mt}=Ke({queryKey:["/api/reedit-projects"],refetchInterval:5e3}),{data:ht=[]}=Ke({queryKey:["/api/reedit-projects",n,"chapters"],enabled:!!n,refetchInterval:3e3}),{data:cn}=Ke({queryKey:["/api/reedit-projects",n,"world-bible"],enabled:!!n,refetchInterval:1e4}),{data:Jt=[]}=Ke({queryKey:["/api/reedit-projects",n,"audit-reports"],enabled:!!n,refetchInterval:5e3}),{data:Vt=[]}=Ke({queryKey:["/api/reedit-projects",n,"issues"],enabled:!!n,refetchInterval:3e3}),{data:tt}=Ke({queryKey:["/api/reedit-projects",n,"issues","summary"],enabled:!!n,refetchInterval:5e3}),L=Qe.find(H=>H.id===n),de=ye({mutationFn:async H=>{const Nt=await fetch("/api/reedit-projects",{method:"POST",body:H});if(!Nt.ok){const zn=await Nt.json();throw new Error(zn.error||"Error al subir")}return Nt.json()},onSuccess:H=>{t({title:"Manuscrito Subido",description:`Proyecto "${H.title}" creado exitosamente. ${H.chaptersDetected||1} captulo(s) detectado(s).`}),ae.invalidateQueries({queryKey:["/api/reedit-projects"]}),i(""),p(null),r(H.projectId)},onError:H=>{t({title:"Error de Subida",description:H.message,variant:"destructive"})}}),ge=ye({mutationFn:async H=>je("POST",`/api/reedit-projects/${H}/start`),onSuccess:()=>{t({title:"Procesamiento Iniciado",description:"El manuscrito est siendo reeditado"}),ae.invalidateQueries({queryKey:["/api/reedit-projects"]})},onError:H=>{t({title:"Error",description:H.message,variant:"destructive"})}}),ze=ye({mutationFn:async({projectId:H,settingContext:Nt})=>(await je("PATCH",`/api/reedit-projects/${H}`,{settingContext:Nt}),await je("POST",`/api/reedit-projects/${H}/analyze-structure`,{})),onMutate:()=>{D({stage:"analyzing",message:"Iniciando anlisis estructural..."})},onSuccess:()=>{D(null),t({title:"Anlisis Completado",description:"El anlisis estructural ha sido completado. Revisa el plan de reconstruccin."}),ae.invalidateQueries({queryKey:["/api/reedit-projects"]}),q(!1),re(!0)},onError:H=>{D(null),t({title:"Error",description:H.message,variant:"destructive"})}}),M=ye({mutationFn:async({projectId:H,modifiedPlan:Nt})=>je("POST",`/api/reedit-projects/${H}/approve-plan`,{modifiedPlan:Nt}),onSuccess:()=>{t({title:"Plan Aprobado",description:"El plan de reconstruccin ha sido aprobado."}),ae.invalidateQueries({queryKey:["/api/reedit-projects"]}),re(!1)},onError:H=>{t({title:"Error",description:H.message,variant:"destructive"})}}),ie=ye({mutationFn:async H=>je("POST",`/api/reedit-projects/${H}/execute-plan`),onSuccess:()=>{t({title:"Ejecucin Iniciada",description:"El plan est siendo ejecutado."}),ae.invalidateQueries({queryKey:["/api/reedit-projects"]})},onError:H=>{t({title:"Error",description:H.message,variant:"destructive"})}}),we=ye({mutationFn:async H=>je("POST",`/api/reedit-projects/${H}/cancel`),onSuccess:()=>{t({title:"Cancelado",description:"El procesamiento ha sido cancelado"}),ae.invalidateQueries({queryKey:["/api/reedit-projects"]})}}),qe=ye({mutationFn:async H=>je("POST",`/api/reedit-projects/${H}/force-unlock`),onSuccess:()=>{t({title:"Desbloqueado",description:"El proyecto ha sido desbloqueado. Ahora puedes continuar o reiniciar."}),ae.invalidateQueries({queryKey:["/api/reedit-projects"]})},onError:H=>{t({title:"Error",description:H.message,variant:"destructive"})}}),Ze=ye({mutationFn:async({projectId:H,instructions:Nt})=>je("POST",`/api/reedit-projects/${H}/resume`,{instructions:Nt}),onSuccess:()=>{t({title:"Procesamiento Reanudado",description:"El manuscrito contina siendo reeditado"}),ae.invalidateQueries({queryKey:["/api/reedit-projects"]}),O("")},onError:H=>{t({title:"Error",description:H.message,variant:"destructive"})}}),Rt=ye({mutationFn:async H=>je("POST",`/api/reedit-issues/${H}/approve`),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/reedit-projects",n,"issues"]}),ae.invalidateQueries({queryKey:["/api/reedit-projects",n,"issues","summary"]})},onError:H=>{t({title:"Error",description:H.message,variant:"destructive"})}}),en=ye({mutationFn:async({issueId:H,reason:Nt})=>je("POST",`/api/reedit-issues/${H}/reject`,{reason:Nt}),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/reedit-projects",n,"issues"]}),ae.invalidateQueries({queryKey:["/api/reedit-projects",n,"issues","summary"]})},onError:H=>{t({title:"Error",description:H.message,variant:"destructive"})}}),Lt=ye({mutationFn:async H=>je("POST",`/api/reedit-projects/${H}/issues/approve-all`),onSuccess:()=>{t({title:"Todos Aprobados",description:"Todos los problemas han sido aprobados para correccin"}),ae.invalidateQueries({queryKey:["/api/reedit-projects",n,"issues"]}),ae.invalidateQueries({queryKey:["/api/reedit-projects",n,"issues","summary"]})},onError:H=>{t({title:"Error",description:H.message,variant:"destructive"})}}),An=ye({mutationFn:async H=>je("POST",`/api/reedit-projects/${H}/issues/reject-all`,{reason:"Bulk rejected by user"}),onSuccess:()=>{t({title:"Todos Rechazados",description:"Todos los problemas han sido ignorados"}),ae.invalidateQueries({queryKey:["/api/reedit-projects",n,"issues"]}),ae.invalidateQueries({queryKey:["/api/reedit-projects",n,"issues","summary"]})},onError:H=>{t({title:"Error",description:H.message,variant:"destructive"})}}),Hn=ye({mutationFn:async H=>je("POST",`/api/reedit-projects/${H}/proceed-corrections`),onSuccess:H=>{t({title:"Correcciones Iniciadas",description:`Procediendo con ${H.approvedCount||0} correcciones aprobadas`}),ae.invalidateQueries({queryKey:["/api/reedit-projects"]})},onError:H=>{t({title:"Error",description:H.message,variant:"destructive"})}}),tn=ye({mutationFn:async H=>je("DELETE",`/api/reedit-projects/${H}`),onSuccess:()=>{t({title:"Eliminado",description:"El proyecto ha sido eliminado"}),ae.invalidateQueries({queryKey:["/api/reedit-projects"]}),n&&r(null)}}),Sn=ye({mutationFn:async H=>je("POST",`/api/reedit-projects/${H.projectId}/restart`,{expandChapters:H.expandChapters,insertNewChapters:H.insertNewChapters,targetMinWordsPerChapter:H.targetMinWordsPerChapter}),onSuccess:()=>{t({title:"Proyecto Reiniciado",description:"El proyecto usar la versin editada como base para la nueva reedicin."}),ae.invalidateQueries({queryKey:["/api/reedit-projects"]}),R(!1)},onError:H=>{t({title:"Error",description:H.message,variant:"destructive"})}}),hn=ye({mutationFn:async H=>(await je("POST",`/api/reedit-projects/${H}/normalize-titles`)).json(),onSuccess:H=>{t({title:"Ttulos Normalizados",description:`Se actualizaron ${H.chaptersUpdated} de ${H.totalChapters} captulos.`}),ae.invalidateQueries({queryKey:["/api/reedit-projects",n,"chapters"]})},onError:H=>{t({title:"Error",description:H.message,variant:"destructive"})}}),Jr=x.useCallback(()=>{L&&Sn.mutate({projectId:L.id,expandChapters:E,insertNewChapters:W,targetMinWordsPerChapter:se})},[L,E,W,se,Sn]),Ts=x.useCallback(()=>{L&&(A(L.expandChapters||!1),X(L.insertNewChapters||!1),V(L.targetMinWordsPerChapter||2e3),R(!0))},[L]),ir=ye({mutationFn:async H=>je("POST",`/api/reedit-projects/${H.projectId}/custom-polishing`,{chapterRange:H.chapterRange,diagnosis:H.diagnosis,procedure:H.procedure,objective:H.objective}),onSuccess:()=>{t({title:"Pulido Iniciado",description:"El proceso de pulido personalizado ha comenzado."}),ae.invalidateQueries({queryKey:["/api/reedit-projects"]}),Ne(!1),Se(""),Pe(""),ve(""),Ye("")},onError:H=>{t({title:"Error",description:H.message,variant:"destructive"})}}),$r=x.useCallback(()=>{Se(""),Pe(""),ve(""),Ye(""),Ne(!0)},[]),ba=x.useCallback(()=>{if(L){if(!xe.trim()){t({title:"Campo Requerido",description:"Por favor indica el rango de captulos",variant:"destructive"});return}ir.mutate({projectId:L.id,chapterRange:xe.trim(),diagnosis:Oe.trim(),procedure:Be.trim(),objective:We.trim()})}},[L,xe,Oe,Be,We,ir]),Rs=x.useCallback(H=>{const Nt=H.target.files?.[0];Nt&&(p(Nt),s||i(Nt.name.replace(/\.(docx|doc)$/i,"")))},[s]),te=x.useCallback(async()=>{if(!d||!s.trim()){t({title:"Informacin Faltante",description:"Por favor proporciona un ttulo y un archivo",variant:"destructive"});return}h(!0);const H=new FormData;H.append("manuscript",d),H.append("title",s.trim()),H.append("language",o),H.append("expandChapters",g.toString()),H.append("insertNewChapters",j.toString()),H.append("targetMinWordsPerChapter",b.toString()),S.trim()&&H.append("instructions",S.trim());try{await de.mutateAsync(H),k("")}finally{h(!1)}},[d,s,o,g,j,b,S,de,t]);x.useEffect(()=>{!n&&Qe.length>0&&r(Qe[0].id)},[Qe,n]);const Ee=L?(L.processedChapters||0)/Math.max(L.totalChapters||1,1)*100:0;return e.jsxs("div",{className:"container mx-auto p-4 max-w-7xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Reedicin de Manuscritos"}),e.jsx("p",{className:"text-muted-foreground",children:"Sube manuscritos existentes para una edicin completa con IA a travs de Editor, Corrector de Estilo, Auditores QA y Revisor Final."})]}),e.jsxs("div",{className:`grid grid-cols-1 gap-6 ${F?"lg:grid-cols-4":"lg:grid-cols-3"}`,children:[e.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[e.jsxs(me,{children:[e.jsxs(Re,{children:[e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(ha,{className:"h-5 w-5"}),"Subir Manuscrito"]}),e.jsx(At,{children:"Sube un documento Word (.docx) para reedicin"})]}),e.jsxs(he,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(st,{htmlFor:"reedit-title",children:"Ttulo"}),e.jsx(gt,{id:"reedit-title","data-testid":"input-reedit-title",value:s,onChange:H=>i(H.target.value),placeholder:"Ttulo del manuscrito"})]}),e.jsxs("div",{children:[e.jsx(st,{htmlFor:"reedit-language",children:"Idioma"}),e.jsxs(Pt,{value:o,onValueChange:c,children:[e.jsx(St,{"data-testid":"select-reedit-language",children:e.jsx(Tt,{placeholder:"Seleccionar idioma"})}),e.jsx(kt,{children:gP.map(H=>e.jsx(ce,{value:H.code,children:H.name},H.code))})]})]}),e.jsxs("div",{className:"space-y-3 pt-2 border-t",children:[e.jsx("p",{className:"text-sm font-medium",children:"Opciones de Expansin"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(st,{htmlFor:"expand-chapters",className:"text-sm cursor-pointer",children:"Expandir captulos cortos"}),e.jsx(hr,{id:"expand-chapters","data-testid":"switch-expand-chapters",checked:g,onCheckedChange:v})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(st,{htmlFor:"insert-chapters",className:"text-sm cursor-pointer",children:"Insertar nuevos captulos"}),e.jsx(hr,{id:"insert-chapters","data-testid":"switch-insert-chapters",checked:j,onCheckedChange:N})]}),(g||j)&&e.jsxs("div",{children:[e.jsx(st,{htmlFor:"target-words",className:"text-sm",children:"Palabras mnimas por captulo"}),e.jsx(gt,{id:"target-words",type:"number","data-testid":"input-target-words",value:b,onChange:H=>C(parseInt(H.target.value)||2e3),min:500,max:5e3,step:100,className:"mt-1"})]})]}),e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsx(st,{htmlFor:"upload-instructions",className:"text-sm font-medium",children:"Instrucciones para la reedicin (opcional)"}),e.jsx("textarea",{id:"upload-instructions","data-testid":"textarea-upload-instructions",value:S,onChange:H=>k(H.target.value),placeholder:"Instrucciones especficas para guiar la reedicin: cambios de tono, aspectos a mejorar, elementos a preservar...",className:"w-full min-h-[80px] p-2 text-sm border rounded-md bg-background resize-y",rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Estas instrucciones guiarn a los agentes de IA durante todo el proceso de reedicin."})]}),e.jsxs("div",{children:[e.jsx(st,{htmlFor:"reedit-file",children:"Archivo"}),e.jsx(gt,{id:"reedit-file",type:"file","data-testid":"input-reedit-file",accept:".docx,.doc",onChange:Rs}),d&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[d.name," (",(d.size/1024).toFixed(1)," KB)"]})]}),e.jsxs(B,{onClick:te,disabled:!d||!s.trim()||m,className:"w-full","data-testid":"button-upload-reedit",children:[m?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(ha,{className:"h-4 w-4 mr-2"}),"Subir y Crear Proyecto"]})]})]}),e.jsxs(me,{children:[e.jsx(Re,{children:e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(yt,{className:"h-5 w-5"}),"Proyectos"]})}),e.jsx(he,{children:mt?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(be,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):Qe.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Sin proyectos an. Sube un manuscrito para comenzar."}):e.jsx("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:Qe.map(H=>e.jsxs("div",{"data-testid":`card-reedit-project-${H.id}`,className:`p-3 rounded-md cursor-pointer transition-colors ${n===H.id?"bg-accent":"hover-elevate"}`,onClick:()=>r(H.id),children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium truncate",children:H.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[Vw(H.detectedLanguage),"  ",H.totalWordCount?.toLocaleString()||0," palabras"]})]}),Hf(H.status)]}),H.status==="processing"&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground mb-1",children:[e.jsx("span",{children:qw(H.currentStage)}),e.jsxs("span",{children:[H.processedChapters,"/",H.totalChapters]})]}),e.jsx(di,{value:(H.processedChapters||0)/Math.max(H.totalChapters||1,1)*100,className:"h-1"})]}),H.bestsellerScore&&e.jsx("div",{className:"mt-2",children:e.jsx(qc,{score:H.bestsellerScore})})]},H.id))})})]})]}),e.jsx("div",{className:"lg:col-span-2",children:L?e.jsxs(me,{children:[e.jsx(Re,{children:e.jsxs("div",{className:"flex items-start justify-between gap-4 flex-wrap",children:[e.jsxs("div",{children:[e.jsx(Ie,{children:L.title}),e.jsxs(At,{children:[Vw(L.detectedLanguage),"  ",L.totalWordCount?.toLocaleString()||0," palabras  ",L.totalChapters||0," captulos"]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[Hf(L.status),L.status==="pending"&&e.jsxs(B,{onClick:()=>ge.mutate(L.id),disabled:ge.isPending,"data-testid":"button-start-reedit",children:[ge.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Yn,{className:"h-4 w-4 mr-2"}),"Iniciar Reedicin"]}),L.status==="processing"&&e.jsxs(e.Fragment,{children:[e.jsxs(B,{variant:"destructive",onClick:()=>we.mutate(L.id),disabled:we.isPending,"data-testid":"button-cancel-reedit",children:[we.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(lf,{className:"h-4 w-4 mr-2"}),"Cancelar"]}),e.jsxs(B,{variant:"outline",onClick:()=>qe.mutate(L.id),disabled:qe.isPending,"data-testid":"button-force-unlock",children:[qe.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(TA,{className:"h-4 w-4 mr-2"}),"Desbloquear"]})]}),(L.status==="error"||L.status==="paused")&&e.jsxs(B,{onClick:()=>Ze.mutate({projectId:L.id}),disabled:Ze.isPending,"data-testid":"button-resume-reedit",children:[Ze.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Yn,{className:"h-4 w-4 mr-2"}),"Continuar"]}),L.status==="awaiting_instructions"&&e.jsxs(e.Fragment,{children:[e.jsxs(B,{onClick:()=>Ze.mutate({projectId:L.id,instructions:G}),disabled:Ze.isPending,"data-testid":"button-resume-with-instructions",children:[Ze.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Yn,{className:"h-4 w-4 mr-2"}),"Continuar con Instrucciones"]}),e.jsxs(B,{variant:"destructive",onClick:()=>we.mutate(L.id),disabled:we.isPending,"data-testid":"button-cancel-awaiting",children:[we.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(lf,{className:"h-4 w-4 mr-2"}),"Cancelar"]})]}),L.status==="awaiting_issue_approval"&&e.jsxs(B,{variant:"destructive",onClick:()=>we.mutate(L.id),disabled:we.isPending,"data-testid":"button-cancel-issues",children:[we.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(lf,{className:"h-4 w-4 mr-2"}),"Cancelar Proceso"]}),L.status==="completed"&&e.jsxs(e.Fragment,{children:[e.jsxs(B,{variant:"outline",onClick:Ts,"data-testid":"button-restart-reedit",children:[e.jsx(Ho,{className:"h-4 w-4 mr-2"}),"Reeditar de Nuevo"]}),e.jsxs(B,{variant:"outline",onClick:$r,"data-testid":"button-custom-polishing",children:[e.jsx(da,{className:"h-4 w-4 mr-2"}),"Pulido Manual"]})]}),e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>tn.mutate(L.id),disabled:tn.isPending||L.status==="processing","data-testid":"button-delete-reedit",children:e.jsx(Rn,{className:"h-4 w-4"})}),e.jsxs(B,{variant:F?"secondary":"outline",onClick:()=>U(!F),"data-testid":"button-toggle-chat-reedit",children:[e.jsx($i,{className:"h-4 w-4 mr-2"}),F?"Cerrar Chat":"Reeditor IA"]})]})]})}),e.jsx(he,{children:e.jsxs(ci,{defaultValue:"live-report",children:[e.jsxs(ga,{className:"flex-wrap h-auto",children:[e.jsx(Bt,{value:"live-report","data-testid":"tab-trigger-live-report",children:"Informe Progreso"}),e.jsx(Bt,{value:"progress","data-testid":"tab-trigger-progress",children:"Estado"}),e.jsx(Bt,{value:"chapters","data-testid":"tab-trigger-chapters",children:"Captulos"}),e.jsx(Bt,{value:"worldbible","data-testid":"tab-trigger-worldbible",children:"Biblia del Mundo"}),e.jsx(Bt,{value:"structural","data-testid":"tab-trigger-structural",children:"Anlisis Estructural"}),e.jsx(Bt,{value:"audits","data-testid":"tab-trigger-audits",children:"Auditoras QA"}),e.jsx(Bt,{value:"report","data-testid":"tab-trigger-report",children:"Informe Final"}),e.jsx(Bt,{value:"quality-report","data-testid":"tab-trigger-quality-report",children:"Informe Calidad"})]}),e.jsx(Gt,{value:"live-report",children:e.jsx(jt,{className:"h-[500px] mt-4 pr-4",children:ht.length>0?e.jsx(oq,{project:L,chapters:ht}):e.jsxs("div",{className:"text-center text-muted-foreground py-12",children:[e.jsx(yt,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"El informe de progreso aparecer cuando se carguen los captulos"})]})})}),e.jsxs(Gt,{value:"progress",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[e.jsx(me,{children:e.jsx(he,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Etapa Actual"}),e.jsx(Q,{variant:"outline",className:"text-lg px-4 py-1",children:qw(L.currentStage)})]})})}),e.jsx(me,{children:e.jsx(he,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Progreso"}),e.jsxs("p",{className:"text-2xl font-bold",children:[L.processedChapters||0,"/",L.totalChapters||0]})]})})})]}),L.status==="processing"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[e.jsx("span",{children:"Procesando manuscrito..."}),e.jsxs("span",{children:[Math.round(Ee),"%"]})]}),e.jsx(di,{value:Ee}),e.jsx(me,{className:"border-blue-500/50 bg-blue-50/50 dark:bg-blue-950/20","data-testid":"card-current-activity",children:e.jsx(he,{className:"py-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 p-2 bg-blue-100 dark:bg-blue-900/50 rounded-full",children:e.jsx(be,{className:"h-5 w-5 animate-spin text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[e.jsxs(Q,{variant:"outline",className:"bg-slate-100 text-slate-700 dark:bg-slate-800 dark:text-slate-300","data-testid":"badge-revision-cycle",children:[e.jsx(Ns,{className:"h-3 w-3 mr-1"}),"Ciclo ",(L.revisionCycle||0)+1]}),L.currentChapter&&L.currentChapter>0?e.jsxs(Q,{variant:"secondary",className:"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-300",children:[e.jsx(da,{className:"h-3 w-3 mr-1"}),"Reescribiendo Capitulo ",L.currentChapter]}):L.currentStage==="reviewing"?e.jsxs(Q,{variant:"secondary",className:"bg-purple-100 text-purple-700 dark:bg-purple-900/50 dark:text-purple-300",children:[e.jsx(Wu,{className:"h-3 w-3 mr-1"}),"Revision Final"]}):null]}),e.jsx("p",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:L.currentActivity||"Procesando..."})]})]})})})]}),L.status==="awaiting_instructions"&&e.jsx(me,{className:"border-amber-500/50 bg-amber-50/50 dark:bg-amber-950/20",children:e.jsxs(he,{className:"pt-6 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(on,{className:"h-5 w-5 text-amber-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-amber-800 dark:text-amber-200",children:"Pausa Automtica - Instrucciones Requeridas"}),e.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-300 mt-1",children:L.pauseReason||"El sistema ha pausado despus de 15 evaluaciones sin alcanzar la puntuacin perfecta (10/10)."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Instrucciones para el agente (opcional):"}),e.jsx("textarea",{className:"w-full min-h-[100px] p-3 border rounded-md bg-background resize-y",placeholder:"Ej: Enfcate en mejorar el ritmo narrativo de los captulos 5-8. El tono debera ser ms oscuro...",value:G,onChange:H=>O(H.target.value),"data-testid":"input-user-instructions"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Estas instrucciones se pasarn al agente en el prximo ciclo de correccin."})]})]})}),L.status==="awaiting_issue_approval"&&e.jsx(me,{className:"border-orange-500/50 bg-orange-50/50 dark:bg-orange-950/20",children:e.jsxs(he,{className:"pt-6 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Dr,{className:"h-5 w-5 text-orange-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-orange-800 dark:text-orange-200",children:"Revisin de Problemas Detectados"}),e.jsx("p",{className:"text-sm text-orange-700 dark:text-orange-300 mt-1",children:L.pauseReason||"Se han detectado problemas que requieren tu aprobacin antes de corregirlos automticamente."})]})]}),tt&&e.jsxs("div",{className:"grid grid-cols-4 gap-2 text-center",children:[e.jsxs("div",{className:"p-2 bg-orange-100 dark:bg-orange-900/30 rounded-md",children:[e.jsx("p",{className:"text-lg font-bold text-orange-700 dark:text-orange-300",children:tt.pending||0}),e.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400",children:"Pendientes"})]}),e.jsxs("div",{className:"p-2 bg-green-100 dark:bg-green-900/30 rounded-md",children:[e.jsx("p",{className:"text-lg font-bold text-green-700 dark:text-green-300",children:tt.approved||0}),e.jsx("p",{className:"text-xs text-green-600 dark:text-green-400",children:"Aprobados"})]}),e.jsxs("div",{className:"p-2 bg-gray-100 dark:bg-gray-800 rounded-md",children:[e.jsx("p",{className:"text-lg font-bold text-gray-700 dark:text-gray-300",children:tt.rejected||0}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Rechazados"})]}),e.jsxs("div",{className:"p-2 bg-red-100 dark:bg-red-900/30 rounded-md",children:[e.jsx("p",{className:"text-lg font-bold text-red-700 dark:text-red-300",children:tt.bySeverity?.critical||0}),e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400",children:"Crticos"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs(B,{size:"sm",variant:"outline",onClick:()=>L&&Lt.mutate(L.id),disabled:Lt.isPending||(tt?.pending||0)===0,"data-testid":"button-approve-all-issues",children:[e.jsx(Xt,{className:"h-4 w-4 mr-1"}),"Aprobar Todos"]}),e.jsxs(B,{size:"sm",variant:"ghost",onClick:()=>L&&An.mutate(L.id),disabled:An.isPending||(tt?.pending||0)===0,"data-testid":"button-reject-all-issues",children:[e.jsx(Hs,{className:"h-4 w-4 mr-1"}),"Ignorar Todos"]})]}),e.jsx(jt,{className:"h-[300px] border rounded-md p-2",children:e.jsxs("div",{className:"space-y-2",children:[Vt.filter(H=>H.status==="pending").map(H=>e.jsx("div",{className:`p-3 border rounded-md ${H.severity==="critical"?"border-red-400 bg-red-50 dark:bg-red-950/30":H.severity==="major"?"border-orange-400 bg-orange-50 dark:bg-orange-950/30":"border-gray-300 bg-gray-50 dark:bg-gray-900/30"}`,"data-testid":`issue-card-${H.id}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx(Q,{variant:H.severity==="critical"?"destructive":H.severity==="major"?"default":"secondary",children:H.severity==="critical"?"Crtico":H.severity==="major"?"Mayor":"Menor"}),e.jsx(Q,{variant:"outline",children:H.category}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Cap. ",H.chapterNumber]})]}),e.jsx("p",{className:"text-sm",children:H.description}),H.correctionInstruction&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1 italic",children:["Correccin: ",H.correctionInstruction.substring(0,150),"..."]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(B,{size:"icon",variant:"ghost",className:"h-7 w-7 text-green-600 hover:bg-green-100",onClick:()=>Rt.mutate(H.id),disabled:Rt.isPending,"data-testid":`button-approve-issue-${H.id}`,children:e.jsx(Tn,{className:"h-4 w-4"})}),e.jsx(B,{size:"icon",variant:"ghost",className:"h-7 w-7 text-red-600 hover:bg-red-100",onClick:()=>en.mutate({issueId:H.id}),disabled:en.isPending,"data-testid":`button-reject-issue-${H.id}`,children:e.jsx(Gn,{className:"h-4 w-4"})})]})]})},H.id)),Vt.filter(H=>H.status==="resolved").length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-dashed",children:[e.jsxs("p",{className:"text-xs text-muted-foreground mb-2 flex items-center gap-1",children:[e.jsx(Xt,{className:"h-3 w-3 text-green-600"}),"Problemas corregidos (",Vt.filter(H=>H.status==="resolved").length,")"]}),Vt.filter(H=>H.status==="resolved").map(H=>e.jsx("div",{className:"p-2 border rounded-md border-green-200 bg-green-50/50 dark:bg-green-950/20 mb-1 opacity-60","data-testid":`issue-card-resolved-${H.id}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xt,{className:"h-4 w-4 text-green-600 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(Q,{variant:"outline",className:"text-xs opacity-70",children:H.category}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Cap. ",H.chapterNumber]})]}),e.jsx("p",{className:"text-sm line-through text-muted-foreground",children:H.description})]})]})},H.id))]}),Vt.filter(H=>H.status==="pending").length===0&&Vt.filter(H=>H.status==="resolved").length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Xt,{className:"h-8 w-8 mx-auto mb-2 text-green-600"}),e.jsx("p",{children:"Todos los problemas han sido revisados"})]})]})}),(tt?.pending||0)===0&&e.jsxs(B,{className:"w-full",onClick:()=>L&&Hn.mutate(L.id),disabled:Hn.isPending,"data-testid":"button-proceed-corrections",children:[Hn.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Yn,{className:"h-4 w-4 mr-2"}),(tt?.approved||0)>0?`Proceder con ${tt?.approved||0} Correcciones`:"Finalizar sin Correcciones"]})]})}),e.jsx(nq,{projectId:L.id,isProcessing:L.status==="processing"}),Vt.filter(H=>H.status==="resolved").length>0&&e.jsxs(me,{children:[e.jsx(Re,{className:"pb-2",children:e.jsxs(Ie,{className:"text-base flex items-center gap-2",children:[e.jsx(Xt,{className:"h-4 w-4 text-green-600"}),"Correcciones Aplicadas (",Vt.filter(H=>H.status==="resolved").length,")"]})}),e.jsx(he,{children:e.jsx(jt,{className:"h-[200px]",children:e.jsx("div",{className:"space-y-1",children:Vt.filter(H=>H.status==="resolved").map(H=>e.jsx("div",{className:"p-2 border rounded-md border-green-200 bg-green-50/50 dark:bg-green-950/20","data-testid":`resolved-issue-${H.id}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xt,{className:"h-4 w-4 text-green-600 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(Q,{variant:"outline",className:"text-xs",children:H.category}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Cap. ",H.chapterNumber]})]}),e.jsx("p",{className:"text-sm line-through text-muted-foreground",children:H.description})]})]})},H.id))})})})]}),L.bestsellerScore&&e.jsx(me,{className:"bg-muted/50",children:e.jsx(he,{className:"pt-6",children:e.jsx("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Puntuacin Bestseller"}),e.jsx(qc,{score:L.bestsellerScore})]})})})}),L.structureAnalysis!=null&&e.jsxs(me,{children:[e.jsx(Re,{children:e.jsx(Ie,{className:"text-base",children:"Anlisis de Estructura"})}),e.jsx(he,{children:e.jsx(rq,{analysis:L.structureAnalysis})})]})]}),e.jsx(Gt,{value:"chapters",children:e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4 flex-wrap",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[ht.length," captulos  ",ht.filter(H=>H.editedContent).length," reeditados"]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>L&&hn.mutate(L.id),disabled:hn.isPending||ht.length===0,"data-testid":"button-normalize-reedit-titles",children:[hn.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(da,{className:"h-4 w-4 mr-2"}),"Normalizar Ttulos"]})]}),ht.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"An no se han parseado captulos"}):T?(()=>{const H=ht.find(zn=>zn.id===T);if(!H)return null;const Nt=H.editedContent||H.originalContent||"";return e.jsxs("div",{className:"flex flex-col h-[400px]",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 pb-3 border-b mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(B,{variant:"ghost",size:"sm",onClick:()=>Y(null),"data-testid":"button-back-to-list",children:[e.jsx(Wc,{className:"h-4 w-4 rotate-180"}),"Volver"]}),e.jsx(Q,{variant:"outline",children:rl(H.chapterNumber)}),e.jsx("span",{className:"font-medium font-serif",children:yp(H.chapterNumber,H.title)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Q,{variant:"secondary",children:[Nt.split(/\s+/).filter(zn=>zn.length>0).length.toLocaleString()," palabras"]}),H.editedContent&&e.jsx(Q,{className:"bg-green-500/20 text-green-600",children:"Reeditado"})]})]}),e.jsx(jt,{className:"flex-1",children:e.jsx("article",{className:"prose prose-lg dark:prose-invert max-w-prose mx-auto leading-7 font-serif text-sm",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:Nt.replace(/\n\n/g,"</p><p>").replace(/\n/g,"<br />").replace(/^/,"<p>").replace(/$/,"</p>")}})})})]})})():e.jsx(jt,{className:"h-[400px]",children:e.jsx("div",{className:"space-y-2",children:ht.map(H=>{const zn=(L.chaptersBeingRewritten||[]).includes(H.chapterNumber),Xn=L.currentChapter===H.chapterNumber;return e.jsxs("div",{"data-testid":`card-reedit-chapter-${H.id}`,className:`p-3 border rounded-md hover-elevate cursor-pointer ${zn?"border-amber-500/50 bg-amber-50/30 dark:bg-amber-950/20":""} ${Xn?"border-blue-500 bg-blue-50/50 dark:bg-blue-950/30":""}`,onClick:()=>(H.editedContent||H.originalContent)&&Y(H.id),children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{variant:"outline",children:rl(H.chapterNumber)}),e.jsx("span",{className:"font-medium",children:yp(H.chapterNumber,H.title)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[Xn&&L.status==="processing"&&e.jsxs(Q,{className:"bg-blue-500/20 text-blue-600 dark:text-blue-400 animate-pulse",children:[e.jsx(da,{className:"h-3 w-3 mr-1 animate-spin"}),"Reescribiendo"]}),zn&&!Xn&&L.status==="processing"&&e.jsxs(Q,{variant:"outline",className:"border-amber-500 text-amber-600 dark:text-amber-400",children:[e.jsx(Cn,{className:"h-3 w-3 mr-1"}),"Pendiente"]}),H.editorScore&&e.jsxs(Q,{variant:"secondary",children:["Editor: ",H.editorScore,"/10"]}),H.editedContent&&!zn&&!Xn&&e.jsxs(Q,{className:"bg-green-500/20 text-green-600",children:[e.jsx(Xt,{className:"h-3 w-3 mr-1"}),"Reeditado"]}),Hf(H.status),(H.editedContent||H.originalContent)&&e.jsx(fr,{className:"h-4 w-4 text-muted-foreground"})]})]}),(H.editedContent||H.originalContent)&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:[(H.editedContent||H.originalContent||"").split(/\s+/).filter(wa=>wa.length>0).length.toLocaleString()," palabras",H.copyeditorChanges&&e.jsxs("span",{className:"ml-2",children:[" ",H.copyeditorChanges.substring(0,80),"..."]})]})]},H.id)})})})]})}),e.jsx(Gt,{value:"worldbible",children:e.jsx(jt,{className:"h-[400px] mt-4",children:cn?e.jsxs(me,{children:[e.jsxs(Re,{children:[e.jsx(Ie,{className:"text-base",children:"Biblia del Mundo Narrativo"}),e.jsx(At,{children:"Personajes, ubicaciones, lnea temporal y reglas extradas del manuscrito"})]}),e.jsx(he,{children:e.jsx(aq,{worldBible:cn})})]}):e.jsxs("div",{className:"text-center text-muted-foreground py-12",children:[e.jsx(yt,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"La Biblia del Mundo se generar durante el procesamiento"})]})})}),e.jsx(Gt,{value:"structural",children:e.jsx(jt,{className:"h-[500px] mt-4",children:e.jsxs("div",{className:"space-y-4",children:[L.currentStage==="plan_ready"&&!L.planApproved&&e.jsx(me,{className:"border-2 border-amber-500/50 bg-amber-500/5",children:e.jsxs(he,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(on,{className:"h-5 w-5 text-amber-500"}),e.jsx("span",{className:"font-semibold",children:"Plan de Reconstruccin Listo"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"El anlisis estructural ha generado un plan de reconstruccin. Revsalo y aprubalo para continuar."}),e.jsxs(B,{onClick:()=>re(!0),"data-testid":"button-review-plan",children:[e.jsx(fr,{className:"h-4 w-4 mr-2"}),"Revisar Plan"]})]})}),L.planApproved&&e.jsx(me,{className:"border-2 border-green-500/50 bg-green-500/5",children:e.jsxs(he,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Xt,{className:"h-5 w-5 text-green-500"}),e.jsx("span",{className:"font-semibold",children:"Plan Aprobado"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"El plan de reconstruccin ha sido aprobado y est listo para ejecutarse."}),L.status==="pending"&&e.jsxs(B,{onClick:()=>ie.mutate(L.id),disabled:ie.isPending,className:"mt-4","data-testid":"button-execute-plan",children:[ie.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Yn,{className:"h-4 w-4 mr-2"}),"Ejecutar Plan"]})]})}),L.structuralReport&&e.jsxs(me,{children:[e.jsx(Re,{children:e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(yt,{className:"h-5 w-5 text-primary"}),"Informe Estructural (LitEditors 3.0)"]})}),e.jsx(he,{children:e.jsx(iq,{report:L.structuralReport})})]}),!L.structuralReport&&L.status==="pending"&&e.jsx(me,{children:e.jsx(he,{className:"pt-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(yt,{className:"h-12 w-12 mx-auto opacity-50"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Anlisis Estructural Avanzado"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Ejecuta un anlisis profundo para detectar huecos en la trama, redundancias, problemas de ritmo y anacronismos."})]}),e.jsxs(B,{onClick:()=>q(!0),"data-testid":"button-start-structural-analysis",children:[e.jsx(us,{className:"h-4 w-4 mr-2"}),"Iniciar Anlisis Estructural"]})]})})}),J&&e.jsx(me,{className:"border-2 border-primary/50",children:e.jsx(he,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-5 w-5 animate-spin text-primary"}),e.jsx("span",{className:"font-medium",children:J.message})]})})})]})})}),e.jsx(Gt,{value:"audits",children:e.jsx(jt,{className:"h-[400px] mt-4",children:Jt.length>0?e.jsx(cq,{reports:Jt}):e.jsxs("div",{className:"text-center text-muted-foreground py-12",children:[e.jsx(yt,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Los informes de auditora se generarn durante el procesamiento"})]})})}),e.jsx(Gt,{value:"report",children:L.finalReviewResult?e.jsxs(me,{className:"mt-4",children:[e.jsx(Re,{children:e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(Wu,{className:"h-5 w-5 text-yellow-500"}),"Resultados de la Revisin Final"]})}),e.jsxs(he,{children:[e.jsx(sq,{result:L.finalReviewResult}),e.jsxs("div",{className:"mt-4 flex justify-end gap-2 flex-wrap",children:[e.jsxs(B,{variant:"outline","data-testid":"button-download-reedit-docx",onClick:()=>{window.open(`/api/reedit-projects/${L.id}/export`,"_blank")},children:[e.jsx(xn,{className:"h-4 w-4 mr-2"}),"Exportar Word (.docx)"]}),e.jsxs(B,{variant:"outline","data-testid":"button-download-reedit-md",onClick:()=>{window.open(`/api/reedit-projects/${L.id}/export-md`,"_blank")},children:[e.jsx(xn,{className:"h-4 w-4 mr-2"}),"Exportar Markdown (.md)"]}),e.jsxs(B,{variant:"outline","data-testid":"button-download-reedit-logs",onClick:()=>{window.open(`/api/reedit-projects/${L.id}/export-logs-pdf`,"_blank")},children:[e.jsx(yt,{className:"h-4 w-4 mr-2"}),"Descargar Logs (.pdf)"]})]})]})]}):e.jsxs("div",{className:"text-center text-muted-foreground py-12",children:[e.jsx(yt,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"El informe final estar disponible cuando se complete el procesamiento"})]})}),e.jsx(Gt,{value:"quality-report",children:e.jsx(lq,{projectId:L.id})})]})})]}):e.jsx(me,{children:e.jsxs(he,{className:"py-12 text-center",children:[e.jsx(yt,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground opacity-50"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Selecciona un Proyecto"}),e.jsx("p",{className:"text-muted-foreground",children:"Elige un proyecto de la lista o sube un nuevo manuscrito para comenzar"})]})})}),F&&n&&e.jsx(sv,{agentType:"reeditor",reeditProjectId:n,className:"lg:col-span-1 h-[calc(100vh-200px)]",onClose:()=>U(!1)})]}),e.jsx(Pn,{open:P,onOpenChange:R,children:e.jsxs(yn,{children:[e.jsxs(jn,{children:[e.jsx(bn,{children:"Reeditar de Nuevo"}),e.jsx($n,{children:"El proyecto se reiniciar usando la versin editada como base para la nueva reedicin. Configura las opciones de expansin si lo deseas."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(st,{children:"Expandir Captulos Cortos"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Aade escenas y dilogos a captulos por debajo del mnimo"})]}),e.jsx(hr,{checked:E,onCheckedChange:A,"data-testid":"switch-restart-expand-chapters"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(st,{children:"Insertar Nuevos Captulos"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Detecta huecos narrativos e inserta captulos intermedios"})]}),e.jsx(hr,{checked:W,onCheckedChange:X,"data-testid":"switch-restart-insert-chapters"})]}),(E||W)&&e.jsxs("div",{children:[e.jsx(st,{children:"Palabras Mnimas por Captulo"}),e.jsx(gt,{type:"number",value:se,onChange:H=>V(parseInt(H.target.value)||2e3),min:500,max:1e4,className:"mt-1","data-testid":"input-restart-min-words"})]})]}),e.jsxs(Ir,{children:[e.jsx(B,{variant:"outline",onClick:()=>R(!1),children:"Cancelar"}),e.jsxs(B,{onClick:Jr,disabled:Sn.isPending,"data-testid":"button-confirm-restart",children:[Sn.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Ho,{className:"h-4 w-4 mr-2"}),"Reiniciar Proyecto"]})]})]})}),e.jsx(Pn,{open:$,onOpenChange:q,children:e.jsxs(yn,{className:"max-w-md",children:[e.jsxs(jn,{children:[e.jsx(bn,{children:"Anlisis Estructural (LitEditors 3.0)"}),e.jsx($n,{children:"Configura el contexto histrico para detectar anacronismos y problemas de continuidad."})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{children:[e.jsx(st,{htmlFor:"setting-context",children:"Contexto Histrico"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:'Ej: "Pars, 1920" o "Espaa medieval, siglo XIV". Esto ayuda a detectar anacronismos.'}),e.jsx(gt,{id:"setting-context",value:le,onChange:H=>K(H.target.value),placeholder:"Lugar y poca de la historia...","data-testid":"input-setting-context"})]})}),e.jsxs(Ir,{children:[e.jsx(B,{variant:"outline",onClick:()=>q(!1),children:"Cancelar"}),e.jsxs(B,{onClick:()=>{L&&ze.mutate({projectId:L.id,settingContext:le})},disabled:ze.isPending,"data-testid":"button-confirm-structural-analysis",children:[ze.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(us,{className:"h-4 w-4 mr-2"}),"Iniciar Anlisis"]})]})]})}),e.jsx(Pn,{open:I,onOpenChange:re,children:e.jsxs(yn,{className:"max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsxs(jn,{children:[e.jsx(bn,{children:"Plan de Reconstruccin"}),e.jsx($n,{children:"Revisa el plan generado por el anlisis estructural. Puedes aprobar el plan o modificarlo antes de la ejecucin."})]}),e.jsx(jt,{className:"flex-1 py-4",children:L?.reconstructionPlan&&Array.isArray(L.reconstructionPlan)?e.jsx("div",{className:"space-y-3",children:L.reconstructionPlan.map((H,Nt)=>e.jsx(me,{className:`border-l-4 ${H.action==="KEEP"?"border-l-green-500":H.action==="INSERT"?"border-l-blue-500":H.action==="DELETE"?"border-l-red-500":H.action==="MERGE"?"border-l-purple-500":"border-l-gray-500"}`,children:e.jsx(he,{className:"py-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Q,{className:`shrink-0 ${H.action==="KEEP"?"bg-green-500":H.action==="INSERT"?"bg-blue-500":H.action==="DELETE"?"bg-red-500":H.action==="MERGE"?"bg-purple-500":""}`,children:H.action}),e.jsxs("div",{className:"flex-1",children:[H.original_id&&e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Captulo original:"})," ",H.original_id,H.new_order&&e.jsxs("span",{className:"text-muted-foreground",children:["  Nuevo orden: ",H.new_order]})]}),H.merge_with&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Fusionar con captulo: ",H.merge_with]}),H.reason&&e.jsx("p",{className:"text-sm mt-1",children:H.reason}),H.prompt_for_writer&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1 italic",children:["Instrucciones: ",H.prompt_for_writer]})]})]})})},Nt))}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(yt,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No hay plan de reconstruccin disponible"})]})}),e.jsxs(Ir,{className:"border-t pt-4",children:[e.jsx(B,{variant:"outline",onClick:()=>re(!1),children:"Cancelar"}),e.jsxs(B,{onClick:()=>{L&&M.mutate({projectId:L.id})},disabled:M.isPending,"data-testid":"button-approve-plan",children:[M.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Tn,{className:"h-4 w-4 mr-2"}),"Aprobar Plan"]})]})]})}),e.jsx(Pn,{open:oe,onOpenChange:Ne,children:e.jsxs(yn,{className:"max-w-2xl",children:[e.jsxs(jn,{children:[e.jsx(bn,{children:"Pulido Manual Personalizado"}),e.jsx($n,{children:"Define instrucciones especficas para pulir y reescribir captulos seleccionados. til para corregir problemas de coherencia narrativa o desarrollo de personajes."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{children:[e.jsx(st,{htmlFor:"polishing-chapters",children:"Rango de Captulos *"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:'Ej: "18-19" o "5, 7, 12-15" o "Captulo 18-19 (El cambio de bando de Salgado)"'}),e.jsx(gt,{id:"polishing-chapters",value:xe,onChange:H=>Se(H.target.value),placeholder:"Captulos a reescribir...","data-testid":"input-polishing-chapters"})]}),e.jsxs("div",{children:[e.jsx(st,{htmlFor:"polishing-diagnosis",children:"Diagnstico"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Cul es el problema que has detectado?"}),e.jsx(Nn,{id:"polishing-diagnosis",value:Oe,onChange:H=>Pe(H.target.value),placeholder:"Ej: El giro del personaje es abrupto y se percibe como una conveniencia del guion...",rows:3,"data-testid":"textarea-polishing-diagnosis"})]}),e.jsxs("div",{children:[e.jsx(st,{htmlFor:"polishing-procedure",children:"Procedimiento"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Qu cambios especficos deben hacerse?"}),e.jsx(Nn,{id:"polishing-procedure",value:Be,onChange:H=>ve(H.target.value),placeholder:"Ej: Insertar una escena o monlogo interno donde el personaje vea una prueba de que...",rows:4,"data-testid":"textarea-polishing-procedure"})]}),e.jsxs("div",{children:[e.jsx(st,{htmlFor:"polishing-objective",children:"Objetivo"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Qu resultado esperas lograr con estos cambios?"}),e.jsx(Nn,{id:"polishing-objective",value:We,onChange:H=>Ye(H.target.value),placeholder:"Ej: Dar coherencia causal al arco del personaje...",rows:2,"data-testid":"textarea-polishing-objective"})]})]}),e.jsxs(Ir,{children:[e.jsx(B,{variant:"outline",onClick:()=>Ne(!1),"data-testid":"button-cancel-polishing",children:"Cancelar"}),e.jsxs(B,{onClick:ba,disabled:ir.isPending||!xe.trim(),"data-testid":"button-submit-polishing",children:[ir.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(da,{className:"h-4 w-4 mr-2"}),"Iniciar Pulido"]})]})]})})]})}const Qx=x.forwardRef(({className:t,...n},r)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:r,className:Ae("w-full caption-bottom text-sm",t),...n})}));Qx.displayName="Table";const Yx=x.forwardRef(({className:t,...n},r)=>e.jsx("thead",{ref:r,className:Ae("[&_tr]:border-b",t),...n}));Yx.displayName="TableHeader";const Zx=x.forwardRef(({className:t,...n},r)=>e.jsx("tbody",{ref:r,className:Ae("[&_tr:last-child]:border-0",t),...n}));Zx.displayName="TableBody";const uq=x.forwardRef(({className:t,...n},r)=>e.jsx("tfoot",{ref:r,className:Ae("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...n}));uq.displayName="TableFooter";const _o=x.forwardRef(({className:t,...n},r)=>e.jsx("tr",{ref:r,className:Ae("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...n}));_o.displayName="TableRow";const js=x.forwardRef(({className:t,...n},r)=>e.jsx("th",{ref:r,className:Ae("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...n}));js.displayName="TableHead";const ur=x.forwardRef(({className:t,...n},r)=>e.jsx("td",{ref:r,className:Ae("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...n}));ur.displayName="TableCell";const pq=x.forwardRef(({className:t,...n},r)=>e.jsx("caption",{ref:r,className:Ae("mt-4 text-sm text-muted-foreground",t),...n}));pq.displayName="TableCaption";function ca(t){return t>=1e6?`${(t/1e6).toFixed(2)}M`:t>=1e3?`${(t/1e3).toFixed(1)}K`:t.toString()}function Pu(t){return`$${t.toFixed(4)}`}const mq=`Tarifas por milln de tokens:

DeepSeek R1 (reasoner): $0.55 input / $2.19 output
DeepSeek V3 (chat): $0.28 input / $0.42 output

Gemini 3 Pro Preview: $1.25 input / $10.00 output
Gemini 2.5 Flash: $0.30 input / $2.50 output`;function hq(t){if(t.length===0)return{start:null,end:null};const n=t.map(r=>new Date(r.createdAt)).filter(r=>!isNaN(r.getTime())).sort((r,s)=>r.getTime()-s.getTime());return{start:n[0]||null,end:n[n.length-1]||null}}function Uw(t){return t?t.toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}function fq(t){const n=new Map;for(const r of t){const s=r.model||"unknown",i=new Date(r.createdAt),o=n.get(s);o?(o.inputTokens+=r.inputTokens||0,o.outputTokens+=r.outputTokens||0,o.thinkingTokens+=r.thinkingTokens||0,o.cost+=parseFloat(r.totalCostUsd||"0"),(!o.firstDate||i<o.firstDate)&&(o.firstDate=i),(!o.lastDate||i>o.lastDate)&&(o.lastDate=i)):n.set(s,{model:s,inputTokens:r.inputTokens||0,outputTokens:r.outputTokens||0,thinkingTokens:r.thinkingTokens||0,cost:parseFloat(r.totalCostUsd||"0"),firstDate:i,lastDate:i})}return Array.from(n.values()).sort((r,s)=>s.cost-r.cost)}function xq(t){return t.startsWith("gemini")?"Gemini":t.startsWith("deepseek")?"DeepSeek":"Otro"}function gq(t){const n=new Map;for(const r of t){const s=xq(r.model),i=n.get(s);i?(i.inputTokens+=r.inputTokens,i.outputTokens+=r.outputTokens,i.thinkingTokens+=r.thinkingTokens,i.cost+=r.cost):n.set(s,{provider:s,inputTokens:r.inputTokens,outputTokens:r.outputTokens,thinkingTokens:r.thinkingTokens,cost:r.cost})}return Array.from(n.values()).sort((r,s)=>s.cost-r.cost)}function vq(){const{currentProject:t,isLoading:n}=fi(),{data:r,isLoading:s}=Ke({queryKey:[`/api/projects/${t?.id}/ai-usage`],enabled:!!t?.id,refetchInterval:5e3}),i=fq(r||[]),o=gq(i),c=hq(r||[]),d=i.reduce((g,v)=>g+v.cost,0),p=i.reduce((g,v)=>g+v.inputTokens,0),m=i.reduce((g,v)=>g+v.outputTokens,0),h=i.reduce((g,v)=>g+v.thinkingTokens,0);return t?e.jsxs("div",{className:"p-6 space-y-6","data-testid":"costs-history-page",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Costos: ",t.title]}),e.jsx("p",{className:"text-muted-foreground",children:"Tokens y costos por modelo"})]}),e.jsxs(ei,{children:[e.jsx(ti,{asChild:!0,children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground cursor-help",children:[e.jsx(t1,{className:"h-4 w-4"}),e.jsx("span",{children:"Info de precios"})]})}),e.jsx(ua,{side:"left",className:"max-w-sm whitespace-pre-line",children:mq})]})]}),e.jsxs(me,{children:[e.jsxs(Re,{className:"flex flex-row items-center justify-between gap-2 pb-2",children:[e.jsx(Ie,{className:"text-sm font-medium",children:"Resumen del Proyecto"}),e.jsx(Fi,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(he,{children:n||s?e.jsx(jf,{className:"h-8 w-full"}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-3xl font-bold text-primary",children:Pu(d)}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["Inicio: ",e.jsx("span",{className:"text-foreground",children:Uw(c.start)})]}),e.jsxs("span",{children:["Fin: ",e.jsx("span",{className:"text-foreground",children:Uw(c.end)})]})]})]})})]}),o.length>0&&e.jsxs(me,{children:[e.jsx(Re,{children:e.jsx(Ie,{children:"Desglose por Proveedor"})}),e.jsx(he,{children:s?e.jsx(jf,{className:"h-16 w-full"}):e.jsxs(Qx,{children:[e.jsx(Yx,{children:e.jsxs(_o,{children:[e.jsx(js,{children:"Proveedor"}),e.jsx(js,{className:"text-right",children:"Input"}),e.jsx(js,{className:"text-right",children:"Output"}),e.jsx(js,{className:"text-right",children:"Thinking"}),e.jsx(js,{className:"text-right",children:"Costo"})]})}),e.jsx(Zx,{children:o.map(g=>e.jsxs(_o,{children:[e.jsx(ur,{className:"font-medium text-sm",children:g.provider}),e.jsx(ur,{className:"text-right font-mono text-sm",children:ca(g.inputTokens)}),e.jsx(ur,{className:"text-right font-mono text-sm",children:ca(g.outputTokens)}),e.jsx(ur,{className:"text-right font-mono text-sm text-muted-foreground",children:ca(g.thinkingTokens)}),e.jsx(ur,{className:"text-right font-mono text-sm font-semibold",children:Pu(g.cost)})]},g.provider))})]})})]}),e.jsxs(me,{children:[e.jsx(Re,{children:e.jsx(Ie,{children:"Desglose por Modelo"})}),e.jsx(he,{children:s?e.jsx(jf,{className:"h-24 w-full"}):i.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-4",children:"No hay datos de uso registrados"}):e.jsxs(Qx,{children:[e.jsx(Yx,{children:e.jsxs(_o,{children:[e.jsx(js,{children:"Modelo"}),e.jsx(js,{className:"text-right",children:"Input"}),e.jsx(js,{className:"text-right",children:"Output"}),e.jsx(js,{className:"text-right",children:"Thinking"}),e.jsx(js,{className:"text-right",children:"Costo"})]})}),e.jsxs(Zx,{children:[i.map(g=>e.jsxs(_o,{children:[e.jsx(ur,{className:"font-medium font-mono text-sm",children:g.model}),e.jsx(ur,{className:"text-right font-mono text-sm",children:ca(g.inputTokens)}),e.jsx(ur,{className:"text-right font-mono text-sm",children:ca(g.outputTokens)}),e.jsx(ur,{className:"text-right font-mono text-sm text-muted-foreground",children:ca(g.thinkingTokens)}),e.jsx(ur,{className:"text-right font-mono text-sm font-semibold",children:Pu(g.cost)})]},g.model)),e.jsxs(_o,{className:"bg-muted/50 font-bold",children:[e.jsx(ur,{children:"TOTAL"}),e.jsx(ur,{className:"text-right font-mono",children:ca(p)}),e.jsx(ur,{className:"text-right font-mono",children:ca(m)}),e.jsx(ur,{className:"text-right font-mono text-muted-foreground",children:ca(h)}),e.jsx(ur,{className:"text-right font-mono text-lg",children:Pu(d)})]})]})]})})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-6",children:[e.jsx(mn,{className:"h-16 w-16 text-muted-foreground/20 mb-4"}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Sin proyecto seleccionado"}),e.jsx("p",{className:"text-muted-foreground max-w-md",children:"Selecciona un proyecto para ver su historial de costos"})]})}class yq{diff(n,r,s={}){let i;typeof s=="function"?(i=s,s={}):"callback"in s&&(i=s.callback);const o=this.castInput(n,s),c=this.castInput(r,s),d=this.removeEmpty(this.tokenize(o,s)),p=this.removeEmpty(this.tokenize(c,s));return this.diffWithOptionsObj(d,p,s,i)}diffWithOptionsObj(n,r,s,i){var o;const c=k=>{if(k=this.postProcess(k,s),i){setTimeout(function(){i(k)},0);return}else return k},d=r.length,p=n.length;let m=1,h=d+p;s.maxEditLength!=null&&(h=Math.min(h,s.maxEditLength));const g=(o=s.timeout)!==null&&o!==void 0?o:1/0,v=Date.now()+g,j=[{oldPos:-1,lastComponent:void 0}];let N=this.extractCommon(j[0],r,n,0,s);if(j[0].oldPos+1>=p&&N+1>=d)return c(this.buildValues(j[0].lastComponent,r,n));let b=-1/0,C=1/0;const S=()=>{for(let k=Math.max(b,-m);k<=Math.min(C,m);k+=2){let P;const R=j[k-1],E=j[k+1];R&&(j[k-1]=void 0);let A=!1;if(E){const X=E.oldPos-k;A=E&&0<=X&&X<d}const W=R&&R.oldPos+1<p;if(!A&&!W){j[k]=void 0;continue}if(!W||A&&R.oldPos<E.oldPos?P=this.addToPath(E,!0,!1,0,s):P=this.addToPath(R,!1,!0,1,s),N=this.extractCommon(P,r,n,k,s),P.oldPos+1>=p&&N+1>=d)return c(this.buildValues(P.lastComponent,r,n))||!0;j[k]=P,P.oldPos+1>=p&&(C=Math.min(C,k-1)),N+1>=d&&(b=Math.max(b,k+1))}m++};if(i)(function k(){setTimeout(function(){if(m>h||Date.now()>v)return i(void 0);S()||k()},0)})();else for(;m<=h&&Date.now()<=v;){const k=S();if(k)return k}}addToPath(n,r,s,i,o){const c=n.lastComponent;return c&&!o.oneChangePerToken&&c.added===r&&c.removed===s?{oldPos:n.oldPos+i,lastComponent:{count:c.count+1,added:r,removed:s,previousComponent:c.previousComponent}}:{oldPos:n.oldPos+i,lastComponent:{count:1,added:r,removed:s,previousComponent:c}}}extractCommon(n,r,s,i,o){const c=r.length,d=s.length;let p=n.oldPos,m=p-i,h=0;for(;m+1<c&&p+1<d&&this.equals(s[p+1],r[m+1],o);)m++,p++,h++,o.oneChangePerToken&&(n.lastComponent={count:1,previousComponent:n.lastComponent,added:!1,removed:!1});return h&&!o.oneChangePerToken&&(n.lastComponent={count:h,previousComponent:n.lastComponent,added:!1,removed:!1}),n.oldPos=p,m}equals(n,r,s){return s.comparator?s.comparator(n,r):n===r||!!s.ignoreCase&&n.toLowerCase()===r.toLowerCase()}removeEmpty(n){const r=[];for(let s=0;s<n.length;s++)n[s]&&r.push(n[s]);return r}castInput(n,r){return n}tokenize(n,r){return Array.from(n)}join(n){return n.join("")}postProcess(n,r){return n}get useLongestToken(){return!1}buildValues(n,r,s){const i=[];let o;for(;n;)i.push(n),o=n.previousComponent,delete n.previousComponent,n=o;i.reverse();const c=i.length;let d=0,p=0,m=0;for(;d<c;d++){const h=i[d];if(h.removed)h.value=this.join(s.slice(m,m+h.count)),m+=h.count;else{if(!h.added&&this.useLongestToken){let g=r.slice(p,p+h.count);g=g.map(function(v,j){const N=s[m+j];return N.length>v.length?N:v}),h.value=this.join(g)}else h.value=this.join(r.slice(p,p+h.count));p+=h.count,h.added||(m+=h.count)}}return i}}function Bw(t,n){let r;for(r=0;r<t.length&&r<n.length;r++)if(t[r]!=n[r])return t.slice(0,r);return t.slice(0,r)}function Gw(t,n){let r;if(!t||!n||t[t.length-1]!=n[n.length-1])return"";for(r=0;r<t.length&&r<n.length;r++)if(t[t.length-(r+1)]!=n[n.length-(r+1)])return t.slice(-r);return t.slice(-r)}function Xx(t,n,r){if(t.slice(0,n.length)!=n)throw Error(`string ${JSON.stringify(t)} doesn't start with prefix ${JSON.stringify(n)}; this is a bug`);return r+t.slice(n.length)}function Jx(t,n,r){if(!n)return t+r;if(t.slice(-n.length)!=n)throw Error(`string ${JSON.stringify(t)} doesn't end with suffix ${JSON.stringify(n)}; this is a bug`);return t.slice(0,-n.length)+r}function mc(t,n){return Xx(t,n,"")}function Tu(t,n){return Jx(t,n,"")}function Hw(t,n){return n.slice(0,jq(t,n))}function jq(t,n){let r=0;t.length>n.length&&(r=t.length-n.length);let s=n.length;t.length<n.length&&(s=t.length);const i=Array(s);let o=0;i[0]=0;for(let c=1;c<s;c++){for(n[c]==n[o]?i[c]=i[o]:i[c]=o;o>0&&n[c]!=n[o];)o=i[o];n[c]==n[o]&&o++}o=0;for(let c=r;c<t.length;c++){for(;o>0&&t[c]!=n[o];)o=i[o];t[c]==n[o]&&o++}return o}function hc(t){let n;for(n=t.length-1;n>=0&&t[n].match(/\s/);n--);return t.substring(n+1)}function Wa(t){const n=t.match(/^\s*/);return n?n[0]:""}const Kw="a-zA-Z0-9_\\u{AD}\\u{C0}-\\u{D6}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",bq=new RegExp(`[${Kw}]+|\\s+|[^${Kw}]`,"ug");class wq extends yq{equals(n,r,s){return s.ignoreCase&&(n=n.toLowerCase(),r=r.toLowerCase()),n.trim()===r.trim()}tokenize(n,r={}){let s;if(r.intlSegmenter){const c=r.intlSegmenter;if(c.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');s=[];for(const d of Array.from(c.segment(n))){const p=d.segment;s.length&&/\s/.test(s[s.length-1])&&/\s/.test(p)?s[s.length-1]+=p:s.push(p)}}else s=n.match(bq)||[];const i=[];let o=null;return s.forEach(c=>{/\s/.test(c)?o==null?i.push(c):i.push(i.pop()+c):o!=null&&/\s/.test(o)?i[i.length-1]==o?i.push(i.pop()+c):i.push(o+c):i.push(c),o=c}),i}join(n){return n.map((r,s)=>s==0?r:r.replace(/^\s+/,"")).join("")}postProcess(n,r){if(!n||r.oneChangePerToken)return n;let s=null,i=null,o=null;return n.forEach(c=>{c.added?i=c:c.removed?o=c:((i||o)&&Ww(s,o,i,c),s=c,i=null,o=null)}),(i||o)&&Ww(s,o,i,null),n}}const Nq=new wq;function vP(t,n,r){return Nq.diff(t,n,r)}function Ww(t,n,r,s){if(n&&r){const i=Wa(n.value),o=hc(n.value),c=Wa(r.value),d=hc(r.value);if(t){const p=Bw(i,c);t.value=Jx(t.value,c,p),n.value=mc(n.value,p),r.value=mc(r.value,p)}if(s){const p=Gw(o,d);s.value=Xx(s.value,d,p),n.value=Tu(n.value,p),r.value=Tu(r.value,p)}}else if(r){if(t){const i=Wa(r.value);r.value=r.value.substring(i.length)}if(s){const i=Wa(s.value);s.value=s.value.substring(i.length)}}else if(t&&s){const i=Wa(s.value),o=Wa(n.value),c=hc(n.value),d=Bw(i,o);n.value=mc(n.value,d);const p=Gw(mc(i,d),c);n.value=Tu(n.value,p),s.value=Xx(s.value,i,p),t.value=Jx(t.value,i,i.slice(0,i.length-p.length))}else if(s){const i=Wa(s.value),o=hc(n.value),c=Hw(o,i);n.value=Tu(n.value,c)}else if(t){const i=hc(t.value),o=Wa(n.value),c=Hw(i,o);n.value=mc(n.value,c)}}function Wf(t,n){const r=vP(t,n);let s=0,i=0,o=0;r.forEach(m=>{const h=m.value.split(/\s+/).filter(g=>g.length>0).length;m.added?s+=h:m.removed?i+=h:o+=h});const c=s+i,d=o+s,p=d>0?c/d*100:0;return{additions:s,deletions:i,unchanged:o,totalChanges:c,changePercentage:p}}function Cq({original:t,corrected:n}){const r=x.useMemo(()=>vP(t,n),[t,n]);return e.jsx("div",{className:"font-mono text-sm leading-relaxed whitespace-pre-wrap",children:r.map((s,i)=>s.added?e.jsx("span",{className:"bg-green-500/20 text-green-700 dark:text-green-300 px-0.5 rounded",children:s.value},i):s.removed?e.jsx("span",{className:"bg-red-500/20 text-red-700 dark:text-red-300 line-through px-0.5 rounded",children:s.value},i):e.jsx("span",{children:s.value},i))})}function Sq({original:t,corrected:n}){return e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-muted-foreground",children:[e.jsx(ZN,{className:"h-4 w-4 text-red-500"}),"Original (Pre-Correccin)"]}),e.jsx(jt,{className:"h-[500px] border rounded-md p-4 bg-red-500/5",children:e.jsx("div",{className:"font-mono text-sm leading-relaxed whitespace-pre-wrap",children:t})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-muted-foreground",children:[e.jsx(XN,{className:"h-4 w-4 text-green-500"}),"Corregido (Post-Correccin)"]}),e.jsx(jt,{className:"h-[500px] border rounded-md p-4 bg-green-500/5",children:e.jsx("div",{className:"font-mono text-sm leading-relaxed whitespace-pre-wrap",children:n})})]})]})}function kq({stats:t}){return e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(XN,{className:"h-4 w-4 text-green-500"}),e.jsxs("span",{className:"text-green-600 dark:text-green-400",children:["+",t.additions]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ZN,{className:"h-4 w-4 text-red-500"}),e.jsxs("span",{className:"text-red-600 dark:text-red-400",children:["-",t.deletions]})]}),e.jsxs(Q,{variant:t.changePercentage>5?"destructive":t.changePercentage>1?"secondary":"outline",children:[t.changePercentage.toFixed(1),"% cambios"]})]})}function Eq(t,n){const r=new Blob([n],{type:"text/markdown;charset=utf-8"}),s=URL.createObjectURL(r),i=document.createElement("a");i.href=s,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(s)}function Pq(){const[t,n]=x.useState(null),[r,s]=x.useState(0),[i,o]=x.useState("unified"),[c,d]=x.useState(null),{toast:p}=nn(),{data:m,isLoading:h}=Ke({queryKey:["/api/projects"]}),{data:g,isLoading:v}=Ke({queryKey:[`/api/projects/${t}/chapters`],enabled:!!t}),j=m?.filter(R=>R.status==="completed"||R.status==="paused")||[];j.find(R=>R.id===t);const N=async R=>{if(t){d(R);try{const E=await fetch(`/api/projects/${t}/export-markdown?version=${R}`);if(!E.ok){const se=await E.json().catch(()=>({}));throw new Error(se.error||"Error al descargar")}const A=await E.json(),W=A.title.replace(/[^a-zA-Z0-9\u00C0-\u024F\s]/g,"").replace(/\s+/g,"_");Eq(`${W}${R==="original"?"_ORIGINAL":"_CORREGIDO"}.md`,A.markdown),p({title:"Descargado",description:`${A.versionLabel}: ${A.chapterCount} captulos`})}catch(E){p({title:"Error",description:E.message,variant:"destructive"})}finally{d(null)}}},b=x.useMemo(()=>g?g.filter(R=>R.content&&R.originalContent&&R.content!==R.originalContent).sort((R,E)=>R.chapterNumber-E.chapterNumber):[],[g]),C=b[r],S=x.useMemo(()=>{if(!b.length)return null;let R=0,E=0,A=0;b.forEach(V=>{if(V.originalContent&&V.content){const G=Wf(V.originalContent,V.content);R+=G.additions,E+=G.deletions,A+=G.unchanged}});const W=R+E,X=A+R,se=X>0?W/X*100:0;return{additions:R,deletions:E,unchanged:A,totalChanges:W,changePercentage:se,chaptersModified:b.length,totalChapters:g?.length||0}},[b,g]),k=x.useMemo(()=>!C?.originalContent||!C?.content?null:Wf(C.originalContent,C.content),[C]),P=R=>R.chapterNumber===0?"Prlogo":R.chapterNumber===-1?"Eplogo":R.chapterNumber===-2?"Nota del Autor":`Captulo ${R.chapterNumber}`;return e.jsxs("div",{className:"container mx-auto px-6 py-6 space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(e1,{className:"h-6 w-6"}),"Comparar Manuscritos"]}),e.jsx("p",{className:"text-muted-foreground",children:"Analiza las diferencias entre el manuscrito original y el corregido"})]})}),e.jsxs(me,{children:[e.jsxs(Re,{children:[e.jsx(Ie,{children:"Seleccionar Proyecto"}),e.jsx(At,{children:"Elige un proyecto completado que haya pasado por Detect & Fix"})]}),e.jsx(he,{children:e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("div",{className:"flex-1",children:e.jsxs(Pt,{value:t?.toString()||"",onValueChange:R=>{n(parseInt(R)),s(0)},children:[e.jsx(St,{"data-testid":"select-project-compare",children:e.jsx(Tt,{placeholder:"Selecciona un proyecto..."})}),e.jsx(kt,{children:h?e.jsx("div",{className:"p-2 text-center text-muted-foreground",children:e.jsx(be,{className:"h-4 w-4 animate-spin mx-auto"})}):j.length===0?e.jsx("div",{className:"p-2 text-center text-muted-foreground",children:"No hay proyectos completados"}):j.map(R=>e.jsx(ce,{value:R.id.toString(),children:R.title},R.id))})]})})})})]}),t&&v&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(be,{className:"h-8 w-8 animate-spin text-muted-foreground"})}),t&&!v&&b.length===0&&e.jsx(me,{children:e.jsxs(he,{className:"py-12 text-center",children:[e.jsx(Dr,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Sin diferencias encontradas"}),e.jsx("p",{className:"text-muted-foreground max-w-md mx-auto",children:'Este proyecto no tiene manuscrito original guardado o no hubo cambios durante la correccin. El snapshot se guarda al ejecutar "Detect & Fix".'})]})}),S&&b.length>0&&e.jsxs(me,{children:[e.jsx(Re,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(hA,{className:"h-5 w-5"}),"Resumen Global de Correcciones"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>N("original"),disabled:c!==null,"data-testid":"button-download-original",children:[c==="original"?e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(xn,{className:"h-4 w-4 mr-2"}),"Original"]}),e.jsxs(B,{size:"sm",onClick:()=>N("corrected"),disabled:c!==null,"data-testid":"button-download-corrected",children:[c==="corrected"?e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(xn,{className:"h-4 w-4 mr-2"}),"Corregido"]})]})]})}),e.jsx(he,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:["+",S.additions.toLocaleString()]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Palabras aadidas"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:["-",S.deletions.toLocaleString()]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Palabras eliminadas"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold",children:[S.changePercentage.toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Cambio total"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold",children:[S.chaptersModified,"/",S.totalChapters]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Captulos modificados"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold flex items-center justify-center gap-1",children:S.changePercentage<2?e.jsx(Xt,{className:"h-6 w-6 text-green-500"}):S.changePercentage<5?e.jsx(Dr,{className:"h-6 w-6 text-yellow-500"}):e.jsx(Dr,{className:"h-6 w-6 text-red-500"})}),e.jsx("div",{className:"text-sm text-muted-foreground",children:S.changePercentage<2?"Correcciones mnimas":S.changePercentage<5?"Correcciones moderadas":"Correcciones significativas"})]})]})})]}),C&&e.jsxs(me,{children:[e.jsx(Re,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(yt,{className:"h-5 w-5"}),P(C),C.title&&`: ${C.title}`]}),k&&e.jsx("div",{className:"mt-2",children:e.jsx(kq,{stats:k})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{variant:"outline",size:"icon",onClick:()=>s(R=>Math.max(0,R-1)),disabled:r===0,"data-testid":"button-prev-chapter",children:e.jsx(YN,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm text-muted-foreground min-w-[60px] text-center",children:[r+1," / ",b.length]}),e.jsx(B,{variant:"outline",size:"icon",onClick:()=>s(R=>Math.min(b.length-1,R+1)),disabled:r===b.length-1,"data-testid":"button-next-chapter",children:e.jsx(Wc,{className:"h-4 w-4"})})]})]})}),e.jsx(he,{children:e.jsxs(ci,{value:i,onValueChange:R=>o(R),children:[e.jsxs(ga,{className:"mb-4",children:[e.jsx(Bt,{value:"unified","data-testid":"tab-unified",children:"Vista Unificada"}),e.jsx(Bt,{value:"side-by-side","data-testid":"tab-side-by-side",children:"Lado a Lado"})]}),e.jsxs(Gt,{value:"unified",children:[e.jsx(jt,{className:"h-[500px] border rounded-md p-4",children:e.jsx(Cq,{original:C.originalContent||"",corrected:C.content||""})}),e.jsxs("div",{className:"mt-4 flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block w-4 h-4 bg-green-500/20 rounded"}),"Texto aadido"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block w-4 h-4 bg-red-500/20 rounded"}),"Texto eliminado"]})]})]}),e.jsx(Gt,{value:"side-by-side",children:e.jsx(Sq,{original:C.originalContent||"",corrected:C.content||""})})]})})]}),b.length>1&&e.jsxs(me,{children:[e.jsx(Re,{children:e.jsx(Ie,{children:"Navegacin por Captulos"})}),e.jsx(he,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:b.map((R,E)=>{const A=R.originalContent&&R.content?Wf(R.originalContent,R.content):null;return e.jsxs(B,{variant:E===r?"default":"outline",size:"sm",onClick:()=>s(E),className:"relative","data-testid":`button-chapter-${R.chapterNumber}`,children:[P(R),A&&A.changePercentage>2&&e.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-yellow-500 rounded-full"})]},R.id)})})})]})]})}const Tq=gi({title:Kt().min(1,"El ttulo es requerido"),argument:Kt().min(50,"El argumento debe tener al menos 50 caracteres"),genre:Kt().default("thriller"),tone:Kt().default("tenso"),chapterCount:pr().min(5,"Mnimo 5 captulos").max(50,"Mximo 50 captulos"),hasPrologue:mr().default(!0),hasEpilogue:mr().default(!0),hasAuthorNote:mr().default(!1),pseudonymId:Kt().optional(),styleGuideId:Kt().optional(),seriesId:Kt().optional(),seriesOrder:pr().min(1).default(1),kindleUnlimited:mr().default(!0),createProject:mr().default(!0)});function Rq(){const[,t]=ol(),{toast:n}=nn(),[r,s]=x.useState(null),[i,o]=x.useState(null),[c,d]=x.useState(null),p=Dc({resolver:Lc(Tq),defaultValues:{title:"",argument:"",genre:"thriller",tone:"tenso",chapterCount:25,hasPrologue:!0,hasEpilogue:!0,hasAuthorNote:!1,pseudonymId:"",styleGuideId:"",seriesId:"",seriesOrder:1,kindleUnlimited:!0,createProject:!0}}),{data:m=[]}=Ke({queryKey:["/api/pseudonyms"]}),{data:h=[]}=Ke({queryKey:["/api/all-style-guides"]}),{data:g=[]}=Ke({queryKey:["/api/series"]}),v=ye({mutationFn:async E=>(await je("POST","/api/generate-writing-guide",{...E,pseudonymId:E.pseudonymId&&E.pseudonymId!=="none"?parseInt(E.pseudonymId):void 0,styleGuideId:E.styleGuideId&&E.styleGuideId!=="none"?parseInt(E.styleGuideId):void 0,seriesId:E.seriesId&&E.seriesId!=="none"?parseInt(E.seriesId):void 0})).json(),onSuccess:E=>{s(E.guideContent||""),o(E.projectId||null),d(E.extendedGuideId||null),ae.invalidateQueries({queryKey:["/api/projects"]}),ae.invalidateQueries({queryKey:["/api/generation-status"]}),ae.invalidateQueries({queryKey:["/api/extended-guides"]}),n({title:"Gua generada",description:E.message})},onError:E=>{n({title:"Error",description:E.message,variant:"destructive"})}}),j=ye({mutationFn:async()=>(await je("POST","/api/cancel-guide-generation")).json(),onSuccess:E=>{ae.invalidateQueries({queryKey:["/api/generation-status"]}),n({title:"Cancelado",description:E.message||"Generacin de gua cancelada"})},onError:E=>{n({title:"Error",description:E.message,variant:"destructive"})}}),{data:N}=Ke({queryKey:["/api/generation-status"],refetchInterval:v.isPending?5e3:15e3}),b=E=>{v.mutate(E)},C=E=>{p.setValue("pseudonymId",E);const A=m.find(W=>W.id.toString()===E);if(A){A.defaultGenre&&p.setValue("genre",A.defaultGenre),A.defaultTone&&p.setValue("tone",A.defaultTone);const W=h.find(X=>X.pseudonymId===A.id&&X.isActive);W?p.setValue("styleGuideId",W.id.toString()):p.setValue("styleGuideId","none")}else p.setValue("styleGuideId","none")},S=()=>{s(null),o(null),d(null),p.reset()},k=p.watch("argument")?.length||0,P=p.watch("seriesId"),R=P&&P!=="none";return e.jsxs("div",{className:"container mx-auto p-6 max-w-4xl",children:[e.jsxs("div",{className:"mb-6","data-testid":"page-header",children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2","data-testid":"text-page-title",children:[e.jsx(xr,{className:"h-8 w-8 text-primary"}),"Generador de Guas de Escritura"]}),e.jsx("p",{className:"text-muted-foreground mt-2","data-testid":"text-page-description",children:"Genera automticamente una gua de escritura completa a partir de un argumento"})]}),N?.isGenerating&&!v.isSuccess?e.jsxs(me,{className:"border-orange-500/50 bg-orange-500/5",children:[e.jsxs(Re,{children:[e.jsxs(Ie,{className:"flex items-center gap-2 text-orange-600 dark:text-orange-400","data-testid":"text-server-generation-active",children:[e.jsx(be,{className:"h-6 w-6 animate-spin"}),"Generacin en Curso"]}),e.jsx(At,{children:"Espera a que termine o cancela la generacin actual"})]}),e.jsxs(he,{className:"space-y-4",children:[e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg",children:[e.jsx("p",{className:"font-medium text-lg",children:N.activeGeneration?.type}),e.jsxs("p",{className:"text-xl mt-1",children:['"',N.activeGeneration?.title,'"']}),N.activeGeneration?.startedAt&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-3",children:["Iniciado: ",new Date(N.activeGeneration.startedAt).toLocaleString()]})]}),e.jsxs(B,{variant:"destructive",onClick:()=>j.mutate(),disabled:j.isPending,className:"w-full","data-testid":"button-cancel-server-generation",children:[j.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Gn,{className:"h-4 w-4 mr-2"}),"Cancelar Generacin"]})]})]}):r===null?e.jsx(zc,{...p,children:e.jsxs("form",{onSubmit:p.handleSubmit(b),className:"space-y-6",children:[e.jsxs(me,{children:[e.jsxs(Re,{children:[e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(mn,{className:"h-5 w-5"}),"Datos de la Novela"]}),e.jsx(At,{children:"Proporciona el argumento y la configuracin bsica"})]}),e.jsxs(he,{className:"space-y-4",children:[e.jsx(pt,{control:p.control,name:"title",render:({field:E})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Ttulo de la novela"}),e.jsx(dt,{children:e.jsx(gt,{...E,"data-testid":"input-title",placeholder:"Ej: Sombras en el agua"})}),e.jsx(Mt,{})]})}),e.jsx(pt,{control:p.control,name:"argument",render:({field:E})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Argumento / Sinopsis"}),e.jsx(dt,{children:e.jsx(Nn,{...E,"data-testid":"input-argument",placeholder:"Describe la trama principal, el conflicto central y los personajes principales. Cuanto ms detallado, mejor ser la gua generada...",className:"min-h-[200px]"})}),e.jsxs(sn,{children:[k," caracteres (mnimo 50)"]}),e.jsx(Mt,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(pt,{control:p.control,name:"genre",render:({field:E})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Gnero"}),e.jsxs(Pt,{onValueChange:E.onChange,value:E.value,children:[e.jsx(dt,{children:e.jsx(St,{"data-testid":"select-genre",children:e.jsx(Tt,{})})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"thriller","data-testid":"option-genre-thriller",children:"Thriller / Suspense"}),e.jsx(ce,{value:"psychological-thriller","data-testid":"option-genre-psych-thriller",children:"Thriller Psicolgico"}),e.jsx(ce,{value:"police-procedural","data-testid":"option-genre-procedural",children:"Thriller Policial"}),e.jsx(ce,{value:"domestic-thriller","data-testid":"option-genre-domestic",children:"Thriller Domstico"}),e.jsx(ce,{value:"romance","data-testid":"option-genre-romance",children:"Romance Contemporneo"}),e.jsx(ce,{value:"historical-romance","data-testid":"option-genre-hist-romance",children:"Romance Histrico"}),e.jsx(ce,{value:"dark-romance","data-testid":"option-genre-dark-romance",children:"Dark Romance"}),e.jsx(ce,{value:"paranormal-romance","data-testid":"option-genre-para-romance",children:"Romance Paranormal"}),e.jsx(ce,{value:"romantasy","data-testid":"option-genre-romantasy",children:"Romantasy"}),e.jsx(ce,{value:"mafia-romance","data-testid":"option-genre-mafia",children:"Mafia Romance"}),e.jsx(ce,{value:"fantasy","data-testid":"option-genre-fantasy",children:"Fantasa pica"}),e.jsx(ce,{value:"urban-fantasy","data-testid":"option-genre-urban",children:"Fantasa Urbana"}),e.jsx(ce,{value:"grimdark","data-testid":"option-genre-grimdark",children:"Fantasa Oscura (Grimdark)"}),e.jsx(ce,{value:"sci-fi","data-testid":"option-genre-scifi",children:"Ciencia Ficcin"}),e.jsx(ce,{value:"space-opera","data-testid":"option-genre-space",children:"Space Opera"}),e.jsx(ce,{value:"dystopia","data-testid":"option-genre-dystopia",children:"Distopa / Post-apocalptico"}),e.jsx(ce,{value:"horror","data-testid":"option-genre-horror",children:"Terror / Horror"}),e.jsx(ce,{value:"psychological-horror","data-testid":"option-genre-psych-horror",children:"Terror Psicolgico"}),e.jsx(ce,{value:"mystery","data-testid":"option-genre-mystery",children:"Misterio"}),e.jsx(ce,{value:"cozy-mystery","data-testid":"option-genre-cozy",children:"Cozy Mystery"}),e.jsx(ce,{value:"crime-noir","data-testid":"option-genre-noir",children:"Crime Fiction / Noir"}),e.jsx(ce,{value:"historical","data-testid":"option-genre-historical",children:"Ficcin Histrica"}),e.jsx(ce,{value:"literary","data-testid":"option-genre-literary",children:"Literaria"}),e.jsx(ce,{value:"young-adult","data-testid":"option-genre-ya",children:"Young Adult (YA)"}),e.jsx(ce,{value:"new-adult","data-testid":"option-genre-na",children:"New Adult (NA)"}),e.jsx(ce,{value:"erotic","data-testid":"option-genre-erotic",children:"Ertico"}),e.jsx(ce,{value:"litrpg","data-testid":"option-genre-litrpg",children:"LitRPG / GameLit"}),e.jsx(ce,{value:"women-fiction","data-testid":"option-genre-women",children:"Women's Fiction"})]})]}),e.jsx(Mt,{})]})}),e.jsx(pt,{control:p.control,name:"tone",render:({field:E})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Tono"}),e.jsxs(Pt,{onValueChange:E.onChange,value:E.value,children:[e.jsx(dt,{children:e.jsx(St,{"data-testid":"select-tone",children:e.jsx(Tt,{})})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"tenso","data-testid":"option-tone-tenso",children:"Tenso"}),e.jsx(ce,{value:"oscuro","data-testid":"option-tone-oscuro",children:"Oscuro"}),e.jsx(ce,{value:"esperanzador","data-testid":"option-tone-esperanzador",children:"Esperanzador"}),e.jsx(ce,{value:"dramtico","data-testid":"option-tone-dramatico",children:"Dramtico"}),e.jsx(ce,{value:"romntico","data-testid":"option-tone-romantico",children:"Romntico"}),e.jsx(ce,{value:"humorstico","data-testid":"option-tone-humoristico",children:"Humorstico"}),e.jsx(ce,{value:"melanclico","data-testid":"option-tone-melancolico",children:"Melanclico"}),e.jsx(ce,{value:"pico","data-testid":"option-tone-epico",children:"pico"}),e.jsx(ce,{value:"ntimo","data-testid":"option-tone-intimo",children:"ntimo"})]})]}),e.jsx(Mt,{})]})})]}),e.jsx(pt,{control:p.control,name:"chapterCount",render:({field:E})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Nmero de captulos"}),e.jsx(dt,{children:e.jsx(gt,{...E,"data-testid":"input-chapter-count",type:"number",min:5,max:50,onChange:A=>E.onChange(parseInt(A.target.value)||25)})}),e.jsx(Mt,{})]})}),e.jsxs("div",{className:"flex flex-wrap gap-6",children:[e.jsx(pt,{control:p.control,name:"hasPrologue",render:({field:E})=>e.jsxs(ct,{className:"flex items-center space-x-2",children:[e.jsx(dt,{children:e.jsx(hr,{"data-testid":"switch-prologue",checked:E.value,onCheckedChange:E.onChange})}),e.jsx(ot,{className:"!mt-0",children:"Prlogo"})]})}),e.jsx(pt,{control:p.control,name:"hasEpilogue",render:({field:E})=>e.jsxs(ct,{className:"flex items-center space-x-2",children:[e.jsx(dt,{children:e.jsx(hr,{"data-testid":"switch-epilogue",checked:E.value,onCheckedChange:E.onChange})}),e.jsx(ot,{className:"!mt-0",children:"Eplogo"})]})}),e.jsx(pt,{control:p.control,name:"hasAuthorNote",render:({field:E})=>e.jsxs(ct,{className:"flex items-center space-x-2",children:[e.jsx(dt,{children:e.jsx(hr,{"data-testid":"switch-author-note",checked:E.value,onCheckedChange:E.onChange})}),e.jsx(ot,{className:"!mt-0",children:"Nota del autor"})]})}),e.jsx(pt,{control:p.control,name:"kindleUnlimited",render:({field:E})=>e.jsxs(ct,{className:"flex items-center space-x-2",children:[e.jsx(dt,{children:e.jsx(hr,{"data-testid":"switch-kindle-unlimited",checked:E.value,onCheckedChange:E.onChange})}),e.jsx(ot,{className:"!mt-0",children:"Kindle Unlimited"})]})})]})]})]}),e.jsxs(me,{children:[e.jsxs(Re,{children:[e.jsx(Ie,{children:"Autor y Serie"}),e.jsx(At,{children:"Asocia la novela a un seudnimo y/o serie existente"})]}),e.jsxs(he,{className:"space-y-4",children:[e.jsx(pt,{control:p.control,name:"pseudonymId",render:({field:E})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Seudnimo"}),e.jsxs(Pt,{onValueChange:C,value:E.value,children:[e.jsx(dt,{children:e.jsx(St,{"data-testid":"select-pseudonym",children:e.jsx(Tt,{placeholder:"Selecciona un seudnimo (opcional)"})})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"none","data-testid":"option-pseudonym-none",children:"Sin seudnimo"}),m.map(A=>e.jsx(ce,{value:A.id.toString(),"data-testid":`option-pseudonym-${A.id}`,children:A.name},A.id))]})]}),e.jsx(Mt,{})]})}),e.jsx(pt,{control:p.control,name:"styleGuideId",render:({field:E})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Gua de Estilo del Autor"}),e.jsxs(Pt,{onValueChange:E.onChange,value:E.value,children:[e.jsx(dt,{children:e.jsx(St,{"data-testid":"select-style-guide",children:e.jsx(Tt,{placeholder:"Selecciona una gua de estilo (opcional)"})})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"none","data-testid":"option-style-guide-none",children:"Sin gua de estilo"}),h.map(A=>{const W=m.find(X=>X.id===A.pseudonymId);return e.jsxs(ce,{value:A.id.toString(),"data-testid":`option-style-guide-${A.id}`,children:[A.title," ",W?`(${W.name})`:""," ",A.isActive?"- Activa":""]},A.id)})]})]}),e.jsx(sn,{children:"Define el estilo narrativo del autor para la generacin de la gua"}),e.jsx(Mt,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(pt,{control:p.control,name:"seriesId",render:({field:E})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Serie"}),e.jsxs(Pt,{onValueChange:E.onChange,value:E.value,children:[e.jsx(dt,{children:e.jsx(St,{"data-testid":"select-series",children:e.jsx(Tt,{placeholder:"Selecciona una serie (opcional)"})})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"none","data-testid":"option-series-none",children:"Obra independiente"}),g.map(A=>e.jsxs(ce,{value:A.id.toString(),"data-testid":`option-series-${A.id}`,children:[A.title," (",A.workType,")"]},A.id))]})]}),e.jsx(Mt,{})]})}),R&&e.jsx(pt,{control:p.control,name:"seriesOrder",render:({field:E})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Nmero en la serie"}),e.jsx(dt,{children:e.jsx(gt,{...E,"data-testid":"input-series-order",type:"number",min:1,onChange:A=>E.onChange(parseInt(A.target.value)||1)})}),e.jsx(Mt,{})]})})]}),e.jsx(pt,{control:p.control,name:"createProject",render:({field:E})=>e.jsxs(ct,{className:"flex items-center space-x-2 pt-2",children:[e.jsx(dt,{children:e.jsx(hr,{"data-testid":"switch-create-project",checked:E.value,onCheckedChange:E.onChange})}),e.jsx(ot,{className:"!mt-0",children:"Crear proyecto automticamente"})]})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(B,{type:"submit",size:"lg",className:"flex-1","data-testid":"button-generate",disabled:v.isPending,children:v.isPending?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"mr-2 h-5 w-5 animate-spin"}),"Generando gua... (puede tardar 1-2 minutos)"]}):e.jsxs(e.Fragment,{children:[e.jsx(xr,{className:"mr-2 h-5 w-5"}),"Generar Gua de Escritura"]})}),v.isPending&&e.jsx(B,{type:"button",size:"lg",variant:"destructive","data-testid":"button-cancel-generation",onClick:()=>j.mutate(),disabled:j.isPending,children:j.isPending?e.jsx(be,{className:"h-5 w-5 animate-spin"}):e.jsx(Gn,{className:"h-5 w-5"})})]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(me,{className:"border-green-500/50 bg-green-500/5",children:[e.jsxs(Re,{children:[e.jsxs(Ie,{className:"flex items-center gap-2 text-green-600 dark:text-green-400","data-testid":"text-success-title",children:[e.jsx(Xt,{className:"h-6 w-6"}),"Gua Generada Exitosamente"]}),e.jsx(At,{"data-testid":"text-project-id",children:i?`Proyecto creado con ID: ${i}`:c?`Gua guardada (ID: ${c}). Puedes verla en Configuracin > Guas Extendidas.`:"Gua generada correctamente"})]}),e.jsx(he,{className:"space-y-4",children:e.jsxs("div",{className:"flex gap-2",children:[i&&e.jsxs(B,{"data-testid":"button-go-to-dashboard",onClick:()=>t("/"),children:[e.jsx(mn,{className:"mr-2 h-4 w-4"}),"Ir al Dashboard"]}),e.jsxs(B,{variant:"outline","data-testid":"button-download-guide",disabled:!r||r.trim().length===0,onClick:()=>{const E=new Blob([r||""],{type:"text/markdown"}),A=URL.createObjectURL(E),W=document.createElement("a");W.href=A,W.download=`guia_${p.getValues("title").toLowerCase().replace(/\s+/g,"_")}.md`,W.click(),URL.revokeObjectURL(A)},children:[e.jsx(yt,{className:"mr-2 h-4 w-4"}),"Descargar Gua"]}),e.jsx(B,{variant:"ghost","data-testid":"button-new-guide",onClick:S,children:"Generar otra gua"})]})})]}),e.jsxs(me,{children:[e.jsx(Re,{children:e.jsxs(Ie,{className:"flex items-center gap-2","data-testid":"text-preview-title",children:[e.jsx(yt,{className:"h-5 w-5"}),"Vista previa de la gua"]})}),e.jsx(he,{children:e.jsx("div",{className:"max-h-[600px] overflow-y-auto",children:r&&r.trim().length>0?e.jsx("pre",{className:"whitespace-pre-wrap text-sm font-mono bg-muted text-foreground p-4 rounded-lg","data-testid":"text-guide-content",children:r}):e.jsx("p",{className:"text-muted-foreground italic p-4","data-testid":"text-guide-empty",children:"La gua no contiene texto. Esto puede ocurrir si la IA no devolvi contenido. Intenta generar de nuevo."})})})]})]})]})}const Ru="series-guide-form-draft",Qf="series-guide-result",To="series-guide-generation-status",Aq=gi({number:pr(),title:Kt().optional(),argument:Kt().optional()}),_q=gi({seriesTitle:Kt().min(1,"El ttulo de la serie es requerido"),concept:Kt().min(50,"El concepto debe tener al menos 50 caracteres"),genre:Kt().default("thriller"),tone:Kt().default("tenso"),bookCount:pr().min(2,"Mnimo 2 libros").max(20,"Mximo 20 libros"),workType:t8(["series","trilogy"]).default("trilogy"),pseudonymId:Kt().optional(),createSeries:mr().default(!0),styleGuideId:Kt().optional(),predefinedVolumes:qE(Aq).optional()});function Iq(){const[,t]=ol(),{toast:n}=nn(),[r,s]=x.useState(!1),i=x.useCallback(()=>{try{const $=localStorage.getItem(Ru);if($)return JSON.parse($)}catch($){console.error("Error loading saved form data:",$)}return null},[]),o=x.useCallback(()=>{try{const $=localStorage.getItem(Qf);if($)return JSON.parse($)}catch($){console.error("Error loading saved result:",$)}return null},[]),c=x.useCallback(()=>{try{const $=localStorage.getItem(To);if($){const q=JSON.parse($);return q.isGenerating&&Date.now()-q.startedAt>3600*1e3?(localStorage.removeItem(To),null):q}}catch($){console.error("Error loading generation status:",$)}return null},[]),d=i(),p=o(),m=c(),[h,g]=x.useState(p?.guide||null),[v,j]=x.useState(p?.seriesId||null),[N,b]=x.useState(m),[C,S]=x.useState(0);x.useEffect(()=>{if(N?.isGenerating){const $=setInterval(()=>{S(Math.floor((Date.now()-N.startedAt)/1e3))},1e3);return()=>clearInterval($)}},[N?.isGenerating,N?.startedAt]);const k=$=>{const q=Math.floor($/60),le=$%60;return`${q}:${le.toString().padStart(2,"0")}`},P=Dc({resolver:Lc(_q),defaultValues:d||{seriesTitle:"",concept:"",genre:"thriller",tone:"tenso",bookCount:3,workType:"trilogy",pseudonymId:"",createSeries:!0,styleGuideId:"",predefinedVolumes:[]}}),R=P.watch();x.useEffect(()=>{const $=setTimeout(()=>{try{localStorage.setItem(Ru,JSON.stringify(R)),s(!0),setTimeout(()=>s(!1),1500)}catch(q){console.error("Error saving form data:",q)}},500);return()=>clearTimeout($)},[R]);const{data:E=[]}=Ke({queryKey:["/api/pseudonyms"]}),{data:A,refetch:W}=Ke({queryKey:["/api/generation-status"],refetchInterval:N?.isGenerating?5e3:1e4}),X=ye({mutationFn:async()=>(await je("POST","/api/cancel-guide-generation")).json(),onSuccess:()=>{localStorage.removeItem(To),b(null),ae.invalidateQueries({queryKey:["/api/generation-status"]}),n({title:"Generacion cancelada",description:"La generacion de la guia fue cancelada"})},onError:$=>{n({title:"Error",description:$.message,variant:"destructive"})}}),se=ye({mutationFn:async $=>{const q={isGenerating:!0,startedAt:Date.now(),seriesTitle:$.seriesTitle,bookCount:Number($.bookCount),currentStep:"guide"};return localStorage.setItem(To,JSON.stringify(q)),b(q),S(0),(await je("POST","/api/generate-series-guide",{...$,bookCount:Number($.bookCount),pseudonymId:$.pseudonymId&&$.pseudonymId!=="none"?parseInt($.pseudonymId):void 0,styleGuideId:$.styleGuideId&&$.styleGuideId!=="none"?parseInt($.styleGuideId):void 0})).json()},onSuccess:$=>{g($.guideContent),j($.seriesId),ae.invalidateQueries({queryKey:["/api/series"]}),localStorage.removeItem(Ru),localStorage.removeItem(To),b(null),localStorage.setItem(Qf,JSON.stringify({guide:$.guideContent,seriesId:$.seriesId})),n({title:"Gua de serie generada exitosamente",description:$.message,duration:1e4})},onError:$=>{localStorage.removeItem(To),b(null),n({title:"Error",description:$.message,variant:"destructive"})}}),V=$=>{se.mutate($)},G=$=>{P.setValue("pseudonymId",$);const q=E.find(le=>le.id.toString()===$);q&&(q.defaultGenre&&P.setValue("genre",q.defaultGenre),q.defaultTone&&P.setValue("tone",q.defaultTone))},O=()=>{g(null),j(null),localStorage.removeItem(Ru),localStorage.removeItem(Qf),P.reset({seriesTitle:"",concept:"",genre:"thriller",tone:"tenso",bookCount:3,workType:"trilogy",pseudonymId:"",createSeries:!0,styleGuideId:""})},F=P.watch("concept")?.length||0,U=P.watch("workType");return e.jsxs("div",{className:"container mx-auto px-6 py-6 max-w-4xl",children:[e.jsxs("div",{className:"mb-6","data-testid":"page-header",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2","data-testid":"text-page-title",children:[e.jsx(pa,{className:"h-8 w-8 text-primary"}),"Generador de Guas de Serie"]}),r&&e.jsxs("span",{className:"text-sm text-muted-foreground flex items-center gap-1","data-testid":"text-saved-indicator",children:[e.jsx(Pp,{className:"h-3 w-3"}),"Borrador guardado"]})]}),e.jsxs("p",{className:"text-muted-foreground mt-2","data-testid":"text-page-description",children:["Genera automticamente una gua editorial completa para una serie de novelas",d&&!h&&e.jsx("span",{className:"ml-2 text-sm text-primary",children:"(Tienes un borrador guardado)"})]})]}),N?.isGenerating?e.jsxs(me,{className:"border-primary",children:[e.jsxs(Re,{children:[e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-5 w-5 animate-spin text-primary"}),"Generando Serie: ",N.seriesTitle]}),e.jsx(At,{children:"Por favor espera mientras se genera la gua de serie"})]}),e.jsxs(he,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Tiempo transcurrido:"}),e.jsx("span",{className:"font-mono font-bold text-lg",children:k(C)})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${N.currentStep==="guide"?"bg-primary text-primary-foreground animate-pulse":"bg-green-500 text-white"}`,children:N.currentStep==="guide"?e.jsx(be,{className:"h-4 w-4 animate-spin"}):e.jsx(Xt,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:"1. Generando gua de la serie"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Planificacin editorial, personajes, tramas y estructura"})]})]})}),e.jsx("div",{className:"bg-muted/50 p-4 rounded-lg",children:e.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Puedes cambiar de pantalla, el progreso se mantendr."})}),e.jsxs(B,{variant:"destructive",onClick:()=>X.mutate(),disabled:X.isPending,className:"w-full","data-testid":"button-cancel-generation",children:[X.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Hs,{className:"h-4 w-4 mr-2"}),"Cancelar Generacion"]})]})]}):A?.isGenerating?e.jsxs(me,{className:"border-orange-500/50 bg-orange-500/5",children:[e.jsxs(Re,{children:[e.jsxs(Ie,{className:"flex items-center gap-2 text-orange-600 dark:text-orange-400","data-testid":"text-server-generation-active",children:[e.jsx(be,{className:"h-6 w-6 animate-spin"}),"Generacin en Curso"]}),e.jsx(At,{children:"Espera a que termine o cancela la generacin actual"})]}),e.jsxs(he,{className:"space-y-4",children:[e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg",children:[e.jsx("p",{className:"font-medium text-lg",children:A.activeGeneration?.type}),e.jsxs("p",{className:"text-xl mt-1",children:['"',A.activeGeneration?.title,'"']}),A.activeGeneration?.startedAt&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-3",children:["Iniciado: ",new Date(A.activeGeneration.startedAt).toLocaleString()]})]}),e.jsxs(B,{variant:"destructive",onClick:()=>X.mutate(),disabled:X.isPending,className:"w-full","data-testid":"button-cancel-server-generation",children:[X.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Hs,{className:"h-4 w-4 mr-2"}),"Cancelar Generacin"]})]})]}):h?e.jsxs("div",{className:"space-y-6",children:[e.jsxs(me,{className:"border-green-500/50 bg-green-500/5",children:[e.jsxs(Re,{children:[e.jsxs(Ie,{className:"flex items-center gap-2 text-green-600 dark:text-green-400","data-testid":"text-success-title",children:[e.jsx(Xt,{className:"h-6 w-6"}),"Gua de Serie Generada Exitosamente"]}),v&&e.jsxs(At,{"data-testid":"text-series-id",children:["Serie creada con ID: ",v]})]}),e.jsx(he,{className:"space-y-4",children:e.jsxs("div",{className:"flex gap-2",children:[v&&e.jsxs(B,{"data-testid":"button-go-to-series",onClick:()=>t("/series"),children:[e.jsx(pa,{className:"mr-2 h-4 w-4"}),"Ir a Series"]}),e.jsxs(B,{variant:"outline","data-testid":"button-download-guide",onClick:()=>{const $=new Blob([h],{type:"text/markdown"}),q=URL.createObjectURL($),le=document.createElement("a");le.href=q,le.download=`guia_serie_${P.getValues("seriesTitle").toLowerCase().replace(/\s+/g,"_")}.md`,le.click(),URL.revokeObjectURL(q)},children:[e.jsx(yt,{className:"mr-2 h-4 w-4"}),"Descargar Gua"]}),e.jsx(B,{variant:"ghost","data-testid":"button-new-guide",onClick:O,children:"Generar otra gua"})]})})]}),e.jsxs(me,{children:[e.jsx(Re,{children:e.jsxs(Ie,{className:"flex items-center gap-2","data-testid":"text-preview-title",children:[e.jsx(yt,{className:"h-5 w-5"}),"Vista previa de la gua"]})}),e.jsx(he,{children:e.jsx("div",{className:"max-h-[600px] overflow-y-auto",children:e.jsx("pre",{className:"whitespace-pre-wrap text-sm font-mono bg-muted text-foreground p-4 rounded-lg","data-testid":"text-guide-content",children:h})})})]})]}):e.jsx(zc,{...P,children:e.jsxs("form",{onSubmit:P.handleSubmit(V),className:"space-y-6",children:[e.jsxs(me,{children:[e.jsxs(Re,{children:[e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(Vu,{className:"h-5 w-5"}),"Datos de la Serie"]}),e.jsx(At,{children:"Define el concepto y la estructura de tu serie"})]}),e.jsxs(he,{className:"space-y-4",children:[e.jsx(pt,{control:P.control,name:"seriesTitle",render:({field:$})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Ttulo de la serie"}),e.jsx(dt,{children:e.jsx(gt,{...$,"data-testid":"input-series-title",placeholder:"Ej: Los Crmenes de Lakeland"})}),e.jsx(Mt,{})]})}),e.jsx(pt,{control:P.control,name:"concept",render:({field:$})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Concepto de la serie"}),e.jsx(dt,{children:e.jsx(Nn,{...$,"data-testid":"input-concept",placeholder:"Describe el concepto general de la serie: el protagonista recurrente, el escenario, el tipo de casos/conflictos, el hilo conductor que unir todos los libros...",className:"min-h-[200px]"})}),e.jsxs(sn,{children:[F," caracteres (mnimo 50)"]}),e.jsx(Mt,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(pt,{control:P.control,name:"genre",render:({field:$})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Gnero"}),e.jsxs(Pt,{onValueChange:$.onChange,value:$.value,children:[e.jsx(dt,{children:e.jsx(St,{"data-testid":"select-genre",children:e.jsx(Tt,{})})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"thriller","data-testid":"option-genre-thriller",children:"Thriller / Suspense"}),e.jsx(ce,{value:"psychological-thriller","data-testid":"option-genre-psych-thriller",children:"Thriller Psicolgico"}),e.jsx(ce,{value:"police-procedural","data-testid":"option-genre-procedural",children:"Thriller Policial"}),e.jsx(ce,{value:"domestic-thriller","data-testid":"option-genre-domestic",children:"Thriller Domstico"}),e.jsx(ce,{value:"romance","data-testid":"option-genre-romance",children:"Romance Contemporneo"}),e.jsx(ce,{value:"historical-romance","data-testid":"option-genre-hist-romance",children:"Romance Histrico"}),e.jsx(ce,{value:"dark-romance","data-testid":"option-genre-dark-romance",children:"Dark Romance"}),e.jsx(ce,{value:"paranormal-romance","data-testid":"option-genre-para-romance",children:"Romance Paranormal"}),e.jsx(ce,{value:"romantasy","data-testid":"option-genre-romantasy",children:"Romantasy"}),e.jsx(ce,{value:"mafia-romance","data-testid":"option-genre-mafia",children:"Mafia Romance"}),e.jsx(ce,{value:"fantasy","data-testid":"option-genre-fantasy",children:"Fantasa pica"}),e.jsx(ce,{value:"urban-fantasy","data-testid":"option-genre-urban",children:"Fantasa Urbana"}),e.jsx(ce,{value:"grimdark","data-testid":"option-genre-grimdark",children:"Fantasa Oscura (Grimdark)"}),e.jsx(ce,{value:"sci-fi","data-testid":"option-genre-scifi",children:"Ciencia Ficcin"}),e.jsx(ce,{value:"space-opera","data-testid":"option-genre-space",children:"Space Opera"}),e.jsx(ce,{value:"dystopia","data-testid":"option-genre-dystopia",children:"Distopa / Post-apocalptico"}),e.jsx(ce,{value:"horror","data-testid":"option-genre-horror",children:"Terror / Horror"}),e.jsx(ce,{value:"psychological-horror","data-testid":"option-genre-psych-horror",children:"Terror Psicolgico"}),e.jsx(ce,{value:"mystery","data-testid":"option-genre-mystery",children:"Misterio"}),e.jsx(ce,{value:"cozy-mystery","data-testid":"option-genre-cozy",children:"Cozy Mystery"}),e.jsx(ce,{value:"crime-noir","data-testid":"option-genre-noir",children:"Crime Fiction / Noir"}),e.jsx(ce,{value:"historical","data-testid":"option-genre-historical",children:"Ficcin Histrica"}),e.jsx(ce,{value:"literary","data-testid":"option-genre-literary",children:"Literaria"}),e.jsx(ce,{value:"young-adult","data-testid":"option-genre-ya",children:"Young Adult (YA)"}),e.jsx(ce,{value:"new-adult","data-testid":"option-genre-na",children:"New Adult (NA)"}),e.jsx(ce,{value:"erotic","data-testid":"option-genre-erotic",children:"Ertico"}),e.jsx(ce,{value:"litrpg","data-testid":"option-genre-litrpg",children:"LitRPG / GameLit"}),e.jsx(ce,{value:"women-fiction","data-testid":"option-genre-women",children:"Women's Fiction"})]})]}),e.jsx(Mt,{})]})}),e.jsx(pt,{control:P.control,name:"tone",render:({field:$})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Tono"}),e.jsxs(Pt,{onValueChange:$.onChange,value:$.value,children:[e.jsx(dt,{children:e.jsx(St,{"data-testid":"select-tone",children:e.jsx(Tt,{})})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"tenso","data-testid":"option-tone-tenso",children:"Tenso"}),e.jsx(ce,{value:"oscuro","data-testid":"option-tone-oscuro",children:"Oscuro"}),e.jsx(ce,{value:"atmosfrico","data-testid":"option-tone-atmosferico",children:"Atmosfrico"}),e.jsx(ce,{value:"ligero","data-testid":"option-tone-ligero",children:"Ligero"}),e.jsx(ce,{value:"dramtico","data-testid":"option-tone-dramatico",children:"Dramtico"}),e.jsx(ce,{value:"pico","data-testid":"option-tone-epico",children:"pico"})]})]}),e.jsx(Mt,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(pt,{control:P.control,name:"workType",render:({field:$})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Tipo de serie"}),e.jsxs(Pt,{onValueChange:$.onChange,value:$.value,children:[e.jsx(dt,{children:e.jsx(St,{"data-testid":"select-work-type",children:e.jsx(Tt,{})})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"trilogy","data-testid":"option-type-trilogy",children:"Triloga (3 libros)"}),e.jsx(ce,{value:"series","data-testid":"option-type-series",children:"Serie extendida"})]})]}),e.jsx(Mt,{})]})}),e.jsx(pt,{control:P.control,name:"bookCount",render:({field:$})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Nmero de libros"}),e.jsx(dt,{children:e.jsx(gt,{...$,"data-testid":"input-book-count",type:"number",min:2,max:20,onChange:q=>$.onChange(parseInt(q.target.value)||3)})}),e.jsx(sn,{children:U==="trilogy"?"Tpicamente 3":"Tpicamente 6-12"}),e.jsx(Mt,{})]})})]})]})]}),e.jsxs(me,{children:[e.jsxs(Re,{children:[e.jsx(Ie,{children:"Autor"}),e.jsx(At,{children:"Asocia la serie a un seudnimo existente"})]}),e.jsxs(he,{className:"space-y-4",children:[e.jsx(pt,{control:P.control,name:"pseudonymId",render:({field:$})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Seudnimo"}),e.jsxs(Pt,{onValueChange:G,value:$.value,children:[e.jsx(dt,{children:e.jsx(St,{"data-testid":"select-pseudonym",children:e.jsx(Tt,{placeholder:"Selecciona un seudnimo (opcional)"})})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"none","data-testid":"option-pseudonym-none",children:"Sin seudnimo"}),E.map(q=>e.jsx(ce,{value:q.id.toString(),"data-testid":`option-pseudonym-${q.id}`,children:q.name},q.id))]})]}),e.jsx(sn,{children:"Si seleccionas un seudnimo con gua de estilo, se usar para personalizar la serie"}),e.jsx(Mt,{})]})}),e.jsx(pt,{control:P.control,name:"createSeries",render:({field:$})=>e.jsxs(ct,{className:"flex items-center space-x-2 pt-2",children:[e.jsx(dt,{children:e.jsx(hr,{"data-testid":"switch-create-series",checked:$.value,onCheckedChange:$.onChange})}),e.jsx(ot,{className:"!mt-0",children:"Crear serie automticamente"})]})})]})]}),e.jsxs(me,{children:[e.jsxs(Re,{children:[e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(Vu,{className:"h-5 w-5"}),"Volmenes Predefinidos (Opcional)"]}),e.jsx(At,{children:"Si ya tienes ttulos y argumentos para los volmenes, ingrsalos aqu y sern respetados en la gua"})]}),e.jsxs(he,{className:"space-y-4",children:[Array.from({length:P.watch("bookCount")||3},($,q)=>e.jsxs("div",{className:"space-y-2 p-4 border rounded-lg",children:[e.jsxs("p",{className:"font-medium text-sm",children:["Volumen ",q+1]}),e.jsx(gt,{placeholder:`Ttulo del volumen ${q+1} (opcional)`,"data-testid":`input-volume-${q+1}-title`,value:P.watch(`predefinedVolumes.${q}.title`)||"",onChange:le=>{const J=[...P.getValues("predefinedVolumes")||[]];J[q]||(J[q]={number:q+1,title:"",argument:""}),J[q]={...J[q],number:q+1,title:le.target.value},P.setValue("predefinedVolumes",J)}}),e.jsx(Nn,{placeholder:`Argumento del volumen ${q+1} (opcional)`,"data-testid":`input-volume-${q+1}-argument`,className:"min-h-[80px]",value:P.watch(`predefinedVolumes.${q}.argument`)||"",onChange:le=>{const J=[...P.getValues("predefinedVolumes")||[]];J[q]||(J[q]={number:q+1,title:"",argument:""}),J[q]={...J[q],number:q+1,argument:le.target.value},P.setValue("predefinedVolumes",J)}})]},q)),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Los campos vacos sern generados automticamente por la IA"})]})]}),e.jsx(B,{type:"submit",size:"lg",className:"w-full","data-testid":"button-generate",disabled:se.isPending,children:se.isPending?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"mr-2 h-5 w-5 animate-spin"}),"Generando gua de serie... (puede tardar 1-2 minutos)"]}):e.jsxs(e.Fragment,{children:[e.jsx(pa,{className:"mr-2 h-5 w-5"}),"Generar Gua de Serie"]})})]})})]})}const Mq=Bi("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),sl=x.forwardRef(({className:t,variant:n,...r},s)=>e.jsx("div",{ref:s,role:"alert",className:Ae(Mq({variant:n}),t),...r}));sl.displayName="Alert";const al=x.forwardRef(({className:t,...n},r)=>e.jsx("h5",{ref:r,className:Ae("mb-1 font-medium leading-none tracking-tight",t),...n}));al.displayName="AlertTitle";const il=x.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:Ae("text-sm [&_p]:leading-relaxed",t),...n}));il.displayName="AlertDescription";function Oq(t){switch(t){case"CRITICAL":return"destructive";case"HIGH":return"destructive";case"MEDIUM":return"secondary";case"LOW":return"outline";default:return"outline"}}function yP(t){switch(t){case"pending":return e.jsx(Q,{variant:"secondary","data-testid":"badge-status-pending",children:"Pendiente"});case"correcting":return e.jsxs(Q,{variant:"secondary","data-testid":"badge-status-correcting",children:[e.jsx(be,{className:"h-3 w-3 animate-spin mr-1"}),"Corrigiendo"]});case"review":return e.jsx(Q,{variant:"default","data-testid":"badge-status-review",children:"En Revisin"});case"approved":return e.jsx(Q,{className:"bg-green-600","data-testid":"badge-status-approved",children:"Aprobado"});case"error":return e.jsx(Q,{variant:"destructive","data-testid":"badge-status-error",children:"Error"});default:return e.jsx(Q,{variant:"outline","data-testid":"badge-status-unknown",children:t})}}function Dq({correction:t,manuscriptId:n,onApprove:r,onReject:s,onStructuralResolve:i,isApproving:o,isRejecting:c,isResolving:d,onUpdateTexts:p}){const[m,h]=x.useState(!1),[g,v]=x.useState(null),[j,N]=x.useState(!1),[b,C]=x.useState(!1),[S,k]=x.useState(!1),[P,R]=x.useState(t.originalText),[E,A]=x.useState(t.correctedText),W=t.status==="pending";t.instruction?.includes("[REQUIERE EDICIN MANUAL]")||t.originalText?.includes("[Edita manualmente");const X=g?.isStructural||!1;x.useEffect(()=>{W&&!b&&se()},[W,b]);const se=async()=>{try{const F=await(await fetch(`/api/corrected-manuscripts/${n}/structural-options/${t.id}`)).json();v(F),C(!0)}catch(O){console.error("Error checking structural status:",O),C(!0)}},V=async()=>{if(!(g||j)){N(!0);try{const F=await(await fetch(`/api/corrected-manuscripts/${n}/structural-options/${t.id}`)).json();v(F)}catch(O){console.error("Error loading structural options:",O)}finally{N(!1)}}},G=O=>{switch(O){case"delete":return e.jsx(wA,{className:"h-4 w-4 mr-2"});case"rewrite":return e.jsx(Ns,{className:"h-4 w-4 mr-2"});case"merge":return e.jsx(r1,{className:"h-4 w-4 mr-2"});default:return null}};return e.jsxs(me,{className:`mb-3 overflow-hidden ${X?"border-amber-500 dark:border-amber-600":""}`,style:{maxWidth:"100%"},"data-testid":`card-correction-${t.id}`,children:[e.jsxs(Re,{className:"py-3 overflow-hidden",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-wrap flex-1",children:[e.jsx(Q,{variant:Oq(t.severity),"data-testid":`badge-severity-${t.id}`,children:t.severity}),X&&e.jsxs(Q,{variant:"outline",className:"border-amber-500 text-amber-600","data-testid":`badge-structural-${t.id}`,children:[e.jsx(yc,{className:"h-3 w-3 mr-1"}),"Estructural"]}),e.jsx("span",{className:"text-sm text-muted-foreground","data-testid":`text-location-${t.id}`,children:t.location})]}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[t.status==="approved"&&e.jsxs(Q,{className:"bg-green-600","data-testid":`badge-approved-${t.id}`,children:[e.jsx(Us,{className:"h-3 w-3 mr-1"}),"Aprobada"]}),t.status==="applied"&&e.jsxs(Q,{className:"bg-blue-600","data-testid":`badge-applied-${t.id}`,children:[e.jsx(Us,{className:"h-3 w-3 mr-1"}),"Aplicada"]}),t.status==="rejected"&&e.jsxs(Q,{variant:"destructive","data-testid":`badge-rejected-${t.id}`,children:[e.jsx(Hs,{className:"h-3 w-3 mr-1"}),"Rechazada"]}),e.jsx(B,{size:"icon",variant:"ghost",onClick:()=>h(!m),"data-testid":`button-expand-${t.id}`,children:e.jsx(fr,{className:"h-4 w-4"})})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",style:{wordBreak:"break-word",overflowWrap:"anywhere"},"data-testid":`text-instruction-${t.id}`,children:t.instruction})]}),m&&e.jsxs(he,{className:"pt-0",children:[X&&W?e.jsxs(sl,{className:"mb-4 border-amber-500 bg-amber-50 dark:bg-amber-950/30",children:[e.jsx(yc,{className:"h-4 w-4 text-amber-600"}),e.jsx(al,{className:"text-amber-700 dark:text-amber-400",children:"Problema Estructural Detectado"}),e.jsx(il,{className:"text-amber-600 dark:text-amber-300 text-sm",children:"Este problema requiere una resolucin estructural. La correccin simple no es suficiente. Selecciona una opcin de resolucin abajo."})]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Texto Original:"}),W&&!S&&e.jsxs(B,{size:"sm",variant:"ghost",className:"h-6 px-2",onClick:()=>k(!0),"data-testid":`button-edit-${t.id}`,children:[e.jsx(ar,{className:"h-3 w-3 mr-1"}),"Editar"]})]}),S?e.jsx(Nn,{value:P,onChange:O=>R(O.target.value),className:"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-sm min-h-[100px]","data-testid":`textarea-original-${t.id}`}):e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 p-3 rounded text-sm border border-red-200 dark:border-red-800","data-testid":`text-original-${t.id}`,children:t.originalText||"[No localizado]"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-1",children:"Texto Corregido:"}),S?e.jsx(Nn,{value:E,onChange:O=>A(O.target.value),className:"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800 text-sm min-h-[100px]","data-testid":`textarea-corrected-${t.id}`}):e.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 p-3 rounded text-sm border border-green-200 dark:border-green-800","data-testid":`text-corrected-${t.id}`,children:t.correctedText||"[Sin correccin]"})]})]}),S&&e.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[e.jsx(B,{size:"sm",variant:"outline",onClick:()=>{k(!1),R(t.originalText),A(t.correctedText)},"data-testid":`button-cancel-edit-${t.id}`,children:"Cancelar"}),e.jsxs(B,{size:"sm",onClick:()=>{p(t.id,P,E),k(!1)},"data-testid":`button-save-edit-${t.id}`,children:[e.jsx(Pp,{className:"h-3 w-3 mr-1"}),"Guardar"]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsx("div",{className:"flex gap-2 text-xs text-muted-foreground","data-testid":`text-diff-stats-${t.id}`,children:!X&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:["+",t.diffStats.wordsAdded," palabras"]}),e.jsxs("span",{children:["-",t.diffStats.wordsRemoved," palabras"]}),e.jsxs("span",{children:["(",t.diffStats.lengthChange>0?"+":"",t.diffStats.lengthChange," caracteres)"]})]})}),W&&e.jsx("div",{className:"flex gap-2",children:X?e.jsxs(mv,{onOpenChange:O=>O&&V(),children:[e.jsx(hv,{asChild:!0,children:e.jsxs(B,{size:"sm",className:"bg-amber-600",disabled:d,"data-testid":`button-structural-options-${t.id}`,children:[d?e.jsx(be,{className:"h-4 w-4 animate-spin mr-1"}):e.jsx(yc,{className:"h-4 w-4 mr-1"}),"Resolver Problema",e.jsx(Qs,{className:"h-4 w-4 ml-1"})]})}),e.jsxs(sm,{align:"end",className:"w-80",children:[e.jsx(P2,{children:"Opciones de Resolucin"}),e.jsx(T2,{}),j?e.jsxs("div",{className:"flex items-center justify-center py-4",children:[e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}),"Cargando opciones..."]}):g?.isStructural?g.options.map(O=>e.jsxs(Zo,{onClick:()=>i(t.id,O.id),className:"flex flex-col items-start py-3 cursor-pointer","data-testid":`menu-item-${O.id}`,children:[e.jsxs("div",{className:"flex items-center font-medium",children:[G(O.type),O.label]}),e.jsx("span",{className:"text-xs text-muted-foreground ml-6 mt-1",children:O.description}),O.estimatedTokens&&e.jsxs("span",{className:"text-xs text-amber-600 ml-6",children:["~",O.estimatedTokens," tokens"]})]},O.id)):e.jsx("div",{className:"py-2 px-3 text-sm text-muted-foreground",children:g?.error||"No se encontraron opciones de resolucin"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(B,{size:"sm",variant:"outline",onClick:()=>s(t.id),disabled:c,"data-testid":`button-reject-${t.id}`,children:[c?e.jsx(be,{className:"h-4 w-4 animate-spin"}):e.jsx(qA,{className:"h-4 w-4 mr-1"}),"Rechazar"]}),e.jsxs(B,{size:"sm",onClick:()=>r(t.id),disabled:o,"data-testid":`button-approve-${t.id}`,children:[o?e.jsx(be,{className:"h-4 w-4 animate-spin"}):e.jsx(UA,{className:"h-4 w-4 mr-1"}),"Aprobar"]})]})})]})]})]})}function Lq({manuscript:t,onBack:n}){const{toast:r}=nn(),[s,i]=x.useState(null),[o,c]=x.useState(null),[d,p]=x.useState(null),m=t.pendingCorrections||[],h=m.filter(P=>P.status==="pending").length,g=m.filter(P=>P.status==="approved"||P.status==="applied").length,v=m.filter(P=>P.status==="rejected").length,j=ye({mutationFn:async P=>(i(P),(await je("POST",`/api/corrected-manuscripts/${t.id}/approve/${P}`)).json()),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/corrected-manuscripts",t.id]}),r({title:"Correccin aprobada"}),i(null)},onError:P=>{r({title:"Error",description:P.message,variant:"destructive"}),i(null)}}),N=ye({mutationFn:async P=>(c(P),(await je("POST",`/api/corrected-manuscripts/${t.id}/reject/${P}`)).json()),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/corrected-manuscripts",t.id]}),r({title:"Correccin rechazada"}),c(null)},onError:P=>{r({title:"Error",description:P.message,variant:"destructive"}),c(null)}}),b=ye({mutationFn:async({correctionId:P,optionId:R})=>(p(P),(await je("POST",`/api/corrected-manuscripts/${t.id}/structural-resolve/${P}`,{optionId:R})).json()),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/corrected-manuscripts",t.id]}),r({title:"Resolucin aplicada",description:"El problema estructural ha sido resuelto."}),p(null)},onError:P=>{r({title:"Error",description:P.message,variant:"destructive"}),p(null)}}),C=(P,R)=>{b.mutate({correctionId:P,optionId:R})},S=ye({mutationFn:async()=>(await je("POST",`/api/corrected-manuscripts/${t.id}/finalize`)).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/corrected-manuscripts"]}),ae.invalidateQueries({queryKey:["/api/corrected-manuscripts",t.id]}),r({title:"Manuscrito finalizado",description:"El manuscrito ha sido aprobado."})},onError:P=>{r({title:"Error",description:P.message,variant:"destructive"})}}),k=ye({mutationFn:async({id:P,original:R,corrected:E})=>(await je("PATCH",`/api/corrected-manuscripts/${t.id}/update-texts/${P}`,{originalText:R,correctedText:E})).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/corrected-manuscripts",t.id]}),r({title:"Textos actualizados"})},onError:P=>{r({title:"Error",description:P.message,variant:"destructive"})}});return e.jsxs("div",{className:"space-y-4 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsxs(B,{variant:"ghost",size:"sm",onClick:n,"data-testid":"button-back",children:[e.jsx(QN,{className:"h-4 w-4 mr-1"})," Volver"]}),e.jsx("h2",{className:"text-xl font-bold truncate","data-testid":"text-manuscript-title",children:t.projectTitle||"Manuscrito"}),yP(t.status)]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsx(me,{children:e.jsxs(he,{className:"pt-4",children:[e.jsx("div",{className:"text-2xl font-bold","data-testid":"text-total-issues",children:t.totalIssues||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Issues"})]})}),e.jsx(me,{children:e.jsxs(he,{className:"pt-4",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600","data-testid":"text-pending-count",children:h}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Pendientes"})]})}),e.jsx(me,{children:e.jsxs(he,{className:"pt-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600","data-testid":"text-approved-count",children:g}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Aprobadas"})]})}),e.jsx(me,{children:e.jsxs(he,{className:"pt-4",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600","data-testid":"text-rejected-count",children:v}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Rechazadas"})]})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(B,{variant:"outline",onClick:()=>window.open(`/api/corrected-manuscripts/${t.id}/download`,"_blank"),"data-testid":"button-download",children:[e.jsx(xn,{className:"h-4 w-4 mr-2"})," Descargar MD"]}),t.status==="review"&&h===0&&e.jsxs(B,{onClick:()=>S.mutate(),disabled:S.isPending,"data-testid":"button-finalize",children:[S.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(jA,{className:"h-4 w-4 mr-2"}),"Finalizar Manuscrito"]})]}),e.jsxs(me,{className:"overflow-hidden",children:[e.jsxs(Re,{children:[e.jsx(Ie,{children:"Correcciones"}),e.jsx(At,{children:"Revisa y aprueba o rechaza cada correccin propuesta."})]}),e.jsx(he,{className:"min-w-0",children:e.jsx(jt,{className:"h-[500px]",children:m.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8","data-testid":"text-no-corrections",children:"No hay correcciones para mostrar."}):m.map(P=>e.jsx(Dq,{correction:P,manuscriptId:t.id,onApprove:R=>j.mutate(R),onReject:R=>N.mutate(R),onStructuralResolve:C,onUpdateTexts:(R,E,A)=>k.mutate({id:R,original:E,corrected:A}),isApproving:s===P.id,isRejecting:o===P.id,isResolving:d===P.id},P.id))})})]})]})}function Fq(){const{toast:t}=nn(),[n,r]=x.useState(null),{data:s=[],isLoading:i}=Ke({queryKey:["/api/corrected-manuscripts"]}),{data:o}=Ke({queryKey:["/api/corrected-manuscripts",n],enabled:!!n}),[,c]=ol(),d=ye({mutationFn:async m=>(await je("DELETE",`/api/corrected-manuscripts/${m}`)).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/corrected-manuscripts"]}),t({title:"Manuscrito eliminado"})},onError:m=>{t({title:"Error",description:m.message,variant:"destructive"})}}),p=ye({mutationFn:async m=>(await je("POST",`/api/projects/${m}/start-audit`)).json(),onSuccess:m=>{t({title:"Auditora iniciada",description:"Redirigiendo al auditor..."}),c("/auditor")},onError:m=>{t({title:"Error",description:m.message,variant:"destructive"})}});return o?e.jsx("div",{className:"p-6 min-w-0 w-full overflow-hidden",children:e.jsx(Lq,{manuscript:o,onBack:()=>r(null)})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Hu,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold","data-testid":"text-page-title",children:"Manuscritos Corregidos"}),e.jsx("p",{className:"text-muted-foreground",children:"Correcciones quirrgicas aplicadas por DeepSeek"})]})]}),e.jsx(Ja,{href:"/auditor",children:e.jsxs(B,{variant:"outline","data-testid":"button-go-auditor",children:[e.jsx(QN,{className:"h-4 w-4 mr-2"})," Volver al Auditor"]})})]}),i?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(be,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):s.length===0?e.jsxs(sl,{children:[e.jsx(on,{className:"h-4 w-4"}),e.jsx(al,{children:"Sin manuscritos corregidos"}),e.jsx(il,{children:"No hay manuscritos corregidos an. Primero ejecuta una auditora y luego inicia el proceso de correccin."})]}):e.jsx("div",{className:"grid gap-4",children:s.map(m=>e.jsxs(me,{className:"hover-elevate cursor-pointer",onClick:()=>r(m.id),"data-testid":`card-manuscript-${m.id}`,children:[e.jsxs(Re,{className:"pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Ie,{className:"text-lg","data-testid":`text-title-${m.id}`,children:m.projectTitle||`Proyecto #${m.projectId}`}),e.jsxs("div",{className:"flex items-center gap-2",children:[yP(m.status),e.jsx(B,{size:"icon",variant:"ghost",title:"Descargar Manuscrito MD",onClick:h=>{h.stopPropagation(),window.open(`/api/corrected-manuscripts/${m.id}/download`,"_blank")},"data-testid":`button-download-${m.id}`,children:e.jsx(xn,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx(B,{size:"icon",variant:"ghost",title:"Re-Auditar Manuscrito",onClick:h=>{h.stopPropagation(),p.mutate(m.projectId)},disabled:p.isPending,"data-testid":`button-reaudit-${m.id}`,children:p.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin"}):e.jsx(Bu,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx(B,{size:"icon",variant:"ghost",title:"Eliminar Manuscrito",onClick:h=>{h.stopPropagation(),d.mutate(m.id)},"data-testid":`button-delete-${m.id}`,children:e.jsx(Rn,{className:"h-4 w-4 text-muted-foreground"})})]})]}),e.jsx(At,{"data-testid":`text-date-${m.id}`,children:new Date(m.createdAt).toLocaleString()})]}),e.jsx(he,{children:e.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[e.jsxs("div",{"data-testid":`text-stats-total-${m.id}`,children:[e.jsx("span",{className:"text-muted-foreground",children:"Issues: "}),e.jsx("span",{className:"font-medium",children:m.totalIssues||0})]}),e.jsxs("div",{"data-testid":`text-stats-corrected-${m.id}`,children:[e.jsx("span",{className:"text-muted-foreground",children:"Corregidas: "}),e.jsx("span",{className:"font-medium text-green-600",children:m.approvedIssues||0})]}),e.jsxs("div",{"data-testid":`text-stats-rejected-${m.id}`,children:[e.jsx("span",{className:"text-muted-foreground",children:"Rechazadas: "}),e.jsx("span",{className:"font-medium text-red-600",children:m.rejectedIssues||0})]})]})})]},m.id))})]})}const $q=`# GUA DE ESTILO: [NOMBRE DEL SEUDNIMO]

---

## 1. IDENTIDAD DEL AUTOR

### Datos del Seudnimo
- **Nombre completo:** [Nombre del seudnimo]
- **Gnero literario principal:** [Thriller / Romance / Fantasa / etc.]
- **Subgneros:** [Ej: Thriller psicolgico, Suspense domstico]
- **Pblico objetivo:** [Edad, gnero, intereses del lector ideal]

### Biografa Ficticia
[2-3 prrafos con la historia del "autor" para contraportadas y marketing]

---

## 2. VOZ NARRATIVA

### Punto de Vista Preferido
- [ ] Primera persona
- [ ] Tercera persona limitada
- [ ] Tercera persona omnisciente
- [ ] Mltiples POV

### Tiempo Verbal
- [ ] Pasado
- [ ] Presente

### Registro Lingstico
- **Formalidad:** [1-5, donde 1=muy coloquial, 5=muy formal]
- **Complejidad:** [1-5, donde 1=frases simples, 5=frases complejas]
- **Vocabulario:** [Accesible / Tcnico / Literario / Regional]

### Ritmo de Prosa
- **Longitud de frases:** [Cortas y punzantes / Variadas / Largas y fluidas]
- **Longitud de prrafos:** [Breves / Moderados / Extensos]
- **Uso de dilogo vs. narracin:** [70/30, 50/50, 30/70]

---

## 3. ESTRUCTURA NARRATIVA

### Captulos
- **Longitud tpica:** [1500-2500 palabras / 2500-4000 / otro]
- **Inicio de captulo:** [In medias res / Contextual / Gancho de dilogo]
- **Final de captulo:** [Cliffhanger obligatorio / Cierre parcial / Vara]

### Escenas
- **Escenas por captulo:** [2-3 / 3-5 / Variable]
- **Transiciones:** [Corte seco / Marcador visual / Transicin narrativa]

---

## 4. TEMAS RECURRENTES

### Temas Centrales
1. [Tema 1]: [Cmo se explora tpicamente]
2. [Tema 2]: [Cmo se explora tpicamente]
3. [Tema 3]: [Cmo se explora tpicamente]

### Motivos Literarios
- [Motivo 1]: [Ej: Espejos como smbolo de dualidad]
- [Motivo 2]: [Ej: Agua como purificacin o peligro]

---

## 5. PERSONAJES

### Arquetipos de Protagonista
- **Gnero tpico:** [Femenino / Masculino / Variable]
- **Rango de edad:** [25-40 / 30-50 / Variable]
- **Defecto caracterstico:** [Ej: Tendencia a la desconfianza]
- **Fortaleza tpica:** [Ej: Resiliencia ante la adversidad]

### Relaciones
- **Romance:** [Central / Subtrama / Ausente]
- **Nivel de contenido adulto:** [Cerrado / Insinuado / Explcito]

---

## 6. AMBIENTACIN

### Localizaciones Tpicas
- **Tipo de escenario:** [Urbano / Rural / Mixto]
- **Regin geogrfica:** [Espaa / Latinoamrica / Ficticio / Variable]
- **poca:** [Contemporneo / Histrico / Futuro]
- **Atmsfera:** [Claustrofbica / Abierta / Opresiva / Acogedora]

---

## 7. DILOGOS

### Estilo de Dilogo
- **Naturalidad:** [Muy natural / Estilizado / Formal]
- **Acotaciones:** [Mnimas / Moderadas / Descriptivas]

### Verbos de Habla
- **Preferencia:** ["Dijo" mayoritario / Variedad / Eliminar cuando posible]

---

## 8. RECURSOS ESTILSTICOS

### Figuras Retricas Preferidas
- [ ] Metforas
- [ ] Smiles
- [ ] Irona
- [ ] Repeticin enftica

### Tcnicas Narrativas
- [ ] Flashbacks
- [ ] Narrativa no lineal
- [ ] Mltiples lneas temporales
- [ ] Narrador no fiable

---

## 9. PROHIBICIONES Y RESTRICCIONES

### Vocabulario Prohibido
- [Palabra/frase 1]: [Por qu evitarla]
- [Palabra/frase 2]: [Por qu evitarla]

### Tropos a Evitar
- [Tropo 1]: [Ej: El villano que explica su plan]
- [Tropo 2]: [Ej: Deus ex machina]

### Contenido Restringido
- Violencia grfica: [Permitida / Moderada / Evitar]
- Contenido sexual: [Explcito / Insinuado / Evitar]
- Lenguaje soez: [Libre / Moderado / Evitar]

---

## 10. REFERENCIAS E INFLUENCIAS

### Autores de Referencia
1. [Autor 1]: [Qu tomar de su estilo]
2. [Autor 2]: [Qu tomar de su estilo]

---

## 11. FORMATO Y PRESENTACIN

### Formato de Manuscrito
- **Longitud objetivo:** [60.000-80.000 palabras / otro]
- **Captulos tpicos:** [20-25 / 30-40 / otro]
- **Prlogo:** [Siempre / A veces / Nunca]
- **Eplogo:** [Siempre / A veces / Nunca]

---

*ltima actualizacin: [Fecha]*
`,zq=gi({title:Kt().min(1,"El ttulo es requerido"),content:Kt().min(100,"El contenido debe tener al menos 100 caracteres"),pseudonymId:Kt().optional(),newPseudonymName:Kt().optional(),createNewPseudonym:mr().default(!1),isActive:mr().default(!0)}),Vq=gi({referenceAuthor:Kt().min(1,"El autor de referencia es requerido"),pseudonymName:Kt().min(1,"El nombre del seudnimo es requerido"),genre:Kt().optional(),additionalNotes:Kt().optional(),pseudonymId:Kt().optional(),createPseudonym:mr().default(!0),saveGuide:mr().default(!0)});function qq(){const{toast:t}=nn(),[n,r]=x.useState(null),[s,i]=x.useState(!1),[o,c]=x.useState(!1),[d,p]=x.useState(null),m=Dc({resolver:Lc(zq),defaultValues:{title:"",content:"",pseudonymId:"",newPseudonymName:"",createNewPseudonym:!1,isActive:!0}}),h=Dc({resolver:Lc(Vq),defaultValues:{referenceAuthor:"",pseudonymName:"",genre:"",additionalNotes:"",pseudonymId:"",createPseudonym:!0,saveGuide:!0}}),g=m.watch("createNewPseudonym"),v=h.watch("createPseudonym"),{data:j=[]}=Ke({queryKey:["/api/pseudonyms"]}),{data:N=[],isLoading:b}=Ke({queryKey:["/api/all-style-guides"]}),C=ye({mutationFn:async F=>(await je("POST","/api/pseudonyms",{name:F})).json()}),S=ye({mutationFn:async F=>(await je("POST",`/api/pseudonyms/${F.pseudonymId}/style-guides`,{title:F.title,content:F.content,isActive:F.isActive})).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/all-style-guides"]}),ae.invalidateQueries({queryKey:["/api/pseudonyms"]}),m.reset(),t({title:"Gua de estilo creada",description:"La gua ha sido guardada exitosamente"})},onError:F=>{t({title:"Error",description:F.message,variant:"destructive"})}}),k=ye({mutationFn:async F=>(await je("PATCH",`/api/style-guides/${F.id}`,{title:F.title,content:F.content,isActive:F.isActive})).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/all-style-guides"]}),i(!1),r(null),m.reset(),t({title:"Gua actualizada"})},onError:F=>{t({title:"Error",description:F.message,variant:"destructive"})}}),P=ye({mutationFn:async F=>{await je("DELETE",`/api/style-guides/${F}`)},onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/all-style-guides"]}),t({title:"Gua eliminada"})},onError:F=>{t({title:"Error",description:F.message,variant:"destructive"})}}),R=ye({mutationFn:async F=>(await je("POST","/api/generate-style-guide",{...F,pseudonymId:F.pseudonymId&&F.pseudonymId!=="none"?parseInt(F.pseudonymId):void 0})).json(),onSuccess:F=>{p(F.guideContent),ae.invalidateQueries({queryKey:["/api/all-style-guides"]}),ae.invalidateQueries({queryKey:["/api/pseudonyms"]}),t({title:"Gua generada",description:F.message})},onError:F=>{t({title:"Error",description:F.message,variant:"destructive"})}}),E=async F=>{let U;if(F.createNewPseudonym&&F.newPseudonymName)try{U=(await C.mutateAsync(F.newPseudonymName)).id}catch{t({title:"Error",description:"No se pudo crear el seudnimo",variant:"destructive"});return}else if(F.pseudonymId&&F.pseudonymId!=="none")U=parseInt(F.pseudonymId);else{t({title:"Error",description:"Debes seleccionar o crear un seudnimo",variant:"destructive"});return}s&&n?k.mutate({id:n.id,title:F.title,content:F.content,isActive:F.isActive}):S.mutate({pseudonymId:U,title:F.title,content:F.content,isActive:F.isActive})},A=()=>{m.setValue("content",$q),t({title:"Plantilla cargada",description:"Rellena los campos marcados con [corchetes]"})},W=F=>{R.mutate(F)},X=()=>{p(null),h.reset()},se=F=>{r(F),i(!0),m.setValue("title",F.title),m.setValue("content",F.content),m.setValue("isActive",F.isActive),m.setValue("pseudonymId",F.pseudonymId?.toString()||""),m.setValue("createNewPseudonym",!1)},V=()=>{i(!1),r(null),m.reset()},G=F=>{const U=new Blob([F.content],{type:"text/markdown"}),$=URL.createObjectURL(U),q=document.createElement("a");q.href=$,q.download=`${F.title.toLowerCase().replace(/\s+/g,"_")}.md`,q.click(),URL.revokeObjectURL($)},O=F=>F?j.find($=>$.id===F)?.name||"Desconocido":"Sin asignar";return e.jsxs("div",{className:"container mx-auto px-6 py-6 max-w-6xl",children:[e.jsxs("div",{className:"mb-6","data-testid":"page-header",children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2","data-testid":"text-page-title",children:[e.jsx(Ep,{className:"h-8 w-8 text-primary"}),"Guas de Estilo"]}),e.jsx("p",{className:"text-muted-foreground mt-2","data-testid":"text-page-description",children:"Crea y gestiona las guas de estilo para tus seudnimos"})]}),e.jsxs(ci,{defaultValue:"generate",className:"space-y-6",children:[e.jsxs(ga,{"data-testid":"tabs-list",children:[e.jsxs(Bt,{value:"generate","data-testid":"tab-generate",children:[e.jsx(xr,{className:"h-4 w-4 mr-2"}),"Generar con IA"]}),e.jsxs(Bt,{value:"create","data-testid":"tab-create",children:[e.jsx(Nr,{className:"h-4 w-4 mr-2"}),s?"Editar Gua":"Crear Manual"]}),e.jsxs(Bt,{value:"list","data-testid":"tab-list",children:[e.jsx(yt,{className:"h-4 w-4 mr-2"}),"Guas (",N.length,")"]})]}),e.jsx(Gt,{value:"generate",children:d?e.jsxs("div",{className:"space-y-6",children:[e.jsxs(me,{className:"border-green-500/50 bg-green-500/5",children:[e.jsxs(Re,{children:[e.jsxs(Ie,{className:"flex items-center gap-2 text-green-600 dark:text-green-400",children:[e.jsx(Tn,{className:"h-6 w-6"}),"Gua de Estilo Generada"]}),e.jsxs(At,{children:["Basada en el estilo de ",h.getValues("referenceAuthor")]})]}),e.jsx(he,{className:"space-y-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(B,{variant:"outline","data-testid":"button-download-generated",onClick:()=>{const F=new Blob([d],{type:"text/markdown"}),U=URL.createObjectURL(F),$=document.createElement("a");$.href=U,$.download=`guia_estilo_${h.getValues("pseudonymName").toLowerCase().replace(/\s+/g,"_")}.md`,$.click(),URL.revokeObjectURL(U)},children:[e.jsx(xn,{className:"mr-2 h-4 w-4"}),"Descargar"]}),e.jsx(B,{variant:"ghost","data-testid":"button-new-generation",onClick:X,children:"Generar otra gua"})]})})]}),e.jsxs(me,{children:[e.jsx(Re,{children:e.jsx(Ie,{children:"Contenido de la Gua"})}),e.jsx(he,{children:e.jsxs(ci,{defaultValue:"preview",className:"w-full",children:[e.jsxs(ga,{className:"mb-4",children:[e.jsx(Bt,{value:"preview",children:"Vista Previa"}),e.jsx(Bt,{value:"code",children:"Cdigo Markdown"})]}),e.jsx(Gt,{value:"preview",children:e.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none max-h-[500px] overflow-y-auto bg-muted/30 p-4 rounded-lg",children:e.jsx(Iv,{children:d||""})})}),e.jsx(Gt,{value:"code",children:e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:e.jsx("pre",{className:"whitespace-pre-wrap text-sm font-mono bg-muted p-4 rounded-lg",children:d})})})]})})]})]}):e.jsx(zc,{...h,children:e.jsxs("form",{onSubmit:h.handleSubmit(W),className:"space-y-6",children:[e.jsxs(me,{children:[e.jsxs(Re,{children:[e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(xr,{className:"h-5 w-5"}),"Generar Gua de Estilo con IA"]}),e.jsx(At,{children:"Genera automticamente una gua de estilo basada en el estilo de un autor conocido"})]}),e.jsxs(he,{className:"space-y-4",children:[e.jsx(pt,{control:h.control,name:"referenceAuthor",render:({field:F})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Autor de referencia"}),e.jsx(dt,{children:e.jsx(gt,{...F,"data-testid":"input-reference-author",placeholder:"Ej: Stephen King, Gillian Flynn, Paula Hawkins..."})}),e.jsx(sn,{children:"El estilo de este autor servir como base para la gua"}),e.jsx(Mt,{})]})}),e.jsx(pt,{control:h.control,name:"pseudonymName",render:({field:F})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Nombre del seudnimo"}),e.jsx(dt,{children:e.jsx(gt,{...F,"data-testid":"input-pseudonym-name",placeholder:"Ej: Elena Blackwood"})}),e.jsx(Mt,{})]})}),e.jsx(pt,{control:h.control,name:"genre",render:({field:F})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Gnero objetivo (opcional)"}),e.jsxs(Pt,{onValueChange:F.onChange,value:F.value,children:[e.jsx(dt,{children:e.jsx(St,{"data-testid":"select-genre",children:e.jsx(Tt,{placeholder:"Selecciona un gnero"})})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"none",children:"Sin especificar"}),e.jsx(ce,{value:"thriller",children:"Thriller / Suspense"}),e.jsx(ce,{value:"psychological-thriller",children:"Thriller Psicolgico"}),e.jsx(ce,{value:"domestic-thriller",children:"Thriller Domstico"}),e.jsx(ce,{value:"romance",children:"Romance Contemporneo"}),e.jsx(ce,{value:"historical-romance",children:"Romance Histrico"}),e.jsx(ce,{value:"dark-romance",children:"Dark Romance"}),e.jsx(ce,{value:"paranormal-romance",children:"Romance Paranormal"}),e.jsx(ce,{value:"romantasy",children:"Romantasy"}),e.jsx(ce,{value:"mafia-romance",children:"Mafia Romance"}),e.jsx(ce,{value:"fantasy",children:"Fantasa pica"}),e.jsx(ce,{value:"urban-fantasy",children:"Fantasa Urbana"}),e.jsx(ce,{value:"grimdark",children:"Fantasa Oscura (Grimdark)"}),e.jsx(ce,{value:"sci-fi",children:"Ciencia Ficcin"}),e.jsx(ce,{value:"space-opera",children:"Space Opera"}),e.jsx(ce,{value:"dystopia",children:"Distopa / Post-apocalptico"}),e.jsx(ce,{value:"horror",children:"Terror / Horror"}),e.jsx(ce,{value:"psychological-horror",children:"Terror Psicolgico"}),e.jsx(ce,{value:"mystery",children:"Misterio"}),e.jsx(ce,{value:"cozy-mystery",children:"Cozy Mystery"}),e.jsx(ce,{value:"crime-noir",children:"Crime Fiction / Noir"}),e.jsx(ce,{value:"historical",children:"Ficcin Histrica"}),e.jsx(ce,{value:"literary",children:"Literaria"}),e.jsx(ce,{value:"young-adult",children:"Young Adult (YA)"}),e.jsx(ce,{value:"new-adult",children:"New Adult (NA)"}),e.jsx(ce,{value:"erotic",children:"Ertico"}),e.jsx(ce,{value:"litrpg",children:"LitRPG / GameLit"}),e.jsx(ce,{value:"women-fiction",children:"Women's Fiction"})]})]}),e.jsx(Mt,{})]})}),e.jsx(pt,{control:h.control,name:"additionalNotes",render:({field:F})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Notas adicionales (opcional)"}),e.jsx(dt,{children:e.jsx(Nn,{...F,"data-testid":"input-additional-notes",placeholder:"Instrucciones especficas: qu aspectos enfatizar, qu evitar, preferencias particulares...",className:"min-h-[100px]"})}),e.jsx(Mt,{})]})}),e.jsx(pt,{control:h.control,name:"createPseudonym",render:({field:F})=>e.jsxs(ct,{className:"flex items-center space-x-2",children:[e.jsx(dt,{children:e.jsx(hr,{"data-testid":"switch-create-pseudonym-gen",checked:F.value,onCheckedChange:F.onChange})}),e.jsx(ot,{className:"!mt-0",children:"Crear nuevo seudnimo automticamente"})]})}),!v&&e.jsx(pt,{control:h.control,name:"pseudonymId",render:({field:F})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Asignar a seudnimo existente"}),e.jsxs(Pt,{onValueChange:F.onChange,value:F.value,children:[e.jsx(dt,{children:e.jsx(St,{"data-testid":"select-pseudonym-gen",children:e.jsx(Tt,{placeholder:"Selecciona un seudnimo"})})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"none",children:"Selecciona un seudnimo"}),j.map(U=>e.jsx(ce,{value:U.id.toString(),children:U.name},U.id))]})]}),e.jsx(Mt,{})]})}),e.jsx(pt,{control:h.control,name:"saveGuide",render:({field:F})=>e.jsxs(ct,{className:"flex items-center space-x-2",children:[e.jsx(dt,{children:e.jsx(hr,{"data-testid":"switch-save-guide",checked:F.value,onCheckedChange:F.onChange})}),e.jsx(ot,{className:"!mt-0",children:"Guardar gua automticamente"})]})})]})]}),e.jsx(B,{type:"submit",size:"lg",className:"w-full","data-testid":"button-generate-style",disabled:R.isPending,children:R.isPending?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"mr-2 h-5 w-5 animate-spin"}),"Analizando estilo y generando gua..."]}):e.jsxs(e.Fragment,{children:[e.jsx(xr,{className:"mr-2 h-5 w-5"}),"Generar Gua de Estilo"]})})]})})}),e.jsx(Gt,{value:"create",children:e.jsx(zc,{...m,children:e.jsxs("form",{onSubmit:m.handleSubmit(E),className:"space-y-6",children:[e.jsxs(me,{children:[e.jsxs(Re,{children:[e.jsx(Ie,{children:s?"Editar Gua de Estilo":"Nueva Gua de Estilo"}),e.jsx(At,{children:"Define el estilo literario, voz narrativa y preferencias de escritura"})]}),e.jsxs(he,{className:"space-y-4",children:[e.jsx(pt,{control:m.control,name:"title",render:({field:F})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Ttulo de la gua"}),e.jsx(dt,{children:e.jsx(gt,{...F,"data-testid":"input-title",placeholder:"Ej: Estilo Thriller Psicolgico"})}),e.jsx(Mt,{})]})}),!s&&e.jsxs(e.Fragment,{children:[e.jsx(pt,{control:m.control,name:"createNewPseudonym",render:({field:F})=>e.jsxs(ct,{className:"flex items-center space-x-2",children:[e.jsx(dt,{children:e.jsx(hr,{"data-testid":"switch-create-pseudonym",checked:F.value,onCheckedChange:F.onChange})}),e.jsx(ot,{className:"!mt-0",children:"Crear nuevo seudnimo"})]})}),g?e.jsx(pt,{control:m.control,name:"newPseudonymName",render:({field:F})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Nombre del nuevo seudnimo"}),e.jsx(dt,{children:e.jsx(gt,{...F,"data-testid":"input-new-pseudonym",placeholder:"Ej: Elena Blackwood"})}),e.jsx(Mt,{})]})}):e.jsx(pt,{control:m.control,name:"pseudonymId",render:({field:F})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Asignar a seudnimo"}),e.jsxs(Pt,{onValueChange:F.onChange,value:F.value,children:[e.jsx(dt,{children:e.jsx(St,{"data-testid":"select-pseudonym",children:e.jsx(Tt,{placeholder:"Selecciona un seudnimo"})})}),e.jsxs(kt,{children:[e.jsx(ce,{value:"none","data-testid":"option-pseudonym-none",children:"Selecciona un seudnimo"}),j.map(U=>e.jsx(ce,{value:U.id.toString(),"data-testid":`option-pseudonym-${U.id}`,children:U.name},U.id))]})]}),e.jsx(sn,{children:"La gua se asociar a este seudnimo"}),e.jsx(Mt,{})]})})]}),e.jsx(pt,{control:m.control,name:"isActive",render:({field:F})=>e.jsxs(ct,{className:"flex items-center space-x-2",children:[e.jsx(dt,{children:e.jsx(hr,{"data-testid":"switch-active",checked:F.value,onCheckedChange:F.onChange})}),e.jsx(ot,{className:"!mt-0",children:"Gua activa (se usar en generacin)"})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(B,{type:"button",variant:"outline",onClick:A,"data-testid":"button-use-template",children:[e.jsx(Uu,{className:"h-4 w-4 mr-2"}),"Usar Plantilla"]})}),e.jsx(pt,{control:m.control,name:"content",render:({field:F})=>e.jsxs(ct,{children:[e.jsx(ot,{children:"Contenido de la gua"}),e.jsx(dt,{children:e.jsx(Nn,{...F,"data-testid":"input-content",placeholder:"Escribe o pega aqu el contenido de la gua de estilo...",className:"min-h-[400px] font-mono text-sm"})}),e.jsxs(sn,{children:[F.value?.length||0," caracteres"]}),e.jsx(Mt,{})]})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[s&&e.jsx(B,{type:"button",variant:"outline",onClick:V,"data-testid":"button-cancel-edit",children:"Cancelar"}),e.jsx(B,{type:"submit",className:"flex-1","data-testid":"button-save",disabled:S.isPending||k.isPending,children:S.isPending||k.isPending?"Guardando...":s?e.jsxs(e.Fragment,{children:[e.jsx(Tn,{className:"h-4 w-4 mr-2"}),"Guardar Cambios"]}):e.jsxs(e.Fragment,{children:[e.jsx(Nr,{className:"h-4 w-4 mr-2"}),"Crear Gua de Estilo"]})})]})]})})}),e.jsx(Gt,{value:"list",children:e.jsxs(me,{children:[e.jsxs(Re,{children:[e.jsx(Ie,{children:"Guas de Estilo Existentes"}),e.jsx(At,{children:"Todas las guas de estilo organizadas por seudnimo"})]}),e.jsx(he,{children:b?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Cargando guas..."}):N.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground","data-testid":"text-no-guides",children:'No hay guas de estilo. Crea la primera usando la pestaa "Crear Gua".'}):e.jsx("div",{className:"space-y-4",children:N.map(F=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg","data-testid":`guide-item-${F.id}`,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(yt,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium flex items-center gap-2",children:[F.title,F.isActive&&e.jsx(Q,{variant:"default",className:"text-xs",children:"Activa"})]}),e.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[e.jsx(ri,{className:"h-3 w-3"}),O(F.pseudonymId),e.jsxs("span",{className:"text-xs",children:["(",F.content.length.toLocaleString()," caracteres)"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Pn,{open:o&&n?.id===F.id,onOpenChange:U=>{c(U),U||r(null)},children:[e.jsx(gS,{asChild:!0,children:e.jsx(B,{variant:"ghost",size:"icon","data-testid":`button-view-${F.id}`,onClick:()=>{r(F),c(!0)},children:e.jsx(fr,{className:"h-4 w-4"})})}),e.jsxs(yn,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(jn,{children:[e.jsx(bn,{children:F.title}),e.jsxs($n,{children:["Seudnimo: ",O(F.pseudonymId)]})]}),e.jsx("pre",{className:"whitespace-pre-wrap text-sm font-mono bg-muted p-4 rounded-lg",children:F.content})]})]}),e.jsx(B,{variant:"ghost",size:"icon","data-testid":`button-edit-${F.id}`,onClick:()=>se(F),children:e.jsx(LA,{className:"h-4 w-4"})}),e.jsx(B,{variant:"ghost",size:"icon","data-testid":`button-download-${F.id}`,onClick:()=>G(F),children:e.jsx(xn,{className:"h-4 w-4"})}),e.jsx(B,{variant:"ghost",size:"icon","data-testid":`button-delete-${F.id}`,onClick:()=>P.mutate(F.id),children:e.jsx(Rn,{className:"h-4 w-4 text-destructive"})})]})]},F.id))})})]})})]})]})}function Uq(t){switch(t){case"CRITICAL":return"destructive";case"HIGH":return"destructive";case"MEDIUM":return"secondary";case"LOW":return"outline";default:return"outline"}}function Bq(t){switch(t){case"CONTINUITY":return e.jsx(Cn,{className:"h-4 w-4"});case"CHARACTER":return e.jsx(pl,{className:"h-4 w-4"});case"STYLE":return e.jsx(Ep,{className:"h-4 w-4"});default:return e.jsx(yt,{className:"h-4 w-4"})}}function Gq(t){switch(t){case"CONTINUITY":return"Continuidad";case"CHARACTER":return"Personajes";case"STYLE":return"Estilo";default:return t}}function Yf({report:t,agentType:n}){return e.jsxs(me,{"data-testid":`card-report-${n.toLowerCase()}`,children:[e.jsx(Re,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[Bq(t.agentType),e.jsx(Ie,{className:"text-lg","data-testid":`text-agent-title-${n.toLowerCase()}`,children:Gq(t.agentType)})]}),e.jsxs(Q,{variant:t.overallScore>=70?"default":"destructive","data-testid":`badge-score-${n.toLowerCase()}`,children:[t.overallScore,"/100"]})]})}),e.jsxs(he,{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground","data-testid":`text-analysis-${n.toLowerCase()}`,children:t.analysis}),t.issues.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"text-sm font-medium","data-testid":`text-issues-count-${n.toLowerCase()}`,children:["Problemas detectados (",t.issues.length,")"]}),e.jsx(jt,{className:"h-[300px]",children:e.jsx("div",{className:"space-y-2 pr-4",children:t.issues.map((r,s)=>e.jsxs(me,{className:"p-3","data-testid":`card-issue-${n.toLowerCase()}-${s}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsx(Q,{variant:Uq(r.severity),"data-testid":`badge-severity-${n.toLowerCase()}-${s}`,children:r.severity}),e.jsx("span",{className:"text-xs text-muted-foreground","data-testid":`text-location-${n.toLowerCase()}-${s}`,children:r.location})]}),e.jsx("p",{className:"text-sm mb-2","data-testid":`text-description-${n.toLowerCase()}-${s}`,children:r.description}),e.jsxs("div",{className:"text-xs text-muted-foreground bg-muted p-2 rounded","data-testid":`text-suggestion-${n.toLowerCase()}-${s}`,children:[e.jsx("strong",{children:"Sugerencia:"})," ",r.suggestion]})]},s))})})]}),t.issues.length===0&&e.jsxs(sl,{"data-testid":`alert-no-issues-${n.toLowerCase()}`,children:[e.jsx(Us,{className:"h-4 w-4"}),e.jsx(al,{children:"Sin problemas"}),e.jsx(il,{children:"No se detectaron problemas en esta rea."})]})]})]})}function Hq(){const{currentProject:t}=fi(),{toast:n}=nn(),[r,s]=x.useState(!1),[i,o]=x.useState(null),[c,d]=x.useState(null),[p,m]=x.useState(null),h=x.useRef(null),g=x.useRef(!1);x.useEffect(()=>()=>{h.current&&h.current.close()},[]);const{data:v,refetch:j}=Ke({queryKey:[`/api/projects/${t?.id}/audits`],enabled:!!t?.id}),{data:N,refetch:b}=Ke({queryKey:[`/api/audits/${c}`],enabled:!!c,refetchInterval:r?3e3:!1}),C=ye({mutationFn:async()=>{if(!t?.id)throw new Error("No project selected");return(await je("POST",`/api/projects/${t.id}/start-audit`)).json()},onSuccess:E=>{d(E.auditId),n({title:"Auditora iniciada",description:`Analizando ${E.stats.chapters} captulos (${E.stats.words.toLocaleString()} palabras)`}),k(E.auditId)},onError:E=>{n({title:"Error",description:E.message||"No se pudo iniciar la auditora",variant:"destructive"})}}),S=ye({mutationFn:async E=>(await je("DELETE",`/api/audits/${E}`)).json(),onSuccess:()=>{ae.invalidateQueries({queryKey:[`/api/projects/${t?.id}/audits`]}),n({title:"Auditora eliminada",description:"La auditora ha sido eliminada correctamente"})},onError:E=>{n({title:"Error",description:E.message||"No se pudo eliminar la auditora",variant:"destructive"})}}),k=E=>{s(!0),o({phase:"starting",message:"Iniciando anlisis..."});const A=new EventSource(`/api/audits/${E}/run`);h.current=A,A.addEventListener("progress",W=>{const X=JSON.parse(W.data);o({phase:X.phase,message:X.message})}),A.addEventListener("complete",W=>{const X=JSON.parse(W.data);s(!1),o(null),j(),b(),n({title:"Auditora completada",description:`Puntuacin: ${X.overallScore}/100, ${X.criticalFlags} problemas crticos`}),A.close(),h.current=null}),A.addEventListener("error",W=>{try{const X=JSON.parse(W.data);n({title:"Error en auditora",description:X.message,variant:"destructive"})}catch{n({title:"Error en auditora",description:"Conexin perdida",variant:"destructive"})}s(!1),o(null),A.close(),h.current=null}),A.onerror=()=>{s(!1),o(null),A.close(),h.current=null}};x.useEffect(()=>{if(v&&v.length>0&&!g.current){const E=v.find(A=>A.status==="running");E&&!h.current&&(g.current=!0,d(E.id),k(E.id))}},[v]);const P=v?.[0],R=N||P;return t?e.jsxs("div",{className:"container mx-auto p-6 space-y-6","data-testid":"container-auditor",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2","data-testid":"text-page-title",children:[e.jsx(Bu,{className:"h-6 w-6"}),"Auditor Literario"]}),e.jsx("p",{className:"text-muted-foreground","data-testid":"text-page-description",children:"Anlisis profundo con Gemini Context Caching - 3 agentes especializados en paralelo"})]}),e.jsx(B,{size:"lg",onClick:()=>C.mutate(),disabled:r||C.isPending,"data-testid":"button-start-audit",children:r?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"mr-2 h-4 w-4 animate-spin"}),"Analizando..."]}):v&&v.length>0?e.jsxs(e.Fragment,{children:[e.jsx(Yn,{className:"mr-2 h-4 w-4"}),"Re-Auditar Manuscrito"]}):e.jsxs(e.Fragment,{children:[e.jsx(Yn,{className:"mr-2 h-4 w-4"}),"Iniciar Auditora"]})})]}),r&&i&&e.jsx(me,{"data-testid":"card-progress",children:e.jsx(he,{className:"pt-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"font-medium","data-testid":"text-progress-message",children:i.message})]}),e.jsx(di,{value:i.phase==="caching"?30:i.phase==="caching_complete"?40:i.phase==="analyzing"?70:100,"data-testid":"progress-bar"})]})})}),R&&R.status==="completed"&&e.jsxs("div",{className:"space-y-6","data-testid":"container-results",children:[e.jsx(me,{"data-testid":"card-summary",children:e.jsxs(Re,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Ie,{"data-testid":"text-summary-title",children:"Resumen de Auditora"}),e.jsxs(At,{"data-testid":"text-completed-date",children:["Anlisis completado el ",new Date(R.completedAt).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold","data-testid":"text-overall-score",children:R.overallScore}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"/100"})]}),R.criticalFlags>0&&e.jsxs(Q,{variant:"destructive",className:"text-lg px-3 py-1","data-testid":"badge-critical-flags",children:[R.criticalFlags," crticos"]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4 pt-4 border-t",children:[e.jsx(Ja,{href:"/corrected-manuscripts",children:e.jsxs(B,{variant:"outline","data-testid":"button-go-corrections",children:[e.jsx(Hu,{className:"h-4 w-4 mr-2"})," Ver Correcciones"]})}),e.jsxs(B,{onClick:()=>{const E=new EventSource(`/api/audits/${R.id}/start-correction`);n({title:"Iniciando correccin",description:"El proceso de correccin ha comenzado..."}),E.addEventListener("progress",A=>{const W=JSON.parse(A.data);n({title:"Corrigiendo",description:W.message})}),E.addEventListener("completed",A=>{JSON.parse(A.data),n({title:"Correccin completada",description:"Revisa las correcciones propuestas."}),E.close(),window.location.href="/corrected-manuscripts"}),E.addEventListener("error",A=>{try{const W=JSON.parse(A.data);n({title:"Error",description:W.message,variant:"destructive"})}catch{n({title:"Error",description:"Error en correccin",variant:"destructive"})}E.close()})},"data-testid":"button-start-correction",children:[e.jsx(Hu,{className:"h-4 w-4 mr-2"})," Corregir con DeepSeek"]})]})]})}),e.jsxs(ci,{defaultValue:"continuity","data-testid":"tabs-reports",children:[e.jsxs(ga,{className:"grid w-full grid-cols-3",children:[e.jsxs(Bt,{value:"continuity",className:"flex items-center gap-2","data-testid":"tab-continuity",children:[e.jsx(Cn,{className:"h-4 w-4"}),"Continuidad"]}),e.jsxs(Bt,{value:"character",className:"flex items-center gap-2","data-testid":"tab-character",children:[e.jsx(pl,{className:"h-4 w-4"}),"Personajes"]}),e.jsxs(Bt,{value:"style",className:"flex items-center gap-2","data-testid":"tab-style",children:[e.jsx(Ep,{className:"h-4 w-4"}),"Estilo"]})]}),e.jsx(Gt,{value:"continuity",children:R.continuityReport&&e.jsx(Yf,{report:R.continuityReport,agentType:"continuity"})}),e.jsx(Gt,{value:"character",children:R.characterReport&&e.jsx(Yf,{report:R.characterReport,agentType:"character"})}),e.jsx(Gt,{value:"style",children:R.styleReport&&e.jsx(Yf,{report:R.styleReport,agentType:"style"})})]})]}),R&&R.status==="error"&&p!==R.id&&e.jsxs(sl,{variant:"destructive","data-testid":"alert-error",className:"relative",children:[e.jsx(Hs,{className:"h-4 w-4"}),e.jsx(al,{children:"Error en auditora"}),e.jsx(il,{"data-testid":"text-error-message",children:R.errorMessage}),e.jsx(B,{variant:"ghost",size:"sm",className:"absolute top-2 right-2 h-6 w-6 p-0",onClick:()=>m(R.id),"data-testid":"button-dismiss-error",children:e.jsx(Gn,{className:"h-4 w-4"})})]}),!r&&!R&&e.jsx(me,{className:"border-dashed","data-testid":"card-empty-state",children:e.jsxs(he,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Bu,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2","data-testid":"text-empty-title",children:"Sin auditoras previas"}),e.jsx("p",{className:"text-muted-foreground text-center max-w-md mb-4","data-testid":"text-empty-description",children:"El Auditor Literario analiza tu manuscrito completo usando 3 agentes especializados: Continuidad, Personajes y Estilo. Cada agente evala diferentes aspectos de tu obra."}),e.jsxs(B,{onClick:()=>C.mutate(),disabled:C.isPending,"data-testid":"button-start-first-audit",children:[e.jsx(Yn,{className:"mr-2 h-4 w-4"}),"Iniciar Primera Auditora"]})]})}),v&&v.length>1&&e.jsxs(me,{"data-testid":"card-previous-audits",children:[e.jsx(Re,{children:e.jsx(Ie,{"data-testid":"text-previous-audits-title",children:"Auditoras Anteriores"})}),e.jsx(he,{children:e.jsx("div",{className:"space-y-2",children:v.slice(1).map(E=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border cursor-pointer hover-elevate","data-testid":`row-audit-${E.id}`,children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",onClick:()=>d(E.id),children:[E.status==="completed"?e.jsx(Us,{className:"h-4 w-4 text-green-500"}):e.jsx(Hs,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{"data-testid":`text-audit-date-${E.id}`,children:new Date(E.createdAt).toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[E.overallScore!==null&&e.jsxs(Q,{variant:E.overallScore>=70?"default":"secondary","data-testid":`badge-audit-score-${E.id}`,children:[E.overallScore,"/100"]}),e.jsx(B,{size:"icon",variant:"ghost",onClick:A=>{A.stopPropagation(),S.mutate(E.id)},disabled:S.isPending,"data-testid":`button-delete-audit-${E.id}`,children:e.jsx(Rn,{className:"h-4 w-4 text-destructive"})})]})]},E.id))})})]})]}):e.jsx("div",{className:"container mx-auto p-6","data-testid":"container-no-project",children:e.jsxs(sl,{children:[e.jsx(on,{className:"h-4 w-4"}),e.jsx(al,{children:"Selecciona un proyecto"}),e.jsx(il,{children:"Selecciona un proyecto desde el selector en la barra superior para usar el Auditor Literario."})]})})}const Au={repeticion_lexica:"Repeticin Lxica",continuidad:"Continuidad",estructura:"Estructura",personajes:"Personajes",ritmo:"Ritmo",dialogo:"Dilogo",temporal:"Temporal",atmosfera:"Atmsfera",trama:"Trama",transiciones:"Transiciones"},Kq={repeticion_lexica:"bg-orange-500/20 text-orange-700 dark:text-orange-400",continuidad:"bg-blue-500/20 text-blue-700 dark:text-blue-400",estructura:"bg-purple-500/20 text-purple-700 dark:text-purple-400",personajes:"bg-pink-500/20 text-pink-700 dark:text-pink-400",ritmo:"bg-cyan-500/20 text-cyan-700 dark:text-cyan-400",dialogo:"bg-green-500/20 text-green-700 dark:text-green-400",temporal:"bg-amber-500/20 text-amber-700 dark:text-amber-400",atmosfera:"bg-indigo-500/20 text-indigo-700 dark:text-indigo-400",trama:"bg-red-500/20 text-red-700 dark:text-red-400",transiciones:"bg-teal-500/20 text-teal-700 dark:text-teal-400"};function Wq(t){return t>=8?"Crtico":t>=5?"Alto":t>=3?"Medio":"Bajo"}function Qq(t){return t>=8?"bg-red-500/20 text-red-700 dark:text-red-400":t>=5?"bg-orange-500/20 text-orange-700 dark:text-orange-400":t>=3?"bg-yellow-500/20 text-yellow-700 dark:text-yellow-400":"bg-green-500/20 text-green-700 dark:text-green-400"}function Yq(){const{toast:t}=nn(),[n,r]=x.useState(!1),{data:s=[],isLoading:i}=Ke({queryKey:["/api/writing-lessons"]}),o=ye({mutationFn:async()=>(r(!0),(await je("POST","/api/writing-lessons/refresh-sync")).json()),onSuccess:h=>{r(!1),ae.invalidateQueries({queryKey:["/api/writing-lessons"]}),t({title:"Lecciones generadas",description:`Se extrajeron ${h.created||0} lecciones de ${h.projectsAnalyzed||0} proyectos analizados.`})},onError:h=>{r(!1),t({title:"Error al generar lecciones",description:h?.message||"No se pudieron regenerar las lecciones. Verifica que DEEPSEEK_API_KEY est configurada.",variant:"destructive"})}}),c=ye({mutationFn:async({id:h,isActive:g})=>{await je("PATCH",`/api/writing-lessons/${h}`,{isActive:g})},onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/writing-lessons"]})},onError:()=>{t({title:"Error",description:"No se pudo actualizar la leccin",variant:"destructive"})}}),d=ye({mutationFn:async h=>{await je("DELETE",`/api/writing-lessons/${h}`)},onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/writing-lessons"]}),t({title:"Leccin eliminada",description:"La leccin ha sido eliminada correctamente"})},onError:()=>{t({title:"Error",description:"No se pudo eliminar la leccin",variant:"destructive"})}}),p=s.reduce((h,g)=>{const v=g.category||"other";return h[v]||(h[v]=[]),h[v].push(g),h},{}),m=Object.keys(p).sort((h,g)=>{const v=Au[h]||h,j=Au[g]||g;return v.localeCompare(j)});return e.jsxs("div",{className:"p-6 space-y-6","data-testid":"writing-lessons-page",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold","data-testid":"text-page-title",children:"Lecciones de Escritura"}),e.jsx("p",{className:"text-muted-foreground mt-1","data-testid":"text-page-subtitle",children:"Aprendizaje automtico de errores detectados en auditoras anteriores"})]}),e.jsxs(B,{onClick:()=>o.mutate(),disabled:o.isPending||n,"data-testid":"button-refresh-lessons",children:[o.isPending||n?e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Ns,{className:"h-4 w-4 mr-2"}),"Regenerar Lecciones"]})]}),n&&e.jsx(me,{"data-testid":"status-refreshing",children:e.jsxs(he,{className:"flex items-center gap-3 py-4",children:[e.jsx(be,{className:"h-5 w-5 animate-spin text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Analizando auditoras y extrayendo lecciones con DeepSeek... Esto tarda entre 1-3 minutos."})]})}),i?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(be,{className:"h-8 w-8 text-muted-foreground/30 animate-spin"})}):s.length===0&&!n?e.jsx(me,{"data-testid":"status-empty",children:e.jsxs(he,{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx(mn,{className:"h-12 w-12 text-muted-foreground/30 mb-4"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"No hay lecciones de escritura todava"}),e.jsx("p",{className:"text-muted-foreground/60 text-xs mt-1",children:'Haz clic en "Regenerar Lecciones" para analizar las auditoras anteriores y extraer patrones de mejora'})]})}):e.jsx("div",{className:"space-y-8",children:m.map(h=>e.jsxs("div",{"data-testid":`category-group-${h}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4 flex-wrap",children:[e.jsx("h2",{className:"text-xl font-semibold",children:Au[h]||h}),e.jsx(Q,{variant:"outline",className:"text-xs",children:p[h].length})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:p[h].map(g=>e.jsxs(me,{className:`${g.isActive?"":"opacity-60"}`,"data-testid":`card-lesson-${g.id}`,children:[e.jsxs(Re,{className:"flex flex-row items-start justify-between gap-2 pb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(Q,{className:`text-xs ${Kq[g.category]||""}`,children:Au[g.category]||g.category}),e.jsxs(Q,{className:`text-xs ${Qq(g.severityWeight)}`,children:[Wq(g.severityWeight)," (",g.severityWeight,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx(hr,{checked:g.isActive,onCheckedChange:v=>c.mutate({id:g.id,isActive:v}),"data-testid":`switch-toggle-${g.id}`}),e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>d.mutate(g.id),disabled:d.isPending,"data-testid":`button-delete-${g.id}`,children:e.jsx(Rn,{className:"h-4 w-4 text-destructive"})})]})]}),e.jsxs(he,{className:"space-y-3",children:[e.jsx("p",{className:"text-sm font-medium","data-testid":`text-lesson-${g.id}`,children:g.lesson}),e.jsx("p",{className:"text-xs text-muted-foreground","data-testid":`text-rationale-${g.id}`,children:g.rationale}),(g.badExample||g.goodExample)&&e.jsxs("div",{className:"space-y-2",children:[g.badExample&&e.jsxs("div",{className:"text-xs p-2 rounded-md bg-red-500/10 border border-red-500/20 text-red-700 dark:text-red-400","data-testid":`text-bad-example-${g.id}`,children:[e.jsx("span",{className:"font-semibold",children:"Mal:"})," ",g.badExample]}),g.goodExample&&e.jsxs("div",{className:"text-xs p-2 rounded-md bg-green-500/10 border border-green-500/20 text-green-700 dark:text-green-400","data-testid":`text-good-example-${g.id}`,children:[e.jsx("span",{className:"font-semibold",children:"Bien:"})," ",g.goodExample]})]})]})]},g.id))})]},h))})]})}function Qw(t){switch(t){case"pending":return e.jsx(Q,{variant:"secondary","data-testid":"badge-status-pending",children:"Pendiente"});case"auditing":return e.jsxs(Q,{variant:"default","data-testid":"badge-status-auditing",children:[e.jsx(be,{className:"h-3 w-3 mr-1 animate-spin"}),"Auditando"]});case"correcting":return e.jsxs(Q,{variant:"default","data-testid":"badge-status-correcting",children:[e.jsx(be,{className:"h-3 w-3 mr-1 animate-spin"}),"Corrigiendo"]});case"approving":return e.jsxs(Q,{variant:"default","data-testid":"badge-status-approving",children:[e.jsx(be,{className:"h-3 w-3 mr-1 animate-spin"}),"Aprobando"]});case"finalizing":return e.jsxs(Q,{variant:"default","data-testid":"badge-status-finalizing",children:[e.jsx(be,{className:"h-3 w-3 mr-1 animate-spin"}),"Finalizando"]});case"re_auditing":return e.jsxs(Q,{variant:"default","data-testid":"badge-status-reauditing",children:[e.jsx(be,{className:"h-3 w-3 mr-1 animate-spin"}),"Re-auditando"]});case"completed":return e.jsxs(Q,{variant:"default","data-testid":"badge-status-completed",children:[e.jsx(Us,{className:"h-3 w-3 mr-1"}),"Completado"]});case"failed":return e.jsxs(Q,{variant:"destructive","data-testid":"badge-status-failed",children:[e.jsx(Hs,{className:"h-3 w-3 mr-1"}),"Error"]});case"cancelled":return e.jsxs(Q,{variant:"secondary","data-testid":"badge-status-cancelled",children:[e.jsx(Ku,{className:"h-3 w-3 mr-1"}),"Cancelado"]});default:return e.jsx(Q,{variant:"outline",children:t})}}function Zq(t){switch(t){case"threshold_met":return"Umbral alcanzado";case"corrected":return"Corregido";case"no_issues":return"Sin issues";case"max_cycles":return"Mx. ciclos alcanzado";case"error":return"Error";case"cancelled":return"Cancelado";case"score_drop_reverted":return"Revertido (score empeor)";case"no_critical_issues":return"Sin issues crticos";default:return t}}function Xq(t){if(t.status==="failed")return"Error";if(t.status==="cancelled")return"Cancelado";if(!t.cycleHistory||t.cycleHistory.length===0)return null;switch(t.cycleHistory[t.cycleHistory.length-1].result){case"threshold_met":return"Objetivo alcanzado";case"no_issues":return"Sin problemas";case"max_cycles":return`${t.maxCycles} ciclos completados`;case"score_drop_reverted":return"Detenido (score empeor)";case"no_critical_issues":return"Sin issues crticos";case"corrected":return"Correcciones aplicadas";default:return null}}function Ro(t){return["pending","auditing","correcting","approving","finalizing","re_auditing"].includes(t)}function Jq(){const{currentProject:t}=fi(),{toast:n}=nn(),[r,s]=x.useState(3),[i,o]=x.useState(85),[c,d]=x.useState(null),[p,m]=x.useState(null),h=x.useRef(null),g=x.useRef(null),{data:v,isLoading:j}=Ke({queryKey:["/api/projects",t?.id,"auto-correct/runs"],queryFn:async()=>{if(!t?.id)return[];const E=await fetch(`/api/projects/${t.id}/auto-correct/runs`);if(!E.ok)throw new Error(`Failed to fetch runs: ${E.status}`);const A=E.headers.get("content-type");if(!A||!A.includes("application/json"))throw new Error("Invalid response from server");return E.json()},enabled:!!t?.id,refetchInterval:c?5e3:!1});x.useEffect(()=>{if(v&&v.length>0){const E=v.find(A=>Ro(A.status));E&&d(E.id)}},[v]),x.useEffect(()=>{if(!c)return;const E=new EventSource(`/api/auto-correct/runs/${c}/stream`);return h.current=E,E.onmessage=A=>{try{const W=JSON.parse(A.data);m(W),["completed","failed","cancelled"].includes(W.status)&&(E.close(),ae.invalidateQueries({queryKey:["/api/projects",t?.id,"auto-correct/runs"]}),d(null),m(null))}catch{}},E.onerror=()=>{E.close()},()=>{E.close()}},[c,t?.id]),x.useEffect(()=>{g.current?.scrollIntoView({behavior:"smooth"})},[p?.progressLog]);const N=ye({mutationFn:async()=>{if(!t?.id)throw new Error("No project selected");return je("POST",`/api/projects/${t.id}/auto-correct`,{maxCycles:r,targetScore:i,maxCriticalIssues:0})},onSuccess:async E=>{const A=await E.json();n({title:"Auto-corrector iniciado",description:`Run #${A.runId} en progreso`}),d(A.runId),ae.invalidateQueries({queryKey:["/api/projects",t?.id,"auto-correct/runs"]})},onError:E=>{n({title:"Error",description:E.message,variant:"destructive"})}}),b=ye({mutationFn:async E=>je("POST",`/api/auto-correct/runs/${E}/cancel`),onSuccess:()=>{n({title:"Cancelando...",description:"Se solicit la cancelacin"}),ae.invalidateQueries({queryKey:["/api/projects",t?.id,"auto-correct/runs"]})}}),C=ye({mutationFn:async E=>(await je("POST",`/api/auto-correct/runs/${E}/retry`)).json(),onSuccess:E=>{E.success?(n({title:"Reintentando",description:`Nuevo run #${E.runId} creado`}),ae.invalidateQueries({queryKey:["/api/projects",t?.id,"auto-correct/runs"]})):n({title:"Error",description:E.error,variant:"destructive"})},onError:E=>{n({title:"Error",description:E.message,variant:"destructive"})}}),S=ye({mutationFn:async E=>je("DELETE",`/api/auto-correct/runs/${E}`),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/projects",t?.id,"auto-correct/runs"]}),n({title:"Eliminado"})}});if(!t)return e.jsx("div",{className:"flex items-center justify-center h-full","data-testid":"container-no-project",children:e.jsx(me,{children:e.jsx(he,{className:"pt-6",children:e.jsx("p",{className:"text-muted-foreground",children:"Selecciona un proyecto para usar el Auto-Corrector."})})})});const k=v?.some(E=>Ro(E.status)),P=v?.find(E=>E.id===c)||null,R=p||(P?{status:P.status,currentCycle:P.currentCycle,maxCycles:P.maxCycles,cycleHistory:P.cycleHistory,progressLog:P.progressLog,finalScore:P.finalScore,totalIssuesFixed:P.totalIssuesFixed,totalStructuralChanges:P.totalStructuralChanges,errorMessage:P.errorMessage}:null);return e.jsxs("div",{className:"container mx-auto p-4 space-y-6 max-w-5xl","data-testid":"container-auto-corrector",children:[e.jsx("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(us,{className:"h-6 w-6 text-primary"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold","data-testid":"text-page-title",children:"Auto-Corrector"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:['Auditora y correccin autnoma para "',t.title,'"']})]})]})}),!k&&e.jsxs(me,{"data-testid":"card-start-run",children:[e.jsxs(Re,{children:[e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(Qu,{className:"h-5 w-5"}),"Iniciar Auto-Correccin"]}),e.jsx(At,{children:"El sistema auditar el manuscrito con 3 agentes Gemini (continuidad, personajes, estilo), corregir todos los problemas detectados con DeepSeek, y repetir el ciclo hasta alcanzar el umbral de calidad o el mximo de ciclos."})]}),e.jsx(he,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 sm:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{htmlFor:"maxCycles","data-testid":"label-max-cycles",children:"Mx. Ciclos"}),e.jsx(gt,{id:"maxCycles",type:"number",min:1,max:5,value:r,onChange:E=>s(parseInt(E.target.value)||3),"data-testid":"input-max-cycles"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{htmlFor:"targetScore","data-testid":"label-target-score",children:"Score Objetivo"}),e.jsx(gt,{id:"targetScore",type:"number",min:50,max:100,value:i,onChange:E=>o(parseInt(E.target.value)||85),"data-testid":"input-target-score"})]}),e.jsx("div",{className:"flex items-end sm:col-span-1 col-span-2",children:e.jsxs(B,{onClick:()=>N.mutate(),disabled:N.isPending,className:"w-full","data-testid":"button-start-auto-correct",children:[N.isPending?e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Yn,{className:"h-4 w-4 mr-2"}),"Iniciar"]})})]})})]}),R&&c&&e.jsxs(me,{"data-testid":"card-active-run",children:[e.jsx(Re,{children:e.jsxs("div",{className:"flex items-center justify-between gap-2 flex-wrap",children:[e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(Kc,{className:"h-5 w-5"}),"Run #",c," - Ciclo ",R.currentCycle,"/",R.maxCycles]}),e.jsxs("div",{className:"flex items-center gap-2",children:[Qw(R.status),Ro(R.status)&&e.jsxs(B,{size:"sm",variant:"destructive",onClick:()=>b.mutate(c),disabled:b.isPending,"data-testid":"button-cancel-run",children:[e.jsx(Ku,{className:"h-3 w-3 mr-1"}),"Cancelar"]})]})]})}),e.jsxs(he,{className:"space-y-4",children:[Ro(R.status)&&e.jsx(di,{value:R.currentCycle/R.maxCycles*100,className:"h-2","data-testid":"progress-cycles"}),R.finalScore!=null&&e.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:grid-cols-4",children:[e.jsx(me,{children:e.jsxs(he,{className:"pt-4 pb-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold","data-testid":"text-final-score",children:R.finalScore}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Score Final"})]})}),e.jsx(me,{children:e.jsxs(he,{className:"pt-4 pb-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold","data-testid":"text-issues-fixed",children:R.totalIssuesFixed||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Issues Corregidos"})]})}),e.jsx(me,{children:e.jsxs(he,{className:"pt-4 pb-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold","data-testid":"text-structural-changes",children:R.totalStructuralChanges||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Cambios Estructurales"})]})}),e.jsx(me,{children:e.jsxs(he,{className:"pt-4 pb-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold","data-testid":"text-critical-issues",children:R.finalCriticalIssues??"-"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Issues Crticos"})]})})]}),R.cycleHistory&&R.cycleHistory.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(Pc,{className:"h-4 w-4"}),"Historial de Ciclos"]}),e.jsx("div",{className:"space-y-1",children:R.cycleHistory.map((E,A)=>e.jsxs("div",{className:"flex items-center justify-between gap-2 p-2 rounded-md border text-sm flex-wrap",children:[e.jsxs("span",{className:"font-medium","data-testid":`text-cycle-number-${A}`,children:["Ciclo ",E.cycle]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs(Q,{variant:"outline","data-testid":`badge-cycle-score-${A}`,children:["Score: ",E.overallScore]}),e.jsxs(Q,{variant:E.criticalIssues>0?"destructive":"secondary",children:[E.criticalIssues," Crticos"]}),e.jsxs(Q,{variant:"secondary",children:[E.issuesFixed," Corregidos"]}),E.structuralChanges>0&&e.jsxs(Q,{variant:"secondary",children:[E.structuralChanges," Estructurales"]}),e.jsx(Q,{variant:"outline",children:Zq(E.result)})]})]},A))})]}),R.progressLog&&R.progressLog.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(Cn,{className:"h-4 w-4"}),"Log de Actividad"]}),e.jsx(jt,{className:"h-48 border rounded-md p-3",children:e.jsxs("div",{className:"space-y-1",children:[R.progressLog.map((E,A)=>e.jsxs("div",{className:"text-xs flex gap-2","data-testid":`text-log-entry-${A}`,children:[e.jsx("span",{className:"text-muted-foreground shrink-0",children:new Date(E.timestamp).toLocaleTimeString()}),e.jsxs("span",{className:"text-muted-foreground shrink-0",children:["[",E.phase,"]"]}),e.jsx("span",{children:E.message})]},A)),e.jsx("div",{ref:g})]})})]}),R.errorMessage&&e.jsxs("div",{className:"p-3 rounded-md border border-destructive text-sm text-destructive",children:[e.jsx(on,{className:"h-4 w-4 inline mr-2"}),R.errorMessage]})]})]}),v&&v.length>0&&e.jsxs(me,{"data-testid":"card-run-history",children:[e.jsx(Re,{children:e.jsxs(Ie,{className:"flex items-center gap-2",children:[e.jsx(Ho,{className:"h-5 w-5"}),"Historial de Ejecuciones"]})}),e.jsx(he,{children:e.jsx("div",{className:"space-y-2",children:v.filter(E=>E.id!==c||!Ro(E.status)).map(E=>e.jsxs("div",{className:"flex items-center justify-between gap-2 p-3 rounded-md border text-sm flex-wrap","data-testid":`card-run-history-${E.id}`,children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsxs("span",{className:"font-medium",children:["Run #",E.id]}),Qw(E.status),E.finalScore!=null&&e.jsxs(Q,{variant:E.finalScore>=(E.targetScore||85)?"default":"outline","data-testid":`badge-run-score-${E.id}`,children:["Score: ",E.finalScore,"/",E.targetScore||85]}),E.finalCriticalIssues!=null&&e.jsxs(Q,{variant:E.finalCriticalIssues>0?"destructive":"secondary","data-testid":`badge-run-critical-${E.id}`,children:[E.finalCriticalIssues," Crticos"]}),E.totalIssuesFixed!=null&&E.totalIssuesFixed>0&&e.jsxs(Q,{variant:"secondary","data-testid":`badge-run-fixed-${E.id}`,children:[E.totalIssuesFixed," corregidos"]}),E.cycleHistory&&E.cycleHistory.length>0&&e.jsxs("span",{className:"text-muted-foreground text-xs","data-testid":`text-run-cycles-${E.id}`,children:[E.cycleHistory.length,"/",E.maxCycles," ciclos"]}),(()=>{const A=Xq(E);return A?e.jsxs("span",{className:"text-muted-foreground text-xs italic","data-testid":`text-run-reason-${E.id}`,children:[" ",A]}):null})(),e.jsxs("span",{className:"text-muted-foreground text-xs",children:[new Date(E.createdAt).toLocaleDateString()," ",new Date(E.createdAt).toLocaleTimeString()]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[(E.status==="failed"||E.status==="cancelled")&&e.jsxs(B,{size:"sm",variant:"outline",onClick:()=>C.mutate(E.id),disabled:C.isPending,"data-testid":`button-retry-run-${E.id}`,children:[e.jsx(Ho,{className:"h-3 w-3 mr-1"}),"Reintentar"]}),!Ro(E.status)&&e.jsx(B,{size:"icon",variant:"ghost",onClick:()=>S.mutate(E.id),disabled:S.isPending,"data-testid":`button-delete-run-${E.id}`,children:e.jsx(Rn,{className:"h-4 w-4"})})]})]},E.id))})})]}),j&&e.jsx("div",{className:"flex items-center justify-center py-12","data-testid":"container-loading",children:e.jsx(be,{className:"h-8 w-8 animate-spin text-muted-foreground"})})]})}const jP=[{code:"en",name:"English"},{code:"fr",name:"Franais"},{code:"de",name:"Deutsch"},{code:"it",name:"Italiano"},{code:"pt",name:"Portugus"},{code:"ca",name:"Catal"},{code:"es",name:"Espaol"}];function Yw(t){if(!t)return"Sin detectar";const n=jP.find(r=>r.code===t.toLowerCase());return n?n.name:t.toUpperCase()}function Zw(t){return[...t].sort((n,r)=>{const s=n.chapterNumber===0?-1e3:n.chapterNumber===-1?1e3:n.chapterNumber===-2?1001:n.chapterNumber,i=r.chapterNumber===0?-1e3:r.chapterNumber===-1?1e3:r.chapterNumber===-2?1001:r.chapterNumber;return s-i})}function bP(t,n){return t===0?n||"Prlogo":t===-1?n||"Eplogo":t===-2?n||"Nota del Autor":n||`Captulo ${t}`}function e9(t){return t===0?"P":t===-1?"E":t===-2?"N":String(t)}function Oo(t){return t.editedContent||t.originalContent||""}function t9(t){let n=t;const r=[/^#+ *Literary Style Guide[^\n]*\n[\s\S]*?(?=^#+ *(?:CHAPTER|Chapter|Prologue|Epilogue|Author['']?s? Note)\b|\n---\n|$)/gm,/^#+ *Writing Guide[^\n]*\n[\s\S]*?(?=^#+ *(?:CHAPTER|Chapter|Prologue|Epilogue|Author['']?s? Note)\b|\n---\n|$)/gm,/^#+ *Gu\u00eda de Estilo[^\n]*\n[\s\S]*?(?=^#+ *(?:CAP\u00cdTULO|Cap\u00edtulo|Pr\u00f3logo|Ep\u00edlogo|Nota del Autor)\b|\n---\n|$)/gmi,/^#+ *Gu\u00eda de Escritura[^\n]*\n[\s\S]*?(?=^#+ *(?:CAP\u00cdTULO|Cap\u00edtulo|Pr\u00f3logo|Ep\u00edlogo|Nota del Autor)\b|\n---\n|$)/gmi];for(const s of r)n=n.replace(s,"");return n.trim()}function n9(t){let n=t.trim();return n=t9(n),n=n.replace(/^#+ *(CHAPTER|CAP\u00cdTULO|CAP\.?|Cap\u00edtulo|Chapter|Chapitre|Kapitel|Capitolo|Cap\u00edtol|Pr\u00f3logo|Prologue|Prolog|Prologo|Pr\u00f2leg|Ep\u00edlogo|Epilogue|\u00c9pilogue|Epilog|Epilogo|Ep\u00edleg|Nota del Autor|Nota de l'Autor|Author'?s? Note|Note de l'auteur|Nachwort|Nota dell'autore)[^\n]*\n+/gi,""),n.trim()}const Xw={en:{chapter:"Chapter",prologue:"Prologue",epilogue:"Epilogue",authorNote:"Author's Note"},es:{chapter:"Captulo",prologue:"Prlogo",epilogue:"Eplogo",authorNote:"Nota del Autor"},fr:{chapter:"Chapitre",prologue:"Prologue",epilogue:"pilogue",authorNote:"Note de l'auteur"},de:{chapter:"Kapitel",prologue:"Prolog",epilogue:"Epilog",authorNote:"Nachwort"},it:{chapter:"Capitolo",prologue:"Prologo",epilogue:"Epilogo",authorNote:"Nota dell'autore"},pt:{chapter:"Captulo",prologue:"Prlogo",epilogue:"Eplogo",authorNote:"Nota do Autor"},ca:{chapter:"Captol",prologue:"Prleg",epilogue:"Epleg",authorNote:"Nota de l'Autor"}};function r9({chapter:t,manuscriptId:n,onChapterUpdated:r}){const[s,i]=x.useState(!1),[o,c]=x.useState(""),[d,p]=x.useState(""),[m,h]=x.useState(""),[g,v]=x.useState(!1),[j,N]=x.useState(!1),[b,C]=x.useState([]),[S,k]=x.useState(-1),P=x.useRef(null),R=x.useRef(null),{toast:E}=nn();x.useEffect(()=>{t&&c(Oo(t)),i(!1),v(!1),N(!1),p(""),h(""),C([]),k(-1)},[t?.id]);const A=ye({mutationFn:async({chapterId:U,content:$})=>(await je("PATCH",`/api/imported-chapters/${U}`,{editedContent:$,status:"completed"})).json(),onSuccess:()=>{E({title:"Cambios guardados",description:"El contenido se ha actualizado."}),i(!1),ae.invalidateQueries({queryKey:["/api/imported-manuscripts",n,"chapters"]}),r?.()},onError:U=>{E({title:"Error",description:U.message||"No se pudieron guardar los cambios",variant:"destructive"})}}),W=x.useCallback((U,$)=>{if(!U){C([]),k(-1);return}const q=$.toLowerCase(),le=U.toLowerCase(),K=[];let J=0;for(;(J=q.indexOf(le,J))!==-1;)K.push(J),J+=1;C(K),k(K.length>0?0:-1),K.length>0&&P.current&&(P.current.setSelectionRange(K[0],K[0]+U.length),P.current.focus())},[]),X=()=>{if(b.length===0)return;const U=(S+1)%b.length;k(U),P.current&&(P.current.setSelectionRange(b[U],b[U]+d.length),P.current.focus())},se=()=>{if(b.length===0)return;const U=(S-1+b.length)%b.length;k(U),P.current&&(P.current.setSelectionRange(b[U],b[U]+d.length),P.current.focus())},V=()=>{if(!d||b.length===0||S<0)return;const U=b[S],$=o.substring(0,U)+m+o.substring(U+d.length);c($),W(d,$)},G=()=>{if(!d||b.length===0)return;let U="",$=0;for(const q of b)U+=o.substring($,q)+m,$=q+d.length;U+=o.substring($),c(U),W(d,U)};if(x.useEffect(()=>{if(!s)return;const U=$=>{($.ctrlKey||$.metaKey)&&$.key==="f"&&($.preventDefault(),v(!0),setTimeout(()=>R.current?.focus(),100))};return window.addEventListener("keydown",U),()=>window.removeEventListener("keydown",U)},[s]),!t)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full py-12 text-center",children:[e.jsx(yt,{className:"h-12 w-12 text-muted-foreground/30 mb-4"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Selecciona un cap\\u00edtulo para ver su contenido"})]});const O=Oo(t),F=O.split(/\s+/).filter(Boolean).length;return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-3 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-sm font-semibold",children:bP(t.chapterNumber,t.title)}),e.jsxs(Q,{variant:"outline",className:"text-xs no-default-hover-elevate no-default-active-elevate",children:[F.toLocaleString()," palabras"]}),t.editedContent&&e.jsx(Q,{variant:"secondary",className:"text-xs no-default-hover-elevate no-default-active-elevate",children:"Editado"})]}),e.jsx("div",{className:"flex items-center gap-1",children:s?e.jsxs(e.Fragment,{children:[e.jsxs(B,{size:"sm",variant:"ghost",onClick:()=>{v(!0),setTimeout(()=>R.current?.focus(),100)},"data-testid":"button-imported-search",children:[e.jsx(ma,{className:"h-4 w-4 mr-1"}),"Buscar"]}),e.jsxs(B,{size:"sm",variant:"ghost",onClick:()=>{i(!1),c(Oo(t)),v(!1),N(!1)},"data-testid":"button-imported-cancel-edit",children:[e.jsx(Gn,{className:"h-4 w-4 mr-1"}),"Cancelar"]}),e.jsxs(B,{size:"sm",onClick:()=>A.mutate({chapterId:t.id,content:o}),disabled:A.isPending,"data-testid":"button-imported-save",children:[A.isPending?e.jsx(be,{className:"h-4 w-4 mr-1 animate-spin"}):e.jsx(Pp,{className:"h-4 w-4 mr-1"}),"Guardar"]})]}):e.jsxs(B,{size:"sm",variant:"outline",onClick:()=>{c(Oo(t)),i(!0)},"data-testid":"button-imported-edit",children:[e.jsx(i1,{className:"h-4 w-4 mr-1"}),"Editar"]})})]}),s&&g&&e.jsxs("div",{className:"mb-3 p-3 bg-muted/50 rounded-md border space-y-2","data-testid":"imported-search-panel",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-1 flex-1 min-w-[200px]",children:[e.jsx(ma,{className:"h-4 w-4 text-muted-foreground shrink-0"}),e.jsx(gt,{ref:R,value:d,onChange:U=>{p(U.target.value),W(U.target.value,o)},onKeyDown:U=>{U.key==="Enter"&&(U.preventDefault(),U.shiftKey?se():X()),U.key==="Escape"&&(v(!1),N(!1),p(""),h(""),C([]),k(-1))},placeholder:"Buscar texto...",className:"h-8 text-sm","data-testid":"input-imported-search-text"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[d&&e.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap","data-testid":"text-imported-search-count",children:b.length>0?`${S+1} de ${b.length}`:"Sin resultados"}),e.jsx(B,{size:"icon",variant:"ghost",onClick:se,disabled:b.length===0,"data-testid":"button-imported-search-prev",children:e.jsx(kp,{className:"h-4 w-4"})}),e.jsx(B,{size:"icon",variant:"ghost",onClick:X,disabled:b.length===0,"data-testid":"button-imported-search-next",children:e.jsx(Qs,{className:"h-4 w-4"})}),e.jsxs(B,{size:"sm",variant:j?"secondary":"ghost",onClick:()=>N(!j),"data-testid":"button-imported-toggle-replace",children:[e.jsx(Gu,{className:"h-4 w-4 mr-1"}),"Reemplazar"]}),e.jsx(B,{size:"icon",variant:"ghost",onClick:()=>{v(!1),N(!1),p(""),h(""),C([]),k(-1)},"data-testid":"button-imported-close-search",children:e.jsx(Gn,{className:"h-4 w-4"})})]})]}),j&&e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-1 flex-1 min-w-[200px]",children:[e.jsx(Gu,{className:"h-4 w-4 text-muted-foreground shrink-0"}),e.jsx(gt,{value:m,onChange:U=>h(U.target.value),onKeyDown:U=>{U.key==="Enter"&&(U.preventDefault(),V())},placeholder:"Reemplazar con...",className:"h-8 text-sm","data-testid":"input-imported-replace-text"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(B,{size:"sm",variant:"outline",onClick:V,disabled:b.length===0,"data-testid":"button-imported-replace-one",children:"Reemplazar"}),e.jsx(B,{size:"sm",variant:"outline",onClick:G,disabled:b.length===0,"data-testid":"button-imported-replace-all",children:"Reemplazar todo"})]})]})]}),e.jsx(jt,{className:"flex-1",children:s?e.jsx(Nn,{ref:P,value:o,onChange:U=>c(U.target.value),className:"min-h-[500px] font-serif text-base leading-8 resize-none whitespace-pre-wrap",style:{lineHeight:"2rem",paddingTop:"1rem",paddingBottom:"1rem"},placeholder:"Escribe el contenido del cap\\u00edtulo aqu\\u00ed.","data-testid":"textarea-imported-edit-chapter"}):e.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none font-serif text-base leading-8",children:O.split(`

`).map((U,$)=>e.jsx("p",{className:"mb-4",children:U},$))})})]})}function s9(){const[t,n]=x.useState(null),[r,s]=x.useState(null),[i,o]=x.useState(!1),[c,d]=x.useState("architect"),[p,m]=x.useState(!1),[h,g]=x.useState("es"),[,v]=ol(),{toast:j}=nn(),N={architect:"Arquitecto",reeditor:"Re-editor"},{data:b=[],isLoading:C}=Ke({queryKey:["/api/imported-manuscripts"]}),S=b.find(V=>V.id===t)||null,{data:k=[],isLoading:P}=Ke({queryKey:["/api/imported-manuscripts",t,"chapters"],enabled:!!t}),R=ye({mutationFn:async V=>(await je("POST",`/api/imported-manuscripts/${V}/normalize-titles`)).json(),onSuccess:V=>{j({title:"Ttulos normalizados",description:`Se actualizaron ${V.chaptersUpdated} de ${V.totalChapters} captulos.`}),ae.invalidateQueries({queryKey:["/api/imported-manuscripts",t,"chapters"]})},onError:V=>{j({title:"Error",description:V.message||"No se pudieron normalizar los ttulos",variant:"destructive"})}}),E=()=>{if(!S||k.length===0)return;const V=Xw[S.detectedLanguage?.toLowerCase()||"es"]||Xw.es,G=Zw(k).filter($=>Oo($)).map($=>{let q=n9(Oo($)),le;return $.chapterNumber===0?le=`# ${$.title||V.prologue}`:$.chapterNumber===-1?le=`# ${$.title||V.epilogue}`:$.chapterNumber===-2?le=`# ${$.title||V.authorNote}`:le=`# ${V.chapter} ${$.chapterNumber}${$.title?`: ${$.title}`:""}`,`${le}

${q}`}).join(`


`),O=new Blob([G],{type:"text/markdown"}),F=URL.createObjectURL(O),U=document.createElement("a");U.href=F,U.download=`${S.title.replace(/\s+/g,"_")}.md`,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(F)},A=ye({mutationFn:async({manuscriptId:V,tgtLang:G})=>(await je("POST",`/api/imported-manuscripts/${V}/send-to-translation`,{targetLanguage:G})).json(),onSuccess:()=>{j({title:"Enviado a traducciones",description:"El manuscrito se ha enviado a la seccin de traducciones."}),m(!1),v("/export")},onError:V=>{j({title:"Error",description:V.message||"No se pudo enviar a traducciones",variant:"destructive"})}}),W=Zw(k),X=k.filter(V=>V.status==="completed"),se=k.reduce((V,G)=>V+(G.wordCount||0),0);return C?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx(mn,{className:"h-12 w-12 text-muted-foreground/30 mx-auto mb-4 animate-pulse"}),e.jsx("p",{className:"text-muted-foreground",children:"Cargando libros importados..."})]})}):b.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-6",children:[e.jsx(mn,{className:"h-16 w-16 text-muted-foreground/20 mb-4"}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Sin libros importados"}),e.jsx("p",{className:"text-muted-foreground max-w-md",children:'Importa un manuscrito desde la secci\\u00f3n "Importar Libros" para comenzar'})]}):t?e.jsxs("div",{className:"h-full flex flex-col p-6","data-testid":"imported-manuscripts-detail-page",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-6 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(B,{variant:"ghost",size:"icon",onClick:()=>{n(null),s(null)},"data-testid":"button-back-to-list",children:e.jsx(YN,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:S?.title}),e.jsxs("div",{className:"flex items-center gap-3 mt-2 flex-wrap",children:[e.jsx(Q,{variant:"secondary",children:Yw(S?.detectedLanguage)}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[X.length,"/",k.length," cap\\u00edtulos editados"]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[se.toLocaleString()," palabras"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(mv,{children:[e.jsx(hv,{asChild:!0,children:e.jsxs(B,{variant:i?"secondary":"outline","data-testid":"button-imported-toggle-chat",children:[c==="architect"?e.jsx($i,{className:"h-4 w-4 mr-2"}):e.jsx(Ec,{className:"h-4 w-4 mr-2"}),i?`Cerrar ${N[c]}`:"Agentes IA",e.jsx(Qs,{className:"h-4 w-4 ml-2"})]})}),e.jsxs(sm,{children:[e.jsxs(Zo,{onClick:()=>{d("architect"),o(!0)},"data-testid":"menu-imported-agent-architect",children:[e.jsx($i,{className:"h-4 w-4 mr-2"}),"Arquitecto (trama y estructura)"]}),e.jsxs(Zo,{onClick:()=>{d("reeditor"),o(!0)},"data-testid":"menu-imported-agent-reeditor",children:[e.jsx(Ec,{className:"h-4 w-4 mr-2"}),"Re-editor (correcciones y mejoras)"]})]})]}),i&&e.jsx(B,{variant:"ghost",size:"sm",onClick:()=>o(!1),"data-testid":"button-imported-close-chat",children:"Cerrar"})]}),e.jsxs(B,{variant:"outline",onClick:()=>t&&R.mutate(t),disabled:R.isPending||k.length===0,"data-testid":"button-imported-normalize-titles",children:[R.isPending?e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(o1,{className:"h-4 w-4 mr-2"}),"Normalizar T\\u00edtulos"]}),e.jsxs(B,{variant:"outline",onClick:E,disabled:k.length===0,"data-testid":"button-imported-download",children:[e.jsx(xn,{className:"h-4 w-4 mr-2"}),"Descargar MD"]}),e.jsxs(B,{variant:"default",onClick:()=>m(!0),disabled:k.length===0,"data-testid":"button-imported-send-translation",children:[e.jsx(Io,{className:"h-4 w-4 mr-2"}),"Enviar a Traducciones"]})]})]}),e.jsx(Pn,{open:p,onOpenChange:m,children:e.jsxs(yn,{children:[e.jsxs(jn,{children:[e.jsx(bn,{children:"Enviar a Traducciones"}),e.jsx($n,{children:"Se enviar\\u00e1 el manuscrito importado a la secci\\u00f3n de traducciones para su transcreaci\\u00f3n."})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(st,{children:"Idioma destino"}),e.jsxs(Pt,{value:h,onValueChange:g,children:[e.jsx(St,{"data-testid":"select-imported-target-language",children:e.jsx(Tt,{})}),e.jsx(kt,{children:jP.map(V=>e.jsx(ce,{value:V.code,children:V.name},V.code))})]})]})}),e.jsxs(Ir,{children:[e.jsx(B,{variant:"outline",onClick:()=>m(!1),children:"Cancelar"}),e.jsxs(B,{onClick:()=>t&&A.mutate({manuscriptId:t,tgtLang:h}),disabled:A.isPending,"data-testid":"button-confirm-send-translation",children:[A.isPending?e.jsx(be,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Io,{className:"h-4 w-4 mr-2"}),"Enviar"]})]})]})}),e.jsxs("div",{className:`flex-1 grid grid-cols-1 gap-6 min-h-0 ${i?"lg:grid-cols-4":"lg:grid-cols-3"}`,children:[e.jsxs(me,{className:"lg:col-span-1",children:[e.jsx(Re,{className:"pb-2",children:e.jsx(Ie,{className:"text-lg",children:"Cap\\u00edtulos"})}),e.jsx(he,{className:"p-0",children:e.jsx(jt,{className:"h-[calc(100vh-320px)]",children:e.jsx("div",{className:"p-4 space-y-2",children:P?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(be,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):W.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"Sin cap\\u00edtulos"}):W.map(V=>e.jsxs(B,{variant:r?.id===V.id?"secondary":"ghost",className:"w-full justify-start gap-2",onClick:()=>s(V),"data-testid":`button-imported-chapter-${V.id}`,children:[e.jsx(Q,{variant:"outline",className:`font-mono text-xs shrink-0 no-default-hover-elevate no-default-active-elevate ${V.status==="completed"?"bg-green-500/10 text-green-600 border-green-500/30":V.status==="processing"?"bg-blue-500/10 text-blue-600 border-blue-500/30":"bg-muted text-muted-foreground"}`,children:e9(V.chapterNumber)}),e.jsx("span",{className:"truncate flex-1 text-left text-sm",children:bP(V.chapterNumber,V.title)}),V.status==="completed"&&e.jsx(Xt,{className:"h-4 w-4 text-green-500 shrink-0"}),V.status==="processing"&&e.jsx(be,{className:"h-4 w-4 animate-spin text-blue-500 shrink-0"}),V.status==="pending"&&e.jsx(Cn,{className:"h-4 w-4 text-muted-foreground shrink-0"}),V.status==="error"&&e.jsx(Dr,{className:"h-4 w-4 text-destructive shrink-0"})]},V.id))})})})]}),e.jsxs(me,{className:"flex flex-col lg:col-span-2",children:[e.jsx(Re,{className:"pb-2",children:e.jsx(Ie,{className:"text-lg",children:"Vista Previa"})}),e.jsx(he,{className:"flex-1 min-h-0",children:e.jsx(r9,{chapter:r,manuscriptId:t,onChapterUpdated:()=>{ae.invalidateQueries({queryKey:["/api/imported-manuscripts",t,"chapters"]})}})})]}),i&&S&&e.jsx(sv,{agentType:c,projectId:void 0,chapterNumber:r?.chapterNumber,className:"lg:col-span-1 h-[calc(100vh-220px)]",onClose:()=>o(!1)})]})]}):e.jsxs("div",{className:"h-full flex flex-col p-6","data-testid":"imported-manuscripts-page",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Libros Importados"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Selecciona un libro importado para ver y editar su contenido"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:b.map(V=>e.jsxs(me,{className:"hover-elevate cursor-pointer",onClick:()=>n(V.id),"data-testid":`card-imported-manuscript-${V.id}`,children:[e.jsx(Re,{className:"pb-2",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx(Ie,{className:"text-base truncate",children:V.title}),e.jsxs(Q,{variant:V.status==="completed"?"default":"secondary",className:"shrink-0 no-default-hover-elevate no-default-active-elevate",children:[V.status==="completed"&&e.jsx(Xt,{className:"h-3 w-3 mr-1"}),V.status==="processing"&&e.jsx(be,{className:"h-3 w-3 mr-1 animate-spin"}),V.status==="pending"&&e.jsx(Cn,{className:"h-3 w-3 mr-1"}),V.status]})]})}),e.jsx(he,{children:e.jsxs("div",{className:"flex items-center gap-3 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(yt,{className:"h-3 w-3"}),e.jsxs("span",{children:[V.totalChapters||0," caps."]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Mi,{className:"h-3 w-3"}),e.jsx("span",{children:Yw(V.detectedLanguage)})]})]})})]},V.id))})]})}const a9="/assets/ASD_1766442257801-Djy0Uxxs.png";function i9(){return e.jsxs(O4,{children:[e.jsx(En,{path:"/",component:YD}),e.jsx(En,{path:"/manuscript",component:mL}),e.jsx(En,{path:"/translations",component:V8}),e.jsx(En,{path:"/export",component:q8}),e.jsx(En,{path:"/world-bible",component:wL}),e.jsx(En,{path:"/thought-logs",component:zL}),e.jsx(En,{path:"/pseudonyms",component:T8}),e.jsx(En,{path:"/series",component:G8}),e.jsx(En,{path:"/queue",component:H8}),e.jsx(En,{path:"/reedit",component:dq}),e.jsx(En,{path:"/compare",component:Pq}),e.jsx(En,{path:"/costs-history",component:vq}),e.jsx(En,{path:"/generate-guide",component:Rq}),e.jsx(En,{path:"/generate-series-guide",component:Iq}),e.jsx(En,{path:"/style-guides",component:qq}),e.jsx(En,{path:"/auditor",component:Hq}),e.jsx(En,{path:"/corrected-manuscripts",component:Fq}),e.jsx(En,{path:"/writing-lessons",component:Yq}),e.jsx(En,{path:"/auto-corrector",component:Jq}),e.jsx(En,{path:"/imported-manuscripts",component:s9}),e.jsx(En,{path:"/config",component:P8}),e.jsx(En,{component:z3})]})}function o9(){const{projects:t,currentProject:n,setSelectedProjectId:r}=fi();return t.length===0?null:e.jsx(s3,{projects:t,selectedProjectId:n?.id||null,onSelectProject:r})}function l9(){const t={"--sidebar-width":"16rem","--sidebar-width-icon":"3rem"};return e.jsxs(n3,{children:[e.jsx(gO,{style:t,children:e.jsxs("div",{className:"flex h-screen w-full",children:[e.jsx(t3,{}),e.jsxs("div",{className:"flex flex-col flex-1 min-w-0",children:[e.jsxs("header",{className:"flex items-center justify-between gap-4 p-3 border-b shrink-0 sticky top-0 z-50 bg-background",children:[e.jsx(yO,{"data-testid":"button-sidebar-toggle"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(o9,{}),e.jsx($3,{}),e.jsx(tM,{})]})]}),e.jsx("main",{className:"flex-1 overflow-auto",children:e.jsx(i9,{})}),e.jsxs("footer",{className:"flex items-center justify-center gap-2 px-3 py-1.5 border-t text-xs text-muted-foreground shrink-0",children:[e.jsx("img",{src:a9,alt:"ASD",className:"h-4 w-auto"}),e.jsxs("span",{children:[" ",new Date().getFullYear()," Atreyu Servicios Digitales"]})]})]})]})}),e.jsx(k_,{})]})}function c9(){const[t,n]=x.useState(null),{data:r,isLoading:s}=Ke({queryKey:["/api/auth/status"],retry:!1});x.useEffect(()=>{r&&(r.authEnabled?n(r.isAuthenticated):n(!0))},[r]);const i=()=>{n(!0)};return s||t===null?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-pulse text-muted-foreground",children:"Cargando..."})}):t?e.jsx(l9,{}):e.jsx(l3,{onLoginSuccess:i})}function d9(){return e.jsx(tR,{client:ae,children:e.jsx(JI,{children:e.jsx(H1,{children:e.jsx(c9,{})})})})}p4.createRoot(document.getElementById("root")).render(e.jsx(d9,{}));
